{"version":3,"file":"bundle.js","sources":["../../node_modules/svelte/src/runtime/internal/utils.js","../../node_modules/svelte/src/runtime/internal/environment.js","../../node_modules/svelte/src/runtime/internal/loop.js","../../node_modules/svelte/src/runtime/internal/globals.js","../../node_modules/svelte/src/runtime/internal/dom.js","../../node_modules/svelte/src/runtime/internal/style_manager.js","../../node_modules/svelte/src/runtime/internal/lifecycle.js","../../node_modules/svelte/src/runtime/internal/scheduler.js","../../node_modules/svelte/src/runtime/internal/transitions.js","../../node_modules/svelte/src/runtime/internal/await_block.js","../../node_modules/svelte/src/runtime/internal/each.js","../../node_modules/svelte/src/runtime/internal/spread.js","../../node_modules/svelte/src/runtime/internal/Component.js","../../node_modules/svelte/src/shared/version.js","../../node_modules/svelte/src/runtime/internal/disclose-version/index.js","../../node_modules/svelte-routing/src/contexts.js","../../node_modules/svelte-routing/src/utils.js","../../node_modules/svelte-routing/src/Route.svelte","../../node_modules/svelte/src/runtime/store/index.js","../../node_modules/svelte-routing/src/history.js","../../node_modules/svelte-routing/src/Router.svelte","../../src/utils/eventsStore.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/crypto.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/utils.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/utils.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/modular.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/curve.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/weierstrass.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/_shortw_utils.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/secp256k1.js","../../node_modules/nostr-tools/node_modules/@scure/base/lib/esm/index.js","../../node_modules/@scure/bip39/esm/wordlists/english.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/crypto.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/utils.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/pbkdf2.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/_u64.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/sha512.js","../../node_modules/@scure/base/lib/esm/index.js","../../node_modules/@scure/bip39/esm/index.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/utils.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/ripemd160.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/_u64.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/sha512.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/crypto.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/utils.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/utils.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/modular.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/curve.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/weierstrass.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/_shortw_utils.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/secp256k1.js","../../node_modules/@scure/bip32/lib/esm/index.js","../../node_modules/@noble/ciphers/esm/utils.js","../../node_modules/@noble/ciphers/esm/_assert.js","../../node_modules/@noble/ciphers/esm/_poly1305.js","../../node_modules/@noble/ciphers/esm/_salsa.js","../../node_modules/@noble/ciphers/esm/chacha.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/hkdf.js","../../node_modules/nostr-tools/lib/esm/index.js","../../node_modules/tseep/lib/types.js","../../node_modules/tseep/lib/task-collection/bake-collection.js","../../node_modules/tseep/lib/task-collection/task-collection.js","../../node_modules/tseep/lib/task-collection/index.js","../../node_modules/tseep/lib/utils.js","../../node_modules/tseep/lib/ee.js","../../node_modules/tseep/lib/index.js","../../node_modules/ms/index.js","../../node_modules/debug/src/common.js","../../node_modules/debug/src/browser.js","../../node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@noble/hashes/esm/crypto.js","../../node_modules/@noble/hashes/esm/utils.js","../../node_modules/@noble/hashes/esm/_md.js","../../node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@noble/curves/esm/abstract/utils.js","../../node_modules/@noble/curves/esm/abstract/modular.js","../../node_modules/@noble/curves/esm/abstract/curve.js","../../node_modules/@noble/curves/esm/abstract/weierstrass.js","../../node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@noble/curves/esm/_shortw_utils.js","../../node_modules/@noble/curves/esm/secp256k1.js","../../node_modules/typescript-lru-cache/dist/LRUCacheNode.js","../../node_modules/typescript-lru-cache/dist/LRUCache.js","../../node_modules/typescript-lru-cache/dist/index.js","../../node_modules/light-bolt11-decoder/node_modules/@scure/base/lib/index.js","../../node_modules/light-bolt11-decoder/bolt11.js","../../node_modules/@nostr-dev-kit/ndk/dist/index.mjs","../../src/utils/encryption.js","../../src/utils/todoEvents.js","../../src/routes/TodoPage.svelte","../../src/App.svelte","../../src/Login.svelte","../../src/main.js"],"sourcesContent":["/** @returns {void} */\nexport function noop() {}\n\nexport const identity = (x) => x;\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nexport function assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n/**\n * @param {any} value\n * @returns {value is PromiseLike<any>}\n */\nexport function is_promise(value) {\n\treturn (\n\t\t!!value &&\n\t\t(typeof value === 'object' || typeof value === 'function') &&\n\t\ttypeof (/** @type {any} */ (value).then) === 'function'\n\t);\n}\n\n/** @returns {void} */\nexport function add_location(element, file, line, column, char) {\n\telement.__svelte_meta = {\n\t\tloc: { file, line, column, char }\n\t};\n}\n\nexport function run(fn) {\n\treturn fn();\n}\n\nexport function blank_object() {\n\treturn Object.create(null);\n}\n\n/**\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function run_all(fns) {\n\tfns.forEach(run);\n}\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\n/** @returns {boolean} */\nexport function safe_not_equal(a, b) {\n\treturn a != a ? b == b : a !== b || (a && typeof a === 'object') || typeof a === 'function';\n}\n\nlet src_url_equal_anchor;\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nexport function src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\tif (!src_url_equal_anchor) {\n\t\tsrc_url_equal_anchor = document.createElement('a');\n\t}\n\t// This is actually faster than doing URL(..).href\n\tsrc_url_equal_anchor.href = url;\n\treturn element_src === src_url_equal_anchor.href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element_srcset\n * @param {string | undefined | null} srcset\n * @returns {boolean}\n */\nexport function srcset_url_equal(element_srcset, srcset) {\n\tconst element_urls = split_srcset(element_srcset.srcset);\n\tconst urls = split_srcset(srcset || '');\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n\n/** @returns {boolean} */\nexport function not_equal(a, b) {\n\treturn a != a ? b == b : a !== b;\n}\n\n/** @returns {boolean} */\nexport function is_empty(obj) {\n\treturn Object.keys(obj).length === 0;\n}\n\n/** @returns {void} */\nexport function validate_store(store, name) {\n\tif (store != null && typeof store.subscribe !== 'function') {\n\t\tthrow new Error(`'${name}' is not a store with a 'subscribe' method`);\n\t}\n}\n\nexport function subscribe(store, ...callbacks) {\n\tif (store == null) {\n\t\tfor (const callback of callbacks) {\n\t\t\tcallback(undefined);\n\t\t}\n\t\treturn noop;\n\t}\n\tconst unsub = store.subscribe(...callbacks);\n\treturn unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\n\n/**\n * Get the current value from a store by subscribing and immediately unsubscribing.\n *\n * https://svelte.dev/docs/svelte-store#get\n * @template T\n * @param {import('../store/public.js').Readable<T>} store\n * @returns {T}\n */\nexport function get_store_value(store) {\n\tlet value;\n\tsubscribe(store, (_) => (value = _))();\n\treturn value;\n}\n\n/** @returns {void} */\nexport function component_subscribe(component, store, callback) {\n\tcomponent.$$.on_destroy.push(subscribe(store, callback));\n}\n\nexport function create_slot(definition, ctx, $$scope, fn) {\n\tif (definition) {\n\t\tconst slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n\t\treturn definition[0](slot_ctx);\n\t}\n}\n\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n\treturn definition[1] && fn ? assign($$scope.ctx.slice(), definition[1](fn(ctx))) : $$scope.ctx;\n}\n\nexport function get_slot_changes(definition, $$scope, dirty, fn) {\n\tif (definition[2] && fn) {\n\t\tconst lets = definition[2](fn(dirty));\n\t\tif ($$scope.dirty === undefined) {\n\t\t\treturn lets;\n\t\t}\n\t\tif (typeof lets === 'object') {\n\t\t\tconst merged = [];\n\t\t\tconst len = Math.max($$scope.dirty.length, lets.length);\n\t\t\tfor (let i = 0; i < len; i += 1) {\n\t\t\t\tmerged[i] = $$scope.dirty[i] | lets[i];\n\t\t\t}\n\t\t\treturn merged;\n\t\t}\n\t\treturn $$scope.dirty | lets;\n\t}\n\treturn $$scope.dirty;\n}\n\n/** @returns {void} */\nexport function update_slot_base(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tslot_changes,\n\tget_slot_context_fn\n) {\n\tif (slot_changes) {\n\t\tconst slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n\t\tslot.p(slot_context, slot_changes);\n\t}\n}\n\n/** @returns {void} */\nexport function update_slot(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tdirty,\n\tget_slot_changes_fn,\n\tget_slot_context_fn\n) {\n\tconst slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n\tupdate_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\n\n/** @returns {any[] | -1} */\nexport function get_all_dirty_from_scope($$scope) {\n\tif ($$scope.ctx.length > 32) {\n\t\tconst dirty = [];\n\t\tconst length = $$scope.ctx.length / 32;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tdirty[i] = -1;\n\t\t}\n\t\treturn dirty;\n\t}\n\treturn -1;\n}\n\n/** @returns {{}} */\nexport function exclude_internal_props(props) {\n\tconst result = {};\n\tfor (const k in props) if (k[0] !== '$') result[k] = props[k];\n\treturn result;\n}\n\n/** @returns {{}} */\nexport function compute_rest_props(props, keys) {\n\tconst rest = {};\n\tkeys = new Set(keys);\n\tfor (const k in props) if (!keys.has(k) && k[0] !== '$') rest[k] = props[k];\n\treturn rest;\n}\n\n/** @returns {{}} */\nexport function compute_slots(slots) {\n\tconst result = {};\n\tfor (const key in slots) {\n\t\tresult[key] = true;\n\t}\n\treturn result;\n}\n\n/** @returns {(this: any, ...args: any[]) => void} */\nexport function once(fn) {\n\tlet ran = false;\n\treturn function (...args) {\n\t\tif (ran) return;\n\t\tran = true;\n\t\tfn.call(this, ...args);\n\t};\n}\n\nexport function null_to_empty(value) {\n\treturn value == null ? '' : value;\n}\n\nexport function set_store_value(store, ret, value) {\n\tstore.set(value);\n\treturn ret;\n}\n\nexport const has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n\nexport function action_destroyer(action_result) {\n\treturn action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nexport function split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\nexport const contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n","import { noop } from './utils.js';\n\nexport const is_client = typeof window !== 'undefined';\n\n/** @type {() => number} */\nexport let now = is_client ? () => window.performance.now() : () => Date.now();\n\nexport let raf = is_client ? (cb) => requestAnimationFrame(cb) : noop;\n\n// used internally for testing\n/** @returns {void} */\nexport function set_now(fn) {\n\tnow = fn;\n}\n\n/** @returns {void} */\nexport function set_raf(fn) {\n\traf = fn;\n}\n","import { raf } from './environment.js';\n\nconst tasks = new Set();\n\n/**\n * @param {number} now\n * @returns {void}\n */\nfunction run_tasks(now) {\n\ttasks.forEach((task) => {\n\t\tif (!task.c(now)) {\n\t\t\ttasks.delete(task);\n\t\t\ttask.f();\n\t\t}\n\t});\n\tif (tasks.size !== 0) raf(run_tasks);\n}\n\n/**\n * For testing purposes only!\n * @returns {void}\n */\nexport function clear_loops() {\n\ttasks.clear();\n}\n\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n * @param {import('./private.js').TaskCallback} callback\n * @returns {import('./private.js').Task}\n */\nexport function loop(callback) {\n\t/** @type {import('./private.js').TaskEntry} */\n\tlet task;\n\tif (tasks.size === 0) raf(run_tasks);\n\treturn {\n\t\tpromise: new Promise((fulfill) => {\n\t\t\ttasks.add((task = { c: callback, f: fulfill }));\n\t\t}),\n\t\tabort() {\n\t\t\ttasks.delete(task);\n\t\t}\n\t};\n}\n","/** @type {typeof globalThis} */\nexport const globals =\n\ttypeof window !== 'undefined'\n\t\t? window\n\t\t: typeof globalThis !== 'undefined'\n\t\t? globalThis\n\t\t: // @ts-ignore Node typings have this\n\t\t  global;\n","import { contenteditable_truthy_values, has_prop } from './utils.js';\n\nimport { ResizeObserverSingleton } from './ResizeObserverSingleton.js';\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\n\n/**\n * @returns {void}\n */\nexport function start_hydrating() {\n\tis_hydrating = true;\n}\n\n/**\n * @returns {void}\n */\nexport function end_hydrating() {\n\tis_hydrating = false;\n}\n\n/**\n * @param {number} low\n * @param {number} high\n * @param {(index: number) => number} key\n * @param {number} value\n * @returns {number}\n */\nfunction upper_bound(low, high, key, value) {\n\t// Return first index of value larger than input value in the range [low, high)\n\twhile (low < high) {\n\t\tconst mid = low + ((high - low) >> 1);\n\t\tif (key(mid) <= value) {\n\t\t\tlow = mid + 1;\n\t\t} else {\n\t\t\thigh = mid;\n\t\t}\n\t}\n\treturn low;\n}\n\n/**\n * @param {NodeEx} target\n * @returns {void}\n */\nfunction init_hydrate(target) {\n\tif (target.hydrate_init) return;\n\ttarget.hydrate_init = true;\n\t// We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n\n\tlet children = /** @type {ArrayLike<NodeEx2>} */ (target.childNodes);\n\t// If target is <head>, there may be children without claim_order\n\tif (target.nodeName === 'HEAD') {\n\t\tconst my_children = [];\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst node = children[i];\n\t\t\tif (node.claim_order !== undefined) {\n\t\t\t\tmy_children.push(node);\n\t\t\t}\n\t\t}\n\t\tchildren = my_children;\n\t}\n\t/*\n\t * Reorder claimed children optimally.\n\t * We can reorder claimed children optimally by finding the longest subsequence of\n\t * nodes that are already claimed in order and only moving the rest. The longest\n\t * subsequence of nodes that are claimed in order can be found by\n\t * computing the longest increasing subsequence of .claim_order values.\n\t *\n\t * This algorithm is optimal in generating the least amount of reorder operations\n\t * possible.\n\t *\n\t * Proof:\n\t * We know that, given a set of reordering operations, the nodes that do not move\n\t * always form an increasing subsequence, since they do not move among each other\n\t * meaning that they must be already ordered among each other. Thus, the maximal\n\t * set of nodes that do not move form a longest increasing subsequence.\n\t */\n\t// Compute longest increasing subsequence\n\t// m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n\tconst m = new Int32Array(children.length + 1);\n\t// Predecessor indices + 1\n\tconst p = new Int32Array(children.length);\n\tm[0] = -1;\n\tlet longest = 0;\n\tfor (let i = 0; i < children.length; i++) {\n\t\tconst current = children[i].claim_order;\n\t\t// Find the largest subsequence length such that it ends in a value less than our current value\n\t\t// upper_bound returns first greater value, so we subtract one\n\t\t// with fast path for when we are on the current longest subsequence\n\t\tconst seq_len =\n\t\t\t(longest > 0 && children[m[longest]].claim_order <= current\n\t\t\t\t? longest + 1\n\t\t\t\t: upper_bound(1, longest, (idx) => children[m[idx]].claim_order, current)) - 1;\n\t\tp[i] = m[seq_len] + 1;\n\t\tconst new_len = seq_len + 1;\n\t\t// We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n\t\tm[new_len] = i;\n\t\tlongest = Math.max(new_len, longest);\n\t}\n\t// The longest increasing subsequence of nodes (initially reversed)\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst lis = [];\n\t// The rest of the nodes, nodes that will be moved\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst to_move = [];\n\tlet last = children.length - 1;\n\tfor (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n\t\tlis.push(children[cur - 1]);\n\t\tfor (; last >= cur; last--) {\n\t\t\tto_move.push(children[last]);\n\t\t}\n\t\tlast--;\n\t}\n\tfor (; last >= 0; last--) {\n\t\tto_move.push(children[last]);\n\t}\n\tlis.reverse();\n\t// We sort the nodes being moved to guarantee that their insertion order matches the claim order\n\tto_move.sort((a, b) => a.claim_order - b.claim_order);\n\t// Finally, we move the nodes\n\tfor (let i = 0, j = 0; i < to_move.length; i++) {\n\t\twhile (j < lis.length && to_move[i].claim_order >= lis[j].claim_order) {\n\t\t\tj++;\n\t\t}\n\t\tconst anchor = j < lis.length ? lis[j] : null;\n\t\ttarget.insertBefore(to_move[i], anchor);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @returns {void}\n */\nexport function append(target, node) {\n\ttarget.appendChild(node);\n}\n\n/**\n * @param {Node} target\n * @param {string} style_sheet_id\n * @param {string} styles\n * @returns {void}\n */\nexport function append_styles(target, style_sheet_id, styles) {\n\tconst append_styles_to = get_root_for_style(target);\n\tif (!append_styles_to.getElementById(style_sheet_id)) {\n\t\tconst style = element('style');\n\t\tstyle.id = style_sheet_id;\n\t\tstyle.textContent = styles;\n\t\tappend_stylesheet(append_styles_to, style);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {ShadowRoot | Document}\n */\nexport function get_root_for_style(node) {\n\tif (!node) return document;\n\tconst root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n\tif (root && /** @type {ShadowRoot} */ (root).host) {\n\t\treturn /** @type {ShadowRoot} */ (root);\n\t}\n\treturn node.ownerDocument;\n}\n\n/**\n * @param {Node} node\n * @returns {CSSStyleSheet}\n */\nexport function append_empty_stylesheet(node) {\n\tconst style_element = element('style');\n\t// For transitions to work without 'style-src: unsafe-inline' Content Security Policy,\n\t// these empty tags need to be allowed with a hash as a workaround until we move to the Web Animations API.\n\t// Using the hash for the empty string (for an empty tag) works in all browsers except Safari.\n\t// So as a workaround for the workaround, when we append empty style tags we set their content to /* empty */.\n\t// The hash 'sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=' will then work even in Safari.\n\tstyle_element.textContent = '/* empty */';\n\tappend_stylesheet(get_root_for_style(node), style_element);\n\treturn style_element.sheet;\n}\n\n/**\n * @param {ShadowRoot | Document} node\n * @param {HTMLStyleElement} style\n * @returns {CSSStyleSheet}\n */\nfunction append_stylesheet(node, style) {\n\tappend(/** @type {Document} */ (node).head || node, style);\n\treturn style.sheet;\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @returns {void}\n */\nexport function append_hydration(target, node) {\n\tif (is_hydrating) {\n\t\tinit_hydrate(target);\n\t\tif (\n\t\t\ttarget.actual_end_child === undefined ||\n\t\t\t(target.actual_end_child !== null && target.actual_end_child.parentNode !== target)\n\t\t) {\n\t\t\ttarget.actual_end_child = target.firstChild;\n\t\t}\n\t\t// Skip nodes of undefined ordering\n\t\twhile (target.actual_end_child !== null && target.actual_end_child.claim_order === undefined) {\n\t\t\ttarget.actual_end_child = target.actual_end_child.nextSibling;\n\t\t}\n\t\tif (node !== target.actual_end_child) {\n\t\t\t// We only insert if the ordering of this node should be modified or the parent node is not target\n\t\t\tif (node.claim_order !== undefined || node.parentNode !== target) {\n\t\t\t\ttarget.insertBefore(node, target.actual_end_child);\n\t\t\t}\n\t\t} else {\n\t\t\ttarget.actual_end_child = node.nextSibling;\n\t\t}\n\t} else if (node.parentNode !== target || node.nextSibling !== null) {\n\t\ttarget.appendChild(node);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @param {Node} [anchor]\n * @returns {void}\n */\nexport function insert(target, node, anchor) {\n\ttarget.insertBefore(node, anchor || null);\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @param {NodeEx} [anchor]\n * @returns {void}\n */\nexport function insert_hydration(target, node, anchor) {\n\tif (is_hydrating && !anchor) {\n\t\tappend_hydration(target, node);\n\t} else if (node.parentNode !== target || node.nextSibling != anchor) {\n\t\ttarget.insertBefore(node, anchor || null);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {void}\n */\nexport function detach(node) {\n\tif (node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function destroy_each(iterations, detaching) {\n\tfor (let i = 0; i < iterations.length; i += 1) {\n\t\tif (iterations[i]) iterations[i].d(detaching);\n\t}\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element(name) {\n\treturn document.createElement(name);\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @param {string} is\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element_is(name, is) {\n\treturn document.createElement(name, { is });\n}\n\n/**\n * @template T\n * @template {keyof T} K\n * @param {T} obj\n * @param {K[]} exclude\n * @returns {Pick<T, Exclude<keyof T, K>>}\n */\nexport function object_without_properties(obj, exclude) {\n\tconst target = /** @type {Pick<T, Exclude<keyof T, K>>} */ ({});\n\tfor (const k in obj) {\n\t\tif (\n\t\t\thas_prop(obj, k) &&\n\t\t\t// @ts-ignore\n\t\t\texclude.indexOf(k) === -1\n\t\t) {\n\t\t\t// @ts-ignore\n\t\t\ttarget[k] = obj[k];\n\t\t}\n\t}\n\treturn target;\n}\n\n/**\n * @template {keyof SVGElementTagNameMap} K\n * @param {K} name\n * @returns {SVGElement}\n */\nexport function svg_element(name) {\n\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n}\n\n/**\n * @param {string} data\n * @returns {Text}\n */\nexport function text(data) {\n\treturn document.createTextNode(data);\n}\n\n/**\n * @returns {Text} */\nexport function space() {\n\treturn text(' ');\n}\n\n/**\n * @returns {Text} */\nexport function empty() {\n\treturn text('');\n}\n\n/**\n * @param {string} content\n * @returns {Comment}\n */\nexport function comment(content) {\n\treturn document.createComment(content);\n}\n\n/**\n * @param {EventTarget} node\n * @param {string} event\n * @param {EventListenerOrEventListenerObject} handler\n * @param {boolean | AddEventListenerOptions | EventListenerOptions} [options]\n * @returns {() => void}\n */\nexport function listen(node, event, handler, options) {\n\tnode.addEventListener(event, handler, options);\n\treturn () => node.removeEventListener(event, handler, options);\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function prevent_default(fn) {\n\treturn function (event) {\n\t\tevent.preventDefault();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopPropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_immediate_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopImmediatePropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function self(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.target === this) fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function trusted(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.isTrusted) fn.call(this, event);\n\t};\n}\n\n/**\n * @param {Element} node\n * @param {string} attribute\n * @param {string} [value]\n * @returns {void}\n */\nexport function attr(node, attribute, value) {\n\tif (value == null) node.removeAttribute(attribute);\n\telse if (node.getAttribute(attribute) !== value) node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_attributes(node, attributes) {\n\t// @ts-ignore\n\tconst descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n\tfor (const key in attributes) {\n\t\tif (attributes[key] == null) {\n\t\t\tnode.removeAttribute(key);\n\t\t} else if (key === 'style') {\n\t\t\tnode.style.cssText = attributes[key];\n\t\t} else if (key === '__value') {\n\t\t\t/** @type {any} */ (node).value = node[key] = attributes[key];\n\t\t} else if (\n\t\t\tdescriptors[key] &&\n\t\t\tdescriptors[key].set &&\n\t\t\talways_set_through_set_attribute.indexOf(key) === -1\n\t\t) {\n\t\t\tnode[key] = attributes[key];\n\t\t} else {\n\t\t\tattr(node, key, attributes[key]);\n\t\t}\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_svg_attributes(node, attributes) {\n\tfor (const key in attributes) {\n\t\tattr(node, key, attributes[key]);\n\t}\n}\n\n/**\n * @param {Record<string, unknown>} data_map\n * @returns {void}\n */\nexport function set_custom_element_data_map(node, data_map) {\n\tObject.keys(data_map).forEach((key) => {\n\t\tset_custom_element_data(node, key, data_map[key]);\n\t});\n}\n\n/**\n * @returns {void} */\nexport function set_custom_element_data(node, prop, value) {\n\tconst lower = prop.toLowerCase(); // for backwards compatibility with existing behavior we do lowercase first\n\tif (lower in node) {\n\t\tnode[lower] = typeof node[lower] === 'boolean' && value === '' ? true : value;\n\t} else if (prop in node) {\n\t\tnode[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n\t} else {\n\t\tattr(node, prop, value);\n\t}\n}\n\n/**\n * @param {string} tag\n */\nexport function set_dynamic_element_data(tag) {\n\treturn /-/.test(tag) ? set_custom_element_data_map : set_attributes;\n}\n\n/**\n * @returns {void}\n */\nexport function xlink_attr(node, attribute, value) {\n\tnode.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @returns {string}\n */\nexport function get_svelte_dataset(node) {\n\treturn node.dataset.svelteH;\n}\n\n/**\n * @returns {unknown[]} */\nexport function get_binding_group_value(group, __value, checked) {\n\tconst value = new Set();\n\tfor (let i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) value.add(group[i].__value);\n\t}\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement[]} group\n * @returns {{ p(...inputs: HTMLInputElement[]): void; r(): void; }}\n */\nexport function init_binding_group(group) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\treturn {\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\t_inputs.forEach((input) => group.push(input));\n\t\t},\n\t\t/* remove */ r() {\n\t\t\t_inputs.forEach((input) => group.splice(group.indexOf(input), 1));\n\t\t}\n\t};\n}\n\n/**\n * @param {number[]} indexes\n * @returns {{ u(new_indexes: number[]): void; p(...inputs: HTMLInputElement[]): void; r: () => void; }}\n */\nexport function init_binding_group_dynamic(group, indexes) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _group = get_binding_group(group);\n\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\n\tfunction get_binding_group(group) {\n\t\tfor (let i = 0; i < indexes.length; i++) {\n\t\t\tgroup = group[indexes[i]] = group[indexes[i]] || [];\n\t\t}\n\t\treturn group;\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction push() {\n\t\t_inputs.forEach((input) => _group.push(input));\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction remove() {\n\t\t_inputs.forEach((input) => _group.splice(_group.indexOf(input), 1));\n\t}\n\treturn {\n\t\t/* update */ u(new_indexes) {\n\t\t\tindexes = new_indexes;\n\t\t\tconst new_group = get_binding_group(group);\n\t\t\tif (new_group !== _group) {\n\t\t\t\tremove();\n\t\t\t\t_group = new_group;\n\t\t\t\tpush();\n\t\t\t}\n\t\t},\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\tpush();\n\t\t},\n\t\t/* remove */ r: remove\n\t};\n}\n\n/** @returns {number} */\nexport function to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/** @returns {any[]} */\nexport function time_ranges_to_array(ranges) {\n\tconst array = [];\n\tfor (let i = 0; i < ranges.length; i += 1) {\n\t\tarray.push({ start: ranges.start(i), end: ranges.end(i) });\n\t}\n\treturn array;\n}\n\n/**\n * @param {Element} element\n * @returns {ChildNode[]}\n */\nexport function children(element) {\n\treturn Array.from(element.childNodes);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {void}\n */\nfunction init_claim_info(nodes) {\n\tif (nodes.claim_info === undefined) {\n\t\tnodes.claim_info = { last_index: 0, total_claimed: 0 };\n\t}\n}\n\n/**\n * @template {ChildNodeEx} R\n * @param {ChildNodeArray} nodes\n * @param {(node: ChildNodeEx) => node is R} predicate\n * @param {(node: ChildNodeEx) => ChildNodeEx | undefined} process_node\n * @param {() => R} create_node\n * @param {boolean} dont_update_last_index\n * @returns {R}\n */\nfunction claim_node(nodes, predicate, process_node, create_node, dont_update_last_index = false) {\n\t// Try to find nodes in an order such that we lengthen the longest increasing subsequence\n\tinit_claim_info(nodes);\n\tconst result_node = (() => {\n\t\t// We first try to find an element after the previous one\n\t\tfor (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// Otherwise, we try to find one before\n\t\t// We iterate in reverse so that we don't go too far back\n\t\tfor (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t} else if (replacement === undefined) {\n\t\t\t\t\t// Since we spliced before the last_index, we decrease it\n\t\t\t\t\tnodes.claim_info.last_index--;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// If we can't find any matching node, we create a new one\n\t\treturn create_node();\n\t})();\n\tresult_node.claim_order = nodes.claim_info.total_claimed;\n\tnodes.claim_info.total_claimed += 1;\n\treturn result_node;\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @param {(name: string) => Element | SVGElement} create_element\n * @returns {Element | SVGElement}\n */\nfunction claim_element_base(nodes, name, attributes, create_element) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Element | SVGElement} */\n\t\t(node) => node.nodeName === name,\n\t\t/** @param {Element} node */\n\t\t(node) => {\n\t\t\tconst remove = [];\n\t\t\tfor (let j = 0; j < node.attributes.length; j++) {\n\t\t\t\tconst attribute = node.attributes[j];\n\t\t\t\tif (!attributes[attribute.name]) {\n\t\t\t\t\tremove.push(attribute.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove.forEach((v) => node.removeAttribute(v));\n\t\t\treturn undefined;\n\t\t},\n\t\t() => create_element(name)\n\t);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_svg_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, svg_element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Text}\n */\nexport function claim_text(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Text} */\n\t\t(node) => node.nodeType === 3,\n\t\t/** @param {Text} node */\n\t\t(node) => {\n\t\t\tconst data_str = '' + data;\n\t\t\tif (node.data.startsWith(data_str)) {\n\t\t\t\tif (node.data.length !== data_str.length) {\n\t\t\t\t\treturn node.splitText(data_str.length);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode.data = data_str;\n\t\t\t}\n\t\t},\n\t\t() => text(data),\n\t\ttrue // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n\t);\n}\n\n/**\n * @returns {Text} */\nexport function claim_space(nodes) {\n\treturn claim_text(nodes, ' ');\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Comment}\n */\nexport function claim_comment(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Comment} */\n\t\t(node) => node.nodeType === 8,\n\t\t/** @param {Comment} node */\n\t\t(node) => {\n\t\t\tnode.data = '' + data;\n\t\t\treturn undefined;\n\t\t},\n\t\t() => comment(data),\n\t\ttrue\n\t);\n}\n\nfunction get_comment_idx(nodes, text, start) {\n\tfor (let i = start; i < nodes.length; i += 1) {\n\t\tconst node = nodes[i];\n\t\tif (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * @param {boolean} is_svg\n * @returns {HtmlTagHydration}\n */\nexport function claim_html_tag(nodes, is_svg) {\n\t// find html opening tag\n\tconst start_index = get_comment_idx(nodes, 'HTML_TAG_START', 0);\n\tconst end_index = get_comment_idx(nodes, 'HTML_TAG_END', start_index + 1);\n\tif (start_index === -1 || end_index === -1) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\n\tinit_claim_info(nodes);\n\tconst html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n\tdetach(html_tag_nodes[0]);\n\tdetach(html_tag_nodes[html_tag_nodes.length - 1]);\n\tconst claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n\tif (claimed_nodes.length === 0) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\tfor (const n of claimed_nodes) {\n\t\tn.claim_order = nodes.claim_info.total_claimed;\n\t\tnodes.claim_info.total_claimed += 1;\n\t}\n\treturn new HtmlTagHydration(is_svg, claimed_nodes);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data(text, data) {\n\tdata = '' + data;\n\tif (text.data === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data_contenteditable(text, data) {\n\tdata = '' + data;\n\tif (text.wholeText === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @param {string} attr_value\n * @returns {void}\n */\nexport function set_data_maybe_contenteditable(text, data, attr_value) {\n\tif (~contenteditable_truthy_values.indexOf(attr_value)) {\n\t\tset_data_contenteditable(text, data);\n\t} else {\n\t\tset_data(text, data);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_input_value(input, value) {\n\tinput.value = value == null ? '' : value;\n}\n\n/**\n * @returns {void} */\nexport function set_input_type(input, type) {\n\ttry {\n\t\tinput.type = type;\n\t} catch (e) {\n\t\t// do nothing\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_style(node, key, value, important) {\n\tif (value == null) {\n\t\tnode.style.removeProperty(key);\n\t} else {\n\t\tnode.style.setProperty(key, value, important ? 'important' : '');\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_option(select, value, mounting) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\tif (option.__value === value) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_options(select, value) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\toption.selected = ~value.indexOf(option.__value);\n\t}\n}\n\nexport function select_value(select) {\n\tconst selected_option = select.querySelector(':checked');\n\treturn selected_option && selected_option.__value;\n}\n\nexport function select_multiple_value(select) {\n\treturn [].map.call(select.querySelectorAll(':checked'), (option) => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\n\n/**\n * @type {boolean} */\nlet crossorigin;\n\n/**\n * @returns {boolean} */\nexport function is_crossorigin() {\n\tif (crossorigin === undefined) {\n\t\tcrossorigin = false;\n\t\ttry {\n\t\t\tif (typeof window !== 'undefined' && window.parent) {\n\t\t\t\tvoid window.parent.document;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tcrossorigin = true;\n\t\t}\n\t}\n\treturn crossorigin;\n}\n\n/**\n * @param {HTMLElement} node\n * @param {() => void} fn\n * @returns {() => void}\n */\nexport function add_iframe_resize_listener(node, fn) {\n\tconst computed_style = getComputedStyle(node);\n\tif (computed_style.position === 'static') {\n\t\tnode.style.position = 'relative';\n\t}\n\tconst iframe = element('iframe');\n\tiframe.setAttribute(\n\t\t'style',\n\t\t'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n\t\t\t'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;'\n\t);\n\tiframe.setAttribute('aria-hidden', 'true');\n\tiframe.tabIndex = -1;\n\tconst crossorigin = is_crossorigin();\n\n\t/**\n\t * @type {() => void}\n\t */\n\tlet unsubscribe;\n\tif (crossorigin) {\n\t\tiframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n\t\tunsubscribe = listen(\n\t\t\twindow,\n\t\t\t'message',\n\t\t\t/** @param {MessageEvent} event */ (event) => {\n\t\t\t\tif (event.source === iframe.contentWindow) fn();\n\t\t\t}\n\t\t);\n\t} else {\n\t\tiframe.src = 'about:blank';\n\t\tiframe.onload = () => {\n\t\t\tunsubscribe = listen(iframe.contentWindow, 'resize', fn);\n\t\t\t// make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n\t\t\t// see https://github.com/sveltejs/svelte/issues/4233\n\t\t\tfn();\n\t\t};\n\t}\n\tappend(node, iframe);\n\treturn () => {\n\t\tif (crossorigin) {\n\t\t\tunsubscribe();\n\t\t} else if (unsubscribe && iframe.contentWindow) {\n\t\t\tunsubscribe();\n\t\t}\n\t\tdetach(iframe);\n\t};\n}\nexport const resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'content-box'\n});\nexport const resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'border-box'\n});\nexport const resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton(\n\t{ box: 'device-pixel-content-box' }\n);\nexport { ResizeObserverSingleton };\n\n/**\n * @returns {void} */\nexport function toggle_class(element, name, toggle) {\n\t// The `!!` is required because an `undefined` flag means flipping the current state.\n\telement.classList.toggle(name, !!toggle);\n}\n\n/**\n * @template T\n * @param {string} type\n * @param {T} [detail]\n * @param {{ bubbles?: boolean, cancelable?: boolean }} [options]\n * @returns {CustomEvent<T>}\n */\nexport function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * @param {string} selector\n * @param {HTMLElement} parent\n * @returns {ChildNodeArray}\n */\nexport function query_selector_all(selector, parent = document.body) {\n\treturn Array.from(parent.querySelectorAll(selector));\n}\n\n/**\n * @param {string} nodeId\n * @param {HTMLElement} head\n * @returns {any[]}\n */\nexport function head_selector(nodeId, head) {\n\tconst result = [];\n\tlet started = 0;\n\tfor (const node of head.childNodes) {\n\t\tif (node.nodeType === 8 /* comment node */) {\n\t\t\tconst comment = node.textContent.trim();\n\t\t\tif (comment === `HEAD_${nodeId}_END`) {\n\t\t\t\tstarted -= 1;\n\t\t\t\tresult.push(node);\n\t\t\t} else if (comment === `HEAD_${nodeId}_START`) {\n\t\t\t\tstarted += 1;\n\t\t\t\tresult.push(node);\n\t\t\t}\n\t\t} else if (started > 0) {\n\t\t\tresult.push(node);\n\t\t}\n\t}\n\treturn result;\n}\n/** */\nexport class HtmlTag {\n\t/**\n\t * @private\n\t * @default false\n\t */\n\tis_svg = false;\n\t/** parent for creating node */\n\te = undefined;\n\t/** html tag nodes */\n\tn = undefined;\n\t/** target */\n\tt = undefined;\n\t/** anchor */\n\ta = undefined;\n\tconstructor(is_svg = false) {\n\t\tthis.is_svg = is_svg;\n\t\tthis.e = this.n = null;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tthis.h(html);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @param {HTMLElement | SVGElement} target\n\t * @param {HTMLElement | SVGElement} anchor\n\t * @returns {void}\n\t */\n\tm(html, target, anchor = null) {\n\t\tif (!this.e) {\n\t\t\tif (this.is_svg)\n\t\t\t\tthis.e = svg_element(/** @type {keyof SVGElementTagNameMap} */ (target.nodeName));\n\t\t\t/** #7364  target for <template> may be provided as #document-fragment(11) */ else\n\t\t\t\tthis.e = element(\n\t\t\t\t\t/** @type {keyof HTMLElementTagNameMap} */ (\n\t\t\t\t\t\ttarget.nodeType === 11 ? 'TEMPLATE' : target.nodeName\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\tthis.t =\n\t\t\t\ttarget.tagName !== 'TEMPLATE'\n\t\t\t\t\t? target\n\t\t\t\t\t: /** @type {HTMLTemplateElement} */ (target).content;\n\t\t\tthis.c(html);\n\t\t}\n\t\tthis.i(anchor);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\th(html) {\n\t\tthis.e.innerHTML = html;\n\t\tthis.n = Array.from(\n\t\t\tthis.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes\n\t\t);\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert(this.t, this.n[i], anchor);\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tp(html) {\n\t\tthis.d();\n\t\tthis.h(html);\n\t\tthis.i(this.a);\n\t}\n\n\t/**\n\t * @returns {void} */\n\td() {\n\t\tthis.n.forEach(detach);\n\t}\n}\n\nexport class HtmlTagHydration extends HtmlTag {\n\t/** @type {Element[]} hydration claimed nodes */\n\tl = undefined;\n\n\tconstructor(is_svg = false, claimed_nodes) {\n\t\tsuper(is_svg);\n\t\tthis.e = this.n = null;\n\t\tthis.l = claimed_nodes;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tif (this.l) {\n\t\t\tthis.n = this.l;\n\t\t} else {\n\t\t\tsuper.c(html);\n\t\t}\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert_hydration(this.t, this.n[i], anchor);\n\t\t}\n\t}\n}\n\n/**\n * @param {NamedNodeMap} attributes\n * @returns {{}}\n */\nexport function attribute_to_object(attributes) {\n\tconst result = {};\n\tfor (const attribute of attributes) {\n\t\tresult[attribute.name] = attribute.value;\n\t}\n\treturn result;\n}\n\nconst escaped = {\n\t'\"': '&quot;',\n\t'&': '&amp;',\n\t'<': '&lt;'\n};\n\nconst regex_attribute_characters_to_escape = /[\"&<]/g;\n\n/**\n * Note that the attribute itself should be surrounded in double quotes\n * @param {any} attribute\n */\nfunction escape_attribute(attribute) {\n\treturn String(attribute).replace(regex_attribute_characters_to_escape, (match) => escaped[match]);\n}\n\n/**\n * @param {Record<string, string>} attributes\n */\nexport function stringify_spread(attributes) {\n\tlet str = ' ';\n\tfor (const key in attributes) {\n\t\tif (attributes[key] != null) {\n\t\t\tstr += `${key}=\"${escape_attribute(attributes[key])}\" `;\n\t\t}\n\t}\n\n\treturn str;\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {{}}\n */\nexport function get_custom_elements_slots(element) {\n\tconst result = {};\n\telement.childNodes.forEach(\n\t\t/** @param {Element} node */ (node) => {\n\t\t\tresult[node.slot || 'default'] = true;\n\t\t}\n\t);\n\treturn result;\n}\n\nexport function construct_svelte_component(component, props) {\n\treturn new component(props);\n}\n\n/**\n * @typedef {Node & {\n * \tclaim_order?: number;\n * \thydrate_init?: true;\n * \tactual_end_child?: NodeEx;\n * \tchildNodes: NodeListOf<NodeEx>;\n * }} NodeEx\n */\n\n/** @typedef {ChildNode & NodeEx} ChildNodeEx */\n\n/** @typedef {NodeEx & { claim_order: number }} NodeEx2 */\n\n/**\n * @typedef {ChildNodeEx[] & {\n * \tclaim_info?: {\n * \t\tlast_index: number;\n * \t\ttotal_claimed: number;\n * \t};\n * }} ChildNodeArray\n */\n","import { append_empty_stylesheet, detach, get_root_for_style } from './dom.js';\nimport { raf } from './environment.js';\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\n/** @type {Map<Document | ShadowRoot, import('./private.d.ts').StyleInformation>} */\nconst managed_styles = new Map();\n\nlet active = 0;\n\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\n/**\n * @param {string} str\n * @returns {number}\n */\nfunction hash(str) {\n\tlet hash = 5381;\n\tlet i = str.length;\n\twhile (i--) hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n\treturn hash >>> 0;\n}\n\n/**\n * @param {Document | ShadowRoot} doc\n * @param {Element & ElementCSSInlineStyle} node\n * @returns {{ stylesheet: any; rules: {}; }}\n */\nfunction create_style_information(doc, node) {\n\tconst info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n\tmanaged_styles.set(doc, info);\n\treturn info;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {number} a\n * @param {number} b\n * @param {number} duration\n * @param {number} delay\n * @param {(t: number) => number} ease\n * @param {(t: number, u: number) => string} fn\n * @param {number} uid\n * @returns {string}\n */\nexport function create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n\tconst step = 16.666 / duration;\n\tlet keyframes = '{\\n';\n\tfor (let p = 0; p <= 1; p += step) {\n\t\tconst t = a + (b - a) * ease(p);\n\t\tkeyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n\t}\n\tconst rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n\tconst name = `__svelte_${hash(rule)}_${uid}`;\n\tconst doc = get_root_for_style(node);\n\tconst { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n\tif (!rules[name]) {\n\t\trules[name] = true;\n\t\tstylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n\t}\n\tconst animation = node.style.animation || '';\n\tnode.style.animation = `${\n\t\tanimation ? `${animation}, ` : ''\n\t}${name} ${duration}ms linear ${delay}ms 1 both`;\n\tactive += 1;\n\treturn name;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {string} [name]\n * @returns {void}\n */\nexport function delete_rule(node, name) {\n\tconst previous = (node.style.animation || '').split(', ');\n\tconst next = previous.filter(\n\t\tname\n\t\t\t? (anim) => anim.indexOf(name) < 0 // remove specific animation\n\t\t\t: (anim) => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n\t);\n\tconst deleted = previous.length - next.length;\n\tif (deleted) {\n\t\tnode.style.animation = next.join(', ');\n\t\tactive -= deleted;\n\t\tif (!active) clear_rules();\n\t}\n}\n\n/** @returns {void} */\nexport function clear_rules() {\n\traf(() => {\n\t\tif (active) return;\n\t\tmanaged_styles.forEach((info) => {\n\t\t\tconst { ownerNode } = info.stylesheet;\n\t\t\t// there is no ownerNode if it runs on jsdom.\n\t\t\tif (ownerNode) detach(ownerNode);\n\t\t});\n\t\tmanaged_styles.clear();\n\t});\n}\n","import { custom_event } from './dom.js';\n\nexport let current_component;\n\n/** @returns {void} */\nexport function set_current_component(component) {\n\tcurrent_component = component;\n}\n\nexport function get_current_component() {\n\tif (!current_component) throw new Error('Function called outside component initialization');\n\treturn current_component;\n}\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#beforeupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tget_current_component().$$.before_update.push(fn);\n}\n\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * If a function is returned _synchronously_ from `onMount`, it will be called when the component is unmounted.\n *\n * `onMount` does not run inside a [server-side component](https://svelte.dev/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs/svelte#onmount\n * @template T\n * @param {() => import('./private.js').NotFunction<T> | Promise<import('./private.js').NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tget_current_component().$$.on_mount.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#afterupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tget_current_component().$$.after_update.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs/svelte#ondestroy\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tget_current_component().$$.on_destroy.push(fn);\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: never; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * https://svelte.dev/docs/svelte#createeventdispatcher\n * @template {Record<string, any>} [EventMap=any]\n * @returns {import('./public.js').EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst component = get_current_component();\n\treturn (type, detail, { cancelable = false } = {}) => {\n\t\tconst callbacks = component.$$.callbacks[type];\n\t\tif (callbacks) {\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = custom_event(/** @type {string} */ (type), detail, { cancelable });\n\t\t\tcallbacks.slice().forEach((fn) => {\n\t\t\t\tfn.call(component, event);\n\t\t\t});\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\t\treturn true;\n\t};\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#setcontext\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tget_current_component().$$.context.set(key, context);\n\treturn context;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#getcontext\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\treturn get_current_component().$$.context.get(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs/svelte#getallcontexts\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\treturn get_current_component().$$.context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#hascontext\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\treturn get_current_component().$$.context.has(key);\n}\n\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\n/**\n * @param component\n * @param event\n * @returns {void}\n */\nexport function bubble(component, event) {\n\tconst callbacks = component.$$.callbacks[event.type];\n\tif (callbacks) {\n\t\t// @ts-ignore\n\t\tcallbacks.slice().forEach((fn) => fn.call(this, event));\n\t}\n}\n","import { run_all } from './utils.js';\nimport { current_component, set_current_component } from './lifecycle.js';\n\nexport const dirty_components = [];\nexport const intros = { enabled: false };\nexport const binding_callbacks = [];\n\nlet render_callbacks = [];\n\nconst flush_callbacks = [];\n\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\n\nlet update_scheduled = false;\n\n/** @returns {void} */\nexport function schedule_update() {\n\tif (!update_scheduled) {\n\t\tupdate_scheduled = true;\n\t\tresolved_promise.then(flush);\n\t}\n}\n\n/** @returns {Promise<void>} */\nexport function tick() {\n\tschedule_update();\n\treturn resolved_promise;\n}\n\n/** @returns {void} */\nexport function add_render_callback(fn) {\n\trender_callbacks.push(fn);\n}\n\n/** @returns {void} */\nexport function add_flush_callback(fn) {\n\tflush_callbacks.push(fn);\n}\n\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\n\nlet flushidx = 0; // Do *not* move this inside the flush() function\n\n/** @returns {void} */\nexport function flush() {\n\t// Do not reenter flush while dirty components are updated, as this can\n\t// result in an infinite loop. Instead, let the inner flush handle it.\n\t// Reentrancy is ok afterwards for bindings etc.\n\tif (flushidx !== 0) {\n\t\treturn;\n\t}\n\tconst saved_component = current_component;\n\tdo {\n\t\t// first, call beforeUpdate functions\n\t\t// and update components\n\t\ttry {\n\t\t\twhile (flushidx < dirty_components.length) {\n\t\t\t\tconst component = dirty_components[flushidx];\n\t\t\t\tflushidx++;\n\t\t\t\tset_current_component(component);\n\t\t\t\tupdate(component.$$);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// reset dirty state to not end up in a deadlocked state and then rethrow\n\t\t\tdirty_components.length = 0;\n\t\t\tflushidx = 0;\n\t\t\tthrow e;\n\t\t}\n\t\tset_current_component(null);\n\t\tdirty_components.length = 0;\n\t\tflushidx = 0;\n\t\twhile (binding_callbacks.length) binding_callbacks.pop()();\n\t\t// then, once components are updated, call\n\t\t// afterUpdate functions. This may cause\n\t\t// subsequent updates...\n\t\tfor (let i = 0; i < render_callbacks.length; i += 1) {\n\t\t\tconst callback = render_callbacks[i];\n\t\t\tif (!seen_callbacks.has(callback)) {\n\t\t\t\t// ...so guard against infinite loops\n\t\t\t\tseen_callbacks.add(callback);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\trender_callbacks.length = 0;\n\t} while (dirty_components.length);\n\twhile (flush_callbacks.length) {\n\t\tflush_callbacks.pop()();\n\t}\n\tupdate_scheduled = false;\n\tseen_callbacks.clear();\n\tset_current_component(saved_component);\n}\n\n/** @returns {void} */\nfunction update($$) {\n\tif ($$.fragment !== null) {\n\t\t$$.update();\n\t\trun_all($$.before_update);\n\t\tconst dirty = $$.dirty;\n\t\t$$.dirty = [-1];\n\t\t$$.fragment && $$.fragment.p($$.ctx, dirty);\n\t\t$$.after_update.forEach(add_render_callback);\n\t}\n}\n\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function flush_render_callbacks(fns) {\n\tconst filtered = [];\n\tconst targets = [];\n\trender_callbacks.forEach((c) => (fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c)));\n\ttargets.forEach((c) => c());\n\trender_callbacks = filtered;\n}\n","import { identity as linear, is_function, noop, run_all } from './utils.js';\nimport { now } from './environment.js';\nimport { loop } from './loop.js';\nimport { create_rule, delete_rule } from './style_manager.js';\nimport { custom_event } from './dom.js';\nimport { add_render_callback } from './scheduler.js';\n\n/**\n * @type {Promise<void> | null}\n */\nlet promise;\n\n/**\n * @returns {Promise<void>}\n */\nfunction wait() {\n\tif (!promise) {\n\t\tpromise = Promise.resolve();\n\t\tpromise.then(() => {\n\t\t\tpromise = null;\n\t\t});\n\t}\n\treturn promise;\n}\n\n/**\n * @param {Element} node\n * @param {INTRO | OUTRO | boolean} direction\n * @param {'start' | 'end'} kind\n * @returns {void}\n */\nfunction dispatch(node, direction, kind) {\n\tnode.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\n\nconst outroing = new Set();\n\n/**\n * @type {Outro}\n */\nlet outros;\n\n/**\n * @returns {void} */\nexport function group_outros() {\n\toutros = {\n\t\tr: 0,\n\t\tc: [],\n\t\tp: outros // parent group\n\t};\n}\n\n/**\n * @returns {void} */\nexport function check_outros() {\n\tif (!outros.r) {\n\t\trun_all(outros.c);\n\t}\n\toutros = outros.p;\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} [local]\n * @returns {void}\n */\nexport function transition_in(block, local) {\n\tif (block && block.i) {\n\t\toutroing.delete(block);\n\t\tblock.i(local);\n\t}\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} local\n * @param {0 | 1} [detach]\n * @param {() => void} [callback]\n * @returns {void}\n */\nexport function transition_out(block, local, detach, callback) {\n\tif (block && block.o) {\n\t\tif (outroing.has(block)) return;\n\t\toutroing.add(block);\n\t\toutros.c.push(() => {\n\t\t\toutroing.delete(block);\n\t\t\tif (callback) {\n\t\t\t\tif (detach) block.d(1);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t\tblock.o(local);\n\t} else if (callback) {\n\t\tcallback();\n\t}\n}\n\n/**\n * @type {import('../transition/public.js').TransitionConfig}\n */\nconst null_transition = { duration: 0 };\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ start(): void; invalidate(): void; end(): void; }}\n */\nexport function create_in_transition(node, fn, params) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'in' };\n\tlet config = fn(node, params, options);\n\tlet running = false;\n\tlet animation_name;\n\tlet task;\n\tlet uid = 0;\n\n\t/**\n\t * @returns {void} */\n\tfunction cleanup() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\t\tif (css) animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n\t\ttick(0, 1);\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tif (task) task.abort();\n\t\trunning = true;\n\t\tadd_render_callback(() => dispatch(node, true, 'start'));\n\t\ttask = loop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(1, 0);\n\t\t\t\t\tdispatch(node, true, 'end');\n\t\t\t\t\tcleanup();\n\t\t\t\t\treturn (running = false);\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\tlet started = false;\n\treturn {\n\t\tstart() {\n\t\t\tif (started) return;\n\t\t\tstarted = true;\n\t\t\tdelete_rule(node);\n\t\t\tif (is_function(config)) {\n\t\t\t\tconfig = config(options);\n\t\t\t\twait().then(go);\n\t\t\t} else {\n\t\t\t\tgo();\n\t\t\t}\n\t\t},\n\t\tinvalidate() {\n\t\t\tstarted = false;\n\t\t},\n\t\tend() {\n\t\t\tif (running) {\n\t\t\t\tcleanup();\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ end(reset: any): void; }}\n */\nexport function create_out_transition(node, fn, params) {\n\t/** @type {TransitionOptions} */\n\tconst options = { direction: 'out' };\n\tlet config = fn(node, params, options);\n\tlet running = true;\n\tlet animation_name;\n\tconst group = outros;\n\tgroup.r += 1;\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\tif (css) animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tadd_render_callback(() => dispatch(node, false, 'start'));\n\n\t\tif ('inert' in node) {\n\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\tnode.inert = true;\n\t\t}\n\n\t\tloop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(0, 1);\n\t\t\t\t\tdispatch(node, false, 'end');\n\t\t\t\t\tif (!--group.r) {\n\t\t\t\t\t\t// this will result in `end()` being called,\n\t\t\t\t\t\t// so we don't need to clean up here\n\t\t\t\t\t\trun_all(group.c);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(1 - t, t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\n\tif (is_function(config)) {\n\t\twait().then(() => {\n\t\t\t// @ts-ignore\n\t\t\tconfig = config(options);\n\t\t\tgo();\n\t\t});\n\t} else {\n\t\tgo();\n\t}\n\n\treturn {\n\t\tend(reset) {\n\t\t\tif (reset && 'inert' in node) {\n\t\t\t\tnode.inert = original_inert_value;\n\t\t\t}\n\t\t\tif (reset && config.tick) {\n\t\t\t\tconfig.tick(1, 0);\n\t\t\t}\n\t\t\tif (running) {\n\t\t\t\tif (animation_name) delete_rule(node, animation_name);\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @param {boolean} intro\n * @returns {{ run(b: 0 | 1): void; end(): void; }}\n */\nexport function create_bidirectional_transition(node, fn, params, intro) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'both' };\n\tlet config = fn(node, params, options);\n\tlet t = intro ? 0 : 1;\n\n\t/**\n\t * @type {Program | null} */\n\tlet running_program = null;\n\n\t/**\n\t * @type {PendingProgram | null} */\n\tlet pending_program = null;\n\tlet animation_name = null;\n\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction clear_animation() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @param {PendingProgram} program\n\t * @param {number} duration\n\t * @returns {Program}\n\t */\n\tfunction init(program, duration) {\n\t\tconst d = /** @type {Program['d']} */ (program.b - t);\n\t\tduration *= Math.abs(d);\n\t\treturn {\n\t\t\ta: t,\n\t\t\tb: program.b,\n\t\t\td,\n\t\t\tduration,\n\t\t\tstart: program.start,\n\t\t\tend: program.start + duration,\n\t\t\tgroup: program.group\n\t\t};\n\t}\n\n\t/**\n\t * @param {INTRO | OUTRO} b\n\t * @returns {void}\n\t */\n\tfunction go(b) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\t/**\n\t\t * @type {PendingProgram} */\n\t\tconst program = {\n\t\t\tstart: now() + delay,\n\t\t\tb\n\t\t};\n\n\t\tif (!b) {\n\t\t\t// @ts-ignore todo: improve typings\n\t\t\tprogram.group = outros;\n\t\t\toutros.r += 1;\n\t\t}\n\n\t\tif ('inert' in node) {\n\t\t\tif (b) {\n\t\t\t\tif (original_inert_value !== undefined) {\n\t\t\t\t\t// aborted/reversed outro  restore previous inert value\n\t\t\t\t\tnode.inert = original_inert_value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\t\tnode.inert = true;\n\t\t\t}\n\t\t}\n\n\t\tif (running_program || pending_program) {\n\t\t\tpending_program = program;\n\t\t} else {\n\t\t\t// if this is an intro, and there's a delay, we need to do\n\t\t\t// an initial tick and/or apply CSS animation immediately\n\t\t\tif (css) {\n\t\t\t\tclear_animation();\n\t\t\t\tanimation_name = create_rule(node, t, b, duration, delay, easing, css);\n\t\t\t}\n\t\t\tif (b) tick(0, 1);\n\t\t\trunning_program = init(program, duration);\n\t\t\tadd_render_callback(() => dispatch(node, b, 'start'));\n\t\t\tloop((now) => {\n\t\t\t\tif (pending_program && now > pending_program.start) {\n\t\t\t\t\trunning_program = init(pending_program, duration);\n\t\t\t\t\tpending_program = null;\n\t\t\t\t\tdispatch(node, running_program.b, 'start');\n\t\t\t\t\tif (css) {\n\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\tanimation_name = create_rule(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tt,\n\t\t\t\t\t\t\trunning_program.b,\n\t\t\t\t\t\t\trunning_program.duration,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\teasing,\n\t\t\t\t\t\t\tconfig.css\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (running_program) {\n\t\t\t\t\tif (now >= running_program.end) {\n\t\t\t\t\t\ttick((t = running_program.b), 1 - t);\n\t\t\t\t\t\tdispatch(node, running_program.b, 'end');\n\t\t\t\t\t\tif (!pending_program) {\n\t\t\t\t\t\t\t// we're done\n\t\t\t\t\t\t\tif (running_program.b) {\n\t\t\t\t\t\t\t\t// intro  we can tidy up immediately\n\t\t\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// outro  needs to be coordinated\n\t\t\t\t\t\t\t\tif (!--running_program.group.r) run_all(running_program.group.c);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trunning_program = null;\n\t\t\t\t\t} else if (now >= running_program.start) {\n\t\t\t\t\t\tconst p = now - running_program.start;\n\t\t\t\t\t\tt = running_program.a + running_program.d * easing(p / running_program.duration);\n\t\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!(running_program || pending_program);\n\t\t\t});\n\t\t}\n\t}\n\treturn {\n\t\trun(b) {\n\t\t\tif (is_function(config)) {\n\t\t\t\twait().then(() => {\n\t\t\t\t\tconst opts = { direction: b ? 'in' : 'out' };\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tconfig = config(opts);\n\t\t\t\t\tgo(b);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgo(b);\n\t\t\t}\n\t\t},\n\t\tend() {\n\t\t\tclear_animation();\n\t\t\trunning_program = pending_program = null;\n\t\t}\n\t};\n}\n\n/** @typedef {1} INTRO */\n/** @typedef {0} OUTRO */\n/** @typedef {{ direction: 'in' | 'out' | 'both' }} TransitionOptions */\n/** @typedef {(node: Element, params: any, options: TransitionOptions) => import('../transition/public.js').TransitionConfig} TransitionFn */\n\n/**\n * @typedef {Object} Outro\n * @property {number} r\n * @property {Function[]} c\n * @property {Object} p\n */\n\n/**\n * @typedef {Object} PendingProgram\n * @property {number} start\n * @property {INTRO|OUTRO} b\n * @property {Outro} [group]\n */\n\n/**\n * @typedef {Object} Program\n * @property {number} a\n * @property {INTRO|OUTRO} b\n * @property {1|-1} d\n * @property {number} duration\n * @property {number} start\n * @property {number} end\n * @property {Outro} [group]\n */\n","import { is_promise } from './utils.js';\nimport { check_outros, group_outros, transition_in, transition_out } from './transitions.js';\nimport { flush } from './scheduler.js';\nimport { get_current_component, set_current_component } from './lifecycle.js';\n\n/**\n * @template T\n * @param {Promise<T>} promise\n * @param {import('./private.js').PromiseInfo<T>} info\n * @returns {boolean}\n */\nexport function handle_promise(promise, info) {\n\tconst token = (info.token = {});\n\t/**\n\t * @param {import('./private.js').FragmentFactory} type\n\t * @param {0 | 1 | 2} index\n\t * @param {number} [key]\n\t * @param {any} [value]\n\t * @returns {void}\n\t */\n\tfunction update(type, index, key, value) {\n\t\tif (info.token !== token) return;\n\t\tinfo.resolved = value;\n\t\tlet child_ctx = info.ctx;\n\t\tif (key !== undefined) {\n\t\t\tchild_ctx = child_ctx.slice();\n\t\t\tchild_ctx[key] = value;\n\t\t}\n\t\tconst block = type && (info.current = type)(child_ctx);\n\t\tlet needs_flush = false;\n\t\tif (info.block) {\n\t\t\tif (info.blocks) {\n\t\t\t\tinfo.blocks.forEach((block, i) => {\n\t\t\t\t\tif (i !== index && block) {\n\t\t\t\t\t\tgroup_outros();\n\t\t\t\t\t\ttransition_out(block, 1, 1, () => {\n\t\t\t\t\t\t\tif (info.blocks[i] === block) {\n\t\t\t\t\t\t\t\tinfo.blocks[i] = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcheck_outros();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tinfo.block.d(1);\n\t\t\t}\n\t\t\tblock.c();\n\t\t\ttransition_in(block, 1);\n\t\t\tblock.m(info.mount(), info.anchor);\n\t\t\tneeds_flush = true;\n\t\t}\n\t\tinfo.block = block;\n\t\tif (info.blocks) info.blocks[index] = block;\n\t\tif (needs_flush) {\n\t\t\tflush();\n\t\t}\n\t}\n\tif (is_promise(promise)) {\n\t\tconst current_component = get_current_component();\n\t\tpromise.then(\n\t\t\t(value) => {\n\t\t\t\tset_current_component(current_component);\n\t\t\t\tupdate(info.then, 1, info.value, value);\n\t\t\t\tset_current_component(null);\n\t\t\t},\n\t\t\t(error) => {\n\t\t\t\tset_current_component(current_component);\n\t\t\t\tupdate(info.catch, 2, info.error, error);\n\t\t\t\tset_current_component(null);\n\t\t\t\tif (!info.hasCatch) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\t// if we previously had a then/catch block, destroy it\n\t\tif (info.current !== info.pending) {\n\t\t\tupdate(info.pending, 0);\n\t\t\treturn true;\n\t\t}\n\t} else {\n\t\tif (info.current !== info.then) {\n\t\t\tupdate(info.then, 1, info.value, promise);\n\t\t\treturn true;\n\t\t}\n\t\tinfo.resolved = /** @type {T} */ (promise);\n\t}\n}\n\n/** @returns {void} */\nexport function update_await_block_branch(info, ctx, dirty) {\n\tconst child_ctx = ctx.slice();\n\tconst { resolved } = info;\n\tif (info.current === info.then) {\n\t\tchild_ctx[info.value] = resolved;\n\t}\n\tif (info.current === info.catch) {\n\t\tchild_ctx[info.error] = resolved;\n\t}\n\tinfo.block.p(child_ctx, dirty);\n}\n","import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","/** @returns {{}} */\nexport function get_spread_update(levels, updates) {\n\tconst update = {};\n\tconst to_null_out = {};\n\tconst accounted_for = { $$scope: 1 };\n\tlet i = levels.length;\n\twhile (i--) {\n\t\tconst o = levels[i];\n\t\tconst n = updates[i];\n\t\tif (n) {\n\t\t\tfor (const key in o) {\n\t\t\t\tif (!(key in n)) to_null_out[key] = 1;\n\t\t\t}\n\t\t\tfor (const key in n) {\n\t\t\t\tif (!accounted_for[key]) {\n\t\t\t\t\tupdate[key] = n[key];\n\t\t\t\t\taccounted_for[key] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlevels[i] = n;\n\t\t} else {\n\t\t\tfor (const key in o) {\n\t\t\t\taccounted_for[key] = 1;\n\t\t\t}\n\t\t}\n\t}\n\tfor (const key in to_null_out) {\n\t\tif (!(key in update)) update[key] = undefined;\n\t}\n\treturn update;\n}\n\nexport function get_spread_object(spread_props) {\n\treturn typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n","import {\n\tadd_render_callback,\n\tflush,\n\tflush_render_callbacks,\n\tschedule_update,\n\tdirty_components\n} from './scheduler.js';\nimport { current_component, set_current_component } from './lifecycle.js';\nimport { blank_object, is_empty, is_function, run, run_all, noop } from './utils.js';\nimport {\n\tchildren,\n\tdetach,\n\tstart_hydrating,\n\tend_hydrating,\n\tget_custom_elements_slots,\n\tinsert,\n\telement,\n\tattr\n} from './dom.js';\nimport { transition_in } from './transitions.js';\n\n/** @returns {void} */\nexport function bind(component, name, callback) {\n\tconst index = component.$$.props[name];\n\tif (index !== undefined) {\n\t\tcomponent.$$.bound[index] = callback;\n\t\tcallback(component.$$.ctx[index]);\n\t}\n}\n\n/** @returns {void} */\nexport function create_component(block) {\n\tblock && block.c();\n}\n\n/** @returns {void} */\nexport function claim_component(block, parent_nodes) {\n\tblock && block.l(parent_nodes);\n}\n\n/** @returns {void} */\nexport function mount_component(component, target, anchor) {\n\tconst { fragment, after_update } = component.$$;\n\tfragment && fragment.m(target, anchor);\n\t// onMount happens before the initial afterUpdate\n\tadd_render_callback(() => {\n\t\tconst new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n\t\t// if the component was destroyed immediately\n\t\t// it will update the `$$.on_destroy` reference to `null`.\n\t\t// the destructured on_destroy may still reference to the old array\n\t\tif (component.$$.on_destroy) {\n\t\t\tcomponent.$$.on_destroy.push(...new_on_destroy);\n\t\t} else {\n\t\t\t// Edge case - component was destroyed immediately,\n\t\t\t// most likely as a result of a binding initialising\n\t\t\trun_all(new_on_destroy);\n\t\t}\n\t\tcomponent.$$.on_mount = [];\n\t});\n\tafter_update.forEach(add_render_callback);\n}\n\n/** @returns {void} */\nexport function destroy_component(component, detaching) {\n\tconst $$ = component.$$;\n\tif ($$.fragment !== null) {\n\t\tflush_render_callbacks($$.after_update);\n\t\trun_all($$.on_destroy);\n\t\t$$.fragment && $$.fragment.d(detaching);\n\t\t// TODO null out other refs, including component.$$ (but need to\n\t\t// preserve final state?)\n\t\t$$.on_destroy = $$.fragment = null;\n\t\t$$.ctx = [];\n\t}\n}\n\n/** @returns {void} */\nfunction make_dirty(component, i) {\n\tif (component.$$.dirty[0] === -1) {\n\t\tdirty_components.push(component);\n\t\tschedule_update();\n\t\tcomponent.$$.dirty.fill(0);\n\t}\n\tcomponent.$$.dirty[(i / 31) | 0] |= 1 << i % 31;\n}\n\n// TODO: Document the other params\n/**\n * @param {SvelteComponent} component\n * @param {import('./public.js').ComponentConstructorOptions} options\n *\n * @param {import('./utils.js')['not_equal']} not_equal Used to compare props and state values.\n * @param {(target: Element | ShadowRoot) => void} [append_styles] Function that appends styles to the DOM when the component is first initialised.\n * This will be the `add_css` function from the compiled component.\n *\n * @returns {void}\n */\nexport function init(\n\tcomponent,\n\toptions,\n\tinstance,\n\tcreate_fragment,\n\tnot_equal,\n\tprops,\n\tappend_styles = null,\n\tdirty = [-1]\n) {\n\tconst parent_component = current_component;\n\tset_current_component(component);\n\t/** @type {import('./private.js').T$$} */\n\tconst $$ = (component.$$ = {\n\t\tfragment: null,\n\t\tctx: [],\n\t\t// state\n\t\tprops,\n\t\tupdate: noop,\n\t\tnot_equal,\n\t\tbound: blank_object(),\n\t\t// lifecycle\n\t\ton_mount: [],\n\t\ton_destroy: [],\n\t\ton_disconnect: [],\n\t\tbefore_update: [],\n\t\tafter_update: [],\n\t\tcontext: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n\t\t// everything else\n\t\tcallbacks: blank_object(),\n\t\tdirty,\n\t\tskip_bound: false,\n\t\troot: options.target || parent_component.$$.root\n\t});\n\tappend_styles && append_styles($$.root);\n\tlet ready = false;\n\t$$.ctx = instance\n\t\t? instance(component, options.props || {}, (i, ret, ...rest) => {\n\t\t\t\tconst value = rest.length ? rest[0] : ret;\n\t\t\t\tif ($$.ctx && not_equal($$.ctx[i], ($$.ctx[i] = value))) {\n\t\t\t\t\tif (!$$.skip_bound && $$.bound[i]) $$.bound[i](value);\n\t\t\t\t\tif (ready) make_dirty(component, i);\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t  })\n\t\t: [];\n\t$$.update();\n\tready = true;\n\trun_all($$.before_update);\n\t// `false` as a special case of no DOM component\n\t$$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n\tif (options.target) {\n\t\tif (options.hydrate) {\n\t\t\tstart_hydrating();\n\t\t\t// TODO: what is the correct type here?\n\t\t\t// @ts-expect-error\n\t\t\tconst nodes = children(options.target);\n\t\t\t$$.fragment && $$.fragment.l(nodes);\n\t\t\tnodes.forEach(detach);\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\t\t$$.fragment && $$.fragment.c();\n\t\t}\n\t\tif (options.intro) transition_in(component.$$.fragment);\n\t\tmount_component(component, options.target, options.anchor);\n\t\tend_hydrating();\n\t\tflush();\n\t}\n\tset_current_component(parent_component);\n}\n\nexport let SvelteElement;\n\nif (typeof HTMLElement === 'function') {\n\tSvelteElement = class extends HTMLElement {\n\t\t/** The Svelte component constructor */\n\t\t$$ctor;\n\t\t/** Slots */\n\t\t$$s;\n\t\t/** The Svelte component instance */\n\t\t$$c;\n\t\t/** Whether or not the custom element is connected */\n\t\t$$cn = false;\n\t\t/** Component props data */\n\t\t$$d = {};\n\t\t/** `true` if currently in the process of reflecting component props back to attributes */\n\t\t$$r = false;\n\t\t/** @type {Record<string, CustomElementPropDefinition>} Props definition (name, reflected, type etc) */\n\t\t$$p_d = {};\n\t\t/** @type {Record<string, Function[]>} Event listeners */\n\t\t$$l = {};\n\t\t/** @type {Map<Function, Function>} Event listener unsubscribe functions */\n\t\t$$l_u = new Map();\n\n\t\tconstructor($$componentCtor, $$slots, use_shadow_dom) {\n\t\t\tsuper();\n\t\t\tthis.$$ctor = $$componentCtor;\n\t\t\tthis.$$s = $$slots;\n\t\t\tif (use_shadow_dom) {\n\t\t\t\tthis.attachShadow({ mode: 'open' });\n\t\t\t}\n\t\t}\n\n\t\taddEventListener(type, listener, options) {\n\t\t\t// We can't determine upfront if the event is a custom event or not, so we have to\n\t\t\t// listen to both. If someone uses a custom event with the same name as a regular\n\t\t\t// browser event, this fires twice - we can't avoid that.\n\t\t\tthis.$$l[type] = this.$$l[type] || [];\n\t\t\tthis.$$l[type].push(listener);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t}\n\t\t\tsuper.addEventListener(type, listener, options);\n\t\t}\n\n\t\tremoveEventListener(type, listener, options) {\n\t\t\tsuper.removeEventListener(type, listener, options);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$l_u.get(listener);\n\t\t\t\tif (unsub) {\n\t\t\t\t\tunsub();\n\t\t\t\t\tthis.$$l_u.delete(listener);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.$$l[type]) {\n\t\t\t\tconst idx = this.$$l[type].indexOf(listener);\n\t\t\t\tif (idx >= 0) {\n\t\t\t\t\tthis.$$l[type].splice(idx, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tasync connectedCallback() {\n\t\t\tthis.$$cn = true;\n\t\t\tif (!this.$$c) {\n\t\t\t\t// We wait one tick to let possible child slot elements be created/mounted\n\t\t\t\tawait Promise.resolve();\n\t\t\t\tif (!this.$$cn || this.$$c) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfunction create_slot(name) {\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tlet node;\n\t\t\t\t\t\tconst obj = {\n\t\t\t\t\t\t\tc: function create() {\n\t\t\t\t\t\t\t\tnode = element('slot');\n\t\t\t\t\t\t\t\tif (name !== 'default') {\n\t\t\t\t\t\t\t\t\tattr(node, 'name', name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * @param {HTMLElement} target\n\t\t\t\t\t\t\t * @param {HTMLElement} [anchor]\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tm: function mount(target, anchor) {\n\t\t\t\t\t\t\t\tinsert(target, node, anchor);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\td: function destroy(detaching) {\n\t\t\t\t\t\t\t\tif (detaching) {\n\t\t\t\t\t\t\t\t\tdetach(node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tconst $$slots = {};\n\t\t\t\tconst existing_slots = get_custom_elements_slots(this);\n\t\t\t\tfor (const name of this.$$s) {\n\t\t\t\t\tif (name in existing_slots) {\n\t\t\t\t\t\t$$slots[name] = [create_slot(name)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const attribute of this.attributes) {\n\t\t\t\t\t// this.$$data takes precedence over this.attributes\n\t\t\t\t\tconst name = this.$$g_p(attribute.name);\n\t\t\t\t\tif (!(name in this.$$d)) {\n\t\t\t\t\t\tthis.$$d[name] = get_custom_element_value(name, attribute.value, this.$$p_d, 'toProp');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Port over props that were set programmatically before ce was initialized\n\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\tif (!(key in this.$$d) && this[key] !== undefined) {\n\t\t\t\t\t\tthis.$$d[key] = this[key]; // don't transform, these were set through JavaScript\n\t\t\t\t\t\tdelete this[key]; // remove the property that shadows the getter/setter\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$c = new this.$$ctor({\n\t\t\t\t\ttarget: this.shadowRoot || this,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...this.$$d,\n\t\t\t\t\t\t$$slots,\n\t\t\t\t\t\t$$scope: {\n\t\t\t\t\t\t\tctx: []\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Reflect component props as attributes\n\t\t\t\tconst reflect_attributes = () => {\n\t\t\t\t\tthis.$$r = true;\n\t\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\t\tthis.$$d[key] = this.$$c.$$.ctx[this.$$c.$$.props[key]];\n\t\t\t\t\t\tif (this.$$p_d[key].reflect) {\n\t\t\t\t\t\t\tconst attribute_value = get_custom_element_value(\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tthis.$$d[key],\n\t\t\t\t\t\t\t\tthis.$$p_d,\n\t\t\t\t\t\t\t\t'toAttribute'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (attribute_value == null) {\n\t\t\t\t\t\t\t\tthis.removeAttribute(this.$$p_d[key].attribute || key);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.setAttribute(this.$$p_d[key].attribute || key, attribute_value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.$$r = false;\n\t\t\t\t};\n\t\t\t\tthis.$$c.$$.after_update.push(reflect_attributes);\n\t\t\t\treflect_attributes(); // once initially because after_update is added too late for first render\n\n\t\t\t\tfor (const type in this.$$l) {\n\t\t\t\t\tfor (const listener of this.$$l[type]) {\n\t\t\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$l = {};\n\t\t\t}\n\t\t}\n\n\t\t// We don't need this when working within Svelte code, but for compatibility of people using this outside of Svelte\n\t\t// and setting attributes through setAttribute etc, this is helpful\n\t\tattributeChangedCallback(attr, _oldValue, newValue) {\n\t\t\tif (this.$$r) return;\n\t\t\tattr = this.$$g_p(attr);\n\t\t\tthis.$$d[attr] = get_custom_element_value(attr, newValue, this.$$p_d, 'toProp');\n\t\t\tthis.$$c?.$set({ [attr]: this.$$d[attr] });\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.$$cn = false;\n\t\t\t// In a microtask, because this could be a move within the DOM\n\t\t\tPromise.resolve().then(() => {\n\t\t\t\tif (!this.$$cn && this.$$c) {\n\t\t\t\t\tthis.$$c.$destroy();\n\t\t\t\t\tthis.$$c = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$$g_p(attribute_name) {\n\t\t\treturn (\n\t\t\t\tObject.keys(this.$$p_d).find(\n\t\t\t\t\t(key) =>\n\t\t\t\t\t\tthis.$$p_d[key].attribute === attribute_name ||\n\t\t\t\t\t\t(!this.$$p_d[key].attribute && key.toLowerCase() === attribute_name)\n\t\t\t\t) || attribute_name\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param {string} prop\n * @param {any} value\n * @param {Record<string, CustomElementPropDefinition>} props_definition\n * @param {'toAttribute' | 'toProp'} [transform]\n */\nfunction get_custom_element_value(prop, value, props_definition, transform) {\n\tconst type = props_definition[prop]?.type;\n\tvalue = type === 'Boolean' && typeof value !== 'boolean' ? value != null : value;\n\tif (!transform || !props_definition[prop]) {\n\t\treturn value;\n\t} else if (transform === 'toAttribute') {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value == null ? null : JSON.stringify(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value ? '' : null;\n\t\t\tcase 'Number':\n\t\t\t\treturn value == null ? null : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t} else {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value && JSON.parse(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value; // conversion already handled above\n\t\t\tcase 'Number':\n\t\t\t\treturn value != null ? +value : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t}\n}\n\n/**\n * @internal\n *\n * Turn a Svelte component into a custom element.\n * @param {import('./public.js').ComponentType} Component  A Svelte component constructor\n * @param {Record<string, CustomElementPropDefinition>} props_definition  The props to observe\n * @param {string[]} slots  The slots to create\n * @param {string[]} accessors  Other accessors besides the ones for props the component has\n * @param {boolean} use_shadow_dom  Whether to use shadow DOM\n * @param {(ce: new () => HTMLElement) => new () => HTMLElement} [extend]\n */\nexport function create_custom_element(\n\tComponent,\n\tprops_definition,\n\tslots,\n\taccessors,\n\tuse_shadow_dom,\n\textend\n) {\n\tlet Class = class extends SvelteElement {\n\t\tconstructor() {\n\t\t\tsuper(Component, slots, use_shadow_dom);\n\t\t\tthis.$$p_d = props_definition;\n\t\t}\n\t\tstatic get observedAttributes() {\n\t\t\treturn Object.keys(props_definition).map((key) =>\n\t\t\t\t(props_definition[key].attribute || key).toLowerCase()\n\t\t\t);\n\t\t}\n\t};\n\tObject.keys(props_definition).forEach((prop) => {\n\t\tObject.defineProperty(Class.prototype, prop, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c && prop in this.$$c ? this.$$c[prop] : this.$$d[prop];\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tvalue = get_custom_element_value(prop, value, props_definition);\n\t\t\t\tthis.$$d[prop] = value;\n\t\t\t\tthis.$$c?.$set({ [prop]: value });\n\t\t\t}\n\t\t});\n\t});\n\taccessors.forEach((accessor) => {\n\t\tObject.defineProperty(Class.prototype, accessor, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c?.[accessor];\n\t\t\t}\n\t\t});\n\t});\n\tif (extend) {\n\t\t// @ts-expect-error - assigning here is fine\n\t\tClass = extend(Class);\n\t}\n\tComponent.element = /** @type {any} */ (Class);\n\treturn Class;\n}\n\n/**\n * Base class for Svelte components. Used when dev=false.\n *\n * @template {Record<string, any>} [Props=any]\n * @template {Record<string, any>} [Events=any]\n */\nexport class SvelteComponent {\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$ = undefined;\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$set = undefined;\n\n\t/** @returns {void} */\n\t$destroy() {\n\t\tdestroy_component(this, 1);\n\t\tthis.$destroy = noop;\n\t}\n\n\t/**\n\t * @template {Extract<keyof Events, string>} K\n\t * @param {K} type\n\t * @param {((e: Events[K]) => void) | null | undefined} callback\n\t * @returns {() => void}\n\t */\n\t$on(type, callback) {\n\t\tif (!is_function(callback)) {\n\t\t\treturn noop;\n\t\t}\n\t\tconst callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);\n\t\tcallbacks.push(callback);\n\t\treturn () => {\n\t\t\tconst index = callbacks.indexOf(callback);\n\t\t\tif (index !== -1) callbacks.splice(index, 1);\n\t\t};\n\t}\n\n\t/**\n\t * @param {Partial<Props>} props\n\t * @returns {void}\n\t */\n\t$set(props) {\n\t\tif (this.$$set && !is_empty(props)) {\n\t\t\tthis.$$.skip_bound = true;\n\t\t\tthis.$$set(props);\n\t\t\tthis.$$.skip_bound = false;\n\t\t}\n\t}\n}\n\n/**\n * @typedef {Object} CustomElementPropDefinition\n * @property {string} [attribute]\n * @property {boolean} [reflect]\n * @property {'String'|'Boolean'|'Number'|'Array'|'Object'} [type]\n */\n","// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n *\n * https://svelte.dev/docs/svelte-compiler#svelte-version\n * @type {string}\n */\nexport const VERSION = '4.2.20';\nexport const PUBLIC_VERSION = '4';\n","import { PUBLIC_VERSION } from '../../../shared/version.js';\n\nif (typeof window !== 'undefined')\n\t// @ts-ignore\n\t(window.__svelte || (window.__svelte = { v: new Set() })).v.add(PUBLIC_VERSION);\n","import { getContext } from \"svelte\";\n\nexport const LOCATION = {};\nexport const ROUTER = {};\nexport const HISTORY = {};\n\nexport const useLocation = () => getContext(LOCATION);\nexport const useRouter = () => getContext(ROUTER);\nexport const useHistory = () => getContext(HISTORY);\n","/**\n * Adapted from https://github.com/reach/router/blob/b60e6dd781d5d3a4bdaaf4de665649c0f6a7e78d/src/lib/utils.js\n * https://github.com/reach/router/blob/master/LICENSE\n */\n\nconst PARAM = /^:(.+)/;\nconst SEGMENT_POINTS = 4;\nconst STATIC_POINTS = 3;\nconst DYNAMIC_POINTS = 2;\nconst SPLAT_PENALTY = 1;\nconst ROOT_POINTS = 1;\n\n/**\n * Split up the URI into segments delimited by `/`\n * Strip starting/ending `/`\n * @param {string} uri\n * @return {string[]}\n */\nconst segmentize = (uri) => uri.replace(/(^\\/+|\\/+$)/g, \"\").split(\"/\");\n/**\n * Strip `str` of potential start and end `/`\n * @param {string} string\n * @return {string}\n */\nconst stripSlashes = (string) => string.replace(/(^\\/+|\\/+$)/g, \"\");\n/**\n * Score a route depending on how its individual segments look\n * @param {object} route\n * @param {number} index\n * @return {object}\n */\nconst rankRoute = (route, index) => {\n    const score = route.default\n        ? 0\n        : segmentize(route.path).reduce((score, segment) => {\n              score += SEGMENT_POINTS;\n\n              if (segment === \"\") {\n                  score += ROOT_POINTS;\n              } else if (PARAM.test(segment)) {\n                  score += DYNAMIC_POINTS;\n              } else if (segment[0] === \"*\") {\n                  score -= SEGMENT_POINTS + SPLAT_PENALTY;\n              } else {\n                  score += STATIC_POINTS;\n              }\n\n              return score;\n          }, 0);\n\n    return { route, score, index };\n};\n/**\n * Give a score to all routes and sort them on that\n * If two routes have the exact same score, we go by index instead\n * @param {object[]} routes\n * @return {object[]}\n */\nconst rankRoutes = (routes) =>\n    routes\n        .map(rankRoute)\n        .sort((a, b) =>\n            a.score < b.score ? 1 : a.score > b.score ? -1 : a.index - b.index\n        );\n/**\n * Ranks and picks the best route to match. Each segment gets the highest\n * amount of points, then the type of segment gets an additional amount of\n * points where\n *\n *  static > dynamic > splat > root\n *\n * This way we don't have to worry about the order of our routes, let the\n * computers do it.\n *\n * A route looks like this\n *\n *  { path, default, value }\n *\n * And a returned match looks like:\n *\n *  { route, params, uri }\n *\n * @param {object[]} routes\n * @param {string} uri\n * @return {?object}\n */\nconst pick = (routes, uri) => {\n    let match;\n    let default_;\n\n    const [uriPathname] = uri.split(\"?\");\n    const uriSegments = segmentize(uriPathname);\n    const isRootUri = uriSegments[0] === \"\";\n    const ranked = rankRoutes(routes);\n\n    for (let i = 0, l = ranked.length; i < l; i++) {\n        const route = ranked[i].route;\n        let missed = false;\n\n        if (route.default) {\n            default_ = {\n                route,\n                params: {},\n                uri,\n            };\n            continue;\n        }\n\n        const routeSegments = segmentize(route.path);\n        const params = {};\n        const max = Math.max(uriSegments.length, routeSegments.length);\n        let index = 0;\n\n        for (; index < max; index++) {\n            const routeSegment = routeSegments[index];\n            const uriSegment = uriSegments[index];\n\n            if (routeSegment && routeSegment[0] === \"*\") {\n                // Hit a splat, just grab the rest, and return a match\n                // uri:   /files/documents/work\n                // route: /files/* or /files/*splatname\n                const splatName =\n                    routeSegment === \"*\" ? \"*\" : routeSegment.slice(1);\n\n                params[splatName] = uriSegments\n                    .slice(index)\n                    .map(decodeURIComponent)\n                    .join(\"/\");\n                break;\n            }\n\n            if (typeof uriSegment === \"undefined\") {\n                // URI is shorter than the route, no match\n                // uri:   /users\n                // route: /users/:userId\n                missed = true;\n                break;\n            }\n\n            const dynamicMatch = PARAM.exec(routeSegment);\n\n            if (dynamicMatch && !isRootUri) {\n                const value = decodeURIComponent(uriSegment);\n                params[dynamicMatch[1]] = value;\n            } else if (routeSegment !== uriSegment) {\n                // Current segments don't match, not dynamic, not splat, so no match\n                // uri:   /users/123/settings\n                // route: /users/:id/profile\n                missed = true;\n                break;\n            }\n        }\n\n        if (!missed) {\n            match = {\n                route,\n                params,\n                uri: \"/\" + uriSegments.slice(0, index).join(\"/\"),\n            };\n            break;\n        }\n    }\n\n    return match || default_ || null;\n};\n/**\n * Add the query to the pathname if a query is given\n * @param {string} pathname\n * @param {string} [query]\n * @return {string}\n */\nconst addQuery = (pathname, query) => pathname + (query ? `?${query}` : \"\");\n/**\n * Resolve URIs as though every path is a directory, no files. Relative URIs\n * in the browser can feel awkward because not only can you be \"in a directory\",\n * you can be \"at a file\", too. For example:\n *\n *  browserSpecResolve('foo', '/bar/') => /bar/foo\n *  browserSpecResolve('foo', '/bar') => /foo\n *\n * But on the command line of a file system, it's not as complicated. You can't\n * `cd` from a file, only directories. This way, links have to know less about\n * their current path. To go deeper you can do this:\n *\n *  <Link to=\"deeper\"/>\n *  // instead of\n *  <Link to=`{${props.uri}/deeper}`/>\n *\n * Just like `cd`, if you want to go deeper from the command line, you do this:\n *\n *  cd deeper\n *  # not\n *  cd $(pwd)/deeper\n *\n * By treating every path as a directory, linking to relative paths should\n * require less contextual information and (fingers crossed) be more intuitive.\n * @param {string} to\n * @param {string} base\n * @return {string}\n */\nconst resolve = (to, base) => {\n    // /foo/bar, /baz/qux => /foo/bar\n    if (to.startsWith(\"/\")) return to;\n\n    const [toPathname, toQuery] = to.split(\"?\");\n    const [basePathname] = base.split(\"?\");\n    const toSegments = segmentize(toPathname);\n    const baseSegments = segmentize(basePathname);\n\n    // ?a=b, /users?b=c => /users?a=b\n    if (toSegments[0] === \"\") return addQuery(basePathname, toQuery);\n\n    // profile, /users/789 => /users/789/profile\n\n    if (!toSegments[0].startsWith(\".\")) {\n        const pathname = baseSegments.concat(toSegments).join(\"/\");\n        return addQuery((basePathname === \"/\" ? \"\" : \"/\") + pathname, toQuery);\n    }\n\n    // ./       , /users/123 => /users/123\n    // ../      , /users/123 => /users\n    // ../..    , /users/123 => /\n    // ../../one, /a/b/c/d   => /a/b/one\n    // .././one , /a/b/c/d   => /a/b/c/one\n    const allSegments = baseSegments.concat(toSegments);\n    const segments = [];\n\n    allSegments.forEach((segment) => {\n        if (segment === \"..\") segments.pop();\n        else if (segment !== \".\") segments.push(segment);\n    });\n\n    return addQuery(\"/\" + segments.join(\"/\"), toQuery);\n};\n/**\n * Combines the `basepath` and the `path` into one path.\n * @param {string} basepath\n * @param {string} path\n */\nconst combinePaths = (basepath, path) =>\n    `${stripSlashes(\n        path === \"/\"\n            ? basepath\n            : `${stripSlashes(basepath)}/${stripSlashes(path)}`\n    )}/`;\n/**\n * Decides whether a given `event` should result in a navigation or not.\n * @param {object} event\n */\nconst shouldNavigate = (event) =>\n    !event.defaultPrevented &&\n    event.button === 0 &&\n    !(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n\n// svelte seems to kill anchor.host value in ie11, so fall back to checking href\nconst hostMatches = (anchor) => {\n    const host = location.host;\n    return (\n        anchor.host === host ||\n        anchor.href.indexOf(`https://${host}`) === 0 ||\n        anchor.href.indexOf(`http://${host}`) === 0\n    );\n};\n\nconst canUseDOM = () =>\n    typeof window !== \"undefined\" &&\n    \"document\" in window &&\n    \"location\" in window;\n\nexport {\n    stripSlashes,\n    pick,\n    resolve,\n    combinePaths,\n    shouldNavigate,\n    hostMatches,\n    canUseDOM,\n};\n","<script>\n    import { getContext, onDestroy } from \"svelte\";\n    import { ROUTER } from \"./contexts.js\";\n    import { canUseDOM } from \"./utils.js\";\n\n    export let path = \"\";\n    export let component = null;\n\n    let routeParams = {};\n    let routeProps = {};\n\n    const { registerRoute, unregisterRoute, activeRoute } = getContext(ROUTER);\n\n    const route = {\n        path,\n        // If no path prop is given, this Route will act as the default Route\n        // that is rendered if no other Route in the Router is a match.\n        default: path === \"\",\n    };\n\n    $: if ($activeRoute && $activeRoute.route === route) {\n        routeParams = $activeRoute.params;\n\n        const { component: c, path, ...rest } = $$props;\n        routeProps = rest;\n\n        if (c) {\n            if (c.toString().startsWith(\"class \")) component = c;\n            else component = c();\n        }\n\n        canUseDOM() && !$activeRoute.preserveScroll && window?.scrollTo(0, 0);\n    }\n\n    registerRoute(route);\n\n    onDestroy(() => {\n        unregisterRoute(route);\n    });\n</script>\n\n{#if $activeRoute && $activeRoute.route === route}\n    {#if component}\n        {#await component then resolvedComponent}\n            <svelte:component\n                this={resolvedComponent?.default || resolvedComponent}\n                {...routeParams}\n                {...routeProps}\n            />\n        {/await}\n    {:else}\n        <slot params={routeParams} />\n    {/if}\n{/if}\n","import {\n\trun_all,\n\tsubscribe,\n\tnoop,\n\tsafe_not_equal,\n\tis_function,\n\tget_store_value\n} from '../internal/index.js';\n\nconst subscriber_queue = [];\n\n/**\n * Creates a `Readable` store that allows reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#readable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readable(value, start) {\n\treturn {\n\t\tsubscribe: writable(value, start).subscribe\n\t};\n}\n\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#writable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Writable<T>}\n */\nexport function writable(value, start = noop) {\n\t/** @type {import('./public.js').Unsubscriber} */\n\tlet stop;\n\t/** @type {Set<import('./private.js').SubscribeInvalidateTuple<T>>} */\n\tconst subscribers = new Set();\n\t/** @param {T} new_value\n\t * @returns {void}\n\t */\n\tfunction set(new_value) {\n\t\tif (safe_not_equal(value, new_value)) {\n\t\t\tvalue = new_value;\n\t\t\tif (stop) {\n\t\t\t\t// store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (const subscriber of subscribers) {\n\t\t\t\t\tsubscriber[1]();\n\t\t\t\t\tsubscriber_queue.push(subscriber, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('./public.js').Updater<T>} fn\n\t * @returns {void}\n\t */\n\tfunction update(fn) {\n\t\tset(fn(value));\n\t}\n\n\t/**\n\t * @param {import('./public.js').Subscriber<T>} run\n\t * @param {import('./private.js').Invalidator<T>} [invalidate]\n\t * @returns {import('./public.js').Unsubscriber}\n\t */\n\tfunction subscribe(run, invalidate = noop) {\n\t\t/** @type {import('./private.js').SubscribeInvalidateTuple<T>} */\n\t\tconst subscriber = [run, invalidate];\n\t\tsubscribers.add(subscriber);\n\t\tif (subscribers.size === 1) {\n\t\t\tstop = start(set, update) || noop;\n\t\t}\n\t\trun(value);\n\t\treturn () => {\n\t\t\tsubscribers.delete(subscriber);\n\t\t\tif (subscribers.size === 0 && stop) {\n\t\t\t\tstop();\n\t\t\t\tstop = null;\n\t\t\t}\n\t\t};\n\t}\n\treturn { set, update, subscribe };\n}\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>, set: (value: T) => void, update: (fn: import('./public.js').Updater<T>) => void) => import('./public.js').Unsubscriber | void} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>) => T} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * @template {import('./private.js').Stores} S\n * @template T\n * @param {S} stores\n * @param {Function} fn\n * @param {T} [initial_value]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function derived(stores, fn, initial_value) {\n\tconst single = !Array.isArray(stores);\n\t/** @type {Array<import('./public.js').Readable<any>>} */\n\tconst stores_array = single ? [stores] : stores;\n\tif (!stores_array.every(Boolean)) {\n\t\tthrow new Error('derived() expects stores as input, got a falsy value');\n\t}\n\tconst auto = fn.length < 2;\n\treturn readable(initial_value, (set, update) => {\n\t\tlet started = false;\n\t\tconst values = [];\n\t\tlet pending = 0;\n\t\tlet cleanup = noop;\n\t\tconst sync = () => {\n\t\t\tif (pending) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcleanup();\n\t\t\tconst result = fn(single ? values[0] : values, set, update);\n\t\t\tif (auto) {\n\t\t\t\tset(result);\n\t\t\t} else {\n\t\t\t\tcleanup = is_function(result) ? result : noop;\n\t\t\t}\n\t\t};\n\t\tconst unsubscribers = stores_array.map((store, i) =>\n\t\t\tsubscribe(\n\t\t\t\tstore,\n\t\t\t\t(value) => {\n\t\t\t\t\tvalues[i] = value;\n\t\t\t\t\tpending &= ~(1 << i);\n\t\t\t\t\tif (started) {\n\t\t\t\t\t\tsync();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tpending |= 1 << i;\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tstarted = true;\n\t\tsync();\n\t\treturn function stop() {\n\t\t\trun_all(unsubscribers);\n\t\t\tcleanup();\n\t\t\t// We need to set this to false because callbacks can still happen despite having unsubscribed:\n\t\t\t// Callbacks might already be placed in the queue which doesn't know it should no longer\n\t\t\t// invoke this derived store.\n\t\t\tstarted = false;\n\t\t};\n\t});\n}\n\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * https://svelte.dev/docs/svelte-store#readonly\n * @template T\n * @param {import('./public.js').Readable<T>} store  - store to make readonly\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readonly(store) {\n\treturn {\n\t\tsubscribe: store.subscribe.bind(store)\n\t};\n}\n\nexport { get_store_value as get };\n","/**\n * Adapted from https://github.com/reach/router/blob/b60e6dd781d5d3a4bdaaf4de665649c0f6a7e78d/src/lib/history.js\n * https://github.com/reach/router/blob/master/LICENSE\n */\nimport { canUseDOM } from \"./utils\";\n\nconst getLocation = (source) => {\n    return {\n        ...source.location,\n        state: source.history.state,\n        key: (source.history.state && source.history.state.key) || \"initial\",\n    };\n};\nconst createHistory = (source) => {\n    const listeners = [];\n    let location = getLocation(source);\n\n    return {\n        get location() {\n            return location;\n        },\n\n        listen(listener) {\n            listeners.push(listener);\n\n            const popstateListener = () => {\n                location = getLocation(source);\n                listener({ location, action: \"POP\" });\n            };\n\n            source.addEventListener(\"popstate\", popstateListener);\n\n            return () => {\n                source.removeEventListener(\"popstate\", popstateListener);\n                const index = listeners.indexOf(listener);\n                listeners.splice(index, 1);\n            };\n        },\n\n        navigate(to, { state, replace = false, preserveScroll = false, blurActiveElement = true } = {}) {\n            state = { ...state, key: Date.now() + \"\" };\n            // try...catch iOS Safari limits to 100 pushState calls\n            try {\n                if (replace) source.history.replaceState(state, \"\", to);\n                else source.history.pushState(state, \"\", to);\n            } catch (e) {\n                source.location[replace ? \"replace\" : \"assign\"](to);\n            }\n            location = getLocation(source);\n            listeners.forEach((listener) =>\n                listener({ location, action: \"PUSH\", preserveScroll })\n            );\n            if(blurActiveElement) document.activeElement.blur();\n        },\n    };\n};\n// Stores history entries in memory for testing or other platforms like Native\nconst createMemorySource = (initialPathname = \"/\") => {\n    let index = 0;\n    const stack = [{ pathname: initialPathname, search: \"\" }];\n    const states = [];\n\n    return {\n        get location() {\n            return stack[index];\n        },\n        addEventListener(name, fn) {},\n        removeEventListener(name, fn) {},\n        history: {\n            get entries() {\n                return stack;\n            },\n            get index() {\n                return index;\n            },\n            get state() {\n                return states[index];\n            },\n            pushState(state, _, uri) {\n                const [pathname, search = \"\"] = uri.split(\"?\");\n                index++;\n                stack.push({ pathname, search });\n                states.push(state);\n            },\n            replaceState(state, _, uri) {\n                const [pathname, search = \"\"] = uri.split(\"?\");\n                stack[index] = { pathname, search };\n                states[index] = state;\n            },\n        },\n    };\n};\n// Global history uses window.history as the source if available,\n// otherwise a memory history\nconst globalHistory = createHistory(\n    canUseDOM() ? window : createMemorySource()\n);\nconst { navigate } = globalHistory;\n\nexport { globalHistory, navigate, createHistory, createMemorySource };\n","<script>\n    import { getContext, onMount, setContext } from \"svelte\";\n    import { derived, writable } from \"svelte/store\";\n    import { HISTORY, LOCATION, ROUTER } from \"./contexts.js\";\n    import { globalHistory } from \"./history.js\";\n    import { combinePaths, pick } from \"./utils.js\";\n\n    export let basepath = \"/\";\n    export let url = null;\n    export let viewtransition = null;\n    export let history = globalHistory;\n\n    const viewtransitionFn = (node, _, direction) => {\n        const vt = viewtransition(direction);\n        if (typeof vt?.fn === \"function\") return vt.fn(node, vt);\n        else return vt;\n    };\n\n    setContext(HISTORY, history);\n\n    const locationContext = getContext(LOCATION);\n    const routerContext = getContext(ROUTER);\n\n    const routes = writable([]);\n    const activeRoute = writable(null);\n    let hasActiveRoute = false; // Used in SSR to synchronously set that a Route is active.\n\n    // If locationContext is not set, this is the topmost Router in the tree.\n    // If the `url` prop is given we force the location to it.\n    const location =\n        locationContext || writable(url ? { pathname: url } : history.location);\n\n    // If routerContext is set, the routerBase of the parent Router\n    // will be the base for this Router's descendants.\n    // If routerContext is not set, the path and resolved uri will both\n    // have the value of the basepath prop.\n    const base = routerContext\n        ? routerContext.routerBase\n        : writable({\n              path: basepath,\n              uri: basepath,\n          });\n\n    const routerBase = derived([base, activeRoute], ([base, activeRoute]) => {\n        // If there is no activeRoute, the routerBase will be identical to the base.\n        if (!activeRoute) return base;\n\n        const { path: basepath } = base;\n        const { route, uri } = activeRoute;\n        // Remove the potential /* or /*splatname from\n        // the end of the child Routes relative paths.\n        const path = route.default ? basepath : route.path.replace(/\\*.*$/, \"\");\n        return { path, uri };\n    });\n\n    const registerRoute = (route) => {\n        const { path: basepath } = $base;\n        let { path } = route;\n\n        // We store the original path in the _path property so we can reuse\n        // it when the basepath changes. The only thing that matters is that\n        // the route reference is intact, so mutation is fine.\n        route._path = path;\n        route.path = combinePaths(basepath, path);\n\n        if (typeof window === \"undefined\") {\n            // In SSR we should set the activeRoute immediately if it is a match.\n            // If there are more Routes being registered after a match is found,\n            // we just skip them.\n            if (hasActiveRoute) return;\n\n            const matchingRoute = pick([route], $location.pathname);\n\n            if (matchingRoute) {\n                activeRoute.set(matchingRoute);\n                hasActiveRoute = true;\n            }\n        } else {\n            routes.update((rs) => [...rs, route]);\n        }\n    };\n\n    const unregisterRoute = (route) => {\n        routes.update((rs) => rs.filter((r) => r !== route));\n    };\n\n    let preserveScroll = false;\n\n    // This reactive statement will update all the Routes' path when\n    // the basepath changes.\n    $: {\n        const { path: basepath } = $base;\n        routes.update((rs) =>\n            rs.map((r) =>\n                Object.assign(r, { path: combinePaths(basepath, r._path) })\n            )\n        );\n    }\n    // This reactive statement will be run when the Router is created\n    // when there are no Routes and then again the following tick, so it\n    // will not find an active Route in SSR and in the browser it will only\n    // pick an active Route after all Routes have been registered.\n    $: {\n        const bestMatch = pick($routes, $location.pathname);\n        activeRoute.set(\n            bestMatch ? { ...bestMatch, preserveScroll } : bestMatch\n        );\n    }\n\n    if (!locationContext) {\n        // The topmost Router in the tree is responsible for updating\n        // the location store and supplying it through context.\n        onMount(() => {\n            const unlisten = history.listen((event) => {\n                preserveScroll = event.preserveScroll || false;\n                location.set(event.location);\n            });\n\n            return unlisten;\n        });\n\n        setContext(LOCATION, location);\n    }\n\n    setContext(ROUTER, {\n        activeRoute,\n        base,\n        routerBase,\n        registerRoute,\n        unregisterRoute,\n    });\n</script>\n\n{#if viewtransition}\n    {#key $location.pathname}\n        <div in:viewtransitionFn out:viewtransitionFn>\n            <slot\n                route={$activeRoute && $activeRoute.uri}\n                location={$location}\n            />\n        </div>\n    {/key}\n{:else}\n    <slot route={$activeRoute && $activeRoute.uri} location={$location} />\n{/if}\n","// eventsStore.js\n\nimport { writable } from 'svelte/store';\n\n// Define and export the eventsStore\nexport const eventsStore = writable([]);\n\n// Export a function to access the events data\nexport function getEvents() {\n    return eventsStore;\n}\n","export function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nexport function bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nexport function bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nexport function hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nexport function exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nexport function output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nconst assert = {\n    number,\n    bool,\n    bytes,\n    hash,\n    exists,\n    output,\n};\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\n// Check if object doens't have custom constructor (like Uint8Array/Array)\nconst isPlainObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]' && obj.constructor === Object;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && (typeof opts !== 'object' || !isPlainObject(opts)))\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import assert from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        assert.exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = wrapConstructor(() => new SHA256());\nexport const sha224 = wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst u8a = (a) => a instanceof Uint8Array;\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nexport function numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? `0${hex}` : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(`${title} must be valid hex string, got \"${hex}\". Cause: ${e}`);\n        }\n    }\n    else if (u8a(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(`${title} must be hex string or Uint8Array`);\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(`${title} expected ${expectedLength} bytes, got ${len}`);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\nexport function equalBytes(b1, b2) {\n    // We don't care about timing attacks here\n    if (b1.length !== b2.length)\n        return false;\n    for (let i = 0; i < b1.length; i++)\n        if (b1[i] !== b2[i])\n            return false;\n    return true;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nexport function bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nexport const bitSet = (n, pos, value) => {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n};\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nexport function validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error(`Invalid validator \"${type}\", expected function`);\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error(`Invalid param ${String(fieldName)}=${val} (${typeof val}), expected ${type}`);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n//# sourceMappingURL=utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities for modular arithmetics and finite fields\nimport { bitMask, numberToBytesBE, numberToBytesLE, bytesToNumberBE, bytesToNumberLE, ensureBytes, validateObject, } from './utils.js';\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _4n = BigInt(4), _5n = BigInt(5), _8n = BigInt(8);\n// prettier-ignore\nconst _9n = BigInt(9), _16n = BigInt(16);\n// Calculates a modulo b\nexport function mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\n// TODO: use field version && remove\nexport function pow(num, power, modulo) {\n    if (modulo <= _0n || power < _0n)\n        throw new Error('Expected power/modulo > 0');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n// Does x ^ (2 ^ power) mod p. pow2(30, 4) == 30 ^ (2 ^ 4)\nexport function pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n// Inverses number over modulo\nexport function invert(number, modulo) {\n    if (number === _0n || modulo <= _0n) {\n        throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    // Euclidean GCD https://brilliant.org/wiki/extended-euclidean-algorithm/\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n// Tonelli-Shanks algorithm\n// Paper 1: https://eprint.iacr.org/2012/685.pdf (page 12)\n// Paper 2: Square Roots from 1; 24, 51, 10 to Dan Shanks\nexport function tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p)  1    if a is a square (mod p)\n    // (a | p)  -1   if a is not a square (mod p)\n    // (a | p)  0    if a  0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p)  -1 and set c  zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++)\n        ;\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be  -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\nexport function FpSqrt(P) {\n    // NOTE: different algorithms can give different roots, it is up to user to decide which one they want.\n    // For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n    // P  3 (mod 4)\n    // n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q  5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P  9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nexport function validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return validateObject(field, opts);\n}\n// Generic field functions\nexport function FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('Expected power > 0');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n// 0 is non-invertible: non-batched version will throw on 0\nexport function FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nexport function FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare(f) {\n    const legendreConst = (f.ORDER - _1n) / _2n; // Integer arithmetic\n    return (x) => {\n        const p = f.pow(x, legendreConst);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nexport function nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a galois field over prime. Non-primes are not supported for now.\n * Do not init in loop: slow. Very fragile: always run a benchmark on change.\n * Major performance gains:\n * a) non-normalized operations like mulN instead of mul\n * b) `Object.freeze`\n * c) Same object shape: never add or remove keys\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error(`Expected Fp ORDER > 0, got ${ORDER}`);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('Field lengths over 2048 bytes are not supported');\n    const sqrtP = FpSqrt(ORDER);\n    const f = Object.freeze({\n        ORDER,\n        BITS,\n        BYTES,\n        MASK: bitMask(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error(`Invalid field element: expected bigint, got ${typeof num}`);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt || ((n) => sqrtP(f, n)),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error(`Fp.fromBytes: expected ${BYTES}, got ${bytes.length}`);\n            return isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nexport function FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nexport function FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * FIPS 186 B.4.1-compliant \"constant-time\" private key generation utility.\n * Can take (n+8) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 40 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. curveFn.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = ensureBytes('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error(`hashToPrivateScalar: expected ${minLen}-1024 bytes of input, got ${hashLen}`);\n    const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n//# sourceMappingURL=modular.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Abelian group utilities\nimport { validateField, nLength } from './modular.js';\nimport { validateObject } from './utils.js';\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n// Elliptic curve multiplication of Point by scalar. Fragile.\n// Scalars should always be less than curve order: this should be checked inside of a curve itself.\n// Creates precomputation tables for fast multiplication:\n// - private scalar is split by fixed size windows of W bits\n// - every window point is collected from window's table & added to accumulator\n// - since windows are different, same point inside tables won't be accessed more than once per calc\n// - each multiplication is 'Math.ceil(CURVE_ORDER / ) + 1' point additions (fixed for any scalar)\n// - +1 window is neccessary for wNAF\n// - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n// TODO: Research returning 2d JS array of windows, instead of a single window. This would allow\n// windows to be in different memory locations\nexport function wNAF(c, bits) {\n    const constTimeNegate = (condition, item) => {\n        const neg = item.negate();\n        return condition ? neg : item;\n    };\n    const opts = (W) => {\n        const windows = Math.ceil(bits / W) + 1; // +1, because\n        const windowSize = 2 ** (W - 1); // -1 because we skip zero\n        return { windows, windowSize };\n    };\n    return {\n        constTimeNegate,\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n) {\n            let p = c.ZERO;\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(1) * (Math.ceil( / ) + 1), where:\n         * -  is the window size\n         * -  is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = opts(W);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = opts(W);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        wNAFCached(P, precomputesMap, n, transform) {\n            // @ts-ignore\n            const W = P._WINDOW_SIZE || 1;\n            // Calculate precomputes on a first run, reuse them after\n            let comp = precomputesMap.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1) {\n                    precomputesMap.set(P, transform(comp));\n                }\n            }\n            return this.wNAF(W, comp, n);\n        },\n    };\n}\nexport function validateBasic(curve) {\n    validateField(curve.Fp);\n    validateObject(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...nLength(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Short Weierstrass curve. The formula is: y = x + ax + b\nimport * as mod from './modular.js';\nimport * as ut from './utils.js';\nimport { ensureBytes } from './utils.js';\nimport { wNAF, validateBasic } from './curve.js';\nfunction validatePointOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('Endomorphism can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('Expected endomorphism with beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\n// ASN.1 DER encoding utilities\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nexport const DER = {\n    // asn.1 DER encoding utils\n    Err: class DERErr extends Error {\n        constructor(m = '') {\n            super(m);\n        }\n    },\n    _parseInt(data) {\n        const { Err: E } = DER;\n        if (data.length < 2 || data[0] !== 0x02)\n            throw new E('Invalid signature integer tag');\n        const len = data[1];\n        const res = data.subarray(2, len + 2);\n        if (!len || res.length !== len)\n            throw new E('Invalid signature integer: wrong length');\n        // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n        // since we always use positive integers here. It must always be empty:\n        // - add zero byte if exists\n        // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n        if (res[0] & 0b10000000)\n            throw new E('Invalid signature integer: negative');\n        if (res[0] === 0x00 && !(res[1] & 0b10000000))\n            throw new E('Invalid signature integer: unnecessary leading zero');\n        return { d: b2n(res), l: data.subarray(len + 2) }; // d is data, l is left\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E } = DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        if (!(data instanceof Uint8Array))\n            throw new Error('ui8a expected');\n        let l = data.length;\n        if (l < 2 || data[0] != 0x30)\n            throw new E('Invalid signature tag');\n        if (data[1] !== l - 2)\n            throw new E('Invalid signature: incorrect length');\n        const { d: r, l: sBytes } = DER._parseInt(data.subarray(2));\n        const { d: s, l: rBytesLeft } = DER._parseInt(sBytes);\n        if (rBytesLeft.length)\n            throw new E('Invalid signature: left bytes after parsing');\n        return { r, s };\n    },\n    hexFromSig(sig) {\n        // Add leading zero if first byte has negative bit enabled. More details in '_parseInt'\n        const slice = (s) => (Number.parseInt(s[0], 16) & 0b1000 ? '00' + s : s);\n        const h = (num) => {\n            const hex = num.toString(16);\n            return hex.length & 1 ? `0${hex}` : hex;\n        };\n        const s = slice(h(sig.s));\n        const r = slice(h(sig.r));\n        const shl = s.length / 2;\n        const rhl = r.length / 2;\n        const sl = h(shl);\n        const rl = h(rhl);\n        return `30${h(rhl + shl + 4)}02${rl}${r}02${sl}${s}`;\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nexport function weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const toBytes = CURVE.toBytes ||\n        ((c, point, isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y = x + ax + b: Short weierstrass curve formula\n     * @returns y\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return typeof num === 'bigint' && _0n < num && num < CURVE.n;\n    }\n    function assertGE(num) {\n        if (!isWithinCurveOrder(num))\n            throw new Error('Expected valid bigint: 0 < bigint < curve.n');\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (key instanceof Uint8Array)\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('Invalid key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE(ensureBytes('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error(`private key must be ${nByteLength} bytes, hex or bigint, not ${typeof key}`);\n        }\n        if (wrapPrivateKey)\n            num = mod.mod(num, n); // disabled by default, enabled for BLS\n        assertGE(num); // num in range [1..N-1]\n        return num;\n    }\n    const pointPrecomputes = new Map();\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z)  (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes(ensureBytes('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            this._WINDOW_SIZE = windowSize;\n            pointPrecomputes.delete(this);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            // Zero is valid point too!\n            if (this.is0()) {\n                if (CURVE.allowInfinityPoint)\n                    return;\n                throw new Error('bad point: ZERO');\n            }\n            // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n            const { x, y } = this.toAffine();\n            // Check if x, y are valid field elements\n            if (!Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('bad point: x or y not FE');\n            const left = Fp.sqr(y); // y\n            const right = weierstrassEquation(x); // x + ax + b\n            if (!Fp.eql(left, right))\n                throw new Error('bad point: equation left != right');\n            if (!this.isTorsionFree())\n                throw new Error('bad point: not in prime-order subgroup');\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, pointPrecomputes, n, (comp) => {\n                const toInv = Fp.invertBatch(comp.map((p) => p.pz));\n                return comp.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n            });\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(n) {\n            const I = Point.ZERO;\n            if (n === _0n)\n                return I;\n            assertGE(n); // Will throw on 0\n            if (n === _1n)\n                return this;\n            const { endo } = CURVE;\n            if (!endo)\n                return wnaf.unsafeLadder(this, n);\n            // Apply endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            assertGE(scalar);\n            let n = scalar;\n            let point, fake; // Fake point is used to const-time mult\n            const { endo } = CURVE;\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(n);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z)  (x=x/z, y=y/z)\n        toAffine(iz) {\n            const { px: x, py: y, pz: z } = this;\n            const is0 = this.is0();\n            // If invZ was 0, we return zero point. However we still want to execute\n            // all operations, so we replace invZ with a random number, 1.\n            if (iz == null)\n                iz = is0 ? Fp.ONE : Fp.inv(z);\n            const ax = Fp.mul(x, iz);\n            const ay = Fp.mul(y, iz);\n            const zz = Fp.mul(z, iz);\n            if (is0)\n                return { x: Fp.ZERO, y: Fp.ZERO };\n            if (!Fp.eql(zz, Fp.ONE))\n                throw new Error('invZ was invalid');\n            return { x: ax, y: ay };\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = wNAF(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\nexport function weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function isValidFieldElement(num) {\n        return _0n < num && num < Fp.ORDER; // 0 is banned since it's not invertible FE\n    }\n    function modN(a) {\n        return mod.mod(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return mod.invert(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!isValidFieldElement(x))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y = x + ax + b\n                let y = Fp.sqrt(y2); // y = y ^ (p+1)/4\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                throw new Error(`Point of length ${len} was invalid. Expected ${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes`);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = ensureBytes('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = DER.toSig(ensureBytes('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            // can use assertGE here\n            if (!isWithinCurveOrder(this.r))\n                throw new Error('r must be 0 < r < CURVE.n');\n            if (!isWithinCurveOrder(this.s))\n                throw new Error('s must be 0 < s < CURVE.n');\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN(ensureBytes('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size (nBitLength+64)\n         * as per FIPS 186 B.4.1 with modulo bias being neglible.\n         */\n        randomPrivateKey: () => {\n            const rand = CURVE.randomBytes(Fp.BYTES + 8);\n            const num = mod.hashToPrivateScalar(rand, CURVE_ORDER);\n            return ut.numberToBytesBE(num, CURVE.nByteLength);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = item instanceof Uint8Array;\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        if (typeof num !== 'bigint')\n            throw new Error('bigint expected');\n        if (!(_0n <= num && num < ORDER_MASK))\n            throw new Error(`bigint expected < 2^${CURVE.nBitLength}`);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order, this will be wrong at least for P521.\n    // Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = ensureBytes('msgHash', msgHash);\n        if (prehash)\n            msgHash = ensureBytes('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push(ensureBytes('extraEntropy', e, Fp.BYTES)); // check for being of size BYTES\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b  [1,q1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G  k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1G - U2P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = ensureBytes('msgHash', msgHash);\n        publicKey = ensureBytes('publicKey', publicKey);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        const { lowS, prehash } = opts;\n        let _sig = undefined;\n        let P;\n        try {\n            if (typeof sg === 'string' || sg instanceof Uint8Array) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof DER.Err))\n                        throw derError;\n                    _sig = Signature.fromCompact(sg);\n                }\n            }\n            else if (typeof sg === 'object' && typeof sg.r === 'bigint' && typeof sg.s === 'bigint') {\n                const { r, s } = sg;\n                _sig = new Signature(r, s);\n            }\n            else {\n                throw new Error('PARSE');\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            if (error.message === 'PARSE')\n                throw new Error(`signature must be Signature instance, Uint8Array or hex string`);\n            return false;\n        }\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1G + u2P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * From draft-irtf-cfrg-hash-to-curve-16\n */\nexport function mapToCurveSimpleSWU(Fp, opts) {\n    mod.validateField(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","import assert from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assert.hash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assert.exists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.bytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac } from '@noble/hashes/hmac';\nimport { concatBytes, randomBytes } from '@noble/hashes/utils';\nimport { weierstrass } from './abstract/weierstrass.js';\n// connects noble-curves to noble-hashes\nexport function getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => hmac(hash, key, concatBytes(...msgs)),\n        randomBytes,\n    };\n}\nexport function createCurve(curveDef, defHash) {\n    const create = (hash) => weierstrass({ ...curveDef, ...getHash(hash) });\n    return Object.freeze({ ...create(defHash), create });\n}\n//# sourceMappingURL=_shortw_utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256 } from '@noble/hashes/sha256';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { Field, mod, pow2 } from './abstract/modular.js';\nimport { mapToCurveSimpleSWU } from './abstract/weierstrass.js';\nimport { bytesToNumberBE, concatBytes, ensureBytes, numberToBytesBE } from './abstract/utils.js';\nimport { createHasher, isogenyMap } from './abstract/hash-to-curve.js';\nimport { createCurve } from './_shortw_utils.js';\nconst secp256k1P = BigInt('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f');\nconst secp256k1N = BigInt('0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141');\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst divNearest = (a, b) => (a + b / _2n) / b;\n/**\n * n = n^((p+1)/4) for fields p = 3 mod 4. We unwrap the loop and multiply bit-by-bit.\n * (P+1n/4n).toString(2) would produce bits [223x 1, 0, 22x 1, 4x 0, 11, 00]\n */\nfunction sqrtMod(y) {\n    const P = secp256k1P;\n    // prettier-ignore\n    const _3n = BigInt(3), _6n = BigInt(6), _11n = BigInt(11), _22n = BigInt(22);\n    // prettier-ignore\n    const _23n = BigInt(23), _44n = BigInt(44), _88n = BigInt(88);\n    const b2 = (y * y * y) % P; // x^3, 11\n    const b3 = (b2 * b2 * y) % P; // x^7\n    const b6 = (pow2(b3, _3n, P) * b3) % P;\n    const b9 = (pow2(b6, _3n, P) * b3) % P;\n    const b11 = (pow2(b9, _2n, P) * b2) % P;\n    const b22 = (pow2(b11, _11n, P) * b11) % P;\n    const b44 = (pow2(b22, _22n, P) * b22) % P;\n    const b88 = (pow2(b44, _44n, P) * b44) % P;\n    const b176 = (pow2(b88, _88n, P) * b88) % P;\n    const b220 = (pow2(b176, _44n, P) * b44) % P;\n    const b223 = (pow2(b220, _3n, P) * b3) % P;\n    const t1 = (pow2(b223, _23n, P) * b22) % P;\n    const t2 = (pow2(t1, _6n, P) * b2) % P;\n    const root = pow2(t2, _2n, P);\n    if (!Fp.eql(Fp.sqr(root), y))\n        throw new Error('Cannot find square root');\n    return root;\n}\nconst Fp = Field(secp256k1P, undefined, undefined, { sqrt: sqrtMod });\nexport const secp256k1 = createCurve({\n    a: BigInt(0),\n    b: BigInt(7),\n    Fp,\n    n: secp256k1N,\n    // Base point (x, y) aka generator point\n    Gx: BigInt('55066263022277343669578718895168534326250603453777594175500187360389116729240'),\n    Gy: BigInt('32670510020758816978083085130507043184471273380659243275938904335757337482424'),\n    h: BigInt(1),\n    lowS: true,\n    /**\n     * secp256k1 belongs to Koblitz curves: it has efficiently computable endomorphism.\n     * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n     * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n     * Explanation: https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066\n     */\n    endo: {\n        beta: BigInt('0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee'),\n        splitScalar: (k) => {\n            const n = secp256k1N;\n            const a1 = BigInt('0x3086d221a7d46bcde86c90e49284eb15');\n            const b1 = -_1n * BigInt('0xe4437ed6010e88286f547fa90abfe4c3');\n            const a2 = BigInt('0x114ca50f7a8e2f3f657c1108d9d44cfd8');\n            const b2 = a1;\n            const POW_2_128 = BigInt('0x100000000000000000000000000000000'); // (2n**128n).toString(16)\n            const c1 = divNearest(b2 * k, n);\n            const c2 = divNearest(-b1 * k, n);\n            let k1 = mod(k - c1 * a1 - c2 * a2, n);\n            let k2 = mod(-c1 * b1 - c2 * b2, n);\n            const k1neg = k1 > POW_2_128;\n            const k2neg = k2 > POW_2_128;\n            if (k1neg)\n                k1 = n - k1;\n            if (k2neg)\n                k2 = n - k2;\n            if (k1 > POW_2_128 || k2 > POW_2_128) {\n                throw new Error('splitScalar: Endomorphism failed, k=' + k);\n            }\n            return { k1neg, k1, k2neg, k2 };\n        },\n    },\n}, sha256);\n// Schnorr signatures are superior to ECDSA from above. Below is Schnorr-specific BIP0340 code.\n// https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki\nconst _0n = BigInt(0);\nconst fe = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1P;\nconst ge = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1N;\n/** An object mapping tags to their tagged hash prefix of [SHA256(tag) | SHA256(tag)] */\nconst TAGGED_HASH_PREFIXES = {};\nfunction taggedHash(tag, ...messages) {\n    let tagP = TAGGED_HASH_PREFIXES[tag];\n    if (tagP === undefined) {\n        const tagH = sha256(Uint8Array.from(tag, (c) => c.charCodeAt(0)));\n        tagP = concatBytes(tagH, tagH);\n        TAGGED_HASH_PREFIXES[tag] = tagP;\n    }\n    return sha256(concatBytes(tagP, ...messages));\n}\n// ECDSA compact points are 33-byte. Schnorr is 32: we strip first byte 0x02 or 0x03\nconst pointToBytes = (point) => point.toRawBytes(true).slice(1);\nconst numTo32b = (n) => numberToBytesBE(n, 32);\nconst modP = (x) => mod(x, secp256k1P);\nconst modN = (x) => mod(x, secp256k1N);\nconst Point = secp256k1.ProjectivePoint;\nconst GmulAdd = (Q, a, b) => Point.BASE.multiplyAndAddUnsafe(Q, a, b);\n// Calculate point, scalar and bytes\nfunction schnorrGetExtPubKey(priv) {\n    let d_ = secp256k1.utils.normPrivateKeyToScalar(priv); // same method executed in fromPrivateKey\n    let p = Point.fromPrivateKey(d_); // P = d'G; 0 < d' < n check is done inside\n    const scalar = p.hasEvenY() ? d_ : modN(-d_);\n    return { scalar: scalar, bytes: pointToBytes(p) };\n}\n/**\n * lift_x from BIP340. Convert 32-byte x coordinate to elliptic curve point.\n * @returns valid point checked for being on-curve\n */\nfunction lift_x(x) {\n    if (!fe(x))\n        throw new Error('bad x: need 0 < x < p'); // Fail if x  p.\n    const xx = modP(x * x);\n    const c = modP(xx * x + BigInt(7)); // Let c = x + 7 mod p.\n    let y = sqrtMod(c); // Let y = c^(p+1)/4 mod p.\n    if (y % _2n !== _0n)\n        y = modP(-y); // Return the unique point P such that x(P) = x and\n    const p = new Point(x, y, _1n); // y(P) = y if y mod 2 = 0 or y(P) = p-y otherwise.\n    p.assertValidity();\n    return p;\n}\n/**\n * Create tagged hash, convert it to bigint, reduce modulo-n.\n */\nfunction challenge(...args) {\n    return modN(bytesToNumberBE(taggedHash('BIP0340/challenge', ...args)));\n}\n/**\n * Schnorr public key is just `x` coordinate of Point as per BIP340.\n */\nfunction schnorrGetPublicKey(privateKey) {\n    return schnorrGetExtPubKey(privateKey).bytes; // d'=int(sk). Fail if d'=0 or d'n. Ret bytes(d'G)\n}\n/**\n * Creates Schnorr signature as per BIP340. Verifies itself before returning anything.\n * auxRand is optional and is not the sole source of k generation: bad CSPRNG won't be dangerous.\n */\nfunction schnorrSign(message, privateKey, auxRand = randomBytes(32)) {\n    const m = ensureBytes('message', message);\n    const { bytes: px, scalar: d } = schnorrGetExtPubKey(privateKey); // checks for isWithinCurveOrder\n    const a = ensureBytes('auxRand', auxRand, 32); // Auxiliary random data a: a 32-byte array\n    const t = numTo32b(d ^ bytesToNumberBE(taggedHash('BIP0340/aux', a))); // Let t be the byte-wise xor of bytes(d) and hash/aux(a)\n    const rand = taggedHash('BIP0340/nonce', t, px, m); // Let rand = hash/nonce(t || bytes(P) || m)\n    const k_ = modN(bytesToNumberBE(rand)); // Let k' = int(rand) mod n\n    if (k_ === _0n)\n        throw new Error('sign failed: k is zero'); // Fail if k' = 0.\n    const { bytes: rx, scalar: k } = schnorrGetExtPubKey(k_); // Let R = k'G.\n    const e = challenge(rx, px, m); // Let e = int(hash/challenge(bytes(R) || bytes(P) || m)) mod n.\n    const sig = new Uint8Array(64); // Let sig = bytes(R) || bytes((k + ed) mod n).\n    sig.set(rx, 0);\n    sig.set(numTo32b(modN(k + e * d)), 32);\n    // If Verify(bytes(P), m, sig) (see below) returns failure, abort\n    if (!schnorrVerify(sig, m, px))\n        throw new Error('sign: Invalid signature produced');\n    return sig;\n}\n/**\n * Verifies Schnorr signature.\n * Will swallow errors & return false except for initial type validation of arguments.\n */\nfunction schnorrVerify(signature, message, publicKey) {\n    const sig = ensureBytes('signature', signature, 64);\n    const m = ensureBytes('message', message);\n    const pub = ensureBytes('publicKey', publicKey, 32);\n    try {\n        const P = lift_x(bytesToNumberBE(pub)); // P = lift_x(int(pk)); fail if that fails\n        const r = bytesToNumberBE(sig.subarray(0, 32)); // Let r = int(sig[0:32]); fail if r  p.\n        if (!fe(r))\n            return false;\n        const s = bytesToNumberBE(sig.subarray(32, 64)); // Let s = int(sig[32:64]); fail if s  n.\n        if (!ge(s))\n            return false;\n        const e = challenge(numTo32b(r), pointToBytes(P), m); // int(challenge(bytes(r)||bytes(P)||m))%n\n        const R = GmulAdd(P, s, modN(-e)); // R = sG - eP\n        if (!R || !R.hasEvenY() || R.toAffine().x !== r)\n            return false; // -eP == (n-e)P\n        return true; // Fail if is_infinite(R) / not has_even_y(R) / x(R)  r.\n    }\n    catch (error) {\n        return false;\n    }\n}\nexport const schnorr = /* @__PURE__ */ (() => ({\n    getPublicKey: schnorrGetPublicKey,\n    sign: schnorrSign,\n    verify: schnorrVerify,\n    utils: {\n        randomPrivateKey: secp256k1.utils.randomPrivateKey,\n        lift_x,\n        pointToBytes,\n        numberToBytesBE,\n        bytesToNumberBE,\n        taggedHash,\n        mod,\n    },\n}))();\nconst isoMap = /* @__PURE__ */ (() => isogenyMap(Fp, [\n    // xNum\n    [\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7',\n        '0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581',\n        '0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262',\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c',\n    ],\n    // xDen\n    [\n        '0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b',\n        '0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n    // yNum\n    [\n        '0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c',\n        '0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3',\n        '0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931',\n        '0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84',\n    ],\n    // yDen\n    [\n        '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b',\n        '0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573',\n        '0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n].map((i) => i.map((j) => BigInt(j)))))();\nconst mapSWU = /* @__PURE__ */ (() => mapToCurveSimpleSWU(Fp, {\n    A: BigInt('0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533'),\n    B: BigInt('1771'),\n    Z: Fp.create(BigInt('-11')),\n}))();\nconst htf = /* @__PURE__ */ (() => createHasher(secp256k1.ProjectivePoint, (scalars) => {\n    const { x, y } = mapSWU(Fp.create(scalars[0]));\n    return isoMap(x, y);\n}, {\n    DST: 'secp256k1_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'secp256k1_XMD:SHA-256_SSWU_NU_',\n    p: Fp.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256,\n}))();\nexport const hashToCurve = /* @__PURE__ */ (() => htf.hashToCurve)();\nexport const encodeToCurve = /* @__PURE__ */ (() => htf.encodeToCurve)();\n//# sourceMappingURL=secp256k1.js.map","/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nexport function assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nfunction chain(...args) {\n    const wrap = (a, b) => (c) => a(b(c));\n    const encode = Array.from(args)\n        .reverse()\n        .reduce((acc, i) => (acc ? wrap(acc, i.encode) : i.encode), undefined);\n    const decode = args.reduce((acc, i) => (acc ? wrap(acc, i.decode) : i.decode), undefined);\n    return { encode, decode };\n}\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\nfunction convertRadix(data, from, to) {\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            digits[i] = Math.floor(digitBase / to);\n            if (!Number.isSafeInteger(digits[i]) || digits[i] * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!digits[i])\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = (from, to) => from + (to - gcd(from, to));\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0;\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1;\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of strings');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of strings');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\nexport const utils = { alphabet, chain, checksum, radix, radix2, join, padding };\nexport const base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexport const base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexport const base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexport const base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexport const base64 = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexport const base64url = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexport const base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexport const base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexport const base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexport const base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nexport const base58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), base58);\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        prefix = prefix.toLowerCase();\n        return `${prefix}1${BECH_ALPHABET.encode(words)}${bechChecksum(prefix, words, ENCODING_CONST)}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        str = lowered;\n        const sepIndex = str.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = str.slice(0, sepIndex);\n        const _words = str.slice(sepIndex + 1);\n        if (_words.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(_words).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!_words.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexport const bech32 = genBech32('bech32');\nexport const bech32m = genBech32('bech32m');\nexport const utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexport const hex = chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\nconst CODERS = {\n    utf8, hex, base16, base32, base64, base64url, base58, base58xmr\n};\nconst coderTypeError = `Invalid encoding type. Available types: ${Object.keys(CODERS).join(', ')}`;\nexport const bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!(bytes instanceof Uint8Array))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexport const str = bytesToString;\nexport const stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexport const bytes = stringToBytes;\n","export const wordlist = `abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo`.split('\\n');\n//# sourceMappingURL=english.js.map","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\n// copied from utils\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\n// Other libraries would silently corrupt the data instead of throwing an error,\n// when they don't support it.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!isBytes(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!isBytes(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        if (!isBytes(a))\n            throw new Error('Uint8Array expected');\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","import { hash as assertHash, number as assertNumber } from './_assert.js';\nimport { hmac } from './hmac.js';\nimport { createView, toBytes, checkOpts, asyncLoop } from './utils.js';\n// Common prologue and epilogue for sync/async functions\nfunction pbkdf2Init(hash, _password, _salt, _opts) {\n    assertHash(hash);\n    const opts = checkOpts({ dkLen: 32, asyncTick: 10 }, _opts);\n    const { c, dkLen, asyncTick } = opts;\n    assertNumber(c);\n    assertNumber(dkLen);\n    assertNumber(asyncTick);\n    if (c < 1)\n        throw new Error('PBKDF2: iterations (c) should be >= 1');\n    const password = toBytes(_password);\n    const salt = toBytes(_salt);\n    // DK = PBKDF2(PRF, Password, Salt, c, dkLen);\n    const DK = new Uint8Array(dkLen);\n    // U1 = PRF(Password, Salt + INT_32_BE(i))\n    const PRF = hmac.create(hash, password);\n    const PRFSalt = PRF._cloneInto().update(salt);\n    return { c, dkLen, asyncTick, DK, PRF, PRFSalt };\n}\nfunction pbkdf2Output(PRF, PRFSalt, DK, prfW, u) {\n    PRF.destroy();\n    PRFSalt.destroy();\n    if (prfW)\n        prfW.destroy();\n    u.fill(0);\n    return DK;\n}\n/**\n * PBKDF2-HMAC: RFC 2898 key derivation function\n * @param hash - hash function that would be used e.g. sha256\n * @param password - password from which a derived key is generated\n * @param salt - cryptographic salt\n * @param opts - {c, dkLen} where c is work factor and dkLen is output message size\n */\nexport function pbkdf2(hash, password, salt, opts) {\n    const { c, dkLen, DK, PRF, PRFSalt } = pbkdf2Init(hash, password, salt, opts);\n    let prfW; // Working copy\n    const arr = new Uint8Array(4);\n    const view = createView(arr);\n    const u = new Uint8Array(PRF.outputLen);\n    // DK = T1 + T2 +  + Tdklen/hlen\n    for (let ti = 1, pos = 0; pos < dkLen; ti++, pos += PRF.outputLen) {\n        // Ti = F(Password, Salt, c, i)\n        const Ti = DK.subarray(pos, pos + PRF.outputLen);\n        view.setInt32(0, ti, false);\n        // F(Password, Salt, c, i) = U1 ^ U2 ^  ^ Uc\n        // U1 = PRF(Password, Salt + INT_32_BE(i))\n        (prfW = PRFSalt._cloneInto(prfW)).update(arr).digestInto(u);\n        Ti.set(u.subarray(0, Ti.length));\n        for (let ui = 1; ui < c; ui++) {\n            // Uc = PRF(Password, Uc1)\n            PRF._cloneInto(prfW).update(u).digestInto(u);\n            for (let i = 0; i < Ti.length; i++)\n                Ti[i] ^= u[i];\n        }\n    }\n    return pbkdf2Output(PRF, PRFSalt, DK, prfW, u);\n}\nexport async function pbkdf2Async(hash, password, salt, opts) {\n    const { c, dkLen, asyncTick, DK, PRF, PRFSalt } = pbkdf2Init(hash, password, salt, opts);\n    let prfW; // Working copy\n    const arr = new Uint8Array(4);\n    const view = createView(arr);\n    const u = new Uint8Array(PRF.outputLen);\n    // DK = T1 + T2 +  + Tdklen/hlen\n    for (let ti = 1, pos = 0; pos < dkLen; ti++, pos += PRF.outputLen) {\n        // Ti = F(Password, Salt, c, i)\n        const Ti = DK.subarray(pos, pos + PRF.outputLen);\n        view.setInt32(0, ti, false);\n        // F(Password, Salt, c, i) = U1 ^ U2 ^  ^ Uc\n        // U1 = PRF(Password, Salt + INT_32_BE(i))\n        (prfW = PRFSalt._cloneInto(prfW)).update(arr).digestInto(u);\n        Ti.set(u.subarray(0, Ti.length));\n        await asyncLoop(c - 1, asyncTick, () => {\n            // Uc = PRF(Password, Uc1)\n            PRF._cloneInto(prfW).update(u).digestInto(u);\n            for (let i = 0; i < Ti.length; i++)\n                Ti[i] ^= u[i];\n        });\n    }\n    return pbkdf2Output(PRF, PRFSalt, DK, prfW, u);\n}\n//# sourceMappingURL=pbkdf2.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","const U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n// We are not using BigUint64Array, because they are extremely slow as per 2022\nfunction fromBig(n, le = false) {\n    if (le)\n        return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n    return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\nfunction split(lst, le = false) {\n    let Ah = new Uint32Array(lst.length);\n    let Al = new Uint32Array(lst.length);\n    for (let i = 0; i < lst.length; i++) {\n        const { h, l } = fromBig(lst[i], le);\n        [Ah[i], Al[i]] = [h, l];\n    }\n    return [Ah, Al];\n}\nconst toBig = (h, l) => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h, _l, s) => h >>> s;\nconst shrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h, l, s) => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h, l, s) => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h, l, s) => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h, l) => l;\nconst rotr32L = (h, _l) => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h, l, s) => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h, l, s) => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h, l, s) => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h, l, s) => (h << (s - 32)) | (l >>> (64 - s));\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(Ah, Al, Bh, Bl) {\n    const l = (Al >>> 0) + (Bl >>> 0);\n    return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al, Bl, Cl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low, Ah, Bh, Ch) => (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al, Bl, Cl, Dl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low, Ah, Bh, Ch, Dh) => (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al, Bl, Cl, Dl, El) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low, Ah, Bh, Ch, Dh, Eh) => (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n// prettier-ignore\nexport { fromBig, split, toBig, shrSH, shrSL, rotrSH, rotrSL, rotrBH, rotrBL, rotr32H, rotr32L, rotlSH, rotlSL, rotlBH, rotlBL, add, add3L, add3H, add4L, add4H, add5H, add5L, };\n// prettier-ignore\nconst u64 = {\n    fromBig, split, toBig,\n    shrSH, shrSL,\n    rotrSH, rotrSL, rotrBH, rotrBL,\n    rotr32H, rotr32L,\n    rotlSH, rotlSL, rotlBH, rotlBL,\n    add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n//# sourceMappingURL=_u64.js.map","import { SHA2 } from './_sha2.js';\nimport u64 from './_u64.js';\nimport { wrapConstructor } from './utils.js';\n// Round contants (first 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409):\n// prettier-ignore\nconst [SHA512_Kh, SHA512_Kl] = /* @__PURE__ */ (() => u64.split([\n    '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n    '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n    '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n    '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n    '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n    '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n    '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n    '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n    '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n    '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n    '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n    '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n    '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n    '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n    '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n    '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n    '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n    '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n    '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n    '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\n// Temporary buffer, not used to store anything between runs\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\nexport class SHA512 extends SHA2 {\n    constructor() {\n        super(128, 64, 16, false);\n        // We cannot use array here since array allows indexing by variable which means optimizer/compiler cannot use registers.\n        // Also looks cleaner and easier to verify with spec.\n        // Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x6a09e667 | 0;\n        this.Al = 0xf3bcc908 | 0;\n        this.Bh = 0xbb67ae85 | 0;\n        this.Bl = 0x84caa73b | 0;\n        this.Ch = 0x3c6ef372 | 0;\n        this.Cl = 0xfe94f82b | 0;\n        this.Dh = 0xa54ff53a | 0;\n        this.Dl = 0x5f1d36f1 | 0;\n        this.Eh = 0x510e527f | 0;\n        this.El = 0xade682d1 | 0;\n        this.Fh = 0x9b05688c | 0;\n        this.Fl = 0x2b3e6c1f | 0;\n        this.Gh = 0x1f83d9ab | 0;\n        this.Gl = 0xfb41bd6b | 0;\n        this.Hh = 0x5be0cd19 | 0;\n        this.Hl = 0x137e2179 | 0;\n    }\n    // prettier-ignore\n    get() {\n        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n    }\n    // prettier-ignore\n    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {\n        this.Ah = Ah | 0;\n        this.Al = Al | 0;\n        this.Bh = Bh | 0;\n        this.Bl = Bl | 0;\n        this.Ch = Ch | 0;\n        this.Cl = Cl | 0;\n        this.Dh = Dh | 0;\n        this.Dl = Dl | 0;\n        this.Eh = Eh | 0;\n        this.El = El | 0;\n        this.Fh = Fh | 0;\n        this.Fl = Fl | 0;\n        this.Gh = Gh | 0;\n        this.Gl = Gl | 0;\n        this.Hh = Hh | 0;\n        this.Hl = Hl | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4) {\n            SHA512_W_H[i] = view.getUint32(offset);\n            SHA512_W_L[i] = view.getUint32((offset += 4));\n        }\n        for (let i = 16; i < 80; i++) {\n            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n            const W15h = SHA512_W_H[i - 15] | 0;\n            const W15l = SHA512_W_L[i - 15] | 0;\n            const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n            const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n            const W2h = SHA512_W_H[i - 2] | 0;\n            const W2l = SHA512_W_L[i - 2] | 0;\n            const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n            const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n            const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n            const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n            SHA512_W_H[i] = SUMh | 0;\n            SHA512_W_L[i] = SUMl | 0;\n        }\n        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        // Compression function main loop, 80 rounds\n        for (let i = 0; i < 80; i++) {\n            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n            const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n            const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n            const CHIl = (El & Fl) ^ (~El & Gl);\n            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n            // prettier-ignore\n            const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n            const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n            const T1l = T1ll | 0;\n            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n            const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n            const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n            const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n            const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n            Hh = Gh | 0;\n            Hl = Gl | 0;\n            Gh = Fh | 0;\n            Gl = Fl | 0;\n            Fh = Eh | 0;\n            Fl = El | 0;\n            ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n            Dh = Ch | 0;\n            Dl = Cl | 0;\n            Ch = Bh | 0;\n            Cl = Bl | 0;\n            Bh = Ah | 0;\n            Bl = Al | 0;\n            const All = u64.add3L(T1l, sigma0l, MAJl);\n            Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n            Al = All | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n        ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n        ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n        ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n        ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n        ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n        ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n        ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n    }\n    roundClean() {\n        SHA512_W_H.fill(0);\n        SHA512_W_L.fill(0);\n    }\n    destroy() {\n        this.buffer.fill(0);\n        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n}\nclass SHA512_224 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x8c3d37c8 | 0;\n        this.Al = 0x19544da2 | 0;\n        this.Bh = 0x73e19966 | 0;\n        this.Bl = 0x89dcd4d6 | 0;\n        this.Ch = 0x1dfab7ae | 0;\n        this.Cl = 0x32ff9c82 | 0;\n        this.Dh = 0x679dd514 | 0;\n        this.Dl = 0x582f9fcf | 0;\n        this.Eh = 0x0f6d2b69 | 0;\n        this.El = 0x7bd44da8 | 0;\n        this.Fh = 0x77e36f73 | 0;\n        this.Fl = 0x04c48942 | 0;\n        this.Gh = 0x3f9d85a8 | 0;\n        this.Gl = 0x6a1d36c8 | 0;\n        this.Hh = 0x1112e6ad | 0;\n        this.Hl = 0x91d692a1 | 0;\n        this.outputLen = 28;\n    }\n}\nclass SHA512_256 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x22312194 | 0;\n        this.Al = 0xfc2bf72c | 0;\n        this.Bh = 0x9f555fa3 | 0;\n        this.Bl = 0xc84c64c2 | 0;\n        this.Ch = 0x2393b86b | 0;\n        this.Cl = 0x6f53b151 | 0;\n        this.Dh = 0x96387719 | 0;\n        this.Dl = 0x5940eabd | 0;\n        this.Eh = 0x96283ee2 | 0;\n        this.El = 0xa88effe3 | 0;\n        this.Fh = 0xbe5e1e25 | 0;\n        this.Fl = 0x53863992 | 0;\n        this.Gh = 0x2b0199fc | 0;\n        this.Gl = 0x2c85b8aa | 0;\n        this.Hh = 0x0eb72ddc | 0;\n        this.Hl = 0x81c52ca2 | 0;\n        this.outputLen = 32;\n    }\n}\nclass SHA384 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0xcbbb9d5d | 0;\n        this.Al = 0xc1059ed8 | 0;\n        this.Bh = 0x629a292a | 0;\n        this.Bl = 0x367cd507 | 0;\n        this.Ch = 0x9159015a | 0;\n        this.Cl = 0x3070dd17 | 0;\n        this.Dh = 0x152fecd8 | 0;\n        this.Dl = 0xf70e5939 | 0;\n        this.Eh = 0x67332667 | 0;\n        this.El = 0xffc00b31 | 0;\n        this.Fh = 0x8eb44a87 | 0;\n        this.Fl = 0x68581511 | 0;\n        this.Gh = 0xdb0c2e0d | 0;\n        this.Gl = 0x64f98fa7 | 0;\n        this.Hh = 0x47b5481d | 0;\n        this.Hl = 0xbefa4fa4 | 0;\n        this.outputLen = 48;\n    }\n}\nexport const sha512 = /* @__PURE__ */ wrapConstructor(() => new SHA512());\nexport const sha512_224 = /* @__PURE__ */ wrapConstructor(() => new SHA512_224());\nexport const sha512_256 = /* @__PURE__ */ wrapConstructor(() => new SHA512_256());\nexport const sha384 = /* @__PURE__ */ wrapConstructor(() => new SHA384());\n//# sourceMappingURL=sha512.js.map","/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities\n/**\n * @__NO_SIDE_EFFECTS__\n */\nexport function assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction chain(...args) {\n    const id = (a) => a;\n    // Wrap call in closure so JIT can inline calls\n    const wrap = (a, b) => (c) => a(b(c));\n    // Construct chain of args[-1].encode(args[-2].encode([...]))\n    const encode = args.map((x) => x.encode).reduceRight(wrap, id);\n    // Construct chain of args[0].decode(args[1].decode(...))\n    const decode = args.map((x) => x.decode).reduce(wrap, id);\n    return { encode, decode };\n}\n/**\n * Encodes integer radix representation to array of strings using alphabet and back\n * @__NO_SIDE_EFFECTS__\n */\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\n/**\n * Pad strings array so it has integer number of bits\n * @__NO_SIDE_EFFECTS__\n */\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\n/**\n * Slow: O(n^2) time complexity\n * @__NO_SIDE_EFFECTS__\n */\nfunction convertRadix(data, from, to) {\n    // base 1 is impossible\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            const rounded = Math.floor(digitBase / to);\n            digits[i] = rounded;\n            if (!Number.isSafeInteger(rounded) || rounded * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!rounded)\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = /* @__NO_SIDE_EFFECTS__ */ (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = /*@__NO_SIDE_EFFECTS__ */ (from, to) => from + (to - gcd(from, to));\n/**\n * Implemented with numbers, because BigInt is 5x slower\n * @__NO_SIDE_EFFECTS__\n */\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0; // bitwise position in current element\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1; // clean carry, otherwise it will cause overflow\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of numbers');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\n/**\n * If both bases are power of same number (like `2**8 <-> 2**64`),\n * there is a linear algorithm. For now we have implementation for power-of-two bases only.\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of numbers');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\n// prettier-ignore\nexport const utils = {\n    alphabet, chain, checksum, convertRadix, convertRadix2, radix, radix2, join, padding,\n};\n// RFC 4648 aka RFC 3548\n// ---------------------\nexport const base16 = /* @__PURE__ */ chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexport const base32 = /* @__PURE__ */ chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexport const base32hex = /* @__PURE__ */ chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexport const base32crockford = /* @__PURE__ */ chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexport const base64 = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexport const base64nopad = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), join(''));\nexport const base64url = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nexport const base64urlnopad = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), join(''));\n// base58 code\n// -----------\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexport const base58 = /* @__PURE__ */ genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexport const base58flickr = /* @__PURE__ */ genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexport const base58xrp = /* @__PURE__ */ genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\n// xmr ver is done in 8-byte blocks (which equals 11 chars in decoding). Last (non-full) block padded with '1' to size in XMR_BLOCK_LEN.\n// Block encoding significantly reduces quadratic complexity of base58.\n// Data len (index) -> encoded block len\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexport const base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nexport const createBase58check = /* @__PURE__ */ (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), base58);\n// legacy export, bad name\nexport const base58check = createBase58check;\nconst BECH_ALPHABET = /* @__PURE__ */ chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        if (prefix.length === 0)\n            throw new TypeError(`Invalid prefix length ${prefix.length}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        const lowered = prefix.toLowerCase();\n        const sum = bechChecksum(lowered, words, ENCODING_CONST);\n        return `${lowered}1${BECH_ALPHABET.encode(words)}${sum}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        // don't allow mixed case\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        const sepIndex = lowered.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = lowered.slice(0, sepIndex);\n        const data = lowered.slice(sepIndex + 1);\n        if (data.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(data).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!data.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexport const bech32 = /* @__PURE__ */ genBech32('bech32');\nexport const bech32m = /* @__PURE__ */ genBech32('bech32m');\nexport const utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexport const hex = /* @__PURE__ */ chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\n// prettier-ignore\nconst CODERS = {\n    utf8, hex, base16, base32, base64, base64url, base58, base58xmr\n};\nconst coderTypeError = 'Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr';\nexport const bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!isBytes(bytes))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexport const str = bytesToString; // as in python, but for bytes only\nexport const stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexport const bytes = stringToBytes;\n//# sourceMappingURL=index.js.map","import assert from '@noble/hashes/_assert';\nimport { pbkdf2, pbkdf2Async } from '@noble/hashes/pbkdf2';\nimport { sha256 } from '@noble/hashes/sha256';\nimport { sha512 } from '@noble/hashes/sha512';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { utils as baseUtils } from '@scure/base';\nconst isJapanese = (wordlist) => wordlist[0] === '\\u3042\\u3044\\u3053\\u304f\\u3057\\u3093';\nfunction nfkd(str) {\n    if (typeof str !== 'string')\n        throw new TypeError(`Invalid mnemonic type: ${typeof str}`);\n    return str.normalize('NFKD');\n}\nfunction normalize(str) {\n    const norm = nfkd(str);\n    const words = norm.split(' ');\n    if (![12, 15, 18, 21, 24].includes(words.length))\n        throw new Error('Invalid mnemonic');\n    return { nfkd: norm, words };\n}\nfunction assertEntropy(entropy) {\n    assert.bytes(entropy, 16, 20, 24, 28, 32);\n}\nexport function generateMnemonic(wordlist, strength = 128) {\n    assert.number(strength);\n    if (strength % 32 !== 0 || strength > 256)\n        throw new TypeError('Invalid entropy');\n    return entropyToMnemonic(randomBytes(strength / 8), wordlist);\n}\nconst calcChecksum = (entropy) => {\n    const bitsLeft = 8 - entropy.length / 4;\n    return new Uint8Array([(sha256(entropy)[0] >> bitsLeft) << bitsLeft]);\n};\nfunction getCoder(wordlist) {\n    if (!Array.isArray(wordlist) || wordlist.length !== 2048 || typeof wordlist[0] !== 'string')\n        throw new Error('Worlist: expected array of 2048 strings');\n    wordlist.forEach((i) => {\n        if (typeof i !== 'string')\n            throw new Error(`Wordlist: non-string element: ${i}`);\n    });\n    return baseUtils.chain(baseUtils.checksum(1, calcChecksum), baseUtils.radix2(11, true), baseUtils.alphabet(wordlist));\n}\nexport function mnemonicToEntropy(mnemonic, wordlist) {\n    const { words } = normalize(mnemonic);\n    const entropy = getCoder(wordlist).decode(words);\n    assertEntropy(entropy);\n    return entropy;\n}\nexport function entropyToMnemonic(entropy, wordlist) {\n    assertEntropy(entropy);\n    const words = getCoder(wordlist).encode(entropy);\n    return words.join(isJapanese(wordlist) ? '\\u3000' : ' ');\n}\nexport function validateMnemonic(mnemonic, wordlist) {\n    try {\n        mnemonicToEntropy(mnemonic, wordlist);\n    }\n    catch (e) {\n        return false;\n    }\n    return true;\n}\nconst salt = (passphrase) => nfkd(`mnemonic${passphrase}`);\nexport function mnemonicToSeed(mnemonic, passphrase = '') {\n    return pbkdf2Async(sha512, normalize(mnemonic).nfkd, salt(passphrase), { c: 2048, dkLen: 64 });\n}\nexport function mnemonicToSeedSync(mnemonic, passphrase = '') {\n    return pbkdf2(sha512, normalize(mnemonic).nfkd, salt(passphrase), { c: 2048, dkLen: 64 });\n}\n//# sourceMappingURL=index.js.map","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\n// copied from utils\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\n// Other libraries would silently corrupt the data instead of throwing an error,\n// when they don't support it.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!isBytes(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!isBytes(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        if (!isBytes(a))\n            throw new Error('Uint8Array expected');\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { wrapConstructor } from './utils.js';\n// https://homes.esat.kuleuven.be/~bosselae/ripemd160.html\n// https://homes.esat.kuleuven.be/~bosselae/ripemd160/pdf/AB-9601/AB-9601.pdf\nconst Rho = /* @__PURE__ */ new Uint8Array([7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8]);\nconst Id = /* @__PURE__ */ Uint8Array.from({ length: 16 }, (_, i) => i);\nconst Pi = /* @__PURE__ */ Id.map((i) => (9 * i + 5) % 16);\nlet idxL = [Id];\nlet idxR = [Pi];\nfor (let i = 0; i < 4; i++)\n    for (let j of [idxL, idxR])\n        j.push(j[i].map((k) => Rho[k]));\nconst shifts = /* @__PURE__ */ [\n    [11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8],\n    [12, 13, 11, 15, 6, 9, 9, 7, 12, 15, 11, 13, 7, 8, 7, 7],\n    [13, 15, 14, 11, 7, 7, 6, 8, 13, 14, 13, 12, 5, 5, 6, 9],\n    [14, 11, 12, 14, 8, 6, 5, 5, 15, 12, 15, 14, 9, 9, 8, 6],\n    [15, 12, 13, 13, 9, 5, 8, 6, 14, 11, 12, 11, 8, 6, 5, 5],\n].map((i) => new Uint8Array(i));\nconst shiftsL = /* @__PURE__ */ idxL.map((idx, i) => idx.map((j) => shifts[i][j]));\nconst shiftsR = /* @__PURE__ */ idxR.map((idx, i) => idx.map((j) => shifts[i][j]));\nconst Kl = /* @__PURE__ */ new Uint32Array([\n    0x00000000, 0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xa953fd4e,\n]);\nconst Kr = /* @__PURE__ */ new Uint32Array([\n    0x50a28be6, 0x5c4dd124, 0x6d703ef3, 0x7a6d76e9, 0x00000000,\n]);\n// The rotate left (circular left shift) operation for uint32\nconst rotl = (word, shift) => (word << shift) | (word >>> (32 - shift));\n// It's called f() in spec.\nfunction f(group, x, y, z) {\n    if (group === 0)\n        return x ^ y ^ z;\n    else if (group === 1)\n        return (x & y) | (~x & z);\n    else if (group === 2)\n        return (x | ~y) ^ z;\n    else if (group === 3)\n        return (x & z) | (y & ~z);\n    else\n        return x ^ (y | ~z);\n}\n// Temporary buffer, not used to store anything between runs\nconst BUF = /* @__PURE__ */ new Uint32Array(16);\nexport class RIPEMD160 extends SHA2 {\n    constructor() {\n        super(64, 20, 8, true);\n        this.h0 = 0x67452301 | 0;\n        this.h1 = 0xefcdab89 | 0;\n        this.h2 = 0x98badcfe | 0;\n        this.h3 = 0x10325476 | 0;\n        this.h4 = 0xc3d2e1f0 | 0;\n    }\n    get() {\n        const { h0, h1, h2, h3, h4 } = this;\n        return [h0, h1, h2, h3, h4];\n    }\n    set(h0, h1, h2, h3, h4) {\n        this.h0 = h0 | 0;\n        this.h1 = h1 | 0;\n        this.h2 = h2 | 0;\n        this.h3 = h3 | 0;\n        this.h4 = h4 | 0;\n    }\n    process(view, offset) {\n        for (let i = 0; i < 16; i++, offset += 4)\n            BUF[i] = view.getUint32(offset, true);\n        // prettier-ignore\n        let al = this.h0 | 0, ar = al, bl = this.h1 | 0, br = bl, cl = this.h2 | 0, cr = cl, dl = this.h3 | 0, dr = dl, el = this.h4 | 0, er = el;\n        // Instead of iterating 0 to 80, we split it into 5 groups\n        // And use the groups in constants, functions, etc. Much simpler\n        for (let group = 0; group < 5; group++) {\n            const rGroup = 4 - group;\n            const hbl = Kl[group], hbr = Kr[group]; // prettier-ignore\n            const rl = idxL[group], rr = idxR[group]; // prettier-ignore\n            const sl = shiftsL[group], sr = shiftsR[group]; // prettier-ignore\n            for (let i = 0; i < 16; i++) {\n                const tl = (rotl(al + f(group, bl, cl, dl) + BUF[rl[i]] + hbl, sl[i]) + el) | 0;\n                al = el, el = dl, dl = rotl(cl, 10) | 0, cl = bl, bl = tl; // prettier-ignore\n            }\n            // 2 loops are 10% faster\n            for (let i = 0; i < 16; i++) {\n                const tr = (rotl(ar + f(rGroup, br, cr, dr) + BUF[rr[i]] + hbr, sr[i]) + er) | 0;\n                ar = er, er = dr, dr = rotl(cr, 10) | 0, cr = br, br = tr; // prettier-ignore\n            }\n        }\n        // Add the compressed chunk to the current hash value\n        this.set((this.h1 + cl + dr) | 0, (this.h2 + dl + er) | 0, (this.h3 + el + ar) | 0, (this.h4 + al + br) | 0, (this.h0 + bl + cr) | 0);\n    }\n    roundClean() {\n        BUF.fill(0);\n    }\n    destroy() {\n        this.destroyed = true;\n        this.buffer.fill(0);\n        this.set(0, 0, 0, 0, 0);\n    }\n}\n/**\n * RIPEMD-160 - a hash function from 1990s.\n * @param message - msg that would be hashed\n */\nexport const ripemd160 = /* @__PURE__ */ wrapConstructor(() => new RIPEMD160());\n//# sourceMappingURL=ripemd160.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","const U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n// We are not using BigUint64Array, because they are extremely slow as per 2022\nfunction fromBig(n, le = false) {\n    if (le)\n        return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n    return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\nfunction split(lst, le = false) {\n    let Ah = new Uint32Array(lst.length);\n    let Al = new Uint32Array(lst.length);\n    for (let i = 0; i < lst.length; i++) {\n        const { h, l } = fromBig(lst[i], le);\n        [Ah[i], Al[i]] = [h, l];\n    }\n    return [Ah, Al];\n}\nconst toBig = (h, l) => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h, _l, s) => h >>> s;\nconst shrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h, l, s) => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h, l, s) => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h, l, s) => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h, l) => l;\nconst rotr32L = (h, _l) => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h, l, s) => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h, l, s) => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h, l, s) => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h, l, s) => (h << (s - 32)) | (l >>> (64 - s));\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(Ah, Al, Bh, Bl) {\n    const l = (Al >>> 0) + (Bl >>> 0);\n    return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al, Bl, Cl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low, Ah, Bh, Ch) => (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al, Bl, Cl, Dl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low, Ah, Bh, Ch, Dh) => (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al, Bl, Cl, Dl, El) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low, Ah, Bh, Ch, Dh, Eh) => (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n// prettier-ignore\nexport { fromBig, split, toBig, shrSH, shrSL, rotrSH, rotrSL, rotrBH, rotrBL, rotr32H, rotr32L, rotlSH, rotlSL, rotlBH, rotlBL, add, add3L, add3H, add4L, add4H, add5H, add5L, };\n// prettier-ignore\nconst u64 = {\n    fromBig, split, toBig,\n    shrSH, shrSL,\n    rotrSH, rotrSL, rotrBH, rotrBL,\n    rotr32H, rotr32L,\n    rotlSH, rotlSL, rotlBH, rotlBL,\n    add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n//# sourceMappingURL=_u64.js.map","import { SHA2 } from './_sha2.js';\nimport u64 from './_u64.js';\nimport { wrapConstructor } from './utils.js';\n// Round contants (first 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409):\n// prettier-ignore\nconst [SHA512_Kh, SHA512_Kl] = /* @__PURE__ */ (() => u64.split([\n    '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n    '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n    '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n    '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n    '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n    '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n    '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n    '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n    '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n    '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n    '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n    '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n    '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n    '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n    '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n    '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n    '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n    '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n    '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n    '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\n// Temporary buffer, not used to store anything between runs\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\nexport class SHA512 extends SHA2 {\n    constructor() {\n        super(128, 64, 16, false);\n        // We cannot use array here since array allows indexing by variable which means optimizer/compiler cannot use registers.\n        // Also looks cleaner and easier to verify with spec.\n        // Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x6a09e667 | 0;\n        this.Al = 0xf3bcc908 | 0;\n        this.Bh = 0xbb67ae85 | 0;\n        this.Bl = 0x84caa73b | 0;\n        this.Ch = 0x3c6ef372 | 0;\n        this.Cl = 0xfe94f82b | 0;\n        this.Dh = 0xa54ff53a | 0;\n        this.Dl = 0x5f1d36f1 | 0;\n        this.Eh = 0x510e527f | 0;\n        this.El = 0xade682d1 | 0;\n        this.Fh = 0x9b05688c | 0;\n        this.Fl = 0x2b3e6c1f | 0;\n        this.Gh = 0x1f83d9ab | 0;\n        this.Gl = 0xfb41bd6b | 0;\n        this.Hh = 0x5be0cd19 | 0;\n        this.Hl = 0x137e2179 | 0;\n    }\n    // prettier-ignore\n    get() {\n        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n    }\n    // prettier-ignore\n    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {\n        this.Ah = Ah | 0;\n        this.Al = Al | 0;\n        this.Bh = Bh | 0;\n        this.Bl = Bl | 0;\n        this.Ch = Ch | 0;\n        this.Cl = Cl | 0;\n        this.Dh = Dh | 0;\n        this.Dl = Dl | 0;\n        this.Eh = Eh | 0;\n        this.El = El | 0;\n        this.Fh = Fh | 0;\n        this.Fl = Fl | 0;\n        this.Gh = Gh | 0;\n        this.Gl = Gl | 0;\n        this.Hh = Hh | 0;\n        this.Hl = Hl | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4) {\n            SHA512_W_H[i] = view.getUint32(offset);\n            SHA512_W_L[i] = view.getUint32((offset += 4));\n        }\n        for (let i = 16; i < 80; i++) {\n            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n            const W15h = SHA512_W_H[i - 15] | 0;\n            const W15l = SHA512_W_L[i - 15] | 0;\n            const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n            const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n            const W2h = SHA512_W_H[i - 2] | 0;\n            const W2l = SHA512_W_L[i - 2] | 0;\n            const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n            const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n            const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n            const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n            SHA512_W_H[i] = SUMh | 0;\n            SHA512_W_L[i] = SUMl | 0;\n        }\n        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        // Compression function main loop, 80 rounds\n        for (let i = 0; i < 80; i++) {\n            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n            const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n            const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n            const CHIl = (El & Fl) ^ (~El & Gl);\n            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n            // prettier-ignore\n            const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n            const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n            const T1l = T1ll | 0;\n            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n            const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n            const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n            const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n            const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n            Hh = Gh | 0;\n            Hl = Gl | 0;\n            Gh = Fh | 0;\n            Gl = Fl | 0;\n            Fh = Eh | 0;\n            Fl = El | 0;\n            ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n            Dh = Ch | 0;\n            Dl = Cl | 0;\n            Ch = Bh | 0;\n            Cl = Bl | 0;\n            Bh = Ah | 0;\n            Bl = Al | 0;\n            const All = u64.add3L(T1l, sigma0l, MAJl);\n            Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n            Al = All | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n        ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n        ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n        ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n        ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n        ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n        ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n        ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n    }\n    roundClean() {\n        SHA512_W_H.fill(0);\n        SHA512_W_L.fill(0);\n    }\n    destroy() {\n        this.buffer.fill(0);\n        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n}\nclass SHA512_224 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x8c3d37c8 | 0;\n        this.Al = 0x19544da2 | 0;\n        this.Bh = 0x73e19966 | 0;\n        this.Bl = 0x89dcd4d6 | 0;\n        this.Ch = 0x1dfab7ae | 0;\n        this.Cl = 0x32ff9c82 | 0;\n        this.Dh = 0x679dd514 | 0;\n        this.Dl = 0x582f9fcf | 0;\n        this.Eh = 0x0f6d2b69 | 0;\n        this.El = 0x7bd44da8 | 0;\n        this.Fh = 0x77e36f73 | 0;\n        this.Fl = 0x04c48942 | 0;\n        this.Gh = 0x3f9d85a8 | 0;\n        this.Gl = 0x6a1d36c8 | 0;\n        this.Hh = 0x1112e6ad | 0;\n        this.Hl = 0x91d692a1 | 0;\n        this.outputLen = 28;\n    }\n}\nclass SHA512_256 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x22312194 | 0;\n        this.Al = 0xfc2bf72c | 0;\n        this.Bh = 0x9f555fa3 | 0;\n        this.Bl = 0xc84c64c2 | 0;\n        this.Ch = 0x2393b86b | 0;\n        this.Cl = 0x6f53b151 | 0;\n        this.Dh = 0x96387719 | 0;\n        this.Dl = 0x5940eabd | 0;\n        this.Eh = 0x96283ee2 | 0;\n        this.El = 0xa88effe3 | 0;\n        this.Fh = 0xbe5e1e25 | 0;\n        this.Fl = 0x53863992 | 0;\n        this.Gh = 0x2b0199fc | 0;\n        this.Gl = 0x2c85b8aa | 0;\n        this.Hh = 0x0eb72ddc | 0;\n        this.Hl = 0x81c52ca2 | 0;\n        this.outputLen = 32;\n    }\n}\nclass SHA384 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0xcbbb9d5d | 0;\n        this.Al = 0xc1059ed8 | 0;\n        this.Bh = 0x629a292a | 0;\n        this.Bl = 0x367cd507 | 0;\n        this.Ch = 0x9159015a | 0;\n        this.Cl = 0x3070dd17 | 0;\n        this.Dh = 0x152fecd8 | 0;\n        this.Dl = 0xf70e5939 | 0;\n        this.Eh = 0x67332667 | 0;\n        this.El = 0xffc00b31 | 0;\n        this.Fh = 0x8eb44a87 | 0;\n        this.Fl = 0x68581511 | 0;\n        this.Gh = 0xdb0c2e0d | 0;\n        this.Gl = 0x64f98fa7 | 0;\n        this.Hh = 0x47b5481d | 0;\n        this.Hl = 0xbefa4fa4 | 0;\n        this.outputLen = 48;\n    }\n}\nexport const sha512 = /* @__PURE__ */ wrapConstructor(() => new SHA512());\nexport const sha512_224 = /* @__PURE__ */ wrapConstructor(() => new SHA512_224());\nexport const sha512_256 = /* @__PURE__ */ wrapConstructor(() => new SHA512_256());\nexport const sha384 = /* @__PURE__ */ wrapConstructor(() => new SHA384());\n//# sourceMappingURL=sha512.js.map","export function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nexport function bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nexport function bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nexport function hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nexport function exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nexport function output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nconst assert = {\n    number,\n    bool,\n    bytes,\n    hash,\n    exists,\n    output,\n};\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\n// Check if object doens't have custom constructor (like Uint8Array/Array)\nconst isPlainObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]' && obj.constructor === Object;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && (typeof opts !== 'object' || !isPlainObject(opts)))\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import assert from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        assert.exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = wrapConstructor(() => new SHA256());\nexport const sha224 = wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst u8a = (a) => a instanceof Uint8Array;\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nexport function numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? `0${hex}` : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(`${title} must be valid hex string, got \"${hex}\". Cause: ${e}`);\n        }\n    }\n    else if (u8a(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(`${title} must be hex string or Uint8Array`);\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(`${title} expected ${expectedLength} bytes, got ${len}`);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\nexport function equalBytes(b1, b2) {\n    // We don't care about timing attacks here\n    if (b1.length !== b2.length)\n        return false;\n    for (let i = 0; i < b1.length; i++)\n        if (b1[i] !== b2[i])\n            return false;\n    return true;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nexport function bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nexport const bitSet = (n, pos, value) => {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n};\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nexport function validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error(`Invalid validator \"${type}\", expected function`);\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error(`Invalid param ${String(fieldName)}=${val} (${typeof val}), expected ${type}`);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n//# sourceMappingURL=utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities for modular arithmetics and finite fields\nimport { bitMask, numberToBytesBE, numberToBytesLE, bytesToNumberBE, bytesToNumberLE, ensureBytes, validateObject, } from './utils.js';\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _4n = BigInt(4), _5n = BigInt(5), _8n = BigInt(8);\n// prettier-ignore\nconst _9n = BigInt(9), _16n = BigInt(16);\n// Calculates a modulo b\nexport function mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\n// TODO: use field version && remove\nexport function pow(num, power, modulo) {\n    if (modulo <= _0n || power < _0n)\n        throw new Error('Expected power/modulo > 0');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n// Does x ^ (2 ^ power) mod p. pow2(30, 4) == 30 ^ (2 ^ 4)\nexport function pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n// Inverses number over modulo\nexport function invert(number, modulo) {\n    if (number === _0n || modulo <= _0n) {\n        throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    // Euclidean GCD https://brilliant.org/wiki/extended-euclidean-algorithm/\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n// Tonelli-Shanks algorithm\n// Paper 1: https://eprint.iacr.org/2012/685.pdf (page 12)\n// Paper 2: Square Roots from 1; 24, 51, 10 to Dan Shanks\nexport function tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p)  1    if a is a square (mod p)\n    // (a | p)  -1   if a is not a square (mod p)\n    // (a | p)  0    if a  0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p)  -1 and set c  zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++)\n        ;\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be  -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\nexport function FpSqrt(P) {\n    // NOTE: different algorithms can give different roots, it is up to user to decide which one they want.\n    // For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n    // P  3 (mod 4)\n    // n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q  5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P  9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nexport function validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return validateObject(field, opts);\n}\n// Generic field functions\nexport function FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('Expected power > 0');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n// 0 is non-invertible: non-batched version will throw on 0\nexport function FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nexport function FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare(f) {\n    const legendreConst = (f.ORDER - _1n) / _2n; // Integer arithmetic\n    return (x) => {\n        const p = f.pow(x, legendreConst);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nexport function nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a galois field over prime. Non-primes are not supported for now.\n * Do not init in loop: slow. Very fragile: always run a benchmark on change.\n * Major performance gains:\n * a) non-normalized operations like mulN instead of mul\n * b) `Object.freeze`\n * c) Same object shape: never add or remove keys\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error(`Expected Fp ORDER > 0, got ${ORDER}`);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('Field lengths over 2048 bytes are not supported');\n    const sqrtP = FpSqrt(ORDER);\n    const f = Object.freeze({\n        ORDER,\n        BITS,\n        BYTES,\n        MASK: bitMask(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error(`Invalid field element: expected bigint, got ${typeof num}`);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt || ((n) => sqrtP(f, n)),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error(`Fp.fromBytes: expected ${BYTES}, got ${bytes.length}`);\n            return isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nexport function FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nexport function FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * FIPS 186 B.4.1-compliant \"constant-time\" private key generation utility.\n * Can take (n+8) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 40 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. curveFn.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = ensureBytes('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error(`hashToPrivateScalar: expected ${minLen}-1024 bytes of input, got ${hashLen}`);\n    const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n//# sourceMappingURL=modular.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Abelian group utilities\nimport { validateField, nLength } from './modular.js';\nimport { validateObject } from './utils.js';\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n// Elliptic curve multiplication of Point by scalar. Fragile.\n// Scalars should always be less than curve order: this should be checked inside of a curve itself.\n// Creates precomputation tables for fast multiplication:\n// - private scalar is split by fixed size windows of W bits\n// - every window point is collected from window's table & added to accumulator\n// - since windows are different, same point inside tables won't be accessed more than once per calc\n// - each multiplication is 'Math.ceil(CURVE_ORDER / ) + 1' point additions (fixed for any scalar)\n// - +1 window is neccessary for wNAF\n// - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n// TODO: Research returning 2d JS array of windows, instead of a single window. This would allow\n// windows to be in different memory locations\nexport function wNAF(c, bits) {\n    const constTimeNegate = (condition, item) => {\n        const neg = item.negate();\n        return condition ? neg : item;\n    };\n    const opts = (W) => {\n        const windows = Math.ceil(bits / W) + 1; // +1, because\n        const windowSize = 2 ** (W - 1); // -1 because we skip zero\n        return { windows, windowSize };\n    };\n    return {\n        constTimeNegate,\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n) {\n            let p = c.ZERO;\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(1) * (Math.ceil( / ) + 1), where:\n         * -  is the window size\n         * -  is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = opts(W);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = opts(W);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        wNAFCached(P, precomputesMap, n, transform) {\n            // @ts-ignore\n            const W = P._WINDOW_SIZE || 1;\n            // Calculate precomputes on a first run, reuse them after\n            let comp = precomputesMap.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1) {\n                    precomputesMap.set(P, transform(comp));\n                }\n            }\n            return this.wNAF(W, comp, n);\n        },\n    };\n}\nexport function validateBasic(curve) {\n    validateField(curve.Fp);\n    validateObject(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...nLength(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Short Weierstrass curve. The formula is: y = x + ax + b\nimport * as mod from './modular.js';\nimport * as ut from './utils.js';\nimport { ensureBytes } from './utils.js';\nimport { wNAF, validateBasic } from './curve.js';\nfunction validatePointOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('Endomorphism can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('Expected endomorphism with beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\n// ASN.1 DER encoding utilities\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nexport const DER = {\n    // asn.1 DER encoding utils\n    Err: class DERErr extends Error {\n        constructor(m = '') {\n            super(m);\n        }\n    },\n    _parseInt(data) {\n        const { Err: E } = DER;\n        if (data.length < 2 || data[0] !== 0x02)\n            throw new E('Invalid signature integer tag');\n        const len = data[1];\n        const res = data.subarray(2, len + 2);\n        if (!len || res.length !== len)\n            throw new E('Invalid signature integer: wrong length');\n        // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n        // since we always use positive integers here. It must always be empty:\n        // - add zero byte if exists\n        // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n        if (res[0] & 0b10000000)\n            throw new E('Invalid signature integer: negative');\n        if (res[0] === 0x00 && !(res[1] & 0b10000000))\n            throw new E('Invalid signature integer: unnecessary leading zero');\n        return { d: b2n(res), l: data.subarray(len + 2) }; // d is data, l is left\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E } = DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        if (!(data instanceof Uint8Array))\n            throw new Error('ui8a expected');\n        let l = data.length;\n        if (l < 2 || data[0] != 0x30)\n            throw new E('Invalid signature tag');\n        if (data[1] !== l - 2)\n            throw new E('Invalid signature: incorrect length');\n        const { d: r, l: sBytes } = DER._parseInt(data.subarray(2));\n        const { d: s, l: rBytesLeft } = DER._parseInt(sBytes);\n        if (rBytesLeft.length)\n            throw new E('Invalid signature: left bytes after parsing');\n        return { r, s };\n    },\n    hexFromSig(sig) {\n        // Add leading zero if first byte has negative bit enabled. More details in '_parseInt'\n        const slice = (s) => (Number.parseInt(s[0], 16) & 0b1000 ? '00' + s : s);\n        const h = (num) => {\n            const hex = num.toString(16);\n            return hex.length & 1 ? `0${hex}` : hex;\n        };\n        const s = slice(h(sig.s));\n        const r = slice(h(sig.r));\n        const shl = s.length / 2;\n        const rhl = r.length / 2;\n        const sl = h(shl);\n        const rl = h(rhl);\n        return `30${h(rhl + shl + 4)}02${rl}${r}02${sl}${s}`;\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nexport function weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const toBytes = CURVE.toBytes ||\n        ((c, point, isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y = x + ax + b: Short weierstrass curve formula\n     * @returns y\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return typeof num === 'bigint' && _0n < num && num < CURVE.n;\n    }\n    function assertGE(num) {\n        if (!isWithinCurveOrder(num))\n            throw new Error('Expected valid bigint: 0 < bigint < curve.n');\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (key instanceof Uint8Array)\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('Invalid key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE(ensureBytes('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error(`private key must be ${nByteLength} bytes, hex or bigint, not ${typeof key}`);\n        }\n        if (wrapPrivateKey)\n            num = mod.mod(num, n); // disabled by default, enabled for BLS\n        assertGE(num); // num in range [1..N-1]\n        return num;\n    }\n    const pointPrecomputes = new Map();\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z)  (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes(ensureBytes('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            this._WINDOW_SIZE = windowSize;\n            pointPrecomputes.delete(this);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            // Zero is valid point too!\n            if (this.is0()) {\n                if (CURVE.allowInfinityPoint)\n                    return;\n                throw new Error('bad point: ZERO');\n            }\n            // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n            const { x, y } = this.toAffine();\n            // Check if x, y are valid field elements\n            if (!Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('bad point: x or y not FE');\n            const left = Fp.sqr(y); // y\n            const right = weierstrassEquation(x); // x + ax + b\n            if (!Fp.eql(left, right))\n                throw new Error('bad point: equation left != right');\n            if (!this.isTorsionFree())\n                throw new Error('bad point: not in prime-order subgroup');\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, pointPrecomputes, n, (comp) => {\n                const toInv = Fp.invertBatch(comp.map((p) => p.pz));\n                return comp.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n            });\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(n) {\n            const I = Point.ZERO;\n            if (n === _0n)\n                return I;\n            assertGE(n); // Will throw on 0\n            if (n === _1n)\n                return this;\n            const { endo } = CURVE;\n            if (!endo)\n                return wnaf.unsafeLadder(this, n);\n            // Apply endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            assertGE(scalar);\n            let n = scalar;\n            let point, fake; // Fake point is used to const-time mult\n            const { endo } = CURVE;\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(n);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z)  (x=x/z, y=y/z)\n        toAffine(iz) {\n            const { px: x, py: y, pz: z } = this;\n            const is0 = this.is0();\n            // If invZ was 0, we return zero point. However we still want to execute\n            // all operations, so we replace invZ with a random number, 1.\n            if (iz == null)\n                iz = is0 ? Fp.ONE : Fp.inv(z);\n            const ax = Fp.mul(x, iz);\n            const ay = Fp.mul(y, iz);\n            const zz = Fp.mul(z, iz);\n            if (is0)\n                return { x: Fp.ZERO, y: Fp.ZERO };\n            if (!Fp.eql(zz, Fp.ONE))\n                throw new Error('invZ was invalid');\n            return { x: ax, y: ay };\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = wNAF(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\nexport function weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function isValidFieldElement(num) {\n        return _0n < num && num < Fp.ORDER; // 0 is banned since it's not invertible FE\n    }\n    function modN(a) {\n        return mod.mod(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return mod.invert(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!isValidFieldElement(x))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y = x + ax + b\n                let y = Fp.sqrt(y2); // y = y ^ (p+1)/4\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                throw new Error(`Point of length ${len} was invalid. Expected ${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes`);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = ensureBytes('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = DER.toSig(ensureBytes('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            // can use assertGE here\n            if (!isWithinCurveOrder(this.r))\n                throw new Error('r must be 0 < r < CURVE.n');\n            if (!isWithinCurveOrder(this.s))\n                throw new Error('s must be 0 < s < CURVE.n');\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN(ensureBytes('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size (nBitLength+64)\n         * as per FIPS 186 B.4.1 with modulo bias being neglible.\n         */\n        randomPrivateKey: () => {\n            const rand = CURVE.randomBytes(Fp.BYTES + 8);\n            const num = mod.hashToPrivateScalar(rand, CURVE_ORDER);\n            return ut.numberToBytesBE(num, CURVE.nByteLength);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = item instanceof Uint8Array;\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        if (typeof num !== 'bigint')\n            throw new Error('bigint expected');\n        if (!(_0n <= num && num < ORDER_MASK))\n            throw new Error(`bigint expected < 2^${CURVE.nBitLength}`);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order, this will be wrong at least for P521.\n    // Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = ensureBytes('msgHash', msgHash);\n        if (prehash)\n            msgHash = ensureBytes('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push(ensureBytes('extraEntropy', e, Fp.BYTES)); // check for being of size BYTES\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b  [1,q1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G  k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1G - U2P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = ensureBytes('msgHash', msgHash);\n        publicKey = ensureBytes('publicKey', publicKey);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        const { lowS, prehash } = opts;\n        let _sig = undefined;\n        let P;\n        try {\n            if (typeof sg === 'string' || sg instanceof Uint8Array) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof DER.Err))\n                        throw derError;\n                    _sig = Signature.fromCompact(sg);\n                }\n            }\n            else if (typeof sg === 'object' && typeof sg.r === 'bigint' && typeof sg.s === 'bigint') {\n                const { r, s } = sg;\n                _sig = new Signature(r, s);\n            }\n            else {\n                throw new Error('PARSE');\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            if (error.message === 'PARSE')\n                throw new Error(`signature must be Signature instance, Uint8Array or hex string`);\n            return false;\n        }\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1G + u2P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * From draft-irtf-cfrg-hash-to-curve-16\n */\nexport function mapToCurveSimpleSWU(Fp, opts) {\n    mod.validateField(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","import assert from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assert.hash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assert.exists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.bytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac } from '@noble/hashes/hmac';\nimport { concatBytes, randomBytes } from '@noble/hashes/utils';\nimport { weierstrass } from './abstract/weierstrass.js';\n// connects noble-curves to noble-hashes\nexport function getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => hmac(hash, key, concatBytes(...msgs)),\n        randomBytes,\n    };\n}\nexport function createCurve(curveDef, defHash) {\n    const create = (hash) => weierstrass({ ...curveDef, ...getHash(hash) });\n    return Object.freeze({ ...create(defHash), create });\n}\n//# sourceMappingURL=_shortw_utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256 } from '@noble/hashes/sha256';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { Field, mod, pow2 } from './abstract/modular.js';\nimport { mapToCurveSimpleSWU } from './abstract/weierstrass.js';\nimport { bytesToNumberBE, concatBytes, ensureBytes, numberToBytesBE } from './abstract/utils.js';\nimport { createHasher, isogenyMap } from './abstract/hash-to-curve.js';\nimport { createCurve } from './_shortw_utils.js';\nconst secp256k1P = BigInt('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f');\nconst secp256k1N = BigInt('0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141');\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst divNearest = (a, b) => (a + b / _2n) / b;\n/**\n * n = n^((p+1)/4) for fields p = 3 mod 4. We unwrap the loop and multiply bit-by-bit.\n * (P+1n/4n).toString(2) would produce bits [223x 1, 0, 22x 1, 4x 0, 11, 00]\n */\nfunction sqrtMod(y) {\n    const P = secp256k1P;\n    // prettier-ignore\n    const _3n = BigInt(3), _6n = BigInt(6), _11n = BigInt(11), _22n = BigInt(22);\n    // prettier-ignore\n    const _23n = BigInt(23), _44n = BigInt(44), _88n = BigInt(88);\n    const b2 = (y * y * y) % P; // x^3, 11\n    const b3 = (b2 * b2 * y) % P; // x^7\n    const b6 = (pow2(b3, _3n, P) * b3) % P;\n    const b9 = (pow2(b6, _3n, P) * b3) % P;\n    const b11 = (pow2(b9, _2n, P) * b2) % P;\n    const b22 = (pow2(b11, _11n, P) * b11) % P;\n    const b44 = (pow2(b22, _22n, P) * b22) % P;\n    const b88 = (pow2(b44, _44n, P) * b44) % P;\n    const b176 = (pow2(b88, _88n, P) * b88) % P;\n    const b220 = (pow2(b176, _44n, P) * b44) % P;\n    const b223 = (pow2(b220, _3n, P) * b3) % P;\n    const t1 = (pow2(b223, _23n, P) * b22) % P;\n    const t2 = (pow2(t1, _6n, P) * b2) % P;\n    const root = pow2(t2, _2n, P);\n    if (!Fp.eql(Fp.sqr(root), y))\n        throw new Error('Cannot find square root');\n    return root;\n}\nconst Fp = Field(secp256k1P, undefined, undefined, { sqrt: sqrtMod });\nexport const secp256k1 = createCurve({\n    a: BigInt(0),\n    b: BigInt(7),\n    Fp,\n    n: secp256k1N,\n    // Base point (x, y) aka generator point\n    Gx: BigInt('55066263022277343669578718895168534326250603453777594175500187360389116729240'),\n    Gy: BigInt('32670510020758816978083085130507043184471273380659243275938904335757337482424'),\n    h: BigInt(1),\n    lowS: true,\n    /**\n     * secp256k1 belongs to Koblitz curves: it has efficiently computable endomorphism.\n     * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n     * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n     * Explanation: https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066\n     */\n    endo: {\n        beta: BigInt('0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee'),\n        splitScalar: (k) => {\n            const n = secp256k1N;\n            const a1 = BigInt('0x3086d221a7d46bcde86c90e49284eb15');\n            const b1 = -_1n * BigInt('0xe4437ed6010e88286f547fa90abfe4c3');\n            const a2 = BigInt('0x114ca50f7a8e2f3f657c1108d9d44cfd8');\n            const b2 = a1;\n            const POW_2_128 = BigInt('0x100000000000000000000000000000000'); // (2n**128n).toString(16)\n            const c1 = divNearest(b2 * k, n);\n            const c2 = divNearest(-b1 * k, n);\n            let k1 = mod(k - c1 * a1 - c2 * a2, n);\n            let k2 = mod(-c1 * b1 - c2 * b2, n);\n            const k1neg = k1 > POW_2_128;\n            const k2neg = k2 > POW_2_128;\n            if (k1neg)\n                k1 = n - k1;\n            if (k2neg)\n                k2 = n - k2;\n            if (k1 > POW_2_128 || k2 > POW_2_128) {\n                throw new Error('splitScalar: Endomorphism failed, k=' + k);\n            }\n            return { k1neg, k1, k2neg, k2 };\n        },\n    },\n}, sha256);\n// Schnorr signatures are superior to ECDSA from above. Below is Schnorr-specific BIP0340 code.\n// https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki\nconst _0n = BigInt(0);\nconst fe = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1P;\nconst ge = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1N;\n/** An object mapping tags to their tagged hash prefix of [SHA256(tag) | SHA256(tag)] */\nconst TAGGED_HASH_PREFIXES = {};\nfunction taggedHash(tag, ...messages) {\n    let tagP = TAGGED_HASH_PREFIXES[tag];\n    if (tagP === undefined) {\n        const tagH = sha256(Uint8Array.from(tag, (c) => c.charCodeAt(0)));\n        tagP = concatBytes(tagH, tagH);\n        TAGGED_HASH_PREFIXES[tag] = tagP;\n    }\n    return sha256(concatBytes(tagP, ...messages));\n}\n// ECDSA compact points are 33-byte. Schnorr is 32: we strip first byte 0x02 or 0x03\nconst pointToBytes = (point) => point.toRawBytes(true).slice(1);\nconst numTo32b = (n) => numberToBytesBE(n, 32);\nconst modP = (x) => mod(x, secp256k1P);\nconst modN = (x) => mod(x, secp256k1N);\nconst Point = secp256k1.ProjectivePoint;\nconst GmulAdd = (Q, a, b) => Point.BASE.multiplyAndAddUnsafe(Q, a, b);\n// Calculate point, scalar and bytes\nfunction schnorrGetExtPubKey(priv) {\n    let d_ = secp256k1.utils.normPrivateKeyToScalar(priv); // same method executed in fromPrivateKey\n    let p = Point.fromPrivateKey(d_); // P = d'G; 0 < d' < n check is done inside\n    const scalar = p.hasEvenY() ? d_ : modN(-d_);\n    return { scalar: scalar, bytes: pointToBytes(p) };\n}\n/**\n * lift_x from BIP340. Convert 32-byte x coordinate to elliptic curve point.\n * @returns valid point checked for being on-curve\n */\nfunction lift_x(x) {\n    if (!fe(x))\n        throw new Error('bad x: need 0 < x < p'); // Fail if x  p.\n    const xx = modP(x * x);\n    const c = modP(xx * x + BigInt(7)); // Let c = x + 7 mod p.\n    let y = sqrtMod(c); // Let y = c^(p+1)/4 mod p.\n    if (y % _2n !== _0n)\n        y = modP(-y); // Return the unique point P such that x(P) = x and\n    const p = new Point(x, y, _1n); // y(P) = y if y mod 2 = 0 or y(P) = p-y otherwise.\n    p.assertValidity();\n    return p;\n}\n/**\n * Create tagged hash, convert it to bigint, reduce modulo-n.\n */\nfunction challenge(...args) {\n    return modN(bytesToNumberBE(taggedHash('BIP0340/challenge', ...args)));\n}\n/**\n * Schnorr public key is just `x` coordinate of Point as per BIP340.\n */\nfunction schnorrGetPublicKey(privateKey) {\n    return schnorrGetExtPubKey(privateKey).bytes; // d'=int(sk). Fail if d'=0 or d'n. Ret bytes(d'G)\n}\n/**\n * Creates Schnorr signature as per BIP340. Verifies itself before returning anything.\n * auxRand is optional and is not the sole source of k generation: bad CSPRNG won't be dangerous.\n */\nfunction schnorrSign(message, privateKey, auxRand = randomBytes(32)) {\n    const m = ensureBytes('message', message);\n    const { bytes: px, scalar: d } = schnorrGetExtPubKey(privateKey); // checks for isWithinCurveOrder\n    const a = ensureBytes('auxRand', auxRand, 32); // Auxiliary random data a: a 32-byte array\n    const t = numTo32b(d ^ bytesToNumberBE(taggedHash('BIP0340/aux', a))); // Let t be the byte-wise xor of bytes(d) and hash/aux(a)\n    const rand = taggedHash('BIP0340/nonce', t, px, m); // Let rand = hash/nonce(t || bytes(P) || m)\n    const k_ = modN(bytesToNumberBE(rand)); // Let k' = int(rand) mod n\n    if (k_ === _0n)\n        throw new Error('sign failed: k is zero'); // Fail if k' = 0.\n    const { bytes: rx, scalar: k } = schnorrGetExtPubKey(k_); // Let R = k'G.\n    const e = challenge(rx, px, m); // Let e = int(hash/challenge(bytes(R) || bytes(P) || m)) mod n.\n    const sig = new Uint8Array(64); // Let sig = bytes(R) || bytes((k + ed) mod n).\n    sig.set(rx, 0);\n    sig.set(numTo32b(modN(k + e * d)), 32);\n    // If Verify(bytes(P), m, sig) (see below) returns failure, abort\n    if (!schnorrVerify(sig, m, px))\n        throw new Error('sign: Invalid signature produced');\n    return sig;\n}\n/**\n * Verifies Schnorr signature.\n * Will swallow errors & return false except for initial type validation of arguments.\n */\nfunction schnorrVerify(signature, message, publicKey) {\n    const sig = ensureBytes('signature', signature, 64);\n    const m = ensureBytes('message', message);\n    const pub = ensureBytes('publicKey', publicKey, 32);\n    try {\n        const P = lift_x(bytesToNumberBE(pub)); // P = lift_x(int(pk)); fail if that fails\n        const r = bytesToNumberBE(sig.subarray(0, 32)); // Let r = int(sig[0:32]); fail if r  p.\n        if (!fe(r))\n            return false;\n        const s = bytesToNumberBE(sig.subarray(32, 64)); // Let s = int(sig[32:64]); fail if s  n.\n        if (!ge(s))\n            return false;\n        const e = challenge(numTo32b(r), pointToBytes(P), m); // int(challenge(bytes(r)||bytes(P)||m))%n\n        const R = GmulAdd(P, s, modN(-e)); // R = sG - eP\n        if (!R || !R.hasEvenY() || R.toAffine().x !== r)\n            return false; // -eP == (n-e)P\n        return true; // Fail if is_infinite(R) / not has_even_y(R) / x(R)  r.\n    }\n    catch (error) {\n        return false;\n    }\n}\nexport const schnorr = /* @__PURE__ */ (() => ({\n    getPublicKey: schnorrGetPublicKey,\n    sign: schnorrSign,\n    verify: schnorrVerify,\n    utils: {\n        randomPrivateKey: secp256k1.utils.randomPrivateKey,\n        lift_x,\n        pointToBytes,\n        numberToBytesBE,\n        bytesToNumberBE,\n        taggedHash,\n        mod,\n    },\n}))();\nconst isoMap = /* @__PURE__ */ (() => isogenyMap(Fp, [\n    // xNum\n    [\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7',\n        '0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581',\n        '0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262',\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c',\n    ],\n    // xDen\n    [\n        '0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b',\n        '0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n    // yNum\n    [\n        '0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c',\n        '0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3',\n        '0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931',\n        '0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84',\n    ],\n    // yDen\n    [\n        '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b',\n        '0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573',\n        '0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n].map((i) => i.map((j) => BigInt(j)))))();\nconst mapSWU = /* @__PURE__ */ (() => mapToCurveSimpleSWU(Fp, {\n    A: BigInt('0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533'),\n    B: BigInt('1771'),\n    Z: Fp.create(BigInt('-11')),\n}))();\nconst htf = /* @__PURE__ */ (() => createHasher(secp256k1.ProjectivePoint, (scalars) => {\n    const { x, y } = mapSWU(Fp.create(scalars[0]));\n    return isoMap(x, y);\n}, {\n    DST: 'secp256k1_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'secp256k1_XMD:SHA-256_SSWU_NU_',\n    p: Fp.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256,\n}))();\nexport const hashToCurve = /* @__PURE__ */ (() => htf.hashToCurve)();\nexport const encodeToCurve = /* @__PURE__ */ (() => htf.encodeToCurve)();\n//# sourceMappingURL=secp256k1.js.map","import { hmac } from '@noble/hashes/hmac';\nimport { ripemd160 } from '@noble/hashes/ripemd160';\nimport { sha256 } from '@noble/hashes/sha256';\nimport { sha512 } from '@noble/hashes/sha512';\nimport { bytes as assertBytes } from '@noble/hashes/_assert';\nimport { bytesToHex, concatBytes, createView, hexToBytes, utf8ToBytes } from '@noble/hashes/utils';\nimport { secp256k1 as secp } from '@noble/curves/secp256k1';\nimport { mod } from '@noble/curves/abstract/modular';\nimport { base58check as base58checker } from '@scure/base';\nconst Point = secp.ProjectivePoint;\nconst base58check = base58checker(sha256);\nfunction bytesToNumber(bytes) {\n    return BigInt(`0x${bytesToHex(bytes)}`);\n}\nfunction numberToBytes(num) {\n    return hexToBytes(num.toString(16).padStart(64, '0'));\n}\nconst MASTER_SECRET = utf8ToBytes('Bitcoin seed');\nconst BITCOIN_VERSIONS = { private: 0x0488ade4, public: 0x0488b21e };\nexport const HARDENED_OFFSET = 0x80000000;\nconst hash160 = (data) => ripemd160(sha256(data));\nconst fromU32 = (data) => createView(data).getUint32(0, false);\nconst toU32 = (n) => {\n    if (!Number.isSafeInteger(n) || n < 0 || n > 2 ** 32 - 1) {\n        throw new Error(`Invalid number=${n}. Should be from 0 to 2 ** 32 - 1`);\n    }\n    const buf = new Uint8Array(4);\n    createView(buf).setUint32(0, n, false);\n    return buf;\n};\nexport class HDKey {\n    get fingerprint() {\n        if (!this.pubHash) {\n            throw new Error('No publicKey set!');\n        }\n        return fromU32(this.pubHash);\n    }\n    get identifier() {\n        return this.pubHash;\n    }\n    get pubKeyHash() {\n        return this.pubHash;\n    }\n    get privateKey() {\n        return this.privKeyBytes || null;\n    }\n    get publicKey() {\n        return this.pubKey || null;\n    }\n    get privateExtendedKey() {\n        const priv = this.privateKey;\n        if (!priv) {\n            throw new Error('No private key');\n        }\n        return base58check.encode(this.serialize(this.versions.private, concatBytes(new Uint8Array([0]), priv)));\n    }\n    get publicExtendedKey() {\n        if (!this.pubKey) {\n            throw new Error('No public key');\n        }\n        return base58check.encode(this.serialize(this.versions.public, this.pubKey));\n    }\n    static fromMasterSeed(seed, versions = BITCOIN_VERSIONS) {\n        assertBytes(seed);\n        if (8 * seed.length < 128 || 8 * seed.length > 512) {\n            throw new Error(`HDKey: wrong seed length=${seed.length}. Should be between 128 and 512 bits; 256 bits is advised)`);\n        }\n        const I = hmac(sha512, MASTER_SECRET, seed);\n        return new HDKey({\n            versions,\n            chainCode: I.slice(32),\n            privateKey: I.slice(0, 32),\n        });\n    }\n    static fromExtendedKey(base58key, versions = BITCOIN_VERSIONS) {\n        const keyBuffer = base58check.decode(base58key);\n        const keyView = createView(keyBuffer);\n        const version = keyView.getUint32(0, false);\n        const opt = {\n            versions,\n            depth: keyBuffer[4],\n            parentFingerprint: keyView.getUint32(5, false),\n            index: keyView.getUint32(9, false),\n            chainCode: keyBuffer.slice(13, 45),\n        };\n        const key = keyBuffer.slice(45);\n        const isPriv = key[0] === 0;\n        if (version !== versions[isPriv ? 'private' : 'public']) {\n            throw new Error('Version mismatch');\n        }\n        if (isPriv) {\n            return new HDKey({ ...opt, privateKey: key.slice(1) });\n        }\n        else {\n            return new HDKey({ ...opt, publicKey: key });\n        }\n    }\n    static fromJSON(json) {\n        return HDKey.fromExtendedKey(json.xpriv);\n    }\n    constructor(opt) {\n        this.depth = 0;\n        this.index = 0;\n        this.chainCode = null;\n        this.parentFingerprint = 0;\n        if (!opt || typeof opt !== 'object') {\n            throw new Error('HDKey.constructor must not be called directly');\n        }\n        this.versions = opt.versions || BITCOIN_VERSIONS;\n        this.depth = opt.depth || 0;\n        this.chainCode = opt.chainCode;\n        this.index = opt.index || 0;\n        this.parentFingerprint = opt.parentFingerprint || 0;\n        if (!this.depth) {\n            if (this.parentFingerprint || this.index) {\n                throw new Error('HDKey: zero depth with non-zero index/parent fingerprint');\n            }\n        }\n        if (opt.publicKey && opt.privateKey) {\n            throw new Error('HDKey: publicKey and privateKey at same time.');\n        }\n        if (opt.privateKey) {\n            if (!secp.utils.isValidPrivateKey(opt.privateKey)) {\n                throw new Error('Invalid private key');\n            }\n            this.privKey =\n                typeof opt.privateKey === 'bigint' ? opt.privateKey : bytesToNumber(opt.privateKey);\n            this.privKeyBytes = numberToBytes(this.privKey);\n            this.pubKey = secp.getPublicKey(opt.privateKey, true);\n        }\n        else if (opt.publicKey) {\n            this.pubKey = Point.fromHex(opt.publicKey).toRawBytes(true);\n        }\n        else {\n            throw new Error('HDKey: no public or private key provided');\n        }\n        this.pubHash = hash160(this.pubKey);\n    }\n    derive(path) {\n        if (!/^[mM]'?/.test(path)) {\n            throw new Error('Path must start with \"m\" or \"M\"');\n        }\n        if (/^[mM]'?$/.test(path)) {\n            return this;\n        }\n        const parts = path.replace(/^[mM]'?\\//, '').split('/');\n        let child = this;\n        for (const c of parts) {\n            const m = /^(\\d+)('?)$/.exec(c);\n            if (!m || m.length !== 3) {\n                throw new Error(`Invalid child index: ${c}`);\n            }\n            let idx = +m[1];\n            if (!Number.isSafeInteger(idx) || idx >= HARDENED_OFFSET) {\n                throw new Error('Invalid index');\n            }\n            if (m[2] === \"'\") {\n                idx += HARDENED_OFFSET;\n            }\n            child = child.deriveChild(idx);\n        }\n        return child;\n    }\n    deriveChild(index) {\n        if (!this.pubKey || !this.chainCode) {\n            throw new Error('No publicKey or chainCode set');\n        }\n        let data = toU32(index);\n        if (index >= HARDENED_OFFSET) {\n            const priv = this.privateKey;\n            if (!priv) {\n                throw new Error('Could not derive hardened child key');\n            }\n            data = concatBytes(new Uint8Array([0]), priv, data);\n        }\n        else {\n            data = concatBytes(this.pubKey, data);\n        }\n        const I = hmac(sha512, this.chainCode, data);\n        const childTweak = bytesToNumber(I.slice(0, 32));\n        const chainCode = I.slice(32);\n        if (!secp.utils.isValidPrivateKey(childTweak)) {\n            throw new Error('Tweak bigger than curve order');\n        }\n        const opt = {\n            versions: this.versions,\n            chainCode,\n            depth: this.depth + 1,\n            parentFingerprint: this.fingerprint,\n            index,\n        };\n        try {\n            if (this.privateKey) {\n                const added = mod(this.privKey + childTweak, secp.CURVE.n);\n                if (!secp.utils.isValidPrivateKey(added)) {\n                    throw new Error('The tweak was out of range or the resulted private key is invalid');\n                }\n                opt.privateKey = added;\n            }\n            else {\n                const added = Point.fromHex(this.pubKey).add(Point.fromPrivateKey(childTweak));\n                if (added.equals(Point.ZERO)) {\n                    throw new Error('The tweak was equal to negative P, which made the result key invalid');\n                }\n                opt.publicKey = added.toRawBytes(true);\n            }\n            return new HDKey(opt);\n        }\n        catch (err) {\n            return this.deriveChild(index + 1);\n        }\n    }\n    sign(hash) {\n        if (!this.privateKey) {\n            throw new Error('No privateKey set!');\n        }\n        assertBytes(hash, 32);\n        return secp.sign(hash, this.privKey).toCompactRawBytes();\n    }\n    verify(hash, signature) {\n        assertBytes(hash, 32);\n        assertBytes(signature, 64);\n        if (!this.publicKey) {\n            throw new Error('No publicKey set!');\n        }\n        let sig;\n        try {\n            sig = secp.Signature.fromCompact(signature);\n        }\n        catch (error) {\n            return false;\n        }\n        return secp.verify(sig, hash, this.publicKey);\n    }\n    wipePrivateData() {\n        this.privKey = undefined;\n        if (this.privKeyBytes) {\n            this.privKeyBytes.fill(0);\n            this.privKeyBytes = undefined;\n        }\n        return this;\n    }\n    toJSON() {\n        return {\n            xpriv: this.privateExtendedKey,\n            xpub: this.publicExtendedKey,\n        };\n    }\n    serialize(version, key) {\n        if (!this.chainCode) {\n            throw new Error('No chainCode set');\n        }\n        assertBytes(key, 33);\n        return concatBytes(toU32(version), new Uint8Array([this.depth]), toU32(this.parentFingerprint), toU32(this.index), this.chainCode, key);\n    }\n}\n//# sourceMappingURL=index.js.map","/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u16 = (arr) => new Uint16Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 2));\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// big-endian hardware is rare. Just in case someone still decides to run ciphers:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\nexport function bytesToUtf8(bytes) {\n    return new TextDecoder().decode(bytes);\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// Check if object doens't have custom constructor (like Uint8Array/Array)\nconst isPlainObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]' && obj.constructor === Object;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && (typeof opts !== 'object' || !isPlainObject(opts)))\n        throw new Error('options must be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function ensureBytes(b, len) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Uint8Array expected');\n    if (typeof len === 'number')\n        if (b.length !== len)\n            throw new Error(`Uint8Array length ${len} expected`);\n}\n// Constant-time equality\nexport function equalBytes(a, b) {\n    // Should not happen\n    if (a.length !== b.length)\n        throw new Error('equalBytes: Different size of Uint8Arrays');\n    let isSame = true;\n    for (let i = 0; i < a.length; i++)\n        isSame && (isSame = a[i] === b[i]); // Lets hope JIT won't optimize away.\n    return isSame;\n}\n// For runtime check if class implements interface\nexport class Hash {\n}\n// Polyfill for Safari 14\nexport function setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n//# sourceMappingURL=utils.js.map","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nfunction bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('hash must be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","import { toBytes, ensureBytes } from './utils.js';\nimport assert from './_assert.js';\n// Poly1305 is a fast and parallel secret-key message-authentication code.\n// https://cr.yp.to/mac.html, https://cr.yp.to/mac/poly1305-20050329.pdf\n// https://datatracker.ietf.org/doc/html/rfc8439\n// Based on Public Domain poly1305-donna https://github.com/floodyberry/poly1305-donna\nconst u8to16 = (a, i) => (a[i++] & 0xff) | ((a[i++] & 0xff) << 8);\nclass Poly1305 {\n    constructor(key) {\n        this.blockLen = 16;\n        this.outputLen = 16;\n        this.buffer = new Uint8Array(16);\n        this.r = new Uint16Array(10);\n        this.h = new Uint16Array(10);\n        this.pad = new Uint16Array(8);\n        this.pos = 0;\n        this.finished = false;\n        key = toBytes(key);\n        ensureBytes(key, 32);\n        const t0 = u8to16(key, 0);\n        const t1 = u8to16(key, 2);\n        const t2 = u8to16(key, 4);\n        const t3 = u8to16(key, 6);\n        const t4 = u8to16(key, 8);\n        const t5 = u8to16(key, 10);\n        const t6 = u8to16(key, 12);\n        const t7 = u8to16(key, 14);\n        // https://github.com/floodyberry/poly1305-donna/blob/e6ad6e091d30d7f4ec2d4f978be1fcfcbce72781/poly1305-donna-16.h#L47\n        this.r[0] = t0 & 0x1fff;\n        this.r[1] = ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n        this.r[2] = ((t1 >>> 10) | (t2 << 6)) & 0x1f03;\n        this.r[3] = ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n        this.r[4] = ((t3 >>> 4) | (t4 << 12)) & 0x00ff;\n        this.r[5] = (t4 >>> 1) & 0x1ffe;\n        this.r[6] = ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n        this.r[7] = ((t5 >>> 11) | (t6 << 5)) & 0x1f81;\n        this.r[8] = ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n        this.r[9] = (t7 >>> 5) & 0x007f;\n        for (let i = 0; i < 8; i++)\n            this.pad[i] = u8to16(key, 16 + 2 * i);\n    }\n    process(data, offset, isLast = false) {\n        const hibit = isLast ? 0 : 1 << 11;\n        const { h, r } = this;\n        const r0 = r[0];\n        const r1 = r[1];\n        const r2 = r[2];\n        const r3 = r[3];\n        const r4 = r[4];\n        const r5 = r[5];\n        const r6 = r[6];\n        const r7 = r[7];\n        const r8 = r[8];\n        const r9 = r[9];\n        const t0 = u8to16(data, offset + 0);\n        const t1 = u8to16(data, offset + 2);\n        const t2 = u8to16(data, offset + 4);\n        const t3 = u8to16(data, offset + 6);\n        const t4 = u8to16(data, offset + 8);\n        const t5 = u8to16(data, offset + 10);\n        const t6 = u8to16(data, offset + 12);\n        const t7 = u8to16(data, offset + 14);\n        let h0 = h[0] + (t0 & 0x1fff);\n        let h1 = h[1] + (((t0 >>> 13) | (t1 << 3)) & 0x1fff);\n        let h2 = h[2] + (((t1 >>> 10) | (t2 << 6)) & 0x1fff);\n        let h3 = h[3] + (((t2 >>> 7) | (t3 << 9)) & 0x1fff);\n        let h4 = h[4] + (((t3 >>> 4) | (t4 << 12)) & 0x1fff);\n        let h5 = h[5] + ((t4 >>> 1) & 0x1fff);\n        let h6 = h[6] + (((t4 >>> 14) | (t5 << 2)) & 0x1fff);\n        let h7 = h[7] + (((t5 >>> 11) | (t6 << 5)) & 0x1fff);\n        let h8 = h[8] + (((t6 >>> 8) | (t7 << 8)) & 0x1fff);\n        let h9 = h[9] + ((t7 >>> 5) | hibit);\n        let c = 0;\n        let d0 = c + h0 * r0 + h1 * (5 * r9) + h2 * (5 * r8) + h3 * (5 * r7) + h4 * (5 * r6);\n        c = d0 >>> 13;\n        d0 &= 0x1fff;\n        d0 += h5 * (5 * r5) + h6 * (5 * r4) + h7 * (5 * r3) + h8 * (5 * r2) + h9 * (5 * r1);\n        c += d0 >>> 13;\n        d0 &= 0x1fff;\n        let d1 = c + h0 * r1 + h1 * r0 + h2 * (5 * r9) + h3 * (5 * r8) + h4 * (5 * r7);\n        c = d1 >>> 13;\n        d1 &= 0x1fff;\n        d1 += h5 * (5 * r6) + h6 * (5 * r5) + h7 * (5 * r4) + h8 * (5 * r3) + h9 * (5 * r2);\n        c += d1 >>> 13;\n        d1 &= 0x1fff;\n        let d2 = c + h0 * r2 + h1 * r1 + h2 * r0 + h3 * (5 * r9) + h4 * (5 * r8);\n        c = d2 >>> 13;\n        d2 &= 0x1fff;\n        d2 += h5 * (5 * r7) + h6 * (5 * r6) + h7 * (5 * r5) + h8 * (5 * r4) + h9 * (5 * r3);\n        c += d2 >>> 13;\n        d2 &= 0x1fff;\n        let d3 = c + h0 * r3 + h1 * r2 + h2 * r1 + h3 * r0 + h4 * (5 * r9);\n        c = d3 >>> 13;\n        d3 &= 0x1fff;\n        d3 += h5 * (5 * r8) + h6 * (5 * r7) + h7 * (5 * r6) + h8 * (5 * r5) + h9 * (5 * r4);\n        c += d3 >>> 13;\n        d3 &= 0x1fff;\n        let d4 = c + h0 * r4 + h1 * r3 + h2 * r2 + h3 * r1 + h4 * r0;\n        c = d4 >>> 13;\n        d4 &= 0x1fff;\n        d4 += h5 * (5 * r9) + h6 * (5 * r8) + h7 * (5 * r7) + h8 * (5 * r6) + h9 * (5 * r5);\n        c += d4 >>> 13;\n        d4 &= 0x1fff;\n        let d5 = c + h0 * r5 + h1 * r4 + h2 * r3 + h3 * r2 + h4 * r1;\n        c = d5 >>> 13;\n        d5 &= 0x1fff;\n        d5 += h5 * r0 + h6 * (5 * r9) + h7 * (5 * r8) + h8 * (5 * r7) + h9 * (5 * r6);\n        c += d5 >>> 13;\n        d5 &= 0x1fff;\n        let d6 = c + h0 * r6 + h1 * r5 + h2 * r4 + h3 * r3 + h4 * r2;\n        c = d6 >>> 13;\n        d6 &= 0x1fff;\n        d6 += h5 * r1 + h6 * r0 + h7 * (5 * r9) + h8 * (5 * r8) + h9 * (5 * r7);\n        c += d6 >>> 13;\n        d6 &= 0x1fff;\n        let d7 = c + h0 * r7 + h1 * r6 + h2 * r5 + h3 * r4 + h4 * r3;\n        c = d7 >>> 13;\n        d7 &= 0x1fff;\n        d7 += h5 * r2 + h6 * r1 + h7 * r0 + h8 * (5 * r9) + h9 * (5 * r8);\n        c += d7 >>> 13;\n        d7 &= 0x1fff;\n        let d8 = c + h0 * r8 + h1 * r7 + h2 * r6 + h3 * r5 + h4 * r4;\n        c = d8 >>> 13;\n        d8 &= 0x1fff;\n        d8 += h5 * r3 + h6 * r2 + h7 * r1 + h8 * r0 + h9 * (5 * r9);\n        c += d8 >>> 13;\n        d8 &= 0x1fff;\n        let d9 = c + h0 * r9 + h1 * r8 + h2 * r7 + h3 * r6 + h4 * r5;\n        c = d9 >>> 13;\n        d9 &= 0x1fff;\n        d9 += h5 * r4 + h6 * r3 + h7 * r2 + h8 * r1 + h9 * r0;\n        c += d9 >>> 13;\n        d9 &= 0x1fff;\n        c = ((c << 2) + c) | 0;\n        c = (c + d0) | 0;\n        d0 = c & 0x1fff;\n        c = c >>> 13;\n        d1 += c;\n        h[0] = d0;\n        h[1] = d1;\n        h[2] = d2;\n        h[3] = d3;\n        h[4] = d4;\n        h[5] = d5;\n        h[6] = d6;\n        h[7] = d7;\n        h[8] = d8;\n        h[9] = d9;\n    }\n    finalize() {\n        const { h, pad } = this;\n        const g = new Uint16Array(10);\n        let c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        for (let i = 2; i < 10; i++) {\n            h[i] += c;\n            c = h[i] >>> 13;\n            h[i] &= 0x1fff;\n        }\n        h[0] += c * 5;\n        c = h[0] >>> 13;\n        h[0] &= 0x1fff;\n        h[1] += c;\n        c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        h[2] += c;\n        g[0] = h[0] + 5;\n        c = g[0] >>> 13;\n        g[0] &= 0x1fff;\n        for (let i = 1; i < 10; i++) {\n            g[i] = h[i] + c;\n            c = g[i] >>> 13;\n            g[i] &= 0x1fff;\n        }\n        g[9] -= 1 << 13;\n        let mask = (c ^ 1) - 1;\n        for (let i = 0; i < 10; i++)\n            g[i] &= mask;\n        mask = ~mask;\n        for (let i = 0; i < 10; i++)\n            h[i] = (h[i] & mask) | g[i];\n        h[0] = (h[0] | (h[1] << 13)) & 0xffff;\n        h[1] = ((h[1] >>> 3) | (h[2] << 10)) & 0xffff;\n        h[2] = ((h[2] >>> 6) | (h[3] << 7)) & 0xffff;\n        h[3] = ((h[3] >>> 9) | (h[4] << 4)) & 0xffff;\n        h[4] = ((h[4] >>> 12) | (h[5] << 1) | (h[6] << 14)) & 0xffff;\n        h[5] = ((h[6] >>> 2) | (h[7] << 11)) & 0xffff;\n        h[6] = ((h[7] >>> 5) | (h[8] << 8)) & 0xffff;\n        h[7] = ((h[8] >>> 8) | (h[9] << 5)) & 0xffff;\n        let f = h[0] + pad[0];\n        h[0] = f & 0xffff;\n        for (let i = 1; i < 8; i++) {\n            f = (((h[i] + pad[i]) | 0) + (f >>> 16)) | 0;\n            h[i] = f & 0xffff;\n        }\n    }\n    update(data) {\n        assert.exists(this);\n        const { buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input\n            if (take === blockLen) {\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(data, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(buffer, 0, false);\n                this.pos = 0;\n            }\n        }\n        return this;\n    }\n    destroy() {\n        this.h.fill(0);\n        this.r.fill(0);\n        this.buffer.fill(0);\n        this.pad.fill(0);\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.output(out, this);\n        this.finished = true;\n        const { buffer, h } = this;\n        let { pos } = this;\n        if (pos) {\n            buffer[pos++] = 1;\n            // buffer.subarray(pos).fill(0);\n            for (; pos < 16; pos++)\n                buffer[pos] = 0;\n            this.process(buffer, 0, true);\n        }\n        this.finalize();\n        let opos = 0;\n        for (let i = 0; i < 8; i++) {\n            out[opos++] = h[i] >>> 0;\n            out[opos++] = h[i] >>> 8;\n        }\n        return out;\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n}\nexport function wrapConstructorWithKey(hashCons) {\n    const hashC = (msg, key) => hashCons(key).update(toBytes(msg)).digest();\n    const tmp = hashCons(new Uint8Array(32));\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (key) => hashCons(key);\n    return hashC;\n}\nexport const poly1305 = wrapConstructorWithKey((key) => new Poly1305(key));\n//# sourceMappingURL=_poly1305.js.map","// Basic utils for salsa-like ciphers\n// Check out _micro.ts for descriptive documentation.\nimport assert from './_assert.js';\nimport { u32, utf8ToBytes, checkOpts } from './utils.js';\n/*\nRFC8439 requires multi-step cipher stream, where\nauthKey starts with counter: 0, actual msg with counter: 1.\n\nFor this, we need a way to re-use nonce / counter:\n\n    const counter = new Uint8Array(4);\n    chacha(..., counter, ...); // counter is now 1\n    chacha(..., counter, ...); // counter is now 2\n\nThis is complicated:\n\n- Original papers don't allow mutating counters\n- Counter overflow is undefined: https://mailarchive.ietf.org/arch/msg/cfrg/gsOnTJzcbgG6OqD8Sc0GO5aR_tU/\n- 3rd-party library stablelib implementation uses an approach where you can provide\n  nonce and counter instead of just nonce - and it will re-use it\n- We could have did something similar, but ChaCha has different counter position\n  (counter | nonce), which is not composable with XChaCha, because full counter\n  is (nonce16 | counter | nonce16). Stablelib doesn't support in-place counter for XChaCha.\n- We could separate nonce & counter and provide separate API for counter re-use, but\n  there are different counter sizes depending on an algorithm.\n- Salsa & ChaCha also differ in structures of key / sigma:\n\n    salsa:     c0 | k(4) | c1 | nonce(2) | ctr(2) | c2 | k(4) | c4\n    chacha:    c(4) | k(8) | ctr(1) | nonce(3)\n    chachaDJB: c(4) | k(8) | ctr(2) | nonce(2)\n- Creating function such as `setSalsaState(key, nonce, sigma, data)` won't work,\n  because we can't re-use counter array\n- 32-bit nonce is `2 ** 32 * 64` = 256GB with 32-bit counter\n- JS does not allow UintArrays bigger than 4GB, so supporting 64-bit counters doesn't matter\n\nStructure is as following:\n\nkey=16 -> sigma16, k=key|key\nkey=32 -> sigma32, k=key\n\nnonces:\nsalsa20:      8   (8-byte counter)\nchacha20djb:  8   (8-byte counter)\nchacha20tls:  12  (4-byte counter)\nxsalsa:       24  (16 -> hsalsa, 8 -> old nonce)\nxchacha:      24  (16 -> hchacha, 8 -> old nonce)\n\nhttps://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha#appendix-A.2\nUse the subkey and remaining 8 byte nonce with ChaCha20 as normal\n(prefixed by 4 NUL bytes, since [RFC8439] specifies a 12-byte nonce).\n*/\nconst sigma16 = utf8ToBytes('expand 16-byte k');\nconst sigma32 = utf8ToBytes('expand 32-byte k');\nconst sigma16_32 = u32(sigma16);\nconst sigma32_32 = u32(sigma32);\n// Is byte array aligned to 4 byte offset (u32)?\nconst isAligned32 = (b) => !(b.byteOffset % 4);\nexport const salsaBasic = (opts) => {\n    const { core, rounds, counterRight, counterLen, allow128bitKeys, extendNonceFn, blockLen } = checkOpts({ rounds: 20, counterRight: false, counterLen: 8, allow128bitKeys: true, blockLen: 64 }, opts);\n    assert.number(counterLen);\n    assert.number(rounds);\n    assert.number(blockLen);\n    assert.bool(counterRight);\n    assert.bool(allow128bitKeys);\n    const blockLen32 = blockLen / 4;\n    if (blockLen % 4 !== 0)\n        throw new Error('Salsa/ChaCha: blockLen must be aligned to 4 bytes');\n    return (key, nonce, data, output, counter = 0) => {\n        assert.bytes(key);\n        assert.bytes(nonce);\n        assert.bytes(data);\n        if (!output)\n            output = new Uint8Array(data.length);\n        assert.bytes(output);\n        assert.number(counter);\n        // > new Uint32Array([2**32])\n        // Uint32Array(1) [ 0 ]\n        // > new Uint32Array([2**32-1])\n        // Uint32Array(1) [ 4294967295 ]\n        if (counter < 0 || counter >= 2 ** 32 - 1)\n            throw new Error('Salsa/ChaCha: counter overflow');\n        if (output.length < data.length) {\n            throw new Error(`Salsa/ChaCha: output (${output.length}) is shorter than data (${data.length})`);\n        }\n        const toClean = [];\n        let k, sigma;\n        // Handle 128 byte keys\n        if (key.length === 32) {\n            k = key;\n            sigma = sigma32_32;\n        }\n        else if (key.length === 16 && allow128bitKeys) {\n            k = new Uint8Array(32);\n            k.set(key);\n            k.set(key, 16);\n            sigma = sigma16_32;\n            toClean.push(k);\n        }\n        else\n            throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${key.length}`);\n        // Handle extended nonce (HChaCha/HSalsa)\n        if (extendNonceFn) {\n            if (nonce.length <= 16)\n                throw new Error(`Salsa/ChaCha: extended nonce must be bigger than 16 bytes`);\n            k = extendNonceFn(sigma, k, nonce.subarray(0, 16), new Uint8Array(32));\n            toClean.push(k);\n            nonce = nonce.subarray(16);\n        }\n        // Handle nonce counter\n        const nonceLen = 16 - counterLen;\n        if (nonce.length !== nonceLen)\n            throw new Error(`Salsa/ChaCha: nonce must be ${nonceLen} or 16 bytes`);\n        // Pad counter when nonce is 64 bit\n        if (nonceLen !== 12) {\n            const nc = new Uint8Array(12);\n            nc.set(nonce, counterRight ? 0 : 12 - nonce.length);\n            toClean.push((nonce = nc));\n        }\n        // Counter positions\n        const block = new Uint8Array(blockLen);\n        // Cast to Uint32Array for speed\n        const b32 = u32(block);\n        const k32 = u32(k);\n        const n32 = u32(nonce);\n        // Make sure that buffers aligned to 4 bytes\n        const d32 = isAligned32(data) && u32(data);\n        const o32 = isAligned32(output) && u32(output);\n        toClean.push(b32);\n        const len = data.length;\n        for (let pos = 0, ctr = counter; pos < len; ctr++) {\n            core(sigma, k32, n32, b32, ctr, rounds);\n            if (ctr >= 2 ** 32 - 1)\n                throw new Error('Salsa/ChaCha: counter overflow');\n            const take = Math.min(blockLen, len - pos);\n            // full block && aligned to 4 bytes\n            if (take === blockLen && o32 && d32) {\n                const pos32 = pos / 4;\n                if (pos % 4 !== 0)\n                    throw new Error('Salsa/ChaCha: invalid block position');\n                for (let j = 0; j < blockLen32; j++)\n                    o32[pos32 + j] = d32[pos32 + j] ^ b32[j];\n                pos += blockLen;\n                continue;\n            }\n            for (let j = 0; j < take; j++)\n                output[pos + j] = data[pos + j] ^ block[j];\n            pos += take;\n        }\n        for (let i = 0; i < toClean.length; i++)\n            toClean[i].fill(0);\n        return output;\n    };\n};\n//# sourceMappingURL=_salsa.js.map","import { createView, ensureBytes, equalBytes, setBigUint64, u32 } from './utils.js';\nimport { poly1305 } from './_poly1305.js';\nimport { salsaBasic } from './_salsa.js';\n// ChaCha20 stream cipher was released in 2008. ChaCha aims to increase\n// the diffusion per round, but had slightly less cryptanalysis.\n// https://cr.yp.to/chacha.html, http://cr.yp.to/chacha/chacha-20080128.pdf\n// Left rotate for uint32\nconst rotl = (a, b) => (a << b) | (a >>> (32 - b));\n/**\n * ChaCha core function.\n */\n// prettier-ignore\nfunction chachaCore(c, k, n, out, cnt, rounds = 20) {\n    let y00 = c[0], y01 = c[1], y02 = c[2], y03 = c[3]; // \"expa\"   \"nd 3\"  \"2-by\"  \"te k\"\n    let y04 = k[0], y05 = k[1], y06 = k[2], y07 = k[3]; // Key      Key     Key     Key\n    let y08 = k[4], y09 = k[5], y10 = k[6], y11 = k[7]; // Key      Key     Key     Key\n    let y12 = cnt, y13 = n[0], y14 = n[1], y15 = n[2]; // Counter  Counter\tNonce   Nonce\n    // Save state to temporary variables\n    let x00 = y00, x01 = y01, x02 = y02, x03 = y03, x04 = y04, x05 = y05, x06 = y06, x07 = y07, x08 = y08, x09 = y09, x10 = y10, x11 = y11, x12 = y12, x13 = y13, x14 = y14, x15 = y15;\n    // Main loop\n    for (let i = 0; i < rounds; i += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 7);\n    }\n    // Write output\n    let oi = 0;\n    out[oi++] = (y00 + x00) | 0;\n    out[oi++] = (y01 + x01) | 0;\n    out[oi++] = (y02 + x02) | 0;\n    out[oi++] = (y03 + x03) | 0;\n    out[oi++] = (y04 + x04) | 0;\n    out[oi++] = (y05 + x05) | 0;\n    out[oi++] = (y06 + x06) | 0;\n    out[oi++] = (y07 + x07) | 0;\n    out[oi++] = (y08 + x08) | 0;\n    out[oi++] = (y09 + x09) | 0;\n    out[oi++] = (y10 + x10) | 0;\n    out[oi++] = (y11 + x11) | 0;\n    out[oi++] = (y12 + x12) | 0;\n    out[oi++] = (y13 + x13) | 0;\n    out[oi++] = (y14 + x14) | 0;\n    out[oi++] = (y15 + x15) | 0;\n}\n/**\n * hchacha helper method, used primarily in xchacha, to hash\n * key and nonce into key' and nonce'.\n * Same as chachaCore, but there doesn't seem to be a way to move the block\n * out without 25% performance hit.\n */\n// prettier-ignore\nexport function hchacha(c, key, src, out) {\n    const k32 = u32(key);\n    const i32 = u32(src);\n    const o32 = u32(out);\n    let x00 = c[0], x01 = c[1], x02 = c[2], x03 = c[3];\n    let x04 = k32[0], x05 = k32[1], x06 = k32[2], x07 = k32[3];\n    let x08 = k32[4], x09 = k32[5], x10 = k32[6], x11 = k32[7];\n    let x12 = i32[0], x13 = i32[1], x14 = i32[2], x15 = i32[3];\n    for (let i = 0; i < 20; i += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 7);\n    }\n    o32[0] = x00;\n    o32[1] = x01;\n    o32[2] = x02;\n    o32[3] = x03;\n    o32[4] = x12;\n    o32[5] = x13;\n    o32[6] = x14;\n    o32[7] = x15;\n    return out;\n}\n/**\n * Original, non-RFC chacha20 from DJB. 8-byte nonce, 8-byte counter.\n */\nexport const chacha20orig = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 8,\n});\n/**\n * ChaCha stream cipher. Conforms to RFC 8439 (IETF, TLS). 12-byte nonce, 4-byte counter.\n * With 12-byte nonce, it's not safe to use fill it with random (CSPRNG), due to collision chance.\n */\nexport const chacha20 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 4,\n    allow128bitKeys: false,\n});\n/**\n * XChaCha eXtended-nonce ChaCha. 24-byte nonce.\n * With 24-byte nonce, it's safe to use fill it with random (CSPRNG).\n * https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha\n */\nexport const xchacha20 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 8,\n    extendNonceFn: hchacha,\n    allow128bitKeys: false,\n});\n/**\n * Reduced 8-round chacha, described in original paper.\n */\nexport const chacha8 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 4,\n    rounds: 8,\n});\n/**\n * Reduced 12-round chacha, described in original paper.\n */\nexport const chacha12 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 4,\n    rounds: 12,\n});\nconst ZERO = /* @__PURE__ */ new Uint8Array(16);\n// Pad to digest size with zeros\nconst updatePadded = (h, msg) => {\n    h.update(msg);\n    const left = msg.length % 16;\n    if (left)\n        h.update(ZERO.subarray(left));\n};\nconst computeTag = (fn, key, nonce, data, AAD) => {\n    const authKey = fn(key, nonce, new Uint8Array(32));\n    const h = poly1305.create(authKey);\n    if (AAD)\n        updatePadded(h, AAD);\n    updatePadded(h, data);\n    const num = new Uint8Array(16);\n    const view = createView(num);\n    setBigUint64(view, 0, BigInt(AAD ? AAD.length : 0), true);\n    setBigUint64(view, 8, BigInt(data.length), true);\n    h.update(num);\n    const res = h.digest();\n    authKey.fill(0);\n    return res;\n};\n/**\n * AEAD algorithm from RFC 8439.\n * Salsa20 and chacha (RFC 8439) use poly1305 differently.\n * We could have composed them similar to:\n * https://github.com/paulmillr/scure-base/blob/b266c73dde977b1dd7ef40ef7a23cc15aab526b3/index.ts#L250\n * But it's hard because of authKey:\n * In salsa20, authKey changes position in salsa stream.\n * In chacha, authKey can't be computed inside computeTag, it modifies the counter.\n */\nexport const _poly1305_aead = (xorStream) => (key, nonce, AAD) => {\n    const tagLength = 16;\n    ensureBytes(key, 32);\n    ensureBytes(nonce);\n    return {\n        tagLength,\n        encrypt: (plaintext, output) => {\n            const plength = plaintext.length;\n            const clength = plength + tagLength;\n            if (output) {\n                ensureBytes(output, clength);\n            }\n            else {\n                output = new Uint8Array(clength);\n            }\n            xorStream(key, nonce, plaintext, output, 1);\n            const tag = computeTag(xorStream, key, nonce, output.subarray(0, -tagLength), AAD);\n            output.set(tag, plength); // append tag\n            return output;\n        },\n        decrypt: (ciphertext, output) => {\n            const clength = ciphertext.length;\n            const plength = clength - tagLength;\n            if (clength < tagLength)\n                throw new Error(`encrypted data must be at least ${tagLength} bytes`);\n            if (output) {\n                ensureBytes(output, plength);\n            }\n            else {\n                output = new Uint8Array(plength);\n            }\n            const data = ciphertext.subarray(0, -tagLength);\n            const passedTag = ciphertext.subarray(-tagLength);\n            const tag = computeTag(xorStream, key, nonce, data, AAD);\n            if (!equalBytes(passedTag, tag))\n                throw new Error('invalid tag');\n            xorStream(key, nonce, data, output, 1);\n            return output;\n        },\n    };\n};\n/**\n * ChaCha20-Poly1305 from RFC 8439.\n * With 12-byte nonce, it's not safe to use fill it with random (CSPRNG), due to collision chance.\n */\nexport const chacha20poly1305 = /* @__PURE__ */ _poly1305_aead(chacha20);\n/**\n * XChaCha20-Poly1305 extended-nonce chacha.\n * https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha\n * With 24-byte nonce, it's safe to use fill it with random (CSPRNG).\n */\nexport const xchacha20poly1305 = /* @__PURE__ */ _poly1305_aead(xchacha20);\n//# sourceMappingURL=chacha.js.map","import assert from './_assert.js';\nimport { toBytes } from './utils.js';\nimport { hmac } from './hmac.js';\n// HKDF (RFC 5869)\n// https://soatok.blog/2021/11/17/understanding-hkdf/\n/**\n * HKDF-Extract(IKM, salt) -> PRK\n * Arguments position differs from spec (IKM is first one, since it is not optional)\n * @param hash\n * @param ikm\n * @param salt\n * @returns\n */\nexport function extract(hash, ikm, salt) {\n    assert.hash(hash);\n    // NOTE: some libraries treat zero-length array as 'not provided';\n    // we don't, since we have undefined as 'not provided'\n    // https://github.com/RustCrypto/KDFs/issues/15\n    if (salt === undefined)\n        salt = new Uint8Array(hash.outputLen); // if not provided, it is set to a string of HashLen zeros\n    return hmac(hash, toBytes(salt), toBytes(ikm));\n}\n// HKDF-Expand(PRK, info, L) -> OKM\nconst HKDF_COUNTER = new Uint8Array([0]);\nconst EMPTY_BUFFER = new Uint8Array();\n/**\n * HKDF-expand from the spec.\n * @param prk - a pseudorandom key of at least HashLen octets (usually, the output from the extract step)\n * @param info - optional context and application specific information (can be a zero-length string)\n * @param length - length of output keying material in octets\n */\nexport function expand(hash, prk, info, length = 32) {\n    assert.hash(hash);\n    assert.number(length);\n    if (length > 255 * hash.outputLen)\n        throw new Error('Length should be <= 255*HashLen');\n    const blocks = Math.ceil(length / hash.outputLen);\n    if (info === undefined)\n        info = EMPTY_BUFFER;\n    // first L(ength) octets of T\n    const okm = new Uint8Array(blocks * hash.outputLen);\n    // Re-use HMAC instance between blocks\n    const HMAC = hmac.create(hash, prk);\n    const HMACTmp = HMAC._cloneInto();\n    const T = new Uint8Array(HMAC.outputLen);\n    for (let counter = 0; counter < blocks; counter++) {\n        HKDF_COUNTER[0] = counter + 1;\n        // T(0) = empty string (zero length)\n        // T(N) = HMAC-Hash(PRK, T(N-1) | info | N)\n        HMACTmp.update(counter === 0 ? EMPTY_BUFFER : T)\n            .update(info)\n            .update(HKDF_COUNTER)\n            .digestInto(T);\n        okm.set(T, hash.outputLen * counter);\n        HMAC._cloneInto(HMACTmp);\n    }\n    HMAC.destroy();\n    HMACTmp.destroy();\n    T.fill(0);\n    HKDF_COUNTER.fill(0);\n    return okm.slice(0, length);\n}\n/**\n * HKDF (RFC 5869): extract + expand in one step.\n * @param hash - hash function that would be used (e.g. sha256)\n * @param ikm - input keying material, the initial key\n * @param salt - optional salt value (a non-secret random value)\n * @param info - optional context and application specific information\n * @param length - length of output keying material in octets\n */\nexport const hkdf = (hash, ikm, salt, info, length) => expand(hash, extract(hash, ikm, salt), info, length);\n//# sourceMappingURL=hkdf.js.map","var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// keys.ts\nimport { schnorr } from \"@noble/curves/secp256k1\";\nimport { bytesToHex } from \"@noble/hashes/utils\";\nfunction generatePrivateKey() {\n  return bytesToHex(schnorr.utils.randomPrivateKey());\n}\nfunction getPublicKey(privateKey) {\n  return bytesToHex(schnorr.getPublicKey(privateKey));\n}\n\n// event.ts\nimport { schnorr as schnorr2 } from \"@noble/curves/secp256k1\";\nimport { sha256 } from \"@noble/hashes/sha256\";\nimport { bytesToHex as bytesToHex2 } from \"@noble/hashes/utils\";\n\n// utils.ts\nvar utils_exports = {};\n__export(utils_exports, {\n  MessageNode: () => MessageNode,\n  MessageQueue: () => MessageQueue,\n  insertEventIntoAscendingList: () => insertEventIntoAscendingList,\n  insertEventIntoDescendingList: () => insertEventIntoDescendingList,\n  normalizeURL: () => normalizeURL,\n  utf8Decoder: () => utf8Decoder,\n  utf8Encoder: () => utf8Encoder\n});\nvar utf8Decoder = new TextDecoder(\"utf-8\");\nvar utf8Encoder = new TextEncoder();\nfunction normalizeURL(url) {\n  let p = new URL(url);\n  p.pathname = p.pathname.replace(/\\/+/g, \"/\");\n  if (p.pathname.endsWith(\"/\"))\n    p.pathname = p.pathname.slice(0, -1);\n  if (p.port === \"80\" && p.protocol === \"ws:\" || p.port === \"443\" && p.protocol === \"wss:\")\n    p.port = \"\";\n  p.searchParams.sort();\n  p.hash = \"\";\n  return p.toString();\n}\nfunction insertEventIntoDescendingList(sortedArray, event) {\n  let start = 0;\n  let end = sortedArray.length - 1;\n  let midPoint;\n  let position = start;\n  if (end < 0) {\n    position = 0;\n  } else if (event.created_at < sortedArray[end].created_at) {\n    position = end + 1;\n  } else if (event.created_at >= sortedArray[start].created_at) {\n    position = start;\n  } else\n    while (true) {\n      if (end <= start + 1) {\n        position = end;\n        break;\n      }\n      midPoint = Math.floor(start + (end - start) / 2);\n      if (sortedArray[midPoint].created_at > event.created_at) {\n        start = midPoint;\n      } else if (sortedArray[midPoint].created_at < event.created_at) {\n        end = midPoint;\n      } else {\n        position = midPoint;\n        break;\n      }\n    }\n  if (sortedArray[position]?.id !== event.id) {\n    return [...sortedArray.slice(0, position), event, ...sortedArray.slice(position)];\n  }\n  return sortedArray;\n}\nfunction insertEventIntoAscendingList(sortedArray, event) {\n  let start = 0;\n  let end = sortedArray.length - 1;\n  let midPoint;\n  let position = start;\n  if (end < 0) {\n    position = 0;\n  } else if (event.created_at > sortedArray[end].created_at) {\n    position = end + 1;\n  } else if (event.created_at <= sortedArray[start].created_at) {\n    position = start;\n  } else\n    while (true) {\n      if (end <= start + 1) {\n        position = end;\n        break;\n      }\n      midPoint = Math.floor(start + (end - start) / 2);\n      if (sortedArray[midPoint].created_at < event.created_at) {\n        start = midPoint;\n      } else if (sortedArray[midPoint].created_at > event.created_at) {\n        end = midPoint;\n      } else {\n        position = midPoint;\n        break;\n      }\n    }\n  if (sortedArray[position]?.id !== event.id) {\n    return [...sortedArray.slice(0, position), event, ...sortedArray.slice(position)];\n  }\n  return sortedArray;\n}\nvar MessageNode = class {\n  _value;\n  _next;\n  get value() {\n    return this._value;\n  }\n  set value(message) {\n    this._value = message;\n  }\n  get next() {\n    return this._next;\n  }\n  set next(node) {\n    this._next = node;\n  }\n  constructor(message) {\n    this._value = message;\n    this._next = null;\n  }\n};\nvar MessageQueue = class {\n  _first;\n  _last;\n  get first() {\n    return this._first;\n  }\n  set first(messageNode) {\n    this._first = messageNode;\n  }\n  get last() {\n    return this._last;\n  }\n  set last(messageNode) {\n    this._last = messageNode;\n  }\n  _size;\n  get size() {\n    return this._size;\n  }\n  set size(v) {\n    this._size = v;\n  }\n  constructor() {\n    this._first = null;\n    this._last = null;\n    this._size = 0;\n  }\n  enqueue(message) {\n    const newNode = new MessageNode(message);\n    if (this._size === 0 || !this._last) {\n      this._first = newNode;\n      this._last = newNode;\n    } else {\n      this._last.next = newNode;\n      this._last = newNode;\n    }\n    this._size++;\n    return true;\n  }\n  dequeue() {\n    if (this._size === 0 || !this._first)\n      return null;\n    let prev = this._first;\n    this._first = prev.next;\n    prev.next = null;\n    this._size--;\n    return prev.value;\n  }\n};\n\n// event.ts\nvar verifiedSymbol = Symbol(\"verified\");\nvar Kind = /* @__PURE__ */ ((Kind3) => {\n  Kind3[Kind3[\"Metadata\"] = 0] = \"Metadata\";\n  Kind3[Kind3[\"Text\"] = 1] = \"Text\";\n  Kind3[Kind3[\"RecommendRelay\"] = 2] = \"RecommendRelay\";\n  Kind3[Kind3[\"Contacts\"] = 3] = \"Contacts\";\n  Kind3[Kind3[\"EncryptedDirectMessage\"] = 4] = \"EncryptedDirectMessage\";\n  Kind3[Kind3[\"EventDeletion\"] = 5] = \"EventDeletion\";\n  Kind3[Kind3[\"Repost\"] = 6] = \"Repost\";\n  Kind3[Kind3[\"Reaction\"] = 7] = \"Reaction\";\n  Kind3[Kind3[\"BadgeAward\"] = 8] = \"BadgeAward\";\n  Kind3[Kind3[\"ChannelCreation\"] = 40] = \"ChannelCreation\";\n  Kind3[Kind3[\"ChannelMetadata\"] = 41] = \"ChannelMetadata\";\n  Kind3[Kind3[\"ChannelMessage\"] = 42] = \"ChannelMessage\";\n  Kind3[Kind3[\"ChannelHideMessage\"] = 43] = \"ChannelHideMessage\";\n  Kind3[Kind3[\"ChannelMuteUser\"] = 44] = \"ChannelMuteUser\";\n  Kind3[Kind3[\"Blank\"] = 255] = \"Blank\";\n  Kind3[Kind3[\"Report\"] = 1984] = \"Report\";\n  Kind3[Kind3[\"ZapRequest\"] = 9734] = \"ZapRequest\";\n  Kind3[Kind3[\"Zap\"] = 9735] = \"Zap\";\n  Kind3[Kind3[\"RelayList\"] = 10002] = \"RelayList\";\n  Kind3[Kind3[\"ClientAuth\"] = 22242] = \"ClientAuth\";\n  Kind3[Kind3[\"NwcRequest\"] = 23194] = \"NwcRequest\";\n  Kind3[Kind3[\"HttpAuth\"] = 27235] = \"HttpAuth\";\n  Kind3[Kind3[\"ProfileBadge\"] = 30008] = \"ProfileBadge\";\n  Kind3[Kind3[\"BadgeDefinition\"] = 30009] = \"BadgeDefinition\";\n  Kind3[Kind3[\"Article\"] = 30023] = \"Article\";\n  Kind3[Kind3[\"FileMetadata\"] = 1063] = \"FileMetadata\";\n  return Kind3;\n})(Kind || {});\nfunction getBlankEvent(kind = 255 /* Blank */) {\n  return {\n    kind,\n    content: \"\",\n    tags: [],\n    created_at: 0\n  };\n}\nfunction finishEvent(t, privateKey) {\n  const event = t;\n  event.pubkey = getPublicKey(privateKey);\n  event.id = getEventHash(event);\n  event.sig = getSignature(event, privateKey);\n  event[verifiedSymbol] = true;\n  return event;\n}\nfunction serializeEvent(evt) {\n  if (!validateEvent(evt))\n    throw new Error(\"can't serialize event with wrong or missing properties\");\n  return JSON.stringify([0, evt.pubkey, evt.created_at, evt.kind, evt.tags, evt.content]);\n}\nfunction getEventHash(event) {\n  let eventHash = sha256(utf8Encoder.encode(serializeEvent(event)));\n  return bytesToHex2(eventHash);\n}\nvar isRecord = (obj) => obj instanceof Object;\nfunction validateEvent(event) {\n  if (!isRecord(event))\n    return false;\n  if (typeof event.kind !== \"number\")\n    return false;\n  if (typeof event.content !== \"string\")\n    return false;\n  if (typeof event.created_at !== \"number\")\n    return false;\n  if (typeof event.pubkey !== \"string\")\n    return false;\n  if (!event.pubkey.match(/^[a-f0-9]{64}$/))\n    return false;\n  if (!Array.isArray(event.tags))\n    return false;\n  for (let i = 0; i < event.tags.length; i++) {\n    let tag = event.tags[i];\n    if (!Array.isArray(tag))\n      return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] === \"object\")\n        return false;\n    }\n  }\n  return true;\n}\nfunction verifySignature(event) {\n  if (typeof event[verifiedSymbol] === \"boolean\")\n    return event[verifiedSymbol];\n  const hash = getEventHash(event);\n  if (hash !== event.id) {\n    return event[verifiedSymbol] = false;\n  }\n  try {\n    return event[verifiedSymbol] = schnorr2.verify(event.sig, hash, event.pubkey);\n  } catch (err) {\n    return event[verifiedSymbol] = false;\n  }\n}\nfunction signEvent(event, key) {\n  console.warn(\n    \"nostr-tools: `signEvent` is deprecated and will be removed or changed in the future. Please use `getSignature` instead.\"\n  );\n  return getSignature(event, key);\n}\nfunction getSignature(event, key) {\n  return bytesToHex2(schnorr2.sign(getEventHash(event), key));\n}\n\n// filter.ts\nfunction matchFilter(filter, event) {\n  if (filter.ids && filter.ids.indexOf(event.id) === -1) {\n    if (!filter.ids.some((prefix) => event.id.startsWith(prefix))) {\n      return false;\n    }\n  }\n  if (filter.kinds && filter.kinds.indexOf(event.kind) === -1)\n    return false;\n  if (filter.authors && filter.authors.indexOf(event.pubkey) === -1) {\n    if (!filter.authors.some((prefix) => event.pubkey.startsWith(prefix))) {\n      return false;\n    }\n  }\n  for (let f in filter) {\n    if (f[0] === \"#\") {\n      let tagName = f.slice(1);\n      let values = filter[`#${tagName}`];\n      if (values && !event.tags.find(([t, v]) => t === f.slice(1) && values.indexOf(v) !== -1))\n        return false;\n    }\n  }\n  if (filter.since && event.created_at < filter.since)\n    return false;\n  if (filter.until && event.created_at > filter.until)\n    return false;\n  return true;\n}\nfunction matchFilters(filters, event) {\n  for (let i = 0; i < filters.length; i++) {\n    if (matchFilter(filters[i], event))\n      return true;\n  }\n  return false;\n}\nfunction mergeFilters(...filters) {\n  let result = {};\n  for (let i = 0; i < filters.length; i++) {\n    let filter = filters[i];\n    Object.entries(filter).forEach(([property, values]) => {\n      if (property === \"kinds\" || property === \"ids\" || property === \"authors\" || property[0] === \"#\") {\n        result[property] = result[property] || [];\n        for (let v = 0; v < values.length; v++) {\n          let value = values[v];\n          if (!result[property].includes(value))\n            result[property].push(value);\n        }\n      }\n    });\n    if (filter.limit && (!result.limit || filter.limit > result.limit))\n      result.limit = filter.limit;\n    if (filter.until && (!result.until || filter.until > result.until))\n      result.until = filter.until;\n    if (filter.since && (!result.since || filter.since < result.since))\n      result.since = filter.since;\n  }\n  return result;\n}\n\n// fakejson.ts\nvar fakejson_exports = {};\n__export(fakejson_exports, {\n  getHex64: () => getHex64,\n  getInt: () => getInt,\n  getSubscriptionId: () => getSubscriptionId,\n  matchEventId: () => matchEventId,\n  matchEventKind: () => matchEventKind,\n  matchEventPubkey: () => matchEventPubkey\n});\nfunction getHex64(json, field) {\n  let len = field.length + 3;\n  let idx = json.indexOf(`\"${field}\":`) + len;\n  let s = json.slice(idx).indexOf(`\"`) + idx + 1;\n  return json.slice(s, s + 64);\n}\nfunction getInt(json, field) {\n  let len = field.length;\n  let idx = json.indexOf(`\"${field}\":`) + len + 3;\n  let sliced = json.slice(idx);\n  let end = Math.min(sliced.indexOf(\",\"), sliced.indexOf(\"}\"));\n  return parseInt(sliced.slice(0, end), 10);\n}\nfunction getSubscriptionId(json) {\n  let idx = json.slice(0, 22).indexOf(`\"EVENT\"`);\n  if (idx === -1)\n    return null;\n  let pstart = json.slice(idx + 7 + 1).indexOf(`\"`);\n  if (pstart === -1)\n    return null;\n  let start = idx + 7 + 1 + pstart;\n  let pend = json.slice(start + 1, 80).indexOf(`\"`);\n  if (pend === -1)\n    return null;\n  let end = start + 1 + pend;\n  return json.slice(start + 1, end);\n}\nfunction matchEventId(json, id) {\n  return id === getHex64(json, \"id\");\n}\nfunction matchEventPubkey(json, pubkey) {\n  return pubkey === getHex64(json, \"pubkey\");\n}\nfunction matchEventKind(json, kind) {\n  return kind === getInt(json, \"kind\");\n}\n\n// relay.ts\nvar newListeners = () => ({\n  connect: [],\n  disconnect: [],\n  error: [],\n  notice: [],\n  auth: []\n});\nfunction relayInit(url, options = {}) {\n  let { listTimeout = 3e3, getTimeout = 3e3, countTimeout = 3e3 } = options;\n  var ws;\n  var openSubs = {};\n  var listeners = newListeners();\n  var subListeners = {};\n  var pubListeners = {};\n  var connectionPromise;\n  async function connectRelay() {\n    if (connectionPromise)\n      return connectionPromise;\n    connectionPromise = new Promise((resolve, reject) => {\n      try {\n        ws = new WebSocket(url);\n      } catch (err) {\n        reject(err);\n      }\n      ws.onopen = () => {\n        listeners.connect.forEach((cb) => cb());\n        resolve();\n      };\n      ws.onerror = () => {\n        connectionPromise = void 0;\n        listeners.error.forEach((cb) => cb());\n        reject();\n      };\n      ws.onclose = async () => {\n        connectionPromise = void 0;\n        listeners.disconnect.forEach((cb) => cb());\n      };\n      let incomingMessageQueue = new MessageQueue();\n      let handleNextInterval;\n      ws.onmessage = (e) => {\n        incomingMessageQueue.enqueue(e.data);\n        if (!handleNextInterval) {\n          handleNextInterval = setInterval(handleNext, 0);\n        }\n      };\n      function handleNext() {\n        if (incomingMessageQueue.size === 0) {\n          clearInterval(handleNextInterval);\n          handleNextInterval = null;\n          return;\n        }\n        var json = incomingMessageQueue.dequeue();\n        if (!json)\n          return;\n        let subid = getSubscriptionId(json);\n        if (subid) {\n          let so = openSubs[subid];\n          if (so && so.alreadyHaveEvent && so.alreadyHaveEvent(getHex64(json, \"id\"), url)) {\n            return;\n          }\n        }\n        try {\n          let data = JSON.parse(json);\n          switch (data[0]) {\n            case \"EVENT\": {\n              let id2 = data[1];\n              let event = data[2];\n              if (validateEvent(event) && openSubs[id2] && (openSubs[id2].skipVerification || verifySignature(event)) && matchFilters(openSubs[id2].filters, event)) {\n                openSubs[id2];\n                (subListeners[id2]?.event || []).forEach((cb) => cb(event));\n              }\n              return;\n            }\n            case \"COUNT\":\n              let id = data[1];\n              let payload = data[2];\n              if (openSubs[id]) {\n                ;\n                (subListeners[id]?.count || []).forEach((cb) => cb(payload));\n              }\n              return;\n            case \"EOSE\": {\n              let id2 = data[1];\n              if (id2 in subListeners) {\n                subListeners[id2].eose.forEach((cb) => cb());\n                subListeners[id2].eose = [];\n              }\n              return;\n            }\n            case \"OK\": {\n              let id2 = data[1];\n              let ok = data[2];\n              let reason = data[3] || \"\";\n              if (id2 in pubListeners) {\n                let { resolve: resolve2, reject: reject2 } = pubListeners[id2];\n                if (ok)\n                  resolve2(null);\n                else\n                  reject2(new Error(reason));\n              }\n              return;\n            }\n            case \"NOTICE\":\n              let notice = data[1];\n              listeners.notice.forEach((cb) => cb(notice));\n              return;\n            case \"AUTH\": {\n              let challenge = data[1];\n              listeners.auth?.forEach((cb) => cb(challenge));\n              return;\n            }\n          }\n        } catch (err) {\n          return;\n        }\n      }\n    });\n    return connectionPromise;\n  }\n  function connected() {\n    return ws?.readyState === 1;\n  }\n  async function connect() {\n    if (connected())\n      return;\n    await connectRelay();\n  }\n  async function trySend(params) {\n    let msg = JSON.stringify(params);\n    if (!connected()) {\n      await new Promise((resolve) => setTimeout(resolve, 1e3));\n      if (!connected()) {\n        return;\n      }\n    }\n    try {\n      ws.send(msg);\n    } catch (err) {\n      console.log(err);\n    }\n  }\n  const sub = (filters, {\n    verb = \"REQ\",\n    skipVerification = false,\n    alreadyHaveEvent = null,\n    id = Math.random().toString().slice(2)\n  } = {}) => {\n    let subid = id;\n    openSubs[subid] = {\n      id: subid,\n      filters,\n      skipVerification,\n      alreadyHaveEvent\n    };\n    trySend([verb, subid, ...filters]);\n    let subscription = {\n      sub: (newFilters, newOpts = {}) => sub(newFilters || filters, {\n        skipVerification: newOpts.skipVerification || skipVerification,\n        alreadyHaveEvent: newOpts.alreadyHaveEvent || alreadyHaveEvent,\n        id: subid\n      }),\n      unsub: () => {\n        delete openSubs[subid];\n        delete subListeners[subid];\n        trySend([\"CLOSE\", subid]);\n      },\n      on: (type, cb) => {\n        subListeners[subid] = subListeners[subid] || {\n          event: [],\n          count: [],\n          eose: []\n        };\n        subListeners[subid][type].push(cb);\n      },\n      off: (type, cb) => {\n        let listeners2 = subListeners[subid];\n        let idx = listeners2[type].indexOf(cb);\n        if (idx >= 0)\n          listeners2[type].splice(idx, 1);\n      },\n      get events() {\n        return eventsGenerator(subscription);\n      }\n    };\n    return subscription;\n  };\n  function _publishEvent(event, type) {\n    return new Promise((resolve, reject) => {\n      if (!event.id) {\n        reject(new Error(`event ${event} has no id`));\n        return;\n      }\n      let id = event.id;\n      trySend([type, event]);\n      pubListeners[id] = { resolve, reject };\n    });\n  }\n  return {\n    url,\n    sub,\n    on: (type, cb) => {\n      listeners[type].push(cb);\n      if (type === \"connect\" && ws?.readyState === 1) {\n        ;\n        cb();\n      }\n    },\n    off: (type, cb) => {\n      let index = listeners[type].indexOf(cb);\n      if (index !== -1)\n        listeners[type].splice(index, 1);\n    },\n    list: (filters, opts) => new Promise((resolve) => {\n      let s = sub(filters, opts);\n      let events = [];\n      let timeout = setTimeout(() => {\n        s.unsub();\n        resolve(events);\n      }, listTimeout);\n      s.on(\"eose\", () => {\n        s.unsub();\n        clearTimeout(timeout);\n        resolve(events);\n      });\n      s.on(\"event\", (event) => {\n        events.push(event);\n      });\n    }),\n    get: (filter, opts) => new Promise((resolve) => {\n      let s = sub([filter], opts);\n      let timeout = setTimeout(() => {\n        s.unsub();\n        resolve(null);\n      }, getTimeout);\n      s.on(\"event\", (event) => {\n        s.unsub();\n        clearTimeout(timeout);\n        resolve(event);\n      });\n    }),\n    count: (filters) => new Promise((resolve) => {\n      let s = sub(filters, { ...sub, verb: \"COUNT\" });\n      let timeout = setTimeout(() => {\n        s.unsub();\n        resolve(null);\n      }, countTimeout);\n      s.on(\"count\", (event) => {\n        s.unsub();\n        clearTimeout(timeout);\n        resolve(event);\n      });\n    }),\n    async publish(event) {\n      await _publishEvent(event, \"EVENT\");\n    },\n    async auth(event) {\n      await _publishEvent(event, \"AUTH\");\n    },\n    connect,\n    close() {\n      listeners = newListeners();\n      subListeners = {};\n      pubListeners = {};\n      if (ws?.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    },\n    get status() {\n      return ws?.readyState ?? 3;\n    }\n  };\n}\nasync function* eventsGenerator(sub) {\n  let nextResolve;\n  const eventQueue = [];\n  const pushToQueue = (event) => {\n    if (nextResolve) {\n      nextResolve(event);\n      nextResolve = void 0;\n    } else {\n      eventQueue.push(event);\n    }\n  };\n  sub.on(\"event\", pushToQueue);\n  try {\n    while (true) {\n      if (eventQueue.length > 0) {\n        yield eventQueue.shift();\n      } else {\n        const event = await new Promise((resolve) => {\n          nextResolve = resolve;\n        });\n        yield event;\n      }\n    }\n  } finally {\n    sub.off(\"event\", pushToQueue);\n  }\n}\n\n// pool.ts\nvar SimplePool = class {\n  _conn;\n  _seenOn = {};\n  batchedByKey = {};\n  eoseSubTimeout;\n  getTimeout;\n  seenOnEnabled = true;\n  batchInterval = 100;\n  constructor(options = {}) {\n    this._conn = {};\n    this.eoseSubTimeout = options.eoseSubTimeout || 3400;\n    this.getTimeout = options.getTimeout || 3400;\n    this.seenOnEnabled = options.seenOnEnabled !== false;\n    this.batchInterval = options.batchInterval || 100;\n  }\n  close(relays) {\n    relays.forEach((url) => {\n      let relay = this._conn[normalizeURL(url)];\n      if (relay)\n        relay.close();\n    });\n  }\n  async ensureRelay(url) {\n    const nm = normalizeURL(url);\n    if (!this._conn[nm]) {\n      this._conn[nm] = relayInit(nm, {\n        getTimeout: this.getTimeout * 0.9,\n        listTimeout: this.getTimeout * 0.9\n      });\n    }\n    const relay = this._conn[nm];\n    await relay.connect();\n    return relay;\n  }\n  sub(relays, filters, opts) {\n    let _knownIds = /* @__PURE__ */ new Set();\n    let modifiedOpts = { ...opts || {} };\n    modifiedOpts.alreadyHaveEvent = (id, url) => {\n      if (opts?.alreadyHaveEvent?.(id, url)) {\n        return true;\n      }\n      if (this.seenOnEnabled) {\n        let set = this._seenOn[id] || /* @__PURE__ */ new Set();\n        set.add(url);\n        this._seenOn[id] = set;\n      }\n      return _knownIds.has(id);\n    };\n    let subs = [];\n    let eventListeners = /* @__PURE__ */ new Set();\n    let eoseListeners = /* @__PURE__ */ new Set();\n    let eosesMissing = relays.length;\n    let eoseSent = false;\n    let eoseTimeout = setTimeout(\n      () => {\n        eoseSent = true;\n        for (let cb of eoseListeners.values())\n          cb();\n      },\n      opts?.eoseSubTimeout || this.eoseSubTimeout\n    );\n    relays.filter((r, i, a) => a.indexOf(r) === i).forEach(async (relay) => {\n      let r;\n      try {\n        r = await this.ensureRelay(relay);\n      } catch (err) {\n        handleEose();\n        return;\n      }\n      if (!r)\n        return;\n      let s = r.sub(filters, modifiedOpts);\n      s.on(\"event\", (event) => {\n        _knownIds.add(event.id);\n        for (let cb of eventListeners.values())\n          cb(event);\n      });\n      s.on(\"eose\", () => {\n        if (eoseSent)\n          return;\n        handleEose();\n      });\n      subs.push(s);\n      function handleEose() {\n        eosesMissing--;\n        if (eosesMissing === 0) {\n          clearTimeout(eoseTimeout);\n          for (let cb of eoseListeners.values())\n            cb();\n        }\n      }\n    });\n    let greaterSub = {\n      sub(filters2, opts2) {\n        subs.forEach((sub) => sub.sub(filters2, opts2));\n        return greaterSub;\n      },\n      unsub() {\n        subs.forEach((sub) => sub.unsub());\n      },\n      on(type, cb) {\n        if (type === \"event\") {\n          eventListeners.add(cb);\n        } else if (type === \"eose\") {\n          eoseListeners.add(cb);\n        }\n      },\n      off(type, cb) {\n        if (type === \"event\") {\n          eventListeners.delete(cb);\n        } else if (type === \"eose\")\n          eoseListeners.delete(cb);\n      },\n      get events() {\n        return eventsGenerator(greaterSub);\n      }\n    };\n    return greaterSub;\n  }\n  get(relays, filter, opts) {\n    return new Promise((resolve) => {\n      let sub = this.sub(relays, [filter], opts);\n      let timeout = setTimeout(() => {\n        sub.unsub();\n        resolve(null);\n      }, this.getTimeout);\n      sub.on(\"event\", (event) => {\n        resolve(event);\n        clearTimeout(timeout);\n        sub.unsub();\n      });\n    });\n  }\n  list(relays, filters, opts) {\n    return new Promise((resolve) => {\n      let events = [];\n      let sub = this.sub(relays, filters, opts);\n      sub.on(\"event\", (event) => {\n        events.push(event);\n      });\n      sub.on(\"eose\", () => {\n        sub.unsub();\n        resolve(events);\n      });\n    });\n  }\n  batchedList(batchKey, relays, filters) {\n    return new Promise((resolve) => {\n      if (!this.batchedByKey[batchKey]) {\n        this.batchedByKey[batchKey] = [\n          {\n            filters,\n            relays,\n            resolve,\n            events: []\n          }\n        ];\n        setTimeout(() => {\n          Object.keys(this.batchedByKey).forEach(async (batchKey2) => {\n            const batchedRequests = this.batchedByKey[batchKey2];\n            const filters2 = [];\n            const relays2 = [];\n            batchedRequests.forEach((br) => {\n              filters2.push(...br.filters);\n              relays2.push(...br.relays);\n            });\n            const sub = this.sub(relays2, [mergeFilters(...filters2)]);\n            sub.on(\"event\", (event) => {\n              batchedRequests.forEach((br) => matchFilters(br.filters, event) && br.events.push(event));\n            });\n            sub.on(\"eose\", () => {\n              sub.unsub();\n              batchedRequests.forEach((br) => br.resolve(br.events));\n            });\n            delete this.batchedByKey[batchKey2];\n          });\n        }, this.batchInterval);\n      } else {\n        this.batchedByKey[batchKey].push({\n          filters,\n          relays,\n          resolve,\n          events: []\n        });\n      }\n    });\n  }\n  publish(relays, event) {\n    return relays.map(async (relay) => {\n      let r = await this.ensureRelay(relay);\n      return r.publish(event);\n    });\n  }\n  seenOn(id) {\n    return Array.from(this._seenOn[id]?.values?.() || []);\n  }\n};\n\n// nip19.ts\nvar nip19_exports = {};\n__export(nip19_exports, {\n  BECH32_REGEX: () => BECH32_REGEX,\n  decode: () => decode,\n  naddrEncode: () => naddrEncode,\n  neventEncode: () => neventEncode,\n  noteEncode: () => noteEncode,\n  nprofileEncode: () => nprofileEncode,\n  npubEncode: () => npubEncode,\n  nrelayEncode: () => nrelayEncode,\n  nsecEncode: () => nsecEncode\n});\nimport { bytesToHex as bytesToHex3, concatBytes, hexToBytes } from \"@noble/hashes/utils\";\nimport { bech32 } from \"@scure/base\";\nvar Bech32MaxSize = 5e3;\nvar BECH32_REGEX = /[\\x21-\\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;\nfunction integerToUint8Array(number) {\n  const uint8Array = new Uint8Array(4);\n  uint8Array[0] = number >> 24 & 255;\n  uint8Array[1] = number >> 16 & 255;\n  uint8Array[2] = number >> 8 & 255;\n  uint8Array[3] = number & 255;\n  return uint8Array;\n}\nfunction decode(nip19) {\n  let { prefix, words } = bech32.decode(nip19, Bech32MaxSize);\n  let data = new Uint8Array(bech32.fromWords(words));\n  switch (prefix) {\n    case \"nprofile\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nprofile\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      return {\n        type: \"nprofile\",\n        data: {\n          pubkey: bytesToHex3(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nevent\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nevent\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      if (tlv[2] && tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (tlv[3] && tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"nevent\",\n        data: {\n          id: bytesToHex3(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : [],\n          author: tlv[2]?.[0] ? bytesToHex3(tlv[2][0]) : void 0,\n          kind: tlv[3]?.[0] ? parseInt(bytesToHex3(tlv[3][0]), 16) : void 0\n        }\n      };\n    }\n    case \"naddr\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for naddr\");\n      if (!tlv[2]?.[0])\n        throw new Error(\"missing TLV 2 for naddr\");\n      if (tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (!tlv[3]?.[0])\n        throw new Error(\"missing TLV 3 for naddr\");\n      if (tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"naddr\",\n        data: {\n          identifier: utf8Decoder.decode(tlv[0][0]),\n          pubkey: bytesToHex3(tlv[2][0]),\n          kind: parseInt(bytesToHex3(tlv[3][0]), 16),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nrelay\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nrelay\");\n      return {\n        type: \"nrelay\",\n        data: utf8Decoder.decode(tlv[0][0])\n      };\n    }\n    case \"nsec\":\n    case \"npub\":\n    case \"note\":\n      return { type: prefix, data: bytesToHex3(data) };\n    default:\n      throw new Error(`unknown prefix ${prefix}`);\n  }\n}\nfunction parseTLV(data) {\n  let result = {};\n  let rest = data;\n  while (rest.length > 0) {\n    let t = rest[0];\n    let l = rest[1];\n    if (!l)\n      throw new Error(`malformed TLV ${t}`);\n    let v = rest.slice(2, 2 + l);\n    rest = rest.slice(2 + l);\n    if (v.length < l)\n      throw new Error(`not enough data to read on TLV ${t}`);\n    result[t] = result[t] || [];\n    result[t].push(v);\n  }\n  return result;\n}\nfunction nsecEncode(hex) {\n  return encodeBytes(\"nsec\", hex);\n}\nfunction npubEncode(hex) {\n  return encodeBytes(\"npub\", hex);\n}\nfunction noteEncode(hex) {\n  return encodeBytes(\"note\", hex);\n}\nfunction encodeBech32(prefix, data) {\n  let words = bech32.toWords(data);\n  return bech32.encode(prefix, words, Bech32MaxSize);\n}\nfunction encodeBytes(prefix, hex) {\n  let data = hexToBytes(hex);\n  return encodeBech32(prefix, data);\n}\nfunction nprofileEncode(profile) {\n  let data = encodeTLV({\n    0: [hexToBytes(profile.pubkey)],\n    1: (profile.relays || []).map((url) => utf8Encoder.encode(url))\n  });\n  return encodeBech32(\"nprofile\", data);\n}\nfunction neventEncode(event) {\n  let kindArray;\n  if (event.kind != void 0) {\n    kindArray = integerToUint8Array(event.kind);\n  }\n  let data = encodeTLV({\n    0: [hexToBytes(event.id)],\n    1: (event.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: event.author ? [hexToBytes(event.author)] : [],\n    3: kindArray ? [new Uint8Array(kindArray)] : []\n  });\n  return encodeBech32(\"nevent\", data);\n}\nfunction naddrEncode(addr) {\n  let kind = new ArrayBuffer(4);\n  new DataView(kind).setUint32(0, addr.kind, false);\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(addr.identifier)],\n    1: (addr.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: [hexToBytes(addr.pubkey)],\n    3: [new Uint8Array(kind)]\n  });\n  return encodeBech32(\"naddr\", data);\n}\nfunction nrelayEncode(url) {\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(url)]\n  });\n  return encodeBech32(\"nrelay\", data);\n}\nfunction encodeTLV(tlv) {\n  let entries = [];\n  Object.entries(tlv).forEach(([t, vs]) => {\n    vs.forEach((v) => {\n      let entry = new Uint8Array(v.length + 2);\n      entry.set([parseInt(t)], 0);\n      entry.set([v.length], 1);\n      entry.set(v, 2);\n      entries.push(entry);\n    });\n  });\n  return concatBytes(...entries);\n}\n\n// references.ts\nvar mentionRegex = /\\bnostr:((note|npub|naddr|nevent|nprofile)1\\w+)\\b|#\\[(\\d+)\\]/g;\nfunction parseReferences(evt) {\n  let references = [];\n  for (let ref of evt.content.matchAll(mentionRegex)) {\n    if (ref[2]) {\n      try {\n        let { type, data } = decode(ref[1]);\n        switch (type) {\n          case \"npub\": {\n            references.push({\n              text: ref[0],\n              profile: { pubkey: data, relays: [] }\n            });\n            break;\n          }\n          case \"nprofile\": {\n            references.push({\n              text: ref[0],\n              profile: data\n            });\n            break;\n          }\n          case \"note\": {\n            references.push({\n              text: ref[0],\n              event: { id: data, relays: [] }\n            });\n            break;\n          }\n          case \"nevent\": {\n            references.push({\n              text: ref[0],\n              event: data\n            });\n            break;\n          }\n          case \"naddr\": {\n            references.push({\n              text: ref[0],\n              address: data\n            });\n            break;\n          }\n        }\n      } catch (err) {\n      }\n    } else if (ref[3]) {\n      let idx = parseInt(ref[3], 10);\n      let tag = evt.tags[idx];\n      if (!tag)\n        continue;\n      switch (tag[0]) {\n        case \"p\": {\n          references.push({\n            text: ref[0],\n            profile: { pubkey: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"e\": {\n          references.push({\n            text: ref[0],\n            event: { id: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"a\": {\n          try {\n            let [kind, pubkey, identifier] = tag[1].split(\":\");\n            references.push({\n              text: ref[0],\n              address: {\n                identifier,\n                pubkey,\n                kind: parseInt(kind, 10),\n                relays: tag[2] ? [tag[2]] : []\n              }\n            });\n          } catch (err) {\n          }\n          break;\n        }\n      }\n    }\n  }\n  return references;\n}\n\n// nip04.ts\nvar nip04_exports = {};\n__export(nip04_exports, {\n  decrypt: () => decrypt,\n  encrypt: () => encrypt\n});\nimport { randomBytes } from \"@noble/hashes/utils\";\nimport { secp256k1 } from \"@noble/curves/secp256k1\";\nimport { base64 } from \"@scure/base\";\nif (typeof crypto !== \"undefined\" && !crypto.subtle && crypto.webcrypto) {\n  crypto.subtle = crypto.webcrypto.subtle;\n}\nasync function encrypt(privkey, pubkey, text) {\n  const key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  const normalizedKey = getNormalizedX(key);\n  let iv = Uint8Array.from(randomBytes(16));\n  let plaintext = utf8Encoder.encode(text);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, { name: \"AES-CBC\" }, false, [\"encrypt\"]);\n  let ciphertext = await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, cryptoKey, plaintext);\n  let ctb64 = base64.encode(new Uint8Array(ciphertext));\n  let ivb64 = base64.encode(new Uint8Array(iv.buffer));\n  return `${ctb64}?iv=${ivb64}`;\n}\nasync function decrypt(privkey, pubkey, data) {\n  let [ctb64, ivb64] = data.split(\"?iv=\");\n  let key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  let normalizedKey = getNormalizedX(key);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, { name: \"AES-CBC\" }, false, [\"decrypt\"]);\n  let ciphertext = base64.decode(ctb64);\n  let iv = base64.decode(ivb64);\n  let plaintext = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, cryptoKey, ciphertext);\n  let text = utf8Decoder.decode(plaintext);\n  return text;\n}\nfunction getNormalizedX(key) {\n  return key.slice(1, 33);\n}\n\n// nip05.ts\nvar nip05_exports = {};\n__export(nip05_exports, {\n  NIP05_REGEX: () => NIP05_REGEX,\n  queryProfile: () => queryProfile,\n  searchDomain: () => searchDomain,\n  useFetchImplementation: () => useFetchImplementation\n});\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w.-]+)$/;\nvar _fetch;\ntry {\n  _fetch = fetch;\n} catch {\n}\nfunction useFetchImplementation(fetchImplementation) {\n  _fetch = fetchImplementation;\n}\nasync function searchDomain(domain, query = \"\") {\n  try {\n    let res = await (await _fetch(`https://${domain}/.well-known/nostr.json?name=${query}`)).json();\n    return res.names;\n  } catch (_) {\n    return {};\n  }\n}\nasync function queryProfile(fullname) {\n  const match = fullname.match(NIP05_REGEX);\n  if (!match)\n    return null;\n  const [_, name = \"_\", domain] = match;\n  try {\n    const res = await _fetch(`https://${domain}/.well-known/nostr.json?name=${name}`);\n    const { names, relays } = parseNIP05Result(await res.json());\n    const pubkey = names[name];\n    return pubkey ? { pubkey, relays: relays?.[pubkey] } : null;\n  } catch (_e) {\n    return null;\n  }\n}\nfunction parseNIP05Result(json) {\n  const result = {\n    names: {}\n  };\n  for (const [name, pubkey] of Object.entries(json.names)) {\n    if (typeof name === \"string\" && typeof pubkey === \"string\") {\n      result.names[name] = pubkey;\n    }\n  }\n  if (json.relays) {\n    result.relays = {};\n    for (const [pubkey, relays] of Object.entries(json.relays)) {\n      if (typeof pubkey === \"string\" && Array.isArray(relays)) {\n        result.relays[pubkey] = relays.filter((relay) => typeof relay === \"string\");\n      }\n    }\n  }\n  return result;\n}\n\n// nip06.ts\nvar nip06_exports = {};\n__export(nip06_exports, {\n  generateSeedWords: () => generateSeedWords,\n  privateKeyFromSeedWords: () => privateKeyFromSeedWords,\n  validateWords: () => validateWords\n});\nimport { bytesToHex as bytesToHex4 } from \"@noble/hashes/utils\";\nimport { wordlist } from \"@scure/bip39/wordlists/english\";\nimport { generateMnemonic, mnemonicToSeedSync, validateMnemonic } from \"@scure/bip39\";\nimport { HDKey } from \"@scure/bip32\";\nfunction privateKeyFromSeedWords(mnemonic, passphrase) {\n  let root = HDKey.fromMasterSeed(mnemonicToSeedSync(mnemonic, passphrase));\n  let privateKey = root.derive(`m/44'/1237'/0'/0/0`).privateKey;\n  if (!privateKey)\n    throw new Error(\"could not derive private key\");\n  return bytesToHex4(privateKey);\n}\nfunction generateSeedWords() {\n  return generateMnemonic(wordlist);\n}\nfunction validateWords(words) {\n  return validateMnemonic(words, wordlist);\n}\n\n// nip10.ts\nvar nip10_exports = {};\n__export(nip10_exports, {\n  parse: () => parse\n});\nfunction parse(event) {\n  const result = {\n    reply: void 0,\n    root: void 0,\n    mentions: [],\n    profiles: []\n  };\n  const eTags = [];\n  for (const tag of event.tags) {\n    if (tag[0] === \"e\" && tag[1]) {\n      eTags.push(tag);\n    }\n    if (tag[0] === \"p\" && tag[1]) {\n      result.profiles.push({\n        pubkey: tag[1],\n        relays: tag[2] ? [tag[2]] : []\n      });\n    }\n  }\n  for (let eTagIndex = 0; eTagIndex < eTags.length; eTagIndex++) {\n    const eTag = eTags[eTagIndex];\n    const [_, eTagEventId, eTagRelayUrl, eTagMarker] = eTag;\n    const eventPointer = {\n      id: eTagEventId,\n      relays: eTagRelayUrl ? [eTagRelayUrl] : []\n    };\n    const isFirstETag = eTagIndex === 0;\n    const isLastETag = eTagIndex === eTags.length - 1;\n    if (eTagMarker === \"root\") {\n      result.root = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"reply\") {\n      result.reply = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"mention\") {\n      result.mentions.push(eventPointer);\n      continue;\n    }\n    if (isFirstETag) {\n      result.root = eventPointer;\n      continue;\n    }\n    if (isLastETag) {\n      result.reply = eventPointer;\n      continue;\n    }\n    result.mentions.push(eventPointer);\n  }\n  return result;\n}\n\n// nip13.ts\nvar nip13_exports = {};\n__export(nip13_exports, {\n  getPow: () => getPow,\n  minePow: () => minePow\n});\nfunction getPow(hex) {\n  let count = 0;\n  for (let i = 0; i < hex.length; i++) {\n    const nibble = parseInt(hex[i], 16);\n    if (nibble === 0) {\n      count += 4;\n    } else {\n      count += Math.clz32(nibble) - 28;\n      break;\n    }\n  }\n  return count;\n}\nfunction minePow(unsigned, difficulty) {\n  let count = 0;\n  const event = unsigned;\n  const tag = [\"nonce\", count.toString(), difficulty.toString()];\n  event.tags.push(tag);\n  while (true) {\n    const now = Math.floor(new Date().getTime() / 1e3);\n    if (now !== event.created_at) {\n      count = 0;\n      event.created_at = now;\n    }\n    tag[1] = (++count).toString();\n    event.id = getEventHash(event);\n    if (getPow(event.id) >= difficulty) {\n      break;\n    }\n  }\n  return event;\n}\n\n// nip18.ts\nvar nip18_exports = {};\n__export(nip18_exports, {\n  finishRepostEvent: () => finishRepostEvent,\n  getRepostedEvent: () => getRepostedEvent,\n  getRepostedEventPointer: () => getRepostedEventPointer\n});\nfunction finishRepostEvent(t, reposted, relayUrl, privateKey) {\n  return finishEvent(\n    {\n      kind: 6 /* Repost */,\n      tags: [...t.tags ?? [], [\"e\", reposted.id, relayUrl], [\"p\", reposted.pubkey]],\n      content: t.content === \"\" ? \"\" : JSON.stringify(reposted),\n      created_at: t.created_at\n    },\n    privateKey\n  );\n}\nfunction getRepostedEventPointer(event) {\n  if (event.kind !== 6 /* Repost */) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i = event.tags.length - 1; i >= 0 && (lastETag === void 0 || lastPTag === void 0); i--) {\n    const tag = event.tags[i];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag?.[2]].filter((x) => typeof x === \"string\"),\n    author: lastPTag?.[1]\n  };\n}\nfunction getRepostedEvent(event, { skipVerification } = {}) {\n  const pointer = getRepostedEventPointer(event);\n  if (pointer === void 0 || event.content === \"\") {\n    return void 0;\n  }\n  let repostedEvent;\n  try {\n    repostedEvent = JSON.parse(event.content);\n  } catch (error) {\n    return void 0;\n  }\n  if (repostedEvent.id !== pointer.id) {\n    return void 0;\n  }\n  if (!skipVerification && !verifySignature(repostedEvent)) {\n    return void 0;\n  }\n  return repostedEvent;\n}\n\n// nip21.ts\nvar nip21_exports = {};\n__export(nip21_exports, {\n  NOSTR_URI_REGEX: () => NOSTR_URI_REGEX,\n  parse: () => parse2,\n  test: () => test\n});\nvar NOSTR_URI_REGEX = new RegExp(`nostr:(${BECH32_REGEX.source})`);\nfunction test(value) {\n  return typeof value === \"string\" && new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(value);\n}\nfunction parse2(uri) {\n  const match = uri.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));\n  if (!match)\n    throw new Error(`Invalid Nostr URI: ${uri}`);\n  return {\n    uri: match[0],\n    value: match[1],\n    decoded: decode(match[1])\n  };\n}\n\n// nip25.ts\nvar nip25_exports = {};\n__export(nip25_exports, {\n  finishReactionEvent: () => finishReactionEvent,\n  getReactedEventPointer: () => getReactedEventPointer\n});\nfunction finishReactionEvent(t, reacted, privateKey) {\n  const inheritedTags = reacted.tags.filter((tag) => tag.length >= 2 && (tag[0] === \"e\" || tag[0] === \"p\"));\n  return finishEvent(\n    {\n      ...t,\n      kind: 7 /* Reaction */,\n      tags: [...t.tags ?? [], ...inheritedTags, [\"e\", reacted.id], [\"p\", reacted.pubkey]],\n      content: t.content ?? \"+\"\n    },\n    privateKey\n  );\n}\nfunction getReactedEventPointer(event) {\n  if (event.kind !== 7 /* Reaction */) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i = event.tags.length - 1; i >= 0 && (lastETag === void 0 || lastPTag === void 0); i--) {\n    const tag = event.tags[i];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0 || lastPTag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag[2]].filter((x) => x !== void 0),\n    author: lastPTag[1]\n  };\n}\n\n// nip26.ts\nvar nip26_exports = {};\n__export(nip26_exports, {\n  createDelegation: () => createDelegation,\n  getDelegator: () => getDelegator\n});\nimport { schnorr as schnorr3 } from \"@noble/curves/secp256k1\";\nimport { bytesToHex as bytesToHex5 } from \"@noble/hashes/utils\";\nimport { sha256 as sha2562 } from \"@noble/hashes/sha256\";\nfunction createDelegation(privateKey, parameters) {\n  let conditions = [];\n  if ((parameters.kind || -1) >= 0)\n    conditions.push(`kind=${parameters.kind}`);\n  if (parameters.until)\n    conditions.push(`created_at<${parameters.until}`);\n  if (parameters.since)\n    conditions.push(`created_at>${parameters.since}`);\n  let cond = conditions.join(\"&\");\n  if (cond === \"\")\n    throw new Error(\"refusing to create a delegation without any conditions\");\n  let sighash = sha2562(utf8Encoder.encode(`nostr:delegation:${parameters.pubkey}:${cond}`));\n  let sig = bytesToHex5(schnorr3.sign(sighash, privateKey));\n  return {\n    from: getPublicKey(privateKey),\n    to: parameters.pubkey,\n    cond,\n    sig\n  };\n}\nfunction getDelegator(event) {\n  let tag = event.tags.find((tag2) => tag2[0] === \"delegation\" && tag2.length >= 4);\n  if (!tag)\n    return null;\n  let pubkey = tag[1];\n  let cond = tag[2];\n  let sig = tag[3];\n  let conditions = cond.split(\"&\");\n  for (let i = 0; i < conditions.length; i++) {\n    let [key, operator, value] = conditions[i].split(/\\b/);\n    if (key === \"kind\" && operator === \"=\" && event.kind === parseInt(value))\n      continue;\n    else if (key === \"created_at\" && operator === \"<\" && event.created_at < parseInt(value))\n      continue;\n    else if (key === \"created_at\" && operator === \">\" && event.created_at > parseInt(value))\n      continue;\n    else\n      return null;\n  }\n  let sighash = sha2562(utf8Encoder.encode(`nostr:delegation:${event.pubkey}:${cond}`));\n  if (!schnorr3.verify(sig, sighash, pubkey))\n    return null;\n  return pubkey;\n}\n\n// nip27.ts\nvar nip27_exports = {};\n__export(nip27_exports, {\n  matchAll: () => matchAll,\n  regex: () => regex,\n  replaceAll: () => replaceAll\n});\nvar regex = () => new RegExp(`\\\\b${NOSTR_URI_REGEX.source}\\\\b`, \"g\");\nfunction* matchAll(content) {\n  const matches = content.matchAll(regex());\n  for (const match of matches) {\n    try {\n      const [uri, value] = match;\n      yield {\n        uri,\n        value,\n        decoded: decode(value),\n        start: match.index,\n        end: match.index + uri.length\n      };\n    } catch (_e) {\n    }\n  }\n}\nfunction replaceAll(content, replacer) {\n  return content.replaceAll(regex(), (uri, value) => {\n    return replacer({\n      uri,\n      value,\n      decoded: decode(value)\n    });\n  });\n}\n\n// nip28.ts\nvar nip28_exports = {};\n__export(nip28_exports, {\n  channelCreateEvent: () => channelCreateEvent,\n  channelHideMessageEvent: () => channelHideMessageEvent,\n  channelMessageEvent: () => channelMessageEvent,\n  channelMetadataEvent: () => channelMetadataEvent,\n  channelMuteUserEvent: () => channelMuteUserEvent\n});\nvar channelCreateEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 40 /* ChannelCreation */,\n      tags: [...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMetadataEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 41 /* ChannelMetadata */,\n      tags: [[\"e\", t.channel_create_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMessageEvent = (t, privateKey) => {\n  const tags = [[\"e\", t.channel_create_event_id, t.relay_url, \"root\"]];\n  if (t.reply_to_channel_message_event_id) {\n    tags.push([\"e\", t.reply_to_channel_message_event_id, t.relay_url, \"reply\"]);\n  }\n  return finishEvent(\n    {\n      kind: 42 /* ChannelMessage */,\n      tags: [...tags, ...t.tags ?? []],\n      content: t.content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelHideMessageEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 43 /* ChannelHideMessage */,\n      tags: [[\"e\", t.channel_message_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMuteUserEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 44 /* ChannelMuteUser */,\n      tags: [[\"p\", t.pubkey_to_mute], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\n\n// nip39.ts\nvar nip39_exports = {};\n__export(nip39_exports, {\n  useFetchImplementation: () => useFetchImplementation2,\n  validateGithub: () => validateGithub\n});\nvar _fetch2;\ntry {\n  _fetch2 = fetch;\n} catch {\n}\nfunction useFetchImplementation2(fetchImplementation) {\n  _fetch2 = fetchImplementation;\n}\nasync function validateGithub(pubkey, username, proof) {\n  try {\n    let res = await (await _fetch2(`https://gist.github.com/${username}/${proof}/raw`)).text();\n    return res === `Verifying that I control the following Nostr public key: ${pubkey}`;\n  } catch (_) {\n    return false;\n  }\n}\n\n// nip42.ts\nvar nip42_exports = {};\n__export(nip42_exports, {\n  authenticate: () => authenticate\n});\nvar authenticate = async ({\n  challenge,\n  relay,\n  sign\n}) => {\n  const e = {\n    kind: 22242 /* ClientAuth */,\n    created_at: Math.floor(Date.now() / 1e3),\n    tags: [\n      [\"relay\", relay.url],\n      [\"challenge\", challenge]\n    ],\n    content: \"\"\n  };\n  return relay.auth(await sign(e));\n};\n\n// nip44.ts\nvar nip44_exports = {};\n__export(nip44_exports, {\n  decrypt: () => decrypt2,\n  encrypt: () => encrypt2,\n  utils: () => utils\n});\nimport { chacha20 } from \"@noble/ciphers/chacha\";\nimport { ensureBytes, equalBytes } from \"@noble/ciphers/utils\";\nimport { secp256k1 as secp256k12 } from \"@noble/curves/secp256k1\";\nimport { hkdf } from \"@noble/hashes/hkdf\";\nimport { hmac } from \"@noble/hashes/hmac\";\nimport { sha256 as sha2563 } from \"@noble/hashes/sha256\";\nimport { concatBytes as concatBytes2, randomBytes as randomBytes2 } from \"@noble/hashes/utils\";\nimport { base64 as base642 } from \"@scure/base\";\nvar utils = {\n  v2: {\n    maxPlaintextSize: 65536 - 128,\n    minCiphertextSize: 100,\n    maxCiphertextSize: 102400,\n    getConversationKey(privkeyA, pubkeyB) {\n      const key = secp256k12.getSharedSecret(privkeyA, \"02\" + pubkeyB);\n      return key.subarray(1, 33);\n    },\n    getMessageKeys(conversationKey, salt) {\n      const keys = hkdf(sha2563, conversationKey, salt, \"nip44-v2\", 76);\n      return {\n        encryption: keys.subarray(0, 32),\n        nonce: keys.subarray(32, 44),\n        auth: keys.subarray(44, 76)\n      };\n    },\n    calcPadding(len) {\n      if (!Number.isSafeInteger(len) || len < 0)\n        throw new Error(\"expected positive integer\");\n      if (len <= 32)\n        return 32;\n      const nextpower = 1 << Math.floor(Math.log2(len - 1)) + 1;\n      const chunk = nextpower <= 256 ? 32 : nextpower / 8;\n      return chunk * (Math.floor((len - 1) / chunk) + 1);\n    },\n    pad(unpadded) {\n      const unpaddedB = utf8Encoder.encode(unpadded);\n      const len = unpaddedB.length;\n      if (len < 1 || len >= utils.v2.maxPlaintextSize)\n        throw new Error(\"invalid plaintext length: must be between 1b and 64KB\");\n      const paddedLen = utils.v2.calcPadding(len);\n      const zeros = new Uint8Array(paddedLen - len);\n      const lenBuf = new Uint8Array(2);\n      new DataView(lenBuf.buffer).setUint16(0, len);\n      return concatBytes2(lenBuf, unpaddedB, zeros);\n    },\n    unpad(padded) {\n      const unpaddedLen = new DataView(padded.buffer).getUint16(0);\n      const unpadded = padded.subarray(2, 2 + unpaddedLen);\n      if (unpaddedLen === 0 || unpadded.length !== unpaddedLen || padded.length !== 2 + utils.v2.calcPadding(unpaddedLen))\n        throw new Error(\"invalid padding\");\n      return utf8Decoder.decode(unpadded);\n    }\n  }\n};\nfunction encrypt2(key, plaintext, options = {}) {\n  const version = options.version ?? 2;\n  if (version !== 2)\n    throw new Error(\"unknown encryption version \" + version);\n  const salt = options.salt ?? randomBytes2(32);\n  ensureBytes(salt, 32);\n  const keys = utils.v2.getMessageKeys(key, salt);\n  const padded = utils.v2.pad(plaintext);\n  const ciphertext = chacha20(keys.encryption, keys.nonce, padded);\n  const mac = hmac(sha2563, keys.auth, ciphertext);\n  return base642.encode(concatBytes2(new Uint8Array([version]), salt, ciphertext, mac));\n}\nfunction decrypt2(key, ciphertext) {\n  const u = utils.v2;\n  ensureBytes(key, 32);\n  const clen = ciphertext.length;\n  if (clen < u.minCiphertextSize || clen >= u.maxCiphertextSize)\n    throw new Error(\"invalid ciphertext length: \" + clen);\n  if (ciphertext[0] === \"#\")\n    throw new Error(\"unknown encryption version\");\n  let data;\n  try {\n    data = base642.decode(ciphertext);\n  } catch (error) {\n    throw new Error(\"invalid base64: \" + error.message);\n  }\n  const vers = data.subarray(0, 1)[0];\n  if (vers !== 2)\n    throw new Error(\"unknown encryption version \" + vers);\n  const salt = data.subarray(1, 33);\n  const ciphertext_ = data.subarray(33, -32);\n  const mac = data.subarray(-32);\n  const keys = u.getMessageKeys(key, salt);\n  const calculatedMac = hmac(sha2563, keys.auth, ciphertext_);\n  if (!equalBytes(calculatedMac, mac))\n    throw new Error(\"invalid MAC\");\n  const padded = chacha20(keys.encryption, keys.nonce, ciphertext_);\n  return u.unpad(padded);\n}\n\n// nip47.ts\nvar nip47_exports = {};\n__export(nip47_exports, {\n  makeNwcRequestEvent: () => makeNwcRequestEvent,\n  parseConnectionString: () => parseConnectionString\n});\nfunction parseConnectionString(connectionString) {\n  const { pathname, searchParams } = new URL(connectionString);\n  const pubkey = pathname;\n  const relay = searchParams.get(\"relay\");\n  const secret = searchParams.get(\"secret\");\n  if (!pubkey || !relay || !secret) {\n    throw new Error(\"invalid connection string\");\n  }\n  return { pubkey, relay, secret };\n}\nasync function makeNwcRequestEvent({\n  pubkey,\n  secret,\n  invoice\n}) {\n  const content = {\n    method: \"pay_invoice\",\n    params: {\n      invoice\n    }\n  };\n  const encryptedContent = await encrypt(secret, pubkey, JSON.stringify(content));\n  const eventTemplate = {\n    kind: 23194 /* NwcRequest */,\n    created_at: Math.round(Date.now() / 1e3),\n    content: encryptedContent,\n    tags: [[\"p\", pubkey]]\n  };\n  return finishEvent(eventTemplate, secret);\n}\n\n// nip57.ts\nvar nip57_exports = {};\n__export(nip57_exports, {\n  getZapEndpoint: () => getZapEndpoint,\n  makeZapReceipt: () => makeZapReceipt,\n  makeZapRequest: () => makeZapRequest,\n  useFetchImplementation: () => useFetchImplementation3,\n  validateZapRequest: () => validateZapRequest\n});\nimport { bech32 as bech322 } from \"@scure/base\";\nvar _fetch3;\ntry {\n  _fetch3 = fetch;\n} catch {\n}\nfunction useFetchImplementation3(fetchImplementation) {\n  _fetch3 = fetchImplementation;\n}\nasync function getZapEndpoint(metadata) {\n  try {\n    let lnurl = \"\";\n    let { lud06, lud16 } = JSON.parse(metadata.content);\n    if (lud06) {\n      let { words } = bech322.decode(lud06, 1e3);\n      let data = bech322.fromWords(words);\n      lnurl = utf8Decoder.decode(data);\n    } else if (lud16) {\n      let [name, domain] = lud16.split(\"@\");\n      lnurl = `https://${domain}/.well-known/lnurlp/${name}`;\n    } else {\n      return null;\n    }\n    let res = await _fetch3(lnurl);\n    let body = await res.json();\n    if (body.allowsNostr && body.nostrPubkey) {\n      return body.callback;\n    }\n  } catch (err) {\n  }\n  return null;\n}\nfunction makeZapRequest({\n  profile,\n  event,\n  amount,\n  relays,\n  comment = \"\"\n}) {\n  if (!amount)\n    throw new Error(\"amount not given\");\n  if (!profile)\n    throw new Error(\"profile not given\");\n  let zr = {\n    kind: 9734,\n    created_at: Math.round(Date.now() / 1e3),\n    content: comment,\n    tags: [\n      [\"p\", profile],\n      [\"amount\", amount.toString()],\n      [\"relays\", ...relays]\n    ]\n  };\n  if (event) {\n    zr.tags.push([\"e\", event]);\n  }\n  return zr;\n}\nfunction validateZapRequest(zapRequestString) {\n  let zapRequest;\n  try {\n    zapRequest = JSON.parse(zapRequestString);\n  } catch (err) {\n    return \"Invalid zap request JSON.\";\n  }\n  if (!validateEvent(zapRequest))\n    return \"Zap request is not a valid Nostr event.\";\n  if (!verifySignature(zapRequest))\n    return \"Invalid signature on zap request.\";\n  let p = zapRequest.tags.find(([t, v]) => t === \"p\" && v);\n  if (!p)\n    return \"Zap request doesn't have a 'p' tag.\";\n  if (!p[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'p' tag is not valid hex.\";\n  let e = zapRequest.tags.find(([t, v]) => t === \"e\" && v);\n  if (e && !e[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'e' tag is not valid hex.\";\n  let relays = zapRequest.tags.find(([t, v]) => t === \"relays\" && v);\n  if (!relays)\n    return \"Zap request doesn't have a 'relays' tag.\";\n  return null;\n}\nfunction makeZapReceipt({\n  zapRequest,\n  preimage,\n  bolt11,\n  paidAt\n}) {\n  let zr = JSON.parse(zapRequest);\n  let tagsFromZapRequest = zr.tags.filter(([t]) => t === \"e\" || t === \"p\" || t === \"a\");\n  let zap = {\n    kind: 9735,\n    created_at: Math.round(paidAt.getTime() / 1e3),\n    content: \"\",\n    tags: [...tagsFromZapRequest, [\"bolt11\", bolt11], [\"description\", zapRequest]]\n  };\n  if (preimage) {\n    zap.tags.push([\"preimage\", preimage]);\n  }\n  return zap;\n}\n\n// nip98.ts\nvar nip98_exports = {};\n__export(nip98_exports, {\n  getToken: () => getToken,\n  unpackEventFromToken: () => unpackEventFromToken,\n  validateEvent: () => validateEvent2,\n  validateToken: () => validateToken\n});\nimport { base64 as base643 } from \"@scure/base\";\nvar _authorizationScheme = \"Nostr \";\nasync function getToken(loginUrl, httpMethod, sign, includeAuthorizationScheme = false) {\n  if (!loginUrl || !httpMethod)\n    throw new Error(\"Missing loginUrl or httpMethod\");\n  const event = getBlankEvent(27235 /* HttpAuth */);\n  event.tags = [\n    [\"u\", loginUrl],\n    [\"method\", httpMethod]\n  ];\n  event.created_at = Math.round(new Date().getTime() / 1e3);\n  const signedEvent = await sign(event);\n  const authorizationScheme = includeAuthorizationScheme ? _authorizationScheme : \"\";\n  return authorizationScheme + base643.encode(utf8Encoder.encode(JSON.stringify(signedEvent)));\n}\nasync function validateToken(token, url, method) {\n  const event = await unpackEventFromToken(token).catch((error) => {\n    throw error;\n  });\n  const valid = await validateEvent2(event, url, method).catch((error) => {\n    throw error;\n  });\n  return valid;\n}\nasync function unpackEventFromToken(token) {\n  if (!token) {\n    throw new Error(\"Missing token\");\n  }\n  token = token.replace(_authorizationScheme, \"\");\n  const eventB64 = utf8Decoder.decode(base643.decode(token));\n  if (!eventB64 || eventB64.length === 0 || !eventB64.startsWith(\"{\")) {\n    throw new Error(\"Invalid token\");\n  }\n  const event = JSON.parse(eventB64);\n  return event;\n}\nasync function validateEvent2(event, url, method) {\n  if (!event) {\n    throw new Error(\"Invalid nostr event\");\n  }\n  if (!verifySignature(event)) {\n    throw new Error(\"Invalid nostr event, signature invalid\");\n  }\n  if (event.kind !== 27235 /* HttpAuth */) {\n    throw new Error(\"Invalid nostr event, kind invalid\");\n  }\n  if (!event.created_at) {\n    throw new Error(\"Invalid nostr event, created_at invalid\");\n  }\n  if (Math.round(new Date().getTime() / 1e3) - event.created_at > 60) {\n    throw new Error(\"Invalid nostr event, expired\");\n  }\n  const urlTag = event.tags.find((t) => t[0] === \"u\");\n  if (urlTag?.length !== 1 && urlTag?.[1] !== url) {\n    throw new Error(\"Invalid nostr event, url tag invalid\");\n  }\n  const methodTag = event.tags.find((t) => t[0] === \"method\");\n  if (methodTag?.length !== 1 && methodTag?.[1].toLowerCase() !== method.toLowerCase()) {\n    throw new Error(\"Invalid nostr event, method tag invalid\");\n  }\n  return true;\n}\nexport {\n  Kind,\n  SimplePool,\n  eventsGenerator,\n  finishEvent,\n  fakejson_exports as fj,\n  generatePrivateKey,\n  getBlankEvent,\n  getEventHash,\n  getPublicKey,\n  getSignature,\n  matchFilter,\n  matchFilters,\n  mergeFilters,\n  nip04_exports as nip04,\n  nip05_exports as nip05,\n  nip06_exports as nip06,\n  nip10_exports as nip10,\n  nip13_exports as nip13,\n  nip18_exports as nip18,\n  nip19_exports as nip19,\n  nip21_exports as nip21,\n  nip25_exports as nip25,\n  nip26_exports as nip26,\n  nip27_exports as nip27,\n  nip28_exports as nip28,\n  nip39_exports as nip39,\n  nip42_exports as nip42,\n  nip44_exports as nip44,\n  nip47_exports as nip47,\n  nip57_exports as nip57,\n  nip98_exports as nip98,\n  parseReferences,\n  relayInit,\n  serializeEvent,\n  signEvent,\n  utils_exports as utils,\n  validateEvent,\n  verifiedSymbol,\n  verifySignature\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bakeCollectionVariadic = exports.bakeCollectionAwait = exports.bakeCollection = exports.BAKED_EMPTY_FUNC = void 0;\nexports.BAKED_EMPTY_FUNC = (function () { });\nvar FORLOOP_FALLBACK = 1500;\nfunction generateArgsDefCode(numArgs) {\n    var argsDefCode = '';\n    if (numArgs === 0)\n        return argsDefCode;\n    for (var i = 0; i < numArgs - 1; ++i) {\n        argsDefCode += ('arg' + String(i) + ', ');\n    }\n    argsDefCode += ('arg' + String(numArgs - 1));\n    return argsDefCode;\n}\nfunction generateBodyPartsCode(argsDefCode, collectionLength) {\n    var funcDefCode = '', funcCallCode = '';\n    for (var i = 0; i < collectionLength; ++i) {\n        funcDefCode += \"var f\".concat(i, \" = collection[\").concat(i, \"];\\n\");\n        funcCallCode += \"f\".concat(i, \"(\").concat(argsDefCode, \")\\n\");\n    }\n    return { funcDefCode: funcDefCode, funcCallCode: funcCallCode };\n}\nfunction generateBodyPartsVariadicCode(collectionLength) {\n    var funcDefCode = '', funcCallCode = '';\n    for (var i = 0; i < collectionLength; ++i) {\n        funcDefCode += \"var f\".concat(i, \" = collection[\").concat(i, \"];\\n\");\n        funcCallCode += \"f\".concat(i, \".apply(undefined, arguments)\\n\");\n    }\n    return { funcDefCode: funcDefCode, funcCallCode: funcCallCode };\n}\nfunction bakeCollection(collection, fixedArgsNum) {\n    if (collection.length === 0)\n        return exports.BAKED_EMPTY_FUNC;\n    else if (collection.length === 1)\n        return collection[0];\n    var funcFactoryCode;\n    if (collection.length < FORLOOP_FALLBACK) {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        var _a = generateBodyPartsCode(argsDefCode, collection.length), funcDefCode = _a.funcDefCode, funcCallCode = _a.funcCallCode;\n        funcFactoryCode = \"(function(collection) {\\n            \".concat(funcDefCode, \"\\n            collection = undefined;\\n            return (function(\").concat(argsDefCode, \") {\\n                \").concat(funcCallCode, \"\\n            });\\n        })\");\n    }\n    else {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        // loop unroll\n        if (collection.length % 10 === 0) {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; i += 10) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                        collection[i+1](\").concat(argsDefCode, \");\\n                        collection[i+2](\").concat(argsDefCode, \");\\n                        collection[i+3](\").concat(argsDefCode, \");\\n                        collection[i+4](\").concat(argsDefCode, \");\\n                        collection[i+5](\").concat(argsDefCode, \");\\n                        collection[i+6](\").concat(argsDefCode, \");\\n                        collection[i+7](\").concat(argsDefCode, \");\\n                        collection[i+8](\").concat(argsDefCode, \");\\n                        collection[i+9](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n        else if (collection.length % 4 === 0) {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; i += 4) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                        collection[i+1](\").concat(argsDefCode, \");\\n                        collection[i+2](\").concat(argsDefCode, \");\\n                        collection[i+3](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n        else if (collection.length % 3 === 0) {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; i += 3) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                        collection[i+1](\").concat(argsDefCode, \");\\n                        collection[i+2](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n        else {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; ++i) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n    }\n    {\n        // isolate\n        var bakeCollection_1 = undefined;\n        var fixedArgsNum_1 = undefined;\n        var bakeCollectionVariadic_1 = undefined;\n        var bakeCollectionAwait_1 = undefined;\n        var funcFactory = eval(funcFactoryCode);\n        return funcFactory(collection);\n    }\n}\nexports.bakeCollection = bakeCollection;\nfunction bakeCollectionAwait(collection, fixedArgsNum) {\n    if (collection.length === 0)\n        return exports.BAKED_EMPTY_FUNC;\n    else if (collection.length === 1)\n        return collection[0];\n    var funcFactoryCode;\n    if (collection.length < FORLOOP_FALLBACK) {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        var _a = generateBodyPartsCode(argsDefCode, collection.length), funcDefCode = _a.funcDefCode, funcCallCode = _a.funcCallCode;\n        funcFactoryCode = \"(function(collection) {\\n            \".concat(funcDefCode, \"\\n            collection = undefined;\\n            return (function(\").concat(argsDefCode, \") {\\n                return Promise.all([ \").concat(funcCallCode, \" ]);\\n            });\\n        })\");\n    }\n    else {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        funcFactoryCode = \"(function(collection) {\\n            return (function(\".concat(argsDefCode, \") {\\n                var promises = Array(collection.length);\\n                for (var i = 0; i < collection.length; ++i) {\\n                    promises[i] = collection[i](\").concat(argsDefCode, \");\\n                }\\n                return Promise.all(promises);\\n            });\\n        })\");\n    }\n    {\n        // isolate\n        var bakeCollection_2 = undefined;\n        var fixedArgsNum_2 = undefined;\n        var bakeCollectionVariadic_2 = undefined;\n        var bakeCollectionAwait_2 = undefined;\n        var funcFactory = eval(funcFactoryCode);\n        return funcFactory(collection);\n    }\n}\nexports.bakeCollectionAwait = bakeCollectionAwait;\nfunction bakeCollectionVariadic(collection) {\n    if (collection.length === 0)\n        return exports.BAKED_EMPTY_FUNC;\n    else if (collection.length === 1)\n        return collection[0];\n    var funcFactoryCode;\n    if (collection.length < FORLOOP_FALLBACK) {\n        var _a = generateBodyPartsVariadicCode(collection.length), funcDefCode = _a.funcDefCode, funcCallCode = _a.funcCallCode;\n        funcFactoryCode = \"(function(collection) {\\n            \".concat(funcDefCode, \"\\n            collection = undefined;\\n            return (function() {\\n                \").concat(funcCallCode, \"\\n            });\\n        })\");\n    }\n    else {\n        funcFactoryCode = \"(function(collection) {\\n            return (function() {\\n                for (var i = 0; i < collection.length; ++i) {\\n                    collection[i].apply(undefined, arguments);\\n                }\\n            });\\n        })\";\n    }\n    {\n        // isolate\n        var bakeCollection_3 = undefined;\n        var fixedArgsNum = undefined;\n        var bakeCollectionVariadic_3 = undefined;\n        var bakeCollectionAwait_3 = undefined;\n        var funcFactory = eval(funcFactoryCode);\n        return funcFactory(collection);\n    }\n}\nexports.bakeCollectionVariadic = bakeCollectionVariadic;\n//# sourceMappingURL=bake-collection.js.map","\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TaskCollection = exports._fast_remove_single = void 0;\nvar bake_collection_1 = require(\"./bake-collection\");\nfunction push_norebuild(a, b /*, ...func: Func[] */) {\n    var len = this.length;\n    if (len > 1) { // tasks is array\n        if (b) { // if multiple args\n            var _a;\n            (_a = this._tasks).push.apply(_a, arguments);\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            this._tasks.push(a);\n            this.length++;\n        }\n    }\n    else { // tasks is (function or null)\n        if (b) { // if multiple args\n            if (len === 1) { // if this._tasks is function\n                var newAr = Array(1 + arguments.length);\n                newAr.push(newAr);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            else {\n                var newAr = Array(arguments.length);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            if (len === 1)\n                this._tasks = [this._tasks, a];\n            else\n                this._tasks = a;\n            this.length++;\n        }\n    }\n}\nfunction push_rebuild(a, b /*, ...func: Func[] */) {\n    var len = this.length;\n    if (len > 1) { // tasks is array\n        if (b) { // if multiple args\n            var _a;\n            (_a = this._tasks).push.apply(_a, arguments);\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            this._tasks.push(a);\n            this.length++;\n        }\n    }\n    else { // tasks is (function or null)\n        if (b) { // if multiple args\n            if (len === 1) { // if this._tasks is function\n                var newAr = Array(1 + arguments.length);\n                newAr.push(newAr);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            else {\n                var newAr = Array(arguments.length);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            if (len === 1)\n                this._tasks = [this._tasks, a];\n            else\n                this._tasks = a;\n            this.length++;\n        }\n    }\n    if (this.firstEmitBuildStrategy)\n        this.call = rebuild_on_first_call;\n    else\n        this.rebuild();\n}\nfunction _fast_remove_single(arr, index) {\n    if (index === -1)\n        return;\n    if (index === 0)\n        arr.shift();\n    else if (index === arr.length - 1)\n        arr.length = arr.length - 1;\n    else\n        arr.splice(index, 1);\n}\nexports._fast_remove_single = _fast_remove_single;\nfunction removeLast_norebuild(a) {\n    if (this.length === 0)\n        return;\n    if (this.length === 1) {\n        if (this._tasks === a) {\n            this.length = 0;\n        }\n    }\n    else {\n        _fast_remove_single(this._tasks, this._tasks.lastIndexOf(a));\n        if (this._tasks.length === 1) {\n            this._tasks = this._tasks[0];\n            this.length = 1;\n        }\n        else\n            this.length = this._tasks.length;\n    }\n}\nfunction removeLast_rebuild(a) {\n    if (this.length === 0)\n        return;\n    if (this.length === 1) {\n        if (this._tasks === a) {\n            this.length = 0;\n        }\n        if (this.firstEmitBuildStrategy) {\n            this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n            return;\n        }\n        else {\n            this.rebuild();\n            return;\n        }\n    }\n    else {\n        _fast_remove_single(this._tasks, this._tasks.lastIndexOf(a));\n        if (this._tasks.length === 1) {\n            this._tasks = this._tasks[0];\n            this.length = 1;\n        }\n        else\n            this.length = this._tasks.length;\n    }\n    if (this.firstEmitBuildStrategy)\n        this.call = rebuild_on_first_call;\n    else\n        this.rebuild();\n}\nfunction insert_norebuild(index) {\n    var _b;\n    var func = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        func[_i - 1] = arguments[_i];\n    }\n    if (this.length === 0) {\n        this._tasks = func;\n        this.length = 1;\n    }\n    else if (this.length === 1) {\n        func.unshift(this._tasks);\n        this._tasks = func;\n        this.length = this._tasks.length;\n    }\n    else {\n        (_b = this._tasks).splice.apply(_b, __spreadArray([index, 0], func, false));\n        this.length = this._tasks.length;\n    }\n}\nfunction insert_rebuild(index) {\n    var _b;\n    var func = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        func[_i - 1] = arguments[_i];\n    }\n    if (this.length === 0) {\n        this._tasks = func;\n        this.length = 1;\n    }\n    else if (this.length === 1) {\n        func.unshift(this._tasks);\n        this._tasks = func;\n        this.length = this._tasks.length;\n    }\n    else {\n        (_b = this._tasks).splice.apply(_b, __spreadArray([index, 0], func, false));\n        this.length = this._tasks.length;\n    }\n    if (this.firstEmitBuildStrategy)\n        this.call = rebuild_on_first_call;\n    else\n        this.rebuild();\n}\nfunction rebuild_noawait() {\n    if (this.length === 0)\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n    else if (this.length === 1)\n        this.call = this._tasks;\n    else\n        this.call = (0, bake_collection_1.bakeCollection)(this._tasks, this.argsNum);\n}\nfunction rebuild_await() {\n    if (this.length === 0)\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n    else if (this.length === 1)\n        this.call = this._tasks;\n    else\n        this.call = (0, bake_collection_1.bakeCollectionAwait)(this._tasks, this.argsNum);\n}\nfunction rebuild_on_first_call() {\n    this.rebuild();\n    this.call.apply(undefined, arguments);\n}\nvar TaskCollection = /** @class */ (function () {\n    function TaskCollection(argsNum, autoRebuild, initialTasks, awaitTasks) {\n        if (autoRebuild === void 0) { autoRebuild = true; }\n        if (initialTasks === void 0) { initialTasks = null; }\n        if (awaitTasks === void 0) { awaitTasks = false; }\n        this.awaitTasks = awaitTasks;\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n        this.argsNum = argsNum;\n        this.firstEmitBuildStrategy = true;\n        if (awaitTasks)\n            this.rebuild = rebuild_await.bind(this);\n        else\n            this.rebuild = rebuild_noawait.bind(this);\n        this.setAutoRebuild(autoRebuild);\n        if (initialTasks) {\n            if (typeof initialTasks === 'function') {\n                this._tasks = initialTasks;\n                this.length = 1;\n            }\n            else {\n                this._tasks = initialTasks;\n                this.length = initialTasks.length;\n            }\n        }\n        else {\n            this._tasks = null;\n            this.length = 0;\n        }\n        if (autoRebuild)\n            this.rebuild();\n    }\n    return TaskCollection;\n}());\nexports.TaskCollection = TaskCollection;\nfunction fastClear() {\n    this._tasks = null;\n    this.length = 0;\n    this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n}\nfunction clear() {\n    this._tasks = null;\n    this.length = 0;\n    this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n}\nfunction growArgsNum(argsNum) {\n    if (this.argsNum < argsNum) {\n        this.argsNum = argsNum;\n        if (this.firstEmitBuildStrategy)\n            this.call = rebuild_on_first_call;\n        else\n            this.rebuild();\n    }\n}\nfunction setAutoRebuild(newVal) {\n    if (newVal) {\n        this.push = push_rebuild.bind(this);\n        this.insert = insert_rebuild.bind(this);\n        this.removeLast = removeLast_rebuild.bind(this);\n    }\n    else {\n        this.push = push_norebuild.bind(this);\n        this.insert = insert_norebuild.bind(this);\n        this.removeLast = removeLast_norebuild.bind(this);\n    }\n}\n;\nfunction tasksAsArray() {\n    if (this.length === 0)\n        return [];\n    if (this.length === 1)\n        return [this._tasks];\n    return this._tasks;\n}\nfunction setTasks(tasks) {\n    if (tasks.length === 0) {\n        this.length = 0;\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n    }\n    else if (tasks.length === 1) {\n        this.length = 1;\n        this.call = tasks[0];\n        this._tasks = tasks[0];\n    }\n    else {\n        this.length = tasks.length;\n        this._tasks = tasks;\n        if (this.firstEmitBuildStrategy)\n            this.call = rebuild_on_first_call;\n        else\n            this.rebuild();\n    }\n}\nTaskCollection.prototype.fastClear = fastClear;\nTaskCollection.prototype.clear = clear;\nTaskCollection.prototype.growArgsNum = growArgsNum;\nTaskCollection.prototype.setAutoRebuild = setAutoRebuild;\nTaskCollection.prototype.tasksAsArray = tasksAsArray;\nTaskCollection.prototype.setTasks = setTasks;\n//# sourceMappingURL=task-collection.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./task-collection\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.nullObj = void 0;\nfunction nullObj() {\n    var x = {};\n    x.__proto__ = null;\n    x.prototype = null;\n    return x;\n}\nexports.nullObj = nullObj;\n//# sourceMappingURL=utils.js.map","\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventEmitter = void 0;\nvar task_collection_1 = require(\"./task-collection\");\nvar utils_1 = require(\"./utils\");\nfunction emit(event, a, b, c, d, e) {\n    var ev = this.events[event];\n    if (ev) {\n        if (ev.length === 0)\n            return false;\n        if (ev.argsNum < 6) {\n            ev.call(a, b, c, d, e);\n        }\n        else {\n            ev.call.apply(undefined, arguments);\n        }\n        return true;\n    }\n    return false;\n}\nfunction emitHasOnce(event, a, b, c, d, e) {\n    var ev = this.events[event];\n    if (ev) {\n        if (ev.length === 0)\n            return false;\n        if (ev.argsNum < 6) {\n            ev.call(a, b, c, d, e);\n        }\n        else {\n            ev.call.apply(undefined, arguments);\n        }\n    }\n    var oev = this.onceEvents[event];\n    if (oev) {\n        if (typeof oev === 'function') {\n            this.onceEvents[event] = undefined;\n            if (arguments.length < 6) {\n                oev(a, b, c, d, e);\n            }\n            else {\n                oev.apply(undefined, arguments);\n            }\n        }\n        else {\n            var fncs = oev;\n            this.onceEvents[event] = undefined;\n            if (arguments.length < 6) {\n                for (var i = 0; i < fncs.length; ++i)\n                    fncs[i](a, b, c, d, e);\n            }\n            else {\n                for (var i = 0; i < fncs.length; ++i)\n                    fncs[i].apply(undefined, arguments);\n            }\n        }\n        return true;\n    }\n    return !!ev;\n}\n/** Implemented event emitter */\nvar EventEmitter = /** @class */ (function () {\n    function EventEmitter() {\n        this.events = (0, utils_1.nullObj)();\n        this.onceEvents = (0, utils_1.nullObj)();\n        this._symbolKeys = new Set;\n        this.maxListeners = Infinity;\n    }\n    Object.defineProperty(EventEmitter.prototype, \"_eventsCount\", {\n        get: function () {\n            return this.eventNames().length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return EventEmitter;\n}());\nexports.EventEmitter = EventEmitter;\nfunction once(event, listener) {\n    if (this.emit === emit) {\n        this.emit = emitHasOnce;\n    }\n    switch (typeof this.onceEvents[event]) {\n        case 'undefined':\n            this.onceEvents[event] = listener;\n            if (typeof event === 'symbol')\n                this._symbolKeys.add(event);\n            break;\n        case 'function':\n            this.onceEvents[event] = [this.onceEvents[event], listener];\n            break;\n        case 'object':\n            this.onceEvents[event].push(listener);\n    }\n    return this;\n}\nfunction addListener(event, listener, argsNum) {\n    if (argsNum === void 0) { argsNum = listener.length; }\n    if (typeof listener !== 'function')\n        throw new TypeError('The listener must be a function');\n    var evtmap = this.events[event];\n    if (!evtmap) {\n        this.events[event] = new task_collection_1.TaskCollection(argsNum, true, listener, false);\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else {\n        evtmap.push(listener);\n        evtmap.growArgsNum(argsNum);\n        if (this.maxListeners !== Infinity && this.maxListeners <= evtmap.length)\n            console.warn(\"Maximum event listeners for \\\"\".concat(String(event), \"\\\" event!\"));\n    }\n    return this;\n}\nfunction removeListener(event, listener) {\n    var evt = this.events[event];\n    if (evt) {\n        evt.removeLast(listener);\n    }\n    var evto = this.onceEvents[event];\n    if (evto) {\n        if (typeof evto === 'function') {\n            this.onceEvents[event] = undefined;\n        }\n        else if (typeof evto === 'object') {\n            if (evto.length === 1 && evto[0] === listener) {\n                this.onceEvents[event] = undefined;\n            }\n            else {\n                (0, task_collection_1._fast_remove_single)(evto, evto.lastIndexOf(listener));\n            }\n        }\n    }\n    return this;\n}\nfunction addListenerBound(event, listener, bindTo, argsNum) {\n    if (bindTo === void 0) { bindTo = this; }\n    if (argsNum === void 0) { argsNum = listener.length; }\n    if (!this.boundFuncs)\n        this.boundFuncs = new Map;\n    var bound = listener.bind(bindTo);\n    this.boundFuncs.set(listener, bound);\n    return this.addListener(event, bound, argsNum);\n}\nfunction removeListenerBound(event, listener) {\n    var _a, _b;\n    var bound = (_a = this.boundFuncs) === null || _a === void 0 ? void 0 : _a.get(listener);\n    (_b = this.boundFuncs) === null || _b === void 0 ? void 0 : _b.delete(listener);\n    return this.removeListener(event, bound);\n}\nfunction hasListeners(event) {\n    return this.events[event] && !!this.events[event].length;\n}\nfunction prependListener(event, listener, argsNum) {\n    if (argsNum === void 0) { argsNum = listener.length; }\n    if (typeof listener !== 'function')\n        throw new TypeError('The listener must be a function');\n    var evtmap = this.events[event];\n    if (!evtmap || !(evtmap instanceof task_collection_1.TaskCollection)) {\n        evtmap = this.events[event] = new task_collection_1.TaskCollection(argsNum, true, listener, false);\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else {\n        evtmap.insert(0, listener);\n        evtmap.growArgsNum(argsNum);\n        if (this.maxListeners !== Infinity && this.maxListeners <= evtmap.length)\n            console.warn(\"Maximum event listeners for \\\"\".concat(String(event), \"\\\" event!\"));\n    }\n    return this;\n}\nfunction prependOnceListener(event, listener) {\n    if (this.emit === emit) {\n        this.emit = emitHasOnce;\n    }\n    var evtmap = this.onceEvents[event];\n    if (!evtmap) {\n        this.onceEvents[event] = [listener];\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else if (typeof evtmap !== 'object') {\n        this.onceEvents[event] = [listener, evtmap];\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else {\n        evtmap.unshift(listener);\n        if (this.maxListeners !== Infinity && this.maxListeners <= evtmap.length) {\n            console.warn(\"Maximum event listeners for \\\"\".concat(String(event), \"\\\" once event!\"));\n        }\n    }\n    return this;\n}\nfunction removeAllListeners(event) {\n    if (event === undefined) {\n        this.events = (0, utils_1.nullObj)();\n        this.onceEvents = (0, utils_1.nullObj)();\n        this._symbolKeys = new Set;\n    }\n    else {\n        this.events[event] = undefined;\n        this.onceEvents[event] = undefined;\n        if (typeof event === 'symbol')\n            this._symbolKeys.delete(event);\n    }\n    return this;\n}\nfunction setMaxListeners(n) {\n    this.maxListeners = n;\n    return this;\n}\nfunction getMaxListeners() {\n    return this.maxListeners;\n}\nfunction listeners(event) {\n    if (this.emit === emit)\n        return this.events[event] ? this.events[event].tasksAsArray().slice() : [];\n    else {\n        if (this.events[event] && this.onceEvents[event]) {\n            return __spreadArray(__spreadArray([], this.events[event].tasksAsArray(), true), (typeof this.onceEvents[event] === 'function' ? [this.onceEvents[event]] : this.onceEvents[event]), true);\n        }\n        else if (this.events[event])\n            return this.events[event].tasksAsArray();\n        else if (this.onceEvents[event])\n            return (typeof this.onceEvents[event] === 'function' ? [this.onceEvents[event]] : this.onceEvents[event]);\n        else\n            return [];\n    }\n}\nfunction eventNames() {\n    var _this = this;\n    if (this.emit === emit) {\n        var keys = Object.keys(this.events);\n        return __spreadArray(__spreadArray([], keys, true), Array.from(this._symbolKeys), true).filter(function (x) { return (x in _this.events) && _this.events[x] && _this.events[x].length; });\n    }\n    else {\n        var keys = Object.keys(this.events).filter(function (x) { return _this.events[x] && _this.events[x].length; });\n        var keysO = Object.keys(this.onceEvents).filter(function (x) { return _this.onceEvents[x] && _this.onceEvents[x].length; });\n        return __spreadArray(__spreadArray(__spreadArray([], keys, true), keysO, true), Array.from(this._symbolKeys).filter(function (x) { return (((x in _this.events) && _this.events[x] && _this.events[x].length) ||\n            ((x in _this.onceEvents) && _this.onceEvents[x] && _this.onceEvents[x].length)); }), true);\n    }\n}\nfunction listenerCount(type) {\n    if (this.emit === emit)\n        return this.events[type] && this.events[type].length || 0;\n    else\n        return (this.events[type] && this.events[type].length || 0) + (this.onceEvents[type] && this.onceEvents[type].length || 0);\n}\nEventEmitter.prototype.emit = emit;\nEventEmitter.prototype.on = addListener;\nEventEmitter.prototype.once = once;\nEventEmitter.prototype.addListener = addListener;\nEventEmitter.prototype.removeListener = removeListener;\nEventEmitter.prototype.addListenerBound = addListenerBound;\nEventEmitter.prototype.removeListenerBound = removeListenerBound;\nEventEmitter.prototype.hasListeners = hasListeners;\nEventEmitter.prototype.prependListener = prependListener;\nEventEmitter.prototype.prependOnceListener = prependOnceListener;\nEventEmitter.prototype.off = removeListener;\nEventEmitter.prototype.removeAllListeners = removeAllListeners;\nEventEmitter.prototype.setMaxListeners = setMaxListeners;\nEventEmitter.prototype.getMaxListeners = getMaxListeners;\nEventEmitter.prototype.listeners = listeners;\nEventEmitter.prototype.eventNames = eventNames;\nEventEmitter.prototype.listenerCount = listenerCount;\n//# sourceMappingURL=ee.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./types\"), exports);\n__exportStar(require(\"./ee\"), exports);\n//# sourceMappingURL=index.js.map","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\tcreateDebug.destroy = destroy;\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\t\tlet enableOverride = null;\n\t\tlet namespacesCache;\n\t\tlet enabledCache;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn '%';\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = createDebug.selectColor(namespace);\n\t\tdebug.extend = extend;\n\t\tdebug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.\n\n\t\tObject.defineProperty(debug, 'enabled', {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget: () => {\n\t\t\t\tif (enableOverride !== null) {\n\t\t\t\t\treturn enableOverride;\n\t\t\t\t}\n\t\t\t\tif (namespacesCache !== createDebug.namespaces) {\n\t\t\t\t\tnamespacesCache = createDebug.namespaces;\n\t\t\t\t\tenabledCache = createDebug.enabled(namespace);\n\t\t\t\t}\n\n\t\t\t\treturn enabledCache;\n\t\t\t},\n\t\t\tset: v => {\n\t\t\t\tenableOverride = v;\n\t\t\t}\n\t\t});\n\n\t\t// Env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\treturn debug;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\t\tcreateDebug.namespaces = namespaces;\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.slice(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\t/**\n\t* XXX DO NOT USE. This is a temporary stub function.\n\t* XXX It WILL be removed in the next major release.\n\t*/\n\tfunction destroy() {\n\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\nexports.destroy = (() => {\n\tlet warned = false;\n\n\treturn () => {\n\t\tif (!warned) {\n\t\t\twarned = true;\n\t\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t\t}\n\t};\n})();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n *\n * @api public\n */\nexports.log = console.debug || console.log || (() => {});\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`positive integer expected, not ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`boolean expected, not ${b}`);\n}\n// copied from utils\nexport function isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Uint8Array expected of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(h) {\n    if (typeof h !== 'function' || typeof h.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(h.outputLen);\n    number(h.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nimport { bytes as abytes } from './_assert.js';\n// export { isBytes } from './_assert.js';\n// We can't reuse isBytes from _assert, because somehow this causes huge perf issues\nexport function isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// The rotate left (circular left shift) operation for uint32\nexport const rotl = (word, shift) => (word << shift) | ((word >>> (32 - shift)) >>> 0);\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\n// The byte swap operation for uint32\nexport const byteSwap = (word) => ((word << 24) & 0xff000000) |\n    ((word << 8) & 0xff0000) |\n    ((word >>> 8) & 0xff00) |\n    ((word >>> 24) & 0xff);\n// Conditionally byte swap if on a big-endian platform\nexport const byteSwapIfBE = isLE ? (n) => n : (n) => byteSwap(n);\n// In place byte swap for Uint32Array\nexport function byteSwap32(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = byteSwap(arr[i]);\n    }\n}\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    abytes(data);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Choice: a ? b : c\nexport const Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nexport const Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nexport class HashMD extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in\n        // current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_md.js.map","import { HashMD, Chi, Maj } from './_md.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state:\n// first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19\n// prettier-ignore\nconst SHA256_IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends HashMD {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = SHA256_IV[0] | 0;\n        this.B = SHA256_IV[1] | 0;\n        this.C = SHA256_IV[2] | 0;\n        this.D = SHA256_IV[3] | 0;\n        this.E = SHA256_IV[4] | 0;\n        this.F = SHA256_IV[5] | 0;\n        this.G = SHA256_IV[6] | 0;\n        this.H = SHA256_IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nexport function isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nexport function abytes(item) {\n    if (!isBytes(item))\n        throw new Error('Uint8Array expected');\n}\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nexport function numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? `0${hex}` : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    abytes(bytes);\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(`${title} must be valid hex string, got \"${hex}\". Cause: ${e}`);\n        }\n    }\n    else if (isBytes(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(`${title} must be hex string or Uint8Array`);\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(`${title} expected ${expectedLength} bytes, got ${len}`);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// Compares 2 u8a-s in kinda constant time\nexport function equalBytes(a, b) {\n    if (a.length !== b.length)\n        return false;\n    let diff = 0;\n    for (let i = 0; i < a.length; i++)\n        diff |= a[i] ^ b[i];\n    return diff === 0;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nexport function bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nexport function bitSet(n, pos, value) {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n}\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    stringOrUint8Array: (val) => typeof val === 'string' || isBytes(val),\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nexport function validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error(`Invalid validator \"${type}\", expected function`);\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error(`Invalid param ${String(fieldName)}=${val} (${typeof val}), expected ${type}`);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n//# sourceMappingURL=utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities for modular arithmetics and finite fields\nimport { bitMask, numberToBytesBE, numberToBytesLE, bytesToNumberBE, bytesToNumberLE, ensureBytes, validateObject, } from './utils.js';\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _4n = BigInt(4), _5n = BigInt(5), _8n = BigInt(8);\n// prettier-ignore\nconst _9n = BigInt(9), _16n = BigInt(16);\n// Calculates a modulo b\nexport function mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\n// TODO: use field version && remove\nexport function pow(num, power, modulo) {\n    if (modulo <= _0n || power < _0n)\n        throw new Error('Expected power/modulo > 0');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n// Does x ^ (2 ^ power) mod p. pow2(30, 4) == 30 ^ (2 ^ 4)\nexport function pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n// Inverses number over modulo\nexport function invert(number, modulo) {\n    if (number === _0n || modulo <= _0n) {\n        throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    // Euclidean GCD https://brilliant.org/wiki/extended-euclidean-algorithm/\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n/**\n * Tonelli-Shanks square root search algorithm.\n * 1. https://eprint.iacr.org/2012/685.pdf (page 12)\n * 2. Square Roots from 1; 24, 51, 10 to Dan Shanks\n * Will start an infinite loop if field order P is not prime.\n * @param P field order\n * @returns function that takes field Fp (created from P) and number n\n */\nexport function tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p)  1    if a is a square (mod p)\n    // (a | p)  -1   if a is not a square (mod p)\n    // (a | p)  0    if a  0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p)  -1 and set c  zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++)\n        ;\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be  -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\nexport function FpSqrt(P) {\n    // NOTE: different algorithms can give different roots, it is up to user to decide which one they want.\n    // For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n    // P  3 (mod 4)\n    // n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q  5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P  9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nexport function validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return validateObject(field, opts);\n}\n// Generic field functions\n/**\n * Same as `pow` but for Fp: non-constant-time.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n */\nexport function FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('Expected power > 0');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n/**\n * Efficiently invert an array of Field elements.\n * `inv(0)` will return `undefined` here: make sure to throw an error.\n */\nexport function FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nexport function FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare(f) {\n    const legendreConst = (f.ORDER - _1n) / _2n; // Integer arithmetic\n    return (x) => {\n        const p = f.pow(x, legendreConst);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nexport function nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a finite field over prime. **Non-primes are not supported.**\n * Do not init in loop: slow. Very fragile: always run a benchmark on a change.\n * Major performance optimizations:\n * * a) denormalized operations like mulN instead of mul\n * * b) same object shape: never add or remove keys\n * * c) Object.freeze\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error(`Expected Field ORDER > 0, got ${ORDER}`);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('Field lengths over 2048 bytes are not supported');\n    const sqrtP = FpSqrt(ORDER);\n    const f = Object.freeze({\n        ORDER,\n        BITS,\n        BYTES,\n        MASK: bitMask(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error(`Invalid field element: expected bigint, got ${typeof num}`);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt || ((n) => sqrtP(f, n)),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error(`Fp.fromBytes: expected ${BYTES}, got ${bytes.length}`);\n            return isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nexport function FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nexport function FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Same as mapKeyToField, but accepts less bytes (40 instead of 48 for 32-byte field).\n * Which makes it slightly more biased, less secure.\n * @deprecated use mapKeyToField instead\n */\nexport function hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = ensureBytes('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error(`hashToPrivateScalar: expected ${minLen}-1024 bytes of input, got ${hashLen}`);\n    const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n/**\n * Returns total number of bytes consumed by the field element.\n * For example, 32 bytes for usual 256-bit weierstrass curve.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of field\n */\nexport function getFieldBytesLength(fieldOrder) {\n    if (typeof fieldOrder !== 'bigint')\n        throw new Error('field order must be bigint');\n    const bitLength = fieldOrder.toString(2).length;\n    return Math.ceil(bitLength / 8);\n}\n/**\n * Returns minimal amount of bytes that can be safely reduced\n * by field order.\n * Should be 2^-128 for 128-bit curve such as P256.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of target hash\n */\nexport function getMinHashLength(fieldOrder) {\n    const length = getFieldBytesLength(fieldOrder);\n    return length + Math.ceil(length / 2);\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Can take (n + n/2) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 48 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * FIPS 186-5, A.2 https://csrc.nist.gov/publications/detail/fips/186/5/final\n * RFC 9380, https://www.rfc-editor.org/rfc/rfc9380#section-5\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. secp256k1.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function mapHashToField(key, fieldOrder, isLE = false) {\n    const len = key.length;\n    const fieldLen = getFieldBytesLength(fieldOrder);\n    const minLen = getMinHashLength(fieldOrder);\n    // No small numbers: need to understand bias story. No huge numbers: easier to detect JS timings.\n    if (len < 16 || len < minLen || len > 1024)\n        throw new Error(`expected ${minLen}-1024 bytes of input, got ${len}`);\n    const num = isLE ? bytesToNumberBE(key) : bytesToNumberLE(key);\n    // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n    const reduced = mod(num, fieldOrder - _1n) + _1n;\n    return isLE ? numberToBytesLE(reduced, fieldLen) : numberToBytesBE(reduced, fieldLen);\n}\n//# sourceMappingURL=modular.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Abelian group utilities\nimport { validateField, nLength } from './modular.js';\nimport { validateObject } from './utils.js';\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n// Elliptic curve multiplication of Point by scalar. Fragile.\n// Scalars should always be less than curve order: this should be checked inside of a curve itself.\n// Creates precomputation tables for fast multiplication:\n// - private scalar is split by fixed size windows of W bits\n// - every window point is collected from window's table & added to accumulator\n// - since windows are different, same point inside tables won't be accessed more than once per calc\n// - each multiplication is 'Math.ceil(CURVE_ORDER / ) + 1' point additions (fixed for any scalar)\n// - +1 window is neccessary for wNAF\n// - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n// TODO: Research returning 2d JS array of windows, instead of a single window. This would allow\n// windows to be in different memory locations\nexport function wNAF(c, bits) {\n    const constTimeNegate = (condition, item) => {\n        const neg = item.negate();\n        return condition ? neg : item;\n    };\n    const opts = (W) => {\n        const windows = Math.ceil(bits / W) + 1; // +1, because\n        const windowSize = 2 ** (W - 1); // -1 because we skip zero\n        return { windows, windowSize };\n    };\n    return {\n        constTimeNegate,\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n) {\n            let p = c.ZERO;\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(1) * (Math.ceil( / ) + 1), where:\n         * -  is the window size\n         * -  is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = opts(W);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = opts(W);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        wNAFCached(P, precomputesMap, n, transform) {\n            // @ts-ignore\n            const W = P._WINDOW_SIZE || 1;\n            // Calculate precomputes on a first run, reuse them after\n            let comp = precomputesMap.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1) {\n                    precomputesMap.set(P, transform(comp));\n                }\n            }\n            return this.wNAF(W, comp, n);\n        },\n    };\n}\nexport function validateBasic(curve) {\n    validateField(curve.Fp);\n    validateObject(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...nLength(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Short Weierstrass curve. The formula is: y = x + ax + b\nimport * as mod from './modular.js';\nimport * as ut from './utils.js';\nimport { ensureBytes } from './utils.js';\nimport { wNAF, validateBasic } from './curve.js';\nfunction validatePointOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('Endomorphism can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('Expected endomorphism with beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\n// ASN.1 DER encoding utilities\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nexport const DER = {\n    // asn.1 DER encoding utils\n    Err: class DERErr extends Error {\n        constructor(m = '') {\n            super(m);\n        }\n    },\n    _parseInt(data) {\n        const { Err: E } = DER;\n        if (data.length < 2 || data[0] !== 0x02)\n            throw new E('Invalid signature integer tag');\n        const len = data[1];\n        const res = data.subarray(2, len + 2);\n        if (!len || res.length !== len)\n            throw new E('Invalid signature integer: wrong length');\n        // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n        // since we always use positive integers here. It must always be empty:\n        // - add zero byte if exists\n        // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n        if (res[0] & 0b10000000)\n            throw new E('Invalid signature integer: negative');\n        if (res[0] === 0x00 && !(res[1] & 0b10000000))\n            throw new E('Invalid signature integer: unnecessary leading zero');\n        return { d: b2n(res), l: data.subarray(len + 2) }; // d is data, l is left\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E } = DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        ut.abytes(data);\n        let l = data.length;\n        if (l < 2 || data[0] != 0x30)\n            throw new E('Invalid signature tag');\n        if (data[1] !== l - 2)\n            throw new E('Invalid signature: incorrect length');\n        const { d: r, l: sBytes } = DER._parseInt(data.subarray(2));\n        const { d: s, l: rBytesLeft } = DER._parseInt(sBytes);\n        if (rBytesLeft.length)\n            throw new E('Invalid signature: left bytes after parsing');\n        return { r, s };\n    },\n    hexFromSig(sig) {\n        // Add leading zero if first byte has negative bit enabled. More details in '_parseInt'\n        const slice = (s) => (Number.parseInt(s[0], 16) & 0b1000 ? '00' + s : s);\n        const h = (num) => {\n            const hex = num.toString(16);\n            return hex.length & 1 ? `0${hex}` : hex;\n        };\n        const s = slice(h(sig.s));\n        const r = slice(h(sig.r));\n        const shl = s.length / 2;\n        const rhl = r.length / 2;\n        const sl = h(shl);\n        const rl = h(rhl);\n        return `30${h(rhl + shl + 4)}02${rl}${r}02${sl}${s}`;\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nexport function weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const toBytes = CURVE.toBytes ||\n        ((_c, point, _isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y = x + ax + b: Short weierstrass curve formula\n     * @returns y\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return typeof num === 'bigint' && _0n < num && num < CURVE.n;\n    }\n    function assertGE(num) {\n        if (!isWithinCurveOrder(num))\n            throw new Error('Expected valid bigint: 0 < bigint < curve.n');\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (ut.isBytes(key))\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('Invalid key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE(ensureBytes('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error(`private key must be ${nByteLength} bytes, hex or bigint, not ${typeof key}`);\n        }\n        if (wrapPrivateKey)\n            num = mod.mod(num, n); // disabled by default, enabled for BLS\n        assertGE(num); // num in range [1..N-1]\n        return num;\n    }\n    const pointPrecomputes = new Map();\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z)  (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes(ensureBytes('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            this._WINDOW_SIZE = windowSize;\n            pointPrecomputes.delete(this);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            if (this.is0()) {\n                // (0, 1, 0) aka ZERO is invalid in most contexts.\n                // In BLS, ZERO can be serialized, so we allow it.\n                // (0, 0, 0) is wrong representation of ZERO and is always invalid.\n                if (CURVE.allowInfinityPoint && !Fp.is0(this.py))\n                    return;\n                throw new Error('bad point: ZERO');\n            }\n            // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n            const { x, y } = this.toAffine();\n            // Check if x, y are valid field elements\n            if (!Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('bad point: x or y not FE');\n            const left = Fp.sqr(y); // y\n            const right = weierstrassEquation(x); // x + ax + b\n            if (!Fp.eql(left, right))\n                throw new Error('bad point: equation left != right');\n            if (!this.isTorsionFree())\n                throw new Error('bad point: not in prime-order subgroup');\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, pointPrecomputes, n, (comp) => {\n                const toInv = Fp.invertBatch(comp.map((p) => p.pz));\n                return comp.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n            });\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(n) {\n            const I = Point.ZERO;\n            if (n === _0n)\n                return I;\n            assertGE(n); // Will throw on 0\n            if (n === _1n)\n                return this;\n            const { endo } = CURVE;\n            if (!endo)\n                return wnaf.unsafeLadder(this, n);\n            // Apply endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            assertGE(scalar);\n            let n = scalar;\n            let point, fake; // Fake point is used to const-time mult\n            const { endo } = CURVE;\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(n);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z)  (x=x/z, y=y/z)\n        toAffine(iz) {\n            const { px: x, py: y, pz: z } = this;\n            const is0 = this.is0();\n            // If invZ was 0, we return zero point. However we still want to execute\n            // all operations, so we replace invZ with a random number, 1.\n            if (iz == null)\n                iz = is0 ? Fp.ONE : Fp.inv(z);\n            const ax = Fp.mul(x, iz);\n            const ay = Fp.mul(y, iz);\n            const zz = Fp.mul(z, iz);\n            if (is0)\n                return { x: Fp.ZERO, y: Fp.ZERO };\n            if (!Fp.eql(zz, Fp.ONE))\n                throw new Error('invZ was invalid');\n            return { x: ax, y: ay };\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = wNAF(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\nexport function weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function isValidFieldElement(num) {\n        return _0n < num && num < Fp.ORDER; // 0 is banned since it's not invertible FE\n    }\n    function modN(a) {\n        return mod.mod(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return mod.invert(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(_c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!isValidFieldElement(x))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y = x + ax + b\n                let y;\n                try {\n                    y = Fp.sqrt(y2); // y = y ^ (p+1)/4\n                }\n                catch (sqrtError) {\n                    const suffix = sqrtError instanceof Error ? ': ' + sqrtError.message : '';\n                    throw new Error('Point is not on curve' + suffix);\n                }\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                throw new Error(`Point of length ${len} was invalid. Expected ${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes`);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = ensureBytes('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = DER.toSig(ensureBytes('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            // can use assertGE here\n            if (!isWithinCurveOrder(this.r))\n                throw new Error('r must be 0 < r < CURVE.n');\n            if (!isWithinCurveOrder(this.s))\n                throw new Error('s must be 0 < s < CURVE.n');\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN(ensureBytes('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size\n         * (groupLen + ceil(groupLen / 2)) with modulo bias being negligible.\n         */\n        randomPrivateKey: () => {\n            const length = mod.getMinHashLength(CURVE.n);\n            return mod.mapHashToField(CURVE.randomBytes(length), CURVE.n);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = ut.isBytes(item);\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        if (typeof num !== 'bigint')\n            throw new Error('bigint expected');\n        if (!(_0n <= num && num < ORDER_MASK))\n            throw new Error(`bigint expected < 2^${CURVE.nBitLength}`);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order, this will be wrong at least for P521.\n    // Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = ensureBytes('msgHash', msgHash);\n        if (prehash)\n            msgHash = ensureBytes('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null && ent !== false) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push(ensureBytes('extraEntropy', e)); // check for being bytes\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b  [1,q1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G  k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1G - U2P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = ensureBytes('msgHash', msgHash);\n        publicKey = ensureBytes('publicKey', publicKey);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        const { lowS, prehash } = opts;\n        let _sig = undefined;\n        let P;\n        try {\n            if (typeof sg === 'string' || ut.isBytes(sg)) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof DER.Err))\n                        throw derError;\n                    _sig = Signature.fromCompact(sg);\n                }\n            }\n            else if (typeof sg === 'object' && typeof sg.r === 'bigint' && typeof sg.s === 'bigint') {\n                const { r, s } = sg;\n                _sig = new Signature(r, s);\n            }\n            else {\n                throw new Error('PARSE');\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            if (error.message === 'PARSE')\n                throw new Error(`signature must be Signature instance, Uint8Array or hex string`);\n            return false;\n        }\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1G + u2P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * Simplified Shallue-van de Woestijne-Ulas Method\n * https://www.rfc-editor.org/rfc/rfc9380#section-6.6.2\n */\nexport function mapToCurveSimpleSWU(Fp, opts) {\n    mod.validateField(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac } from '@noble/hashes/hmac';\nimport { concatBytes, randomBytes } from '@noble/hashes/utils';\nimport { weierstrass } from './abstract/weierstrass.js';\n// connects noble-curves to noble-hashes\nexport function getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => hmac(hash, key, concatBytes(...msgs)),\n        randomBytes,\n    };\n}\nexport function createCurve(curveDef, defHash) {\n    const create = (hash) => weierstrass({ ...curveDef, ...getHash(hash) });\n    return Object.freeze({ ...create(defHash), create });\n}\n//# sourceMappingURL=_shortw_utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256 } from '@noble/hashes/sha256';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { Field, mod, pow2 } from './abstract/modular.js';\nimport { mapToCurveSimpleSWU } from './abstract/weierstrass.js';\nimport { bytesToNumberBE, concatBytes, ensureBytes, numberToBytesBE } from './abstract/utils.js';\nimport { createHasher, isogenyMap } from './abstract/hash-to-curve.js';\nimport { createCurve } from './_shortw_utils.js';\nconst secp256k1P = BigInt('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f');\nconst secp256k1N = BigInt('0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141');\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst divNearest = (a, b) => (a + b / _2n) / b;\n/**\n * n = n^((p+1)/4) for fields p = 3 mod 4. We unwrap the loop and multiply bit-by-bit.\n * (P+1n/4n).toString(2) would produce bits [223x 1, 0, 22x 1, 4x 0, 11, 00]\n */\nfunction sqrtMod(y) {\n    const P = secp256k1P;\n    // prettier-ignore\n    const _3n = BigInt(3), _6n = BigInt(6), _11n = BigInt(11), _22n = BigInt(22);\n    // prettier-ignore\n    const _23n = BigInt(23), _44n = BigInt(44), _88n = BigInt(88);\n    const b2 = (y * y * y) % P; // x^3, 11\n    const b3 = (b2 * b2 * y) % P; // x^7\n    const b6 = (pow2(b3, _3n, P) * b3) % P;\n    const b9 = (pow2(b6, _3n, P) * b3) % P;\n    const b11 = (pow2(b9, _2n, P) * b2) % P;\n    const b22 = (pow2(b11, _11n, P) * b11) % P;\n    const b44 = (pow2(b22, _22n, P) * b22) % P;\n    const b88 = (pow2(b44, _44n, P) * b44) % P;\n    const b176 = (pow2(b88, _88n, P) * b88) % P;\n    const b220 = (pow2(b176, _44n, P) * b44) % P;\n    const b223 = (pow2(b220, _3n, P) * b3) % P;\n    const t1 = (pow2(b223, _23n, P) * b22) % P;\n    const t2 = (pow2(t1, _6n, P) * b2) % P;\n    const root = pow2(t2, _2n, P);\n    if (!Fp.eql(Fp.sqr(root), y))\n        throw new Error('Cannot find square root');\n    return root;\n}\nconst Fp = Field(secp256k1P, undefined, undefined, { sqrt: sqrtMod });\nexport const secp256k1 = createCurve({\n    a: BigInt(0), // equation params: a, b\n    b: BigInt(7), // Seem to be rigid: bitcointalk.org/index.php?topic=289795.msg3183975#msg3183975\n    Fp, // Field's prime: 2n**256n - 2n**32n - 2n**9n - 2n**8n - 2n**7n - 2n**6n - 2n**4n - 1n\n    n: secp256k1N, // Curve order, total count of valid points in the field\n    // Base point (x, y) aka generator point\n    Gx: BigInt('55066263022277343669578718895168534326250603453777594175500187360389116729240'),\n    Gy: BigInt('32670510020758816978083085130507043184471273380659243275938904335757337482424'),\n    h: BigInt(1), // Cofactor\n    lowS: true, // Allow only low-S signatures by default in sign() and verify()\n    /**\n     * secp256k1 belongs to Koblitz curves: it has efficiently computable endomorphism.\n     * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n     * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n     * Explanation: https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066\n     */\n    endo: {\n        beta: BigInt('0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee'),\n        splitScalar: (k) => {\n            const n = secp256k1N;\n            const a1 = BigInt('0x3086d221a7d46bcde86c90e49284eb15');\n            const b1 = -_1n * BigInt('0xe4437ed6010e88286f547fa90abfe4c3');\n            const a2 = BigInt('0x114ca50f7a8e2f3f657c1108d9d44cfd8');\n            const b2 = a1;\n            const POW_2_128 = BigInt('0x100000000000000000000000000000000'); // (2n**128n).toString(16)\n            const c1 = divNearest(b2 * k, n);\n            const c2 = divNearest(-b1 * k, n);\n            let k1 = mod(k - c1 * a1 - c2 * a2, n);\n            let k2 = mod(-c1 * b1 - c2 * b2, n);\n            const k1neg = k1 > POW_2_128;\n            const k2neg = k2 > POW_2_128;\n            if (k1neg)\n                k1 = n - k1;\n            if (k2neg)\n                k2 = n - k2;\n            if (k1 > POW_2_128 || k2 > POW_2_128) {\n                throw new Error('splitScalar: Endomorphism failed, k=' + k);\n            }\n            return { k1neg, k1, k2neg, k2 };\n        },\n    },\n}, sha256);\n// Schnorr signatures are superior to ECDSA from above. Below is Schnorr-specific BIP0340 code.\n// https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki\nconst _0n = BigInt(0);\nconst fe = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1P;\nconst ge = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1N;\n/** An object mapping tags to their tagged hash prefix of [SHA256(tag) | SHA256(tag)] */\nconst TAGGED_HASH_PREFIXES = {};\nfunction taggedHash(tag, ...messages) {\n    let tagP = TAGGED_HASH_PREFIXES[tag];\n    if (tagP === undefined) {\n        const tagH = sha256(Uint8Array.from(tag, (c) => c.charCodeAt(0)));\n        tagP = concatBytes(tagH, tagH);\n        TAGGED_HASH_PREFIXES[tag] = tagP;\n    }\n    return sha256(concatBytes(tagP, ...messages));\n}\n// ECDSA compact points are 33-byte. Schnorr is 32: we strip first byte 0x02 or 0x03\nconst pointToBytes = (point) => point.toRawBytes(true).slice(1);\nconst numTo32b = (n) => numberToBytesBE(n, 32);\nconst modP = (x) => mod(x, secp256k1P);\nconst modN = (x) => mod(x, secp256k1N);\nconst Point = secp256k1.ProjectivePoint;\nconst GmulAdd = (Q, a, b) => Point.BASE.multiplyAndAddUnsafe(Q, a, b);\n// Calculate point, scalar and bytes\nfunction schnorrGetExtPubKey(priv) {\n    let d_ = secp256k1.utils.normPrivateKeyToScalar(priv); // same method executed in fromPrivateKey\n    let p = Point.fromPrivateKey(d_); // P = d'G; 0 < d' < n check is done inside\n    const scalar = p.hasEvenY() ? d_ : modN(-d_);\n    return { scalar: scalar, bytes: pointToBytes(p) };\n}\n/**\n * lift_x from BIP340. Convert 32-byte x coordinate to elliptic curve point.\n * @returns valid point checked for being on-curve\n */\nfunction lift_x(x) {\n    if (!fe(x))\n        throw new Error('bad x: need 0 < x < p'); // Fail if x  p.\n    const xx = modP(x * x);\n    const c = modP(xx * x + BigInt(7)); // Let c = x + 7 mod p.\n    let y = sqrtMod(c); // Let y = c^(p+1)/4 mod p.\n    if (y % _2n !== _0n)\n        y = modP(-y); // Return the unique point P such that x(P) = x and\n    const p = new Point(x, y, _1n); // y(P) = y if y mod 2 = 0 or y(P) = p-y otherwise.\n    p.assertValidity();\n    return p;\n}\n/**\n * Create tagged hash, convert it to bigint, reduce modulo-n.\n */\nfunction challenge(...args) {\n    return modN(bytesToNumberBE(taggedHash('BIP0340/challenge', ...args)));\n}\n/**\n * Schnorr public key is just `x` coordinate of Point as per BIP340.\n */\nfunction schnorrGetPublicKey(privateKey) {\n    return schnorrGetExtPubKey(privateKey).bytes; // d'=int(sk). Fail if d'=0 or d'n. Ret bytes(d'G)\n}\n/**\n * Creates Schnorr signature as per BIP340. Verifies itself before returning anything.\n * auxRand is optional and is not the sole source of k generation: bad CSPRNG won't be dangerous.\n */\nfunction schnorrSign(message, privateKey, auxRand = randomBytes(32)) {\n    const m = ensureBytes('message', message);\n    const { bytes: px, scalar: d } = schnorrGetExtPubKey(privateKey); // checks for isWithinCurveOrder\n    const a = ensureBytes('auxRand', auxRand, 32); // Auxiliary random data a: a 32-byte array\n    const t = numTo32b(d ^ bytesToNumberBE(taggedHash('BIP0340/aux', a))); // Let t be the byte-wise xor of bytes(d) and hash/aux(a)\n    const rand = taggedHash('BIP0340/nonce', t, px, m); // Let rand = hash/nonce(t || bytes(P) || m)\n    const k_ = modN(bytesToNumberBE(rand)); // Let k' = int(rand) mod n\n    if (k_ === _0n)\n        throw new Error('sign failed: k is zero'); // Fail if k' = 0.\n    const { bytes: rx, scalar: k } = schnorrGetExtPubKey(k_); // Let R = k'G.\n    const e = challenge(rx, px, m); // Let e = int(hash/challenge(bytes(R) || bytes(P) || m)) mod n.\n    const sig = new Uint8Array(64); // Let sig = bytes(R) || bytes((k + ed) mod n).\n    sig.set(rx, 0);\n    sig.set(numTo32b(modN(k + e * d)), 32);\n    // If Verify(bytes(P), m, sig) (see below) returns failure, abort\n    if (!schnorrVerify(sig, m, px))\n        throw new Error('sign: Invalid signature produced');\n    return sig;\n}\n/**\n * Verifies Schnorr signature.\n * Will swallow errors & return false except for initial type validation of arguments.\n */\nfunction schnorrVerify(signature, message, publicKey) {\n    const sig = ensureBytes('signature', signature, 64);\n    const m = ensureBytes('message', message);\n    const pub = ensureBytes('publicKey', publicKey, 32);\n    try {\n        const P = lift_x(bytesToNumberBE(pub)); // P = lift_x(int(pk)); fail if that fails\n        const r = bytesToNumberBE(sig.subarray(0, 32)); // Let r = int(sig[0:32]); fail if r  p.\n        if (!fe(r))\n            return false;\n        const s = bytesToNumberBE(sig.subarray(32, 64)); // Let s = int(sig[32:64]); fail if s  n.\n        if (!ge(s))\n            return false;\n        const e = challenge(numTo32b(r), pointToBytes(P), m); // int(challenge(bytes(r)||bytes(P)||m))%n\n        const R = GmulAdd(P, s, modN(-e)); // R = sG - eP\n        if (!R || !R.hasEvenY() || R.toAffine().x !== r)\n            return false; // -eP == (n-e)P\n        return true; // Fail if is_infinite(R) / not has_even_y(R) / x(R)  r.\n    }\n    catch (error) {\n        return false;\n    }\n}\nexport const schnorr = /* @__PURE__ */ (() => ({\n    getPublicKey: schnorrGetPublicKey,\n    sign: schnorrSign,\n    verify: schnorrVerify,\n    utils: {\n        randomPrivateKey: secp256k1.utils.randomPrivateKey,\n        lift_x,\n        pointToBytes,\n        numberToBytesBE,\n        bytesToNumberBE,\n        taggedHash,\n        mod,\n    },\n}))();\nconst isoMap = /* @__PURE__ */ (() => isogenyMap(Fp, [\n    // xNum\n    [\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7',\n        '0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581',\n        '0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262',\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c',\n    ],\n    // xDen\n    [\n        '0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b',\n        '0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n    // yNum\n    [\n        '0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c',\n        '0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3',\n        '0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931',\n        '0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84',\n    ],\n    // yDen\n    [\n        '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b',\n        '0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573',\n        '0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n].map((i) => i.map((j) => BigInt(j)))))();\nconst mapSWU = /* @__PURE__ */ (() => mapToCurveSimpleSWU(Fp, {\n    A: BigInt('0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533'),\n    B: BigInt('1771'),\n    Z: Fp.create(BigInt('-11')),\n}))();\nconst htf = /* @__PURE__ */ (() => createHasher(secp256k1.ProjectivePoint, (scalars) => {\n    const { x, y } = mapSWU(Fp.create(scalars[0]));\n    return isoMap(x, y);\n}, {\n    DST: 'secp256k1_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'secp256k1_XMD:SHA-256_SSWU_NU_',\n    p: Fp.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256,\n}))();\nexport const hashToCurve = /* @__PURE__ */ (() => htf.hashToCurve)();\nexport const encodeToCurve = /* @__PURE__ */ (() => htf.encodeToCurve)();\n//# sourceMappingURL=secp256k1.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LRUCacheNode = void 0;\nclass LRUCacheNode {\n    constructor(key, value, options) {\n        const { entryExpirationTimeInMS = null, next = null, prev = null, onEntryEvicted, onEntryMarkedAsMostRecentlyUsed, clone, cloneFn } = options !== null && options !== void 0 ? options : {};\n        if (typeof entryExpirationTimeInMS === 'number' &&\n            (entryExpirationTimeInMS <= 0 || Number.isNaN(entryExpirationTimeInMS))) {\n            throw new Error('entryExpirationTimeInMS must either be null (no expiry) or greater than 0');\n        }\n        this.clone = clone !== null && clone !== void 0 ? clone : false;\n        this.cloneFn = cloneFn !== null && cloneFn !== void 0 ? cloneFn : this.defaultClone;\n        this.key = key;\n        this.internalValue = this.clone ? this.cloneFn(value) : value;\n        this.created = Date.now();\n        this.entryExpirationTimeInMS = entryExpirationTimeInMS;\n        this.next = next;\n        this.prev = prev;\n        this.onEntryEvicted = onEntryEvicted;\n        this.onEntryMarkedAsMostRecentlyUsed = onEntryMarkedAsMostRecentlyUsed;\n    }\n    get value() {\n        return this.clone ? this.cloneFn(this.internalValue) : this.internalValue;\n    }\n    get isExpired() {\n        return typeof this.entryExpirationTimeInMS === 'number' && Date.now() - this.created > this.entryExpirationTimeInMS;\n    }\n    invokeOnEvicted() {\n        if (this.onEntryEvicted) {\n            const { key, value, isExpired } = this;\n            this.onEntryEvicted({ key, value, isExpired });\n        }\n    }\n    invokeOnEntryMarkedAsMostRecentlyUsed() {\n        if (this.onEntryMarkedAsMostRecentlyUsed) {\n            const { key, value } = this;\n            this.onEntryMarkedAsMostRecentlyUsed({ key, value });\n        }\n    }\n    defaultClone(value) {\n        if (typeof value === 'boolean' || typeof value === 'string' || typeof value === 'number') {\n            return value;\n        }\n        return JSON.parse(JSON.stringify(value));\n    }\n}\nexports.LRUCacheNode = LRUCacheNode;\n//# sourceMappingURL=LRUCacheNode.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LRUCache = void 0;\nconst LRUCacheNode_1 = require(\"./LRUCacheNode\");\n/**\n * A key value cache that implements the LRU policy.\n *\n * @typeparam TKey The type of the keys in the cache. Defaults to `string`.\n * @typeparam TValue The type of the values in the cache. Defaults to `any`.\n *\n * @see {@link https://en.wikipedia.org/wiki/Cache_replacement_policies#Least_recently_used_(LRU)}\n */\nclass LRUCache {\n    /**\n     * Creates a new instance of the LRUCache.\n     *\n     * @param options Additional configuration options for the LRUCache.\n     *\n     * @example\n     * ```typescript\n     * // No options.\n     * const cache = new LRUCache();\n     *\n     * // With options.\n     * const cache = new LRUCache({\n     *  entryExpirationTimeInMS: 10000\n     * });\n     * ```\n     */\n    constructor(options) {\n        this.lookupTable = new Map();\n        this.head = null;\n        this.tail = null;\n        const { maxSize = 25, entryExpirationTimeInMS = null, onEntryEvicted, onEntryMarkedAsMostRecentlyUsed, cloneFn, clone } = options !== null && options !== void 0 ? options : {};\n        if (Number.isNaN(maxSize) || maxSize <= 0) {\n            throw new Error('maxSize must be greater than 0.');\n        }\n        if (typeof entryExpirationTimeInMS === 'number' &&\n            (entryExpirationTimeInMS <= 0 || Number.isNaN(entryExpirationTimeInMS))) {\n            throw new Error('entryExpirationTimeInMS must either be null (no expiry) or greater than 0');\n        }\n        this.maxSizeInternal = maxSize;\n        this.entryExpirationTimeInMS = entryExpirationTimeInMS;\n        this.onEntryEvicted = onEntryEvicted;\n        this.onEntryMarkedAsMostRecentlyUsed = onEntryMarkedAsMostRecentlyUsed;\n        this.clone = clone;\n        this.cloneFn = cloneFn;\n    }\n    /**\n     * Returns the number of entries in the LRUCache object.\n     * If the cache has entryExpirationTimeInMS set, expired entries will be removed before the size is returned.\n     *\n     * @returns The number of entries in the cache.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * cache.set('testKey', 'testValue');\n     *\n     * const size = cache.size;\n     *\n     * // Will log 1\n     * console.log(size);\n     * ```\n     */\n    get size() {\n        this.cleanCache();\n        return this.lookupTable.size;\n    }\n    /**\n     * Returns the number of entries that can still be added to the LRUCache without evicting existing entries.\n     *\n     * @returns The number of entries that can still be added without evicting existing entries.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache({ maxSize: 10 });\n     *\n     * cache.set('testKey', 'testValue');\n     *\n     * const remainingSize = cache.remainingSize;\n     *\n     * // Will log 9 due to 9 spots remaining before reaching maxSize of 10.\n     * console.log(remainingSize);\n     * ```\n     */\n    get remainingSize() {\n        return this.maxSizeInternal - this.size;\n    }\n    /**\n     * Returns the most recently used (newest) entry in the cache.\n     * This will not mark the entry as recently used.\n     * If the newest node is expired, it will be removed.\n     *\n     * @returns The most recently used (newest) entry in the cache.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache({ maxSize: 10 });\n     *\n     * cache.set('testKey', 'testValue');\n     *\n     * const newest = cache.newest;\n     *\n     * // Will log testValue\n     * console.log(newest.value);\n     *\n     * // Will log testKey\n     * console.log(newest.key);\n     * ```\n     */\n    get newest() {\n        if (!this.head) {\n            return null;\n        }\n        if (this.head.isExpired) {\n            this.removeNodeFromListAndLookupTable(this.head);\n            return this.newest;\n        }\n        return this.mapNodeToEntry(this.head);\n    }\n    /**\n     * Returns the least recently used (oldest) entry in the cache.\n     * This will not mark the entry as recently used.\n     * If the oldest node is expired, it will be removed.\n     *\n     * @returns The least recently used (oldest) entry in the cache.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache({ maxSize: 10 });\n     *\n     * cache.set('testKey', 'testValue');\n     *\n     * const oldest = cache.oldest;\n     *\n     * // Will log testValue\n     * console.log(oldest.value);\n     *\n     * // Will log testKey\n     * console.log(oldest.key);\n     * ```\n     */\n    get oldest() {\n        if (!this.tail) {\n            return null;\n        }\n        if (this.tail.isExpired) {\n            this.removeNodeFromListAndLookupTable(this.tail);\n            return this.oldest;\n        }\n        return this.mapNodeToEntry(this.tail);\n    }\n    /**\n     * Gets or sets the maxSize of the cache.\n     * This will evict the least recently used entries if needed to reach new maxSize.\n     *\n     * @param value The new value for maxSize. Must be greater than 0.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache({ maxSize: 10 });\n     *\n     * cache.set('testKey', 'testValue');\n     *\n     * // Will be 10\n     * const maxSize = cache.maxSize;\n     *\n     * // Set new maxSize to 5. If there are more than 5 items in the cache, the least recently used entries will be removed until cache size is 5.\n     * cache.maxSize = 5;\n     * ```\n     */\n    get maxSize() {\n        return this.maxSizeInternal;\n    }\n    set maxSize(value) {\n        if (Number.isNaN(value) || value <= 0) {\n            throw new Error('maxSize must be greater than 0.');\n        }\n        this.maxSizeInternal = value;\n        this.enforceSizeLimit();\n    }\n    /**\n     * Sets the value for the key in the LRUCache object. Returns the LRUCache object.\n     * This marks the newly added entry as the most recently used entry.\n     * If adding the new entry makes the cache size go above maxSize,\n     * this will evict the least recently used entries until size is equal to maxSize.\n     *\n     * @param key The key of the entry.\n     * @param value The value to set for the key.\n     * @param entryOptions Additional configuration options for the cache entry.\n     *\n     * @returns The LRUCache instance.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * // Set the key key2 to value value2. Pass in optional options.\n     * cache.set('key2', 'value2', { entryExpirationTimeInMS: 10 });\n     * ```\n     */\n    set(key, value, entryOptions) {\n        const currentNodeForKey = this.lookupTable.get(key);\n        if (currentNodeForKey) {\n            this.removeNodeFromListAndLookupTable(currentNodeForKey);\n        }\n        const node = new LRUCacheNode_1.LRUCacheNode(key, value, {\n            entryExpirationTimeInMS: this.entryExpirationTimeInMS,\n            onEntryEvicted: this.onEntryEvicted,\n            onEntryMarkedAsMostRecentlyUsed: this.onEntryMarkedAsMostRecentlyUsed,\n            clone: this.clone,\n            cloneFn: this.cloneFn,\n            ...entryOptions\n        });\n        this.setNodeAsHead(node);\n        this.lookupTable.set(key, node);\n        this.enforceSizeLimit();\n        return this;\n    }\n    /**\n     * Returns the value associated to the key, or null if there is none or if the entry is expired.\n     * If an entry is returned, this marks the returned entry as the most recently used entry.\n     *\n     * @param key The key of the entry to get.\n     *\n     * @returns The cached value or null.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * // Will be 'testValue'. Entry will now be most recently used.\n     * const item1 = cache.get('testKey');\n     *\n     * // Will be null\n     * const item2 = cache.get('keyNotInCache');\n     * ```\n     */\n    get(key) {\n        const node = this.lookupTable.get(key);\n        if (!node) {\n            return null;\n        }\n        if (node.isExpired) {\n            this.removeNodeFromListAndLookupTable(node);\n            return null;\n        }\n        this.setNodeAsHead(node);\n        return node.value;\n    }\n    /**\n     * Returns the value associated to the key, or null if there is none or if the entry is expired.\n     * If an entry is returned, this will not mark the entry as most recently accessed.\n     * Useful if a value is needed but the order of the cache should not be changed.\n     *\n     * @param key The key of the entry to get.\n     *\n     * @returns The cached value or null.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * // Will be 'testValue'\n     * const item1 = cache.peek('testKey');\n     *\n     * // Will be null\n     * const item2 = cache.peek('keyNotInCache');\n     * ```\n     */\n    peek(key) {\n        const node = this.lookupTable.get(key);\n        if (!node) {\n            return null;\n        }\n        if (node.isExpired) {\n            this.removeNodeFromListAndLookupTable(node);\n            return null;\n        }\n        return node.value;\n    }\n    /**\n     * Deletes the entry for the passed in key.\n     *\n     * @param key The key of the entry to delete\n     *\n     * @returns True if an element in the LRUCache object existed and has been removed,\n     * or false if the element does not exist.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * // Will be true\n     * const wasDeleted = cache.delete('testKey');\n     *\n     * // Will be false\n     * const wasDeleted2 = cache.delete('keyNotInCache');\n     * ```\n     */\n    delete(key) {\n        const node = this.lookupTable.get(key);\n        if (!node) {\n            return false;\n        }\n        return this.removeNodeFromListAndLookupTable(node);\n    }\n    /**\n     * Returns a boolean asserting whether a value has been associated to the key in the LRUCache object or not.\n     * This does not mark the entry as recently used.\n     * If the cache has a key but the entry is expired, it will be removed and false will be returned.\n     *\n     * @param key The key of the entry to check if exists\n     *\n     * @returns true if the cache contains the supplied key. False if not.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * // Will be true\n     * const wasDeleted = cache.has('testKey');\n     *\n     * // Will be false\n     * const wasDeleted2 = cache.has('keyNotInCache');\n     * ```\n     */\n    has(key) {\n        const node = this.lookupTable.get(key);\n        if (!node) {\n            return false;\n        }\n        if (node.isExpired) {\n            this.removeNodeFromListAndLookupTable(node);\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Removes all entries in the cache.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * // Clear cache.\n     * cache.clear();\n     * ```\n     */\n    clear() {\n        this.head = null;\n        this.tail = null;\n        this.lookupTable.clear();\n    }\n    /**\n     * Searches the cache for an entry matching the passed in condition.\n     * Expired entries will be skipped (and removed).\n     * If multiply entries in the cache match the condition, the most recently used entry will be returned.\n     * If an entry is returned, this marks the returned entry as the most recently used entry.\n     *\n     * @param condition The condition to apply to each entry in the\n     *\n     * @returns The first cache entry to match the condition. Null if none match.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * // item will be { key: 'testKey', value: 'testValue }\n     * const item = cache.find(entry => {\n     *   const { key, value } = entry;\n     *\n     *   if (key === 'testKey' || value === 'something') {\n     *     return true;\n     *   }\n     *\n     *   return false;\n     * });\n     *\n     * // item2 will be null\n     * const item2 = cache.find(entry => entry.key === 'notInCache');\n     * ```\n     */\n    find(condition) {\n        let node = this.head;\n        while (node) {\n            if (node.isExpired) {\n                const next = node.next;\n                this.removeNodeFromListAndLookupTable(node);\n                node = next;\n                continue;\n            }\n            const entry = this.mapNodeToEntry(node);\n            if (condition(entry)) {\n                this.setNodeAsHead(node);\n                return entry;\n            }\n            node = node.next;\n        }\n        return null;\n    }\n    /**\n     * Iterates over and applies the callback function to each entry in the cache.\n     * Iterates in order from most recently accessed entry to least recently.\n     * Expired entries will be skipped (and removed).\n     * No entry will be marked as recently used.\n     *\n     * @param callback the callback function to apply to the entry\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * cache.forEach((key, value, index) => {\n     *   // do something with key, value, and/or index\n     * });\n     * ```\n     */\n    forEach(callback) {\n        let node = this.head;\n        let index = 0;\n        while (node) {\n            if (node.isExpired) {\n                const next = node.next;\n                this.removeNodeFromListAndLookupTable(node);\n                node = next;\n                continue;\n            }\n            callback(node.value, node.key, index);\n            node = node.next;\n            index++;\n        }\n    }\n    /**\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache values.\n     * Iterates in order from most recently accessed entry to least recently.\n     * Expired entries will be skipped (and removed).\n     * No entry will be marked as accessed.\n     *\n     * @returns A Generator for the cache values.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * for (const value of cache.values()) {\n     *   // do something with the value\n     * }\n     * ```\n     */\n    *values() {\n        let node = this.head;\n        while (node) {\n            if (node.isExpired) {\n                const next = node.next;\n                this.removeNodeFromListAndLookupTable(node);\n                node = next;\n                continue;\n            }\n            yield node.value;\n            node = node.next;\n        }\n    }\n    /**\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache keys.\n     * Iterates in order from most recently accessed entry to least recently.\n     * Expired entries will be skipped (and removed).\n     * No entry will be marked as accessed.\n     *\n     * @returns A Generator for the cache keys.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * for (const key of cache.keys()) {\n     *   // do something with the key\n     * }\n     * ```\n     */\n    *keys() {\n        let node = this.head;\n        while (node) {\n            if (node.isExpired) {\n                const next = node.next;\n                this.removeNodeFromListAndLookupTable(node);\n                node = next;\n                continue;\n            }\n            yield node.key;\n            node = node.next;\n        }\n    }\n    /**\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache entries.\n     * Iterates in order from most recently accessed entry to least recently.\n     * Expired entries will be skipped (and removed).\n     * No entry will be marked as accessed.\n     *\n     * @returns A Generator for the cache entries.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * for (const entry of cache.entries()) {\n     *   const { key, value } = entry;\n     *   // do something with the entry\n     * }\n     * ```\n     */\n    *entries() {\n        let node = this.head;\n        while (node) {\n            if (node.isExpired) {\n                const next = node.next;\n                this.removeNodeFromListAndLookupTable(node);\n                node = next;\n                continue;\n            }\n            yield this.mapNodeToEntry(node);\n            node = node.next;\n        }\n    }\n    /**\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache entries.\n     * Iterates in order from most recently accessed entry to least recently.\n     * Expired entries will be skipped (and removed).\n     * No entry will be marked as accessed.\n     *\n     * @returns A Generator for the cache entries.\n     *\n     * @example\n     * ```typescript\n     * const cache = new LRUCache();\n     *\n     * // Set the key testKey to value testValue\n     * cache.set('testKey', 'testValue');\n     *\n     * for (const entry of cache) {\n     *   const { key, value } = entry;\n     *   // do something with the entry\n     * }\n     * ```\n     */\n    *[Symbol.iterator]() {\n        let node = this.head;\n        while (node) {\n            if (node.isExpired) {\n                const next = node.next;\n                this.removeNodeFromListAndLookupTable(node);\n                node = next;\n                continue;\n            }\n            yield this.mapNodeToEntry(node);\n            node = node.next;\n        }\n    }\n    enforceSizeLimit() {\n        let node = this.tail;\n        while (node !== null && this.size > this.maxSizeInternal) {\n            const prev = node.prev;\n            this.removeNodeFromListAndLookupTable(node);\n            node = prev;\n        }\n    }\n    mapNodeToEntry({ key, value }) {\n        return {\n            key,\n            value\n        };\n    }\n    setNodeAsHead(node) {\n        this.removeNodeFromList(node);\n        if (!this.head) {\n            this.head = node;\n            this.tail = node;\n        }\n        else {\n            node.next = this.head;\n            this.head.prev = node;\n            this.head = node;\n        }\n        node.invokeOnEntryMarkedAsMostRecentlyUsed();\n    }\n    removeNodeFromList(node) {\n        if (node.prev !== null) {\n            node.prev.next = node.next;\n        }\n        if (node.next !== null) {\n            node.next.prev = node.prev;\n        }\n        if (this.head === node) {\n            this.head = node.next;\n        }\n        if (this.tail === node) {\n            this.tail = node.prev;\n        }\n        node.next = null;\n        node.prev = null;\n    }\n    removeNodeFromListAndLookupTable(node) {\n        node.invokeOnEvicted();\n        this.removeNodeFromList(node);\n        return this.lookupTable.delete(node.key);\n    }\n    cleanCache() {\n        // Don't spend time cleaning if entries don't expire.\n        if (!this.entryExpirationTimeInMS) {\n            return;\n        }\n        const expiredNodes = [];\n        for (const node of this.lookupTable.values()) {\n            if (node.isExpired) {\n                expiredNodes.push(node);\n            }\n        }\n        expiredNodes.forEach(node => this.removeNodeFromListAndLookupTable(node));\n    }\n}\nexports.LRUCache = LRUCache;\n//# sourceMappingURL=LRUCache.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./LRUCache\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\n/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bytes = exports.stringToBytes = exports.str = exports.bytesToString = exports.hex = exports.utf8 = exports.bech32m = exports.bech32 = exports.base58check = exports.base58xmr = exports.base58xrp = exports.base58flickr = exports.base58 = exports.base64url = exports.base64 = exports.base32crockford = exports.base32hex = exports.base32 = exports.base16 = exports.utils = exports.assertNumber = void 0;\nfunction assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nexports.assertNumber = assertNumber;\nfunction chain(...args) {\n    const wrap = (a, b) => (c) => a(b(c));\n    const encode = Array.from(args)\n        .reverse()\n        .reduce((acc, i) => (acc ? wrap(acc, i.encode) : i.encode), undefined);\n    const decode = args.reduce((acc, i) => (acc ? wrap(acc, i.decode) : i.decode), undefined);\n    return { encode, decode };\n}\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\nfunction convertRadix(data, from, to) {\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            digits[i] = Math.floor(digitBase / to);\n            if (!Number.isSafeInteger(digits[i]) || digits[i] * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!digits[i])\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = (from, to) => from + (to - gcd(from, to));\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0;\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1;\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of strings');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of strings');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\nexports.utils = { alphabet, chain, checksum, radix, radix2, join, padding };\nexports.base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexports.base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexports.base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexports.base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexports.base64 = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexports.base64url = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexports.base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexports.base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexports.base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexports.base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += exports.base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = exports.base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nconst base58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), exports.base58);\nexports.base58check = base58check;\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        prefix = prefix.toLowerCase();\n        return `${prefix}1${BECH_ALPHABET.encode(words)}${bechChecksum(prefix, words, ENCODING_CONST)}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        str = lowered;\n        const sepIndex = str.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = str.slice(0, sepIndex);\n        const _words = str.slice(sepIndex + 1);\n        if (_words.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(_words).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!_words.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexports.bech32 = genBech32('bech32');\nexports.bech32m = genBech32('bech32m');\nexports.utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexports.hex = chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\nconst CODERS = {\n    utf8: exports.utf8, hex: exports.hex, base16: exports.base16, base32: exports.base32, base64: exports.base64, base64url: exports.base64url, base58: exports.base58, base58xmr: exports.base58xmr\n};\nconst coderTypeError = `Invalid encoding type. Available types: ${Object.keys(CODERS).join(', ')}`;\nconst bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!(bytes instanceof Uint8Array))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexports.bytesToString = bytesToString;\nexports.str = exports.bytesToString;\nconst stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexports.stringToBytes = stringToBytes;\nexports.bytes = exports.stringToBytes;\n","const {bech32, hex, utf8} = require('@scure/base')\n\n// defaults for encode; default timestamp is current time at call\nconst DEFAULTNETWORK = {\n  // default network is bitcoin\n  bech32: 'bc',\n  pubKeyHash: 0x00,\n  scriptHash: 0x05,\n  validWitnessVersions: [0]\n}\nconst TESTNETWORK = {\n  bech32: 'tb',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst SIGNETNETWORK = {\n  bech32: 'tbs',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst REGTESTNETWORK = {\n  bech32: 'bcrt',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst SIMNETWORK = {\n  bech32: 'sb',\n  pubKeyHash: 0x3f,\n  scriptHash: 0x7b,\n  validWitnessVersions: [0]\n}\n\nconst FEATUREBIT_ORDER = [\n  'option_data_loss_protect',\n  'initial_routing_sync',\n  'option_upfront_shutdown_script',\n  'gossip_queries',\n  'var_onion_optin',\n  'gossip_queries_ex',\n  'option_static_remotekey',\n  'payment_secret',\n  'basic_mpp',\n  'option_support_large_channel'\n]\n\nconst DIVISORS = {\n  m: BigInt(1e3),\n  u: BigInt(1e6),\n  n: BigInt(1e9),\n  p: BigInt(1e12)\n}\n\nconst MAX_MILLISATS = BigInt('2100000000000000000')\n\nconst MILLISATS_PER_BTC = BigInt(1e11)\n\nconst TAGCODES = {\n  payment_hash: 1,\n  payment_secret: 16,\n  description: 13,\n  payee: 19,\n  description_hash: 23, // commit to longer descriptions (used by lnurl-pay)\n  expiry: 6, // default: 3600 (1 hour)\n  min_final_cltv_expiry: 24, // default: 9\n  fallback_address: 9,\n  route_hint: 3, // for extra routing info (private etc.)\n  feature_bits: 5,\n  metadata: 27\n}\n\n// reverse the keys and values of TAGCODES and insert into TAGNAMES\nconst TAGNAMES = {}\nfor (let i = 0, keys = Object.keys(TAGCODES); i < keys.length; i++) {\n  const currentName = keys[i]\n  const currentCode = TAGCODES[keys[i]].toString()\n  TAGNAMES[currentCode] = currentName\n}\n\nconst TAGPARSERS = {\n  1: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  16: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  13: words => utf8.encode(bech32.fromWordsUnsafe(words)), // string variable length\n  19: words => hex.encode(bech32.fromWordsUnsafe(words)), // 264 bits\n  23: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  27: words => hex.encode(bech32.fromWordsUnsafe(words)), // variable\n  6: wordsToIntBE, // default: 3600 (1 hour)\n  24: wordsToIntBE, // default: 9\n  3: routingInfoParser, // for extra routing info (private etc.)\n  5: featureBitsParser // keep feature bits as array of 5 bit words\n}\n\nfunction getUnknownParser(tagCode) {\n  return words => ({\n    tagCode: parseInt(tagCode),\n    words: bech32.encode('unknown', words, Number.MAX_SAFE_INTEGER)\n  })\n}\n\nfunction wordsToIntBE(words) {\n  return words.reverse().reduce((total, item, index) => {\n    return total + item * Math.pow(32, index)\n  }, 0)\n}\n\n// first convert from words to buffer, trimming padding where necessary\n// parse in 51 byte chunks. See encoder for details.\nfunction routingInfoParser(words) {\n  const routes = []\n  let pubkey,\n    shortChannelId,\n    feeBaseMSats,\n    feeProportionalMillionths,\n    cltvExpiryDelta\n  let routesBuffer = bech32.fromWordsUnsafe(words)\n  while (routesBuffer.length > 0) {\n    pubkey = hex.encode(routesBuffer.slice(0, 33)) // 33 bytes\n    shortChannelId = hex.encode(routesBuffer.slice(33, 41)) // 8 bytes\n    feeBaseMSats = parseInt(hex.encode(routesBuffer.slice(41, 45)), 16) // 4 bytes\n    feeProportionalMillionths = parseInt(\n      hex.encode(routesBuffer.slice(45, 49)),\n      16\n    ) // 4 bytes\n    cltvExpiryDelta = parseInt(hex.encode(routesBuffer.slice(49, 51)), 16) // 2 bytes\n\n    routesBuffer = routesBuffer.slice(51)\n\n    routes.push({\n      pubkey,\n      short_channel_id: shortChannelId,\n      fee_base_msat: feeBaseMSats,\n      fee_proportional_millionths: feeProportionalMillionths,\n      cltv_expiry_delta: cltvExpiryDelta\n    })\n  }\n  return routes\n}\n\nfunction featureBitsParser(words) {\n  const bools = words\n    .slice()\n    .reverse()\n    .map(word => [\n      !!(word & 0b1),\n      !!(word & 0b10),\n      !!(word & 0b100),\n      !!(word & 0b1000),\n      !!(word & 0b10000)\n    ])\n    .reduce((finalArr, itemArr) => finalArr.concat(itemArr), [])\n  while (bools.length < FEATUREBIT_ORDER.length * 2) {\n    bools.push(false)\n  }\n\n  const featureBits = {}\n\n  FEATUREBIT_ORDER.forEach((featureName, index) => {\n    let status\n    if (bools[index * 2]) {\n      status = 'required'\n    } else if (bools[index * 2 + 1]) {\n      status = 'supported'\n    } else {\n      status = 'unsupported'\n    }\n    featureBits[featureName] = status\n  })\n\n  const extraBits = bools.slice(FEATUREBIT_ORDER.length * 2)\n  featureBits.extra_bits = {\n    start_bit: FEATUREBIT_ORDER.length * 2,\n    bits: extraBits,\n    has_required: extraBits.reduce(\n      (result, bit, index) =>\n        index % 2 !== 0 ? result || false : result || bit,\n      false\n    )\n  }\n\n  return featureBits\n}\n\nfunction hrpToMillisat(hrpString, outputString) {\n  let divisor, value\n  if (hrpString.slice(-1).match(/^[munp]$/)) {\n    divisor = hrpString.slice(-1)\n    value = hrpString.slice(0, -1)\n  } else if (hrpString.slice(-1).match(/^[^munp0-9]$/)) {\n    throw new Error('Not a valid multiplier for the amount')\n  } else {\n    value = hrpString\n  }\n\n  if (!value.match(/^\\d+$/))\n    throw new Error('Not a valid human readable amount')\n\n  const valueBN = BigInt(value)\n\n  const millisatoshisBN = divisor\n    ? (valueBN * MILLISATS_PER_BTC) / DIVISORS[divisor]\n    : valueBN * MILLISATS_PER_BTC\n\n  if (\n    (divisor === 'p' && !(valueBN % BigInt(10) === BigInt(0))) ||\n    millisatoshisBN > MAX_MILLISATS\n  ) {\n    throw new Error('Amount is outside of valid range')\n  }\n\n  return outputString ? millisatoshisBN.toString() : millisatoshisBN\n}\n\n// decode will only have extra comments that aren't covered in encode comments.\n// also if anything is hard to read I'll comment.\nfunction decode(paymentRequest, network) {\n  if (typeof paymentRequest !== 'string')\n    throw new Error('Lightning Payment Request must be string')\n  if (paymentRequest.slice(0, 2).toLowerCase() !== 'ln')\n    throw new Error('Not a proper lightning payment request')\n\n  const sections = []\n  const decoded = bech32.decode(paymentRequest, Number.MAX_SAFE_INTEGER)\n  paymentRequest = paymentRequest.toLowerCase()\n  const prefix = decoded.prefix\n  let words = decoded.words\n  let letters = paymentRequest.slice(prefix.length + 1)\n  let sigWords = words.slice(-104)\n  words = words.slice(0, -104)\n\n  // Without reverse lookups, can't say that the multipier at the end must\n  // have a number before it, so instead we parse, and if the second group\n  // doesn't have anything, there's a good chance the last letter of the\n  // coin type got captured by the third group, so just re-regex without\n  // the number.\n  let prefixMatches = prefix.match(/^ln(\\S+?)(\\d*)([a-zA-Z]?)$/)\n  if (prefixMatches && !prefixMatches[2])\n    prefixMatches = prefix.match(/^ln(\\S+)$/)\n  if (!prefixMatches) {\n    throw new Error('Not a proper lightning payment request')\n  }\n\n  // \"ln\" section\n  sections.push({\n    name: 'lightning_network',\n    letters: 'ln'\n  })\n\n  // \"bc\" section\n  const bech32Prefix = prefixMatches[1]\n  let coinNetwork\n  if (!network) {\n    switch (bech32Prefix) {\n      case DEFAULTNETWORK.bech32:\n        coinNetwork = DEFAULTNETWORK\n        break\n      case TESTNETWORK.bech32:\n        coinNetwork = TESTNETWORK\n        break\n      case SIGNETNETWORK.bech32:\n        coinNetwork = SIGNETNETWORK\n        break\n      case REGTESTNETWORK.bech32:\n        coinNetwork = REGTESTNETWORK\n        break\n      case SIMNETWORK.bech32:\n        coinNetwork = SIMNETWORK\n        break\n    }\n  } else {\n    if (\n      network.bech32 === undefined ||\n      network.pubKeyHash === undefined ||\n      network.scriptHash === undefined ||\n      !Array.isArray(network.validWitnessVersions)\n    )\n      throw new Error('Invalid network')\n    coinNetwork = network\n  }\n  if (!coinNetwork || coinNetwork.bech32 !== bech32Prefix) {\n    throw new Error('Unknown coin bech32 prefix')\n  }\n  sections.push({\n    name: 'coin_network',\n    letters: bech32Prefix,\n    value: coinNetwork\n  })\n\n  // amount section\n  const value = prefixMatches[2]\n  let millisatoshis\n  if (value) {\n    const divisor = prefixMatches[3]\n    millisatoshis = hrpToMillisat(value + divisor, true)\n    sections.push({\n      name: 'amount',\n      letters: prefixMatches[2] + prefixMatches[3],\n      value: millisatoshis\n    })\n  } else {\n    millisatoshis = null\n  }\n\n  // \"1\" separator\n  sections.push({\n    name: 'separator',\n    letters: '1'\n  })\n\n  // timestamp\n  const timestamp = wordsToIntBE(words.slice(0, 7))\n  words = words.slice(7) // trim off the left 7 words\n  sections.push({\n    name: 'timestamp',\n    letters: letters.slice(0, 7),\n    value: timestamp\n  })\n  letters = letters.slice(7)\n\n  let tagName, parser, tagLength, tagWords\n  // we have no tag count to go on, so just keep hacking off words\n  // until we have none.\n  while (words.length > 0) {\n    const tagCode = words[0].toString()\n    tagName = TAGNAMES[tagCode] || 'unknown_tag'\n    parser = TAGPARSERS[tagCode] || getUnknownParser(tagCode)\n    words = words.slice(1)\n\n    tagLength = wordsToIntBE(words.slice(0, 2))\n    words = words.slice(2)\n\n    tagWords = words.slice(0, tagLength)\n    words = words.slice(tagLength)\n\n    sections.push({\n      name: tagName,\n      tag: letters[0],\n      letters: letters.slice(0, 1 + 2 + tagLength),\n      value: parser(tagWords) // see: parsers for more comments\n    })\n    letters = letters.slice(1 + 2 + tagLength)\n  }\n\n  // signature\n  sections.push({\n    name: 'signature',\n    letters: letters.slice(0, 104),\n    value: hex.encode(bech32.fromWordsUnsafe(sigWords))\n  })\n  letters = letters.slice(104)\n\n  // checksum\n  sections.push({\n    name: 'checksum',\n    letters: letters\n  })\n\n  let result = {\n    paymentRequest,\n    sections,\n\n    get expiry() {\n      let exp = sections.find(s => s.name === 'expiry')\n      if (exp) return getValue('timestamp') + exp.value\n    },\n\n    get route_hints() {\n      return sections.filter(s => s.name === 'route_hint').map(s => s.value)\n    }\n  }\n\n  for (let name in TAGCODES) {\n    if (name === 'route_hint') {\n      // route hints can be multiple, so this won't work for them\n      continue\n    }\n\n    Object.defineProperty(result, name, {\n      get() {\n        return getValue(name)\n      }\n    })\n  }\n\n  return result\n\n  function getValue(name) {\n    let section = sections.find(s => s.name === name)\n    return section ? section.value : undefined\n  }\n}\n\nmodule.exports = {\n  decode,\n  hrpToMillisat\n}\n","// src/user/index.ts\nimport { nip19 as nip194 } from \"nostr-tools\";\n\n// src/events/index.ts\nimport { EventEmitter as EventEmitter4 } from \"tseep\";\n\n// src/outbox/relay-ranking.ts\nfunction getTopRelaysForAuthors(ndk, authors) {\n  const relaysWithCount = /* @__PURE__ */ new Map();\n  authors.forEach((author) => {\n    const writeRelays = getWriteRelaysFor(ndk, author);\n    if (writeRelays) {\n      writeRelays.forEach((relay) => {\n        const count = relaysWithCount.get(relay) || 0;\n        relaysWithCount.set(relay, count + 1);\n      });\n    }\n  });\n  let sortedRelays = Array.from(relaysWithCount.entries()).sort((a, b) => b[1] - a[1]);\n  return sortedRelays.map((entry) => entry[0]);\n}\n\n// src/outbox/read/with-authors.ts\nfunction getWriteRelaysFor(ndk, author) {\n  if (!ndk.outboxTracker)\n    return void 0;\n  return ndk.outboxTracker.data.get(author)?.writeRelays;\n}\nfunction getAllRelaysForAllPubkeys(ndk, pubkeys) {\n  const pubkeysToRelays = /* @__PURE__ */ new Map();\n  const authorsMissingRelays = /* @__PURE__ */ new Set();\n  pubkeys.forEach((author) => {\n    const writeRelays = getWriteRelaysFor(ndk, author);\n    if (writeRelays && writeRelays.size > 0) {\n      writeRelays.forEach((relay) => {\n        const pubkeysInRelay = pubkeysToRelays.get(relay) || /* @__PURE__ */ new Set();\n        pubkeysInRelay.add(author);\n        pubkeysToRelays.set(relay, pubkeysInRelay);\n      });\n      pubkeysToRelays.set(author, writeRelays);\n    } else {\n      authorsMissingRelays.add(author);\n    }\n  });\n  return { pubkeysToRelays, authorsMissingRelays };\n}\nfunction getRelaysForFilterWithAuthors(ndk, authors, pool, relayGoalPerAuthor = 2) {\n  const relayToAuthorsMap = /* @__PURE__ */ new Map();\n  const { pubkeysToRelays, authorsMissingRelays } = getAllRelaysForAllPubkeys(ndk, authors);\n  const sortedRelays = getTopRelaysForAuthors(ndk, authors);\n  const addAuthorToRelay = (author, relay) => {\n    const authorsInRelay = relayToAuthorsMap.get(relay) || [];\n    authorsInRelay.push(author);\n    relayToAuthorsMap.set(relay, authorsInRelay);\n  };\n  for (const [author, authorRelays] of pubkeysToRelays.entries()) {\n    let missingRelaysForThisAuthor = relayGoalPerAuthor;\n    for (const authorRelay of authorRelays) {\n      if (relayToAuthorsMap.has(authorRelay)) {\n        addAuthorToRelay(author, authorRelay);\n        missingRelaysForThisAuthor--;\n      }\n    }\n    if (missingRelaysForThisAuthor <= 0)\n      continue;\n    for (const relay of sortedRelays) {\n      if (missingRelaysForThisAuthor <= 0)\n        break;\n      if (authorRelays.has(relay)) {\n        addAuthorToRelay(author, relay);\n        missingRelaysForThisAuthor--;\n      }\n    }\n  }\n  for (const author of authorsMissingRelays) {\n    Array.from(pool.relays.keys()).forEach((relay) => {\n      const authorsInRelay = relayToAuthorsMap.get(relay) || [];\n      authorsInRelay.push(author);\n      relayToAuthorsMap.set(relay, authorsInRelay);\n    });\n  }\n  return relayToAuthorsMap;\n}\n\n// src/relay/index.ts\nimport debug from \"debug\";\nimport { EventEmitter as EventEmitter2 } from \"tseep\";\n\n// src/relay/connectivity.ts\nimport { relayInit } from \"nostr-tools\";\n\n// src/utils/timeout.ts\nasync function runWithTimeout(fn, timeoutMs, timeoutMessage) {\n  if (!timeoutMs)\n    return fn();\n  return new Promise((resolve, reject) => {\n    const timeout = setTimeout(() => {\n      reject(new Error(timeoutMessage || `Timed out after ${timeoutMs}ms`));\n    }, timeoutMs);\n    fn().then(resolve, reject).finally(() => clearTimeout(timeout));\n  });\n}\n\n// src/relay/connectivity.ts\nvar NDKRelayConnectivity = class {\n  ndkRelay;\n  _status;\n  relay;\n  timeoutMs;\n  connectedAt;\n  _connectionStats = {\n    attempts: 0,\n    success: 0,\n    durations: []\n  };\n  debug;\n  reconnectTimeout;\n  constructor(ndkRelay) {\n    this.ndkRelay = ndkRelay;\n    this._status = 3 /* DISCONNECTED */;\n    this.relay = relayInit(this.ndkRelay.url);\n    this.debug = this.ndkRelay.debug.extend(\"connectivity\");\n    this.relay.on(\"notice\", (notice) => this.handleNotice(notice));\n  }\n  async connect(timeoutMs) {\n    if (this.reconnectTimeout) {\n      clearTimeout(this.reconnectTimeout);\n      this.reconnectTimeout = void 0;\n    }\n    timeoutMs ??= this.timeoutMs;\n    if (!this.timeoutMs && timeoutMs)\n      this.timeoutMs = timeoutMs;\n    const connectHandler = () => {\n      this.updateConnectionStats.connected();\n      this._status = 1 /* CONNECTED */;\n      this.ndkRelay.emit(\"connect\");\n      this.ndkRelay.emit(\"ready\");\n    };\n    const disconnectHandler = () => {\n      this.updateConnectionStats.disconnected();\n      if (this._status === 1 /* CONNECTED */) {\n        this._status = 3 /* DISCONNECTED */;\n        this.handleReconnection();\n      }\n      this.ndkRelay.emit(\"disconnect\");\n    };\n    const authHandler = async (challenge) => {\n      this.debug(\"Relay requested authentication\", {\n        havePolicy: !!this.ndkRelay.authPolicy\n      });\n      if (this.ndkRelay.authPolicy) {\n        if (this._status !== 7 /* AUTHENTICATING */) {\n          this._status = 7 /* AUTHENTICATING */;\n          await this.ndkRelay.authPolicy(this.ndkRelay, challenge);\n          if (this._status === 7 /* AUTHENTICATING */) {\n            this.debug(\"Authentication policy finished\");\n            this._status = 1 /* CONNECTED */;\n            this.ndkRelay.emit(\"authed\");\n          }\n        }\n      } else {\n        await this.ndkRelay.emit(\"auth\", challenge);\n      }\n    };\n    try {\n      this.updateConnectionStats.attempt();\n      if (this._status === 3 /* DISCONNECTED */)\n        this._status = 0 /* CONNECTING */;\n      else\n        this._status = 4 /* RECONNECTING */;\n      this.relay.off(\"connect\", connectHandler);\n      this.relay.off(\"disconnect\", disconnectHandler);\n      this.relay.on(\"connect\", connectHandler);\n      this.relay.on(\"disconnect\", disconnectHandler);\n      this.relay.on(\"auth\", authHandler);\n      await runWithTimeout(this.relay.connect, timeoutMs, \"Timed out while connecting\");\n    } catch (e) {\n      this.debug(\"Failed to connect\", e);\n      this._status = 3 /* DISCONNECTED */;\n      this.handleReconnection();\n      throw e;\n    }\n  }\n  disconnect() {\n    this._status = 2 /* DISCONNECTING */;\n    this.relay.close();\n  }\n  get status() {\n    return this._status;\n  }\n  isAvailable() {\n    return this._status === 1 /* CONNECTED */;\n  }\n  /**\n   * Evaluates the connection stats to determine if the relay is flapping.\n   */\n  isFlapping() {\n    const durations = this._connectionStats.durations;\n    if (durations.length % 3 !== 0)\n      return false;\n    const sum = durations.reduce((a, b) => a + b, 0);\n    const avg = sum / durations.length;\n    const variance = durations.map((x) => Math.pow(x - avg, 2)).reduce((a, b) => a + b, 0) / durations.length;\n    const stdDev = Math.sqrt(variance);\n    const isFlapping = stdDev < 1e3;\n    return isFlapping;\n  }\n  async handleNotice(notice) {\n    if (notice.includes(\"oo many\") || notice.includes(\"aximum\")) {\n      this.disconnect();\n      setTimeout(() => this.connect(), 2e3);\n      this.debug(this.relay.url, \"Relay complaining?\", notice);\n    }\n    this.ndkRelay.emit(\"notice\", this.relay, notice);\n  }\n  /**\n   * Called when the relay is unexpectedly disconnected.\n   */\n  handleReconnection(attempt = 0) {\n    if (this.reconnectTimeout)\n      return;\n    this.debug(\"Attempting to reconnect\", { attempt });\n    if (this.isFlapping()) {\n      this.ndkRelay.emit(\"flapping\", this, this._connectionStats);\n      this._status = 5 /* FLAPPING */;\n      return;\n    }\n    const reconnectDelay = this.connectedAt ? Math.max(0, 6e4 - (Date.now() - this.connectedAt)) : 5e3 * (this._connectionStats.attempts + 1);\n    this.reconnectTimeout = setTimeout(() => {\n      this.reconnectTimeout = void 0;\n      this._status = 4 /* RECONNECTING */;\n      this.debug(`Reconnection attempt #${attempt}`);\n      this.connect().then(() => {\n        this.debug(\"Reconnected\");\n      }).catch((err) => {\n        this.debug(\"Reconnect failed\", err);\n        if (attempt < 10) {\n          setTimeout(() => {\n            this.handleReconnection(attempt + 1);\n          }, 1e3 * (attempt + 1) ^ 2);\n        } else {\n          this.debug(\"Reconnect failed after 10 attempts\");\n        }\n      });\n    }, reconnectDelay);\n    this.debug(\"Reconnecting in\", reconnectDelay);\n    this._connectionStats.nextReconnectAt = Date.now() + reconnectDelay;\n  }\n  /**\n   * Utility functions to update the connection stats.\n   */\n  updateConnectionStats = {\n    connected: () => {\n      this._connectionStats.success++;\n      this._connectionStats.connectedAt = Date.now();\n    },\n    disconnected: () => {\n      if (this._connectionStats.connectedAt) {\n        this._connectionStats.durations.push(\n          Date.now() - this._connectionStats.connectedAt\n        );\n        if (this._connectionStats.durations.length > 100) {\n          this._connectionStats.durations.shift();\n        }\n      }\n      this._connectionStats.connectedAt = void 0;\n    },\n    attempt: () => {\n      this._connectionStats.attempts++;\n    }\n  };\n  /**\n   * Returns the connection stats.\n   */\n  get connectionStats() {\n    return this._connectionStats;\n  }\n};\n\n// src/relay/publisher.ts\nvar NDKRelayPublisher = class {\n  ndkRelay;\n  constructor(ndkRelay) {\n    this.ndkRelay = ndkRelay;\n  }\n  /**\n   * Published an event to the relay; if the relay is not connected, it will\n   * wait for the relay to connect before publishing the event.\n   *\n   * If the relay does not connect within the timeout, the publish operation\n   * will fail.\n   * @param event  The event to publish\n   * @param timeoutMs  The timeout for the publish operation in milliseconds\n   * @returns A promise that resolves when the event has been published or rejects if the operation times out\n   */\n  async publish(event, timeoutMs = 2500) {\n    const publishWhenConnected = () => {\n      return new Promise((resolve, reject) => {\n        try {\n          this.publishEvent(event, timeoutMs).then((result) => resolve(result)).catch((err) => reject(err));\n        } catch (err) {\n          reject(err);\n        }\n      });\n    };\n    const timeoutPromise = new Promise((_, reject) => {\n      setTimeout(() => reject(new Error(\"Timeout\")), timeoutMs);\n    });\n    const onConnectHandler = () => {\n      publishWhenConnected().then((result) => connectResolve(result)).catch((err) => connectReject(err));\n    };\n    let connectResolve;\n    let connectReject;\n    if (this.ndkRelay.status === 1 /* CONNECTED */) {\n      return Promise.race([publishWhenConnected(), timeoutPromise]);\n    } else {\n      return Promise.race([\n        new Promise((resolve, reject) => {\n          connectResolve = resolve;\n          connectReject = reject;\n          this.ndkRelay.once(\"connect\", onConnectHandler);\n        }),\n        timeoutPromise\n      ]).finally(() => {\n        this.ndkRelay.removeListener(\"connect\", onConnectHandler);\n      });\n    }\n  }\n  async publishEvent(event, timeoutMs) {\n    const nostrEvent = await event.toNostrEvent();\n    const publish = this.ndkRelay.connectivity.relay.publish(nostrEvent);\n    let publishTimeout;\n    const publishPromise = new Promise((resolve, reject) => {\n      publish.then(() => {\n        clearTimeout(publishTimeout);\n        this.ndkRelay.emit(\"published\", event);\n        resolve(true);\n      }).catch((err) => {\n        clearTimeout(publishTimeout);\n        this.ndkRelay.debug(\"Publish failed\", err, event.id);\n        this.ndkRelay.emit(\"publish:failed\", event, err);\n        reject(err);\n      });\n    });\n    if (!timeoutMs || event.isEphemeral()) {\n      return publishPromise;\n    }\n    const timeoutPromise = new Promise((_, reject) => {\n      publishTimeout = setTimeout(() => {\n        this.ndkRelay.debug(\"Publish timed out\", event.rawEvent());\n        this.ndkRelay.emit(\"publish:failed\", event, \"Timeout\");\n        reject(new Error(\"Publish operation timed out\"));\n      }, timeoutMs);\n    });\n    return Promise.race([publishPromise, timeoutPromise]);\n  }\n  async auth(event) {\n    return this.ndkRelay.connectivity.relay.auth(event.rawEvent());\n  }\n};\n\n// src/relay/subscriptions.ts\nimport { EventEmitter } from \"tseep\";\nimport { matchFilter } from \"nostr-tools\";\n\n// src/subscription/grouping.ts\nfunction calculateGroupableId(filters) {\n  const elements = [];\n  for (const filter of filters) {\n    const hasTimeConstraints = filter.since || filter.until;\n    if (hasTimeConstraints)\n      return null;\n    const keys = Object.keys(filter || {}).sort().join(\"-\");\n    elements.push(keys);\n  }\n  return elements.join(\"|\");\n}\nfunction mergeFilters(filters) {\n  const result = {};\n  filters.forEach((filter) => {\n    Object.entries(filter).forEach(([key, value]) => {\n      if (Array.isArray(value)) {\n        if (result[key] === void 0) {\n          result[key] = [...value];\n        } else {\n          result[key] = Array.from(/* @__PURE__ */ new Set([...result[key], ...value]));\n        }\n      } else {\n        result[key] = value;\n      }\n    });\n  });\n  return result;\n}\n\n// src/subscription/utils.ts\nimport { nip19 } from \"nostr-tools\";\nvar MAX_SUBID_LENGTH = 20;\nfunction queryFullyFilled(subscription) {\n  if (filterIncludesIds(subscription.filter)) {\n    if (resultHasAllRequestedIds(subscription)) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction compareFilter(filter1, filter2) {\n  if (Object.keys(filter1).length !== Object.keys(filter2).length)\n    return false;\n  for (const [key, value] of Object.entries(filter1)) {\n    const valuesInFilter2 = filter2[key];\n    if (!valuesInFilter2)\n      return false;\n    if (Array.isArray(value) && Array.isArray(valuesInFilter2)) {\n      const v = value;\n      for (const valueInFilter2 of valuesInFilter2) {\n        const val = valueInFilter2;\n        if (!v.includes(val)) {\n          return false;\n        }\n      }\n    } else {\n      if (valuesInFilter2 !== value)\n        return false;\n    }\n  }\n  return true;\n}\nfunction filterIncludesIds(filter) {\n  return !!filter[\"ids\"];\n}\nfunction resultHasAllRequestedIds(subscription) {\n  const ids = subscription.filter[\"ids\"];\n  return !!ids && ids.length === subscription.eventFirstSeen.size;\n}\nfunction generateSubId(subscriptions, filters) {\n  const subIds = subscriptions.map((sub) => sub.subId).filter(Boolean);\n  const subIdParts = [];\n  const filterNonKindKeys = /* @__PURE__ */ new Set();\n  const filterKinds = /* @__PURE__ */ new Set();\n  if (subIds.length > 0) {\n    subIdParts.push(Array.from(new Set(subIds)).join(\",\"));\n  } else {\n    for (const filter of filters) {\n      for (const key of Object.keys(filter)) {\n        if (key === \"kinds\") {\n          filter.kinds?.forEach((k) => filterKinds.add(k));\n        } else {\n          filterNonKindKeys.add(key);\n        }\n      }\n    }\n    if (filterKinds.size > 0) {\n      subIdParts.push(\"kinds:\" + Array.from(filterKinds).join(\",\"));\n    }\n    if (filterNonKindKeys.size > 0) {\n      subIdParts.push(Array.from(filterNonKindKeys).join(\",\"));\n    }\n  }\n  let subId = subIdParts.join(\"-\");\n  if (subId.length > MAX_SUBID_LENGTH)\n    subId = subId.substring(0, MAX_SUBID_LENGTH);\n  if (subIds.length !== 1) {\n    subId += \"-\" + Math.floor(Math.random() * 999).toString();\n  }\n  return subId;\n}\nfunction filterFromId(id) {\n  let decoded;\n  if (id.match(NIP33_A_REGEX)) {\n    const [kind, pubkey, identifier] = id.split(\":\");\n    const filter = {\n      authors: [pubkey],\n      kinds: [parseInt(kind)]\n    };\n    if (identifier) {\n      filter[\"#d\"] = [identifier];\n    }\n    return filter;\n  }\n  try {\n    decoded = nip19.decode(id);\n    switch (decoded.type) {\n      case \"nevent\":\n        return { ids: [decoded.data.id] };\n      case \"note\":\n        return { ids: [decoded.data] };\n      case \"naddr\":\n        return {\n          authors: [decoded.data.pubkey],\n          \"#d\": [decoded.data.identifier],\n          kinds: [decoded.data.kind]\n        };\n    }\n  } catch (e) {\n  }\n  return { ids: [id] };\n}\nfunction isNip33AValue(value) {\n  return value.match(NIP33_A_REGEX) !== null;\n}\nvar NIP33_A_REGEX = /^(\\d+):([0-9A-Fa-f]+)(?::(.*))?$/;\nfunction relaysFromBech32(bech322) {\n  try {\n    const decoded = nip19.decode(bech322);\n    if ([\"naddr\", \"nevent\"].includes(decoded?.type)) {\n      const data = decoded.data;\n      if (data?.relays) {\n        return data.relays.map((r) => new NDKRelay(r));\n      }\n    }\n  } catch (e) {\n  }\n  return [];\n}\n\n// src/relay/subscriptions.ts\nvar NDKGroupedSubscriptions = class extends EventEmitter {\n  subscriptions;\n  req;\n  debug;\n  constructor(subscriptions, debug7) {\n    super();\n    this.subscriptions = subscriptions;\n    this.debug = debug7 || this.subscriptions[0].subscription.debug.extend(\"grouped\");\n    for (const subscription of subscriptions) {\n      this.handleSubscriptionClosure(subscription);\n    }\n  }\n  /**\n   * Adds a subscription to this group.\n   * @param subscription\n   */\n  addSubscription(subscription) {\n    this.subscriptions.push(subscription);\n    this.handleSubscriptionClosure(subscription);\n  }\n  eventReceived(event) {\n    for (const subscription of this.subscriptions) {\n      subscription.eventReceived(event);\n    }\n  }\n  eoseReceived(relay) {\n    const subscriptionsToInform = Array.from(this.subscriptions);\n    subscriptionsToInform.forEach(async (subscription) => {\n      subscription.subscription.eoseReceived(relay);\n    });\n  }\n  handleSubscriptionClosure(subscription) {\n    subscription.subscription.on(\"close\", () => {\n      const index = this.subscriptions.findIndex(\n        (i) => i.subscription === subscription.subscription\n      );\n      this.subscriptions.splice(index, 1);\n      if (this.subscriptions.length <= 0) {\n        this.emit(\"close\");\n      }\n    });\n  }\n  /**\n   * Maps each subscription through a transformation function.\n   * @param fn - The transformation function.\n   * @returns A new array with each subscription transformed by fn.\n   */\n  map(fn) {\n    return this.subscriptions.map(fn);\n  }\n  [Symbol.iterator]() {\n    let index = 0;\n    const subscriptions = this.subscriptions;\n    return {\n      next() {\n        if (index < subscriptions.length) {\n          return { value: subscriptions[index++], done: false };\n        } else {\n          return { value: null, done: true };\n        }\n      }\n    };\n  }\n};\nvar NDKSubscriptionFilters = class {\n  subscription;\n  filters = [];\n  ndkRelay;\n  constructor(subscription, filters, ndkRelay) {\n    this.subscription = subscription;\n    this.filters = filters;\n    this.ndkRelay = ndkRelay;\n  }\n  eventReceived(event) {\n    if (!this.eventMatchesLocalFilter(event))\n      return;\n    this.subscription.eventReceived(event, this.ndkRelay, false);\n  }\n  eventMatchesLocalFilter(event) {\n    const rawEvent = event.rawEvent();\n    return this.filters.some((filter) => matchFilter(filter, rawEvent));\n  }\n};\nfunction findMatchingActiveSubscriptions(activeSubscriptions, filters) {\n  if (activeSubscriptions.length !== filters.length)\n    return false;\n  for (let i = 0; i < activeSubscriptions.length; i++) {\n    if (!compareFilter(activeSubscriptions[i], filters[i])) {\n      break;\n    }\n    return activeSubscriptions[i];\n  }\n  return void 0;\n}\nvar NDKRelaySubscriptions = class {\n  ndkRelay;\n  delayedItems = /* @__PURE__ */ new Map();\n  delayedTimers = /* @__PURE__ */ new Map();\n  /**\n   * Active subscriptions this relay is connected to\n   */\n  activeSubscriptions = /* @__PURE__ */ new Map();\n  activeSubscriptionsByGroupId = /* @__PURE__ */ new Map();\n  executionTimeoutsByGroupId = /* @__PURE__ */ new Map();\n  debug;\n  groupingDebug;\n  conn;\n  constructor(ndkRelay) {\n    this.ndkRelay = ndkRelay;\n    this.conn = ndkRelay.connectivity;\n    this.debug = ndkRelay.debug.extend(\"subscriptions\");\n    this.groupingDebug = ndkRelay.debug.extend(\"grouping\");\n  }\n  /**\n   * Creates or queues a subscription to the relay.\n   */\n  subscribe(subscription, filters) {\n    const groupableId = calculateGroupableId(filters);\n    const subscriptionFilters = new NDKSubscriptionFilters(\n      subscription,\n      filters,\n      this.ndkRelay\n    );\n    const isNotGroupable = !groupableId || !subscription.isGroupable();\n    if (isNotGroupable) {\n      this.executeSubscriptions(\n        groupableId,\n        // hacky\n        new NDKGroupedSubscriptions([subscriptionFilters]),\n        filters\n      );\n      return;\n    }\n    const activeSubscriptions = this.activeSubscriptionsByGroupId.get(groupableId);\n    if (activeSubscriptions) {\n      const matchingSubscription = findMatchingActiveSubscriptions(\n        activeSubscriptions.filters,\n        filters\n      );\n      if (matchingSubscription) {\n        const activeSubscription = this.activeSubscriptions.get(activeSubscriptions.sub);\n        activeSubscription?.addSubscription(\n          new NDKSubscriptionFilters(subscription, filters, this.ndkRelay)\n        );\n        return;\n      }\n    }\n    let delayedItem = this.delayedItems.get(groupableId);\n    if (!delayedItem) {\n      delayedItem = new NDKGroupedSubscriptions([subscriptionFilters]);\n      this.delayedItems.set(groupableId, delayedItem);\n      delayedItem.once(\"close\", () => {\n        const delayedItem2 = this.delayedItems.get(groupableId);\n        if (!delayedItem2)\n          return;\n        this.delayedItems.delete(groupableId);\n      });\n    } else {\n      delayedItem.addSubscription(subscriptionFilters);\n    }\n    let timeout = this.executionTimeoutsByGroupId.get(groupableId);\n    if (!timeout || subscription.opts.groupableDelayType === \"at-most\") {\n      timeout = setTimeout(() => {\n        this.executeGroup(groupableId, subscription);\n      }, subscription.opts.groupableDelay);\n      this.executionTimeoutsByGroupId.set(groupableId, timeout);\n    }\n    if (this.delayedTimers.has(groupableId)) {\n      this.delayedTimers.get(groupableId).push(timeout);\n    } else {\n      this.delayedTimers.set(groupableId, [timeout]);\n    }\n  }\n  /**\n   * Executes a delayed subscription via its groupable ID.\n   * @param groupableId\n   */\n  executeGroup(groupableId, triggeredBy) {\n    const delayedItem = this.delayedItems.get(groupableId);\n    this.delayedItems.delete(groupableId);\n    const timeouts = this.delayedTimers.get(groupableId);\n    this.delayedTimers.delete(groupableId);\n    if (timeouts) {\n      for (const timeout of timeouts) {\n        clearTimeout(timeout);\n      }\n    }\n    if (delayedItem) {\n      const filterCount = delayedItem.subscriptions[0].filters.length;\n      const mergedFilters = [];\n      for (let i = 0; i < filterCount; i++) {\n        const allFiltersAtIndex = delayedItem.map((di) => di.filters[i]);\n        mergedFilters.push(mergeFilters(allFiltersAtIndex));\n      }\n      this.executeSubscriptions(groupableId, delayedItem, mergedFilters);\n    }\n  }\n  executeSubscriptionsWhenConnected(groupableId, groupedSubscriptions, mergedFilters) {\n    const readyListener = () => {\n      this.debug(\"new relay coming online for active subscription\", {\n        relay: this.ndkRelay.url\n        // mergedFilters: JSON.stringify(mergedFilters),\n      });\n      this.executeSubscriptionsConnected(groupableId, groupedSubscriptions, mergedFilters);\n    };\n    this.ndkRelay.once(\"ready\", readyListener);\n    groupedSubscriptions.once(\"close\", () => {\n      this.ndkRelay.removeListener(\"ready\", readyListener);\n    });\n  }\n  /**\n   * Executes one or more subscriptions.\n   *\n   * If the relay is not connected, subscriptions will be queued\n   * until the relay connects.\n   *\n   * @param groupableId\n   * @param subscriptionFilters\n   * @param mergedFilters\n   */\n  executeSubscriptions(groupableId, groupedSubscriptions, mergedFilters) {\n    if (this.conn.isAvailable()) {\n      this.executeSubscriptionsConnected(groupableId, groupedSubscriptions, mergedFilters);\n    } else {\n      this.executeSubscriptionsWhenConnected(\n        groupableId,\n        groupedSubscriptions,\n        mergedFilters\n      );\n    }\n  }\n  /**\n   * Executes one or more subscriptions.\n   *\n   * When there are more than one subscription, results\n   * will be sent to the right subscription\n   *\n   * @param subscriptions\n   * @param filters The filters as they should be sent to the relay\n   */\n  executeSubscriptionsConnected(groupableId, groupedSubscriptions, mergedFilters) {\n    const subscriptions = [];\n    for (const { subscription } of groupedSubscriptions) {\n      subscriptions.push(subscription);\n    }\n    const subId = generateSubId(subscriptions, mergedFilters);\n    groupedSubscriptions.req = mergedFilters;\n    const subOptions = { id: subId };\n    if (this.ndkRelay.trusted || subscriptions.every((sub2) => sub2.opts.skipVerification)) {\n      subOptions.skipVerification = true;\n    }\n    const sub = this.conn.relay.sub(mergedFilters, subOptions);\n    this.activeSubscriptions.set(sub, groupedSubscriptions);\n    if (groupableId) {\n      this.activeSubscriptionsByGroupId.set(groupableId, { filters: mergedFilters, sub });\n    }\n    sub.on(\"event\", (event) => {\n      const e = new NDKEvent(void 0, event);\n      e.relay = this.ndkRelay;\n      const subFilters = this.activeSubscriptions.get(sub);\n      subFilters?.eventReceived(e);\n    });\n    sub.on(\"eose\", () => {\n      const subFilters = this.activeSubscriptions.get(sub);\n      subFilters?.eoseReceived(this.ndkRelay);\n    });\n    groupedSubscriptions.once(\"close\", () => {\n      sub.unsub();\n      this.activeSubscriptions.delete(sub);\n      if (groupableId) {\n        this.activeSubscriptionsByGroupId.delete(groupableId);\n      }\n    });\n    this.executeSubscriptionsWhenConnected(groupableId, groupedSubscriptions, mergedFilters);\n    return sub;\n  }\n  executedFilters() {\n    const ret = /* @__PURE__ */ new Map();\n    for (const [, groupedSubscriptions] of this.activeSubscriptions) {\n      ret.set(\n        groupedSubscriptions.req,\n        groupedSubscriptions.map((sub) => sub.subscription)\n      );\n    }\n    return ret;\n  }\n};\n\n// src/relay/index.ts\nvar NDKRelayStatus = /* @__PURE__ */ ((NDKRelayStatus2) => {\n  NDKRelayStatus2[NDKRelayStatus2[\"CONNECTING\"] = 0] = \"CONNECTING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"CONNECTED\"] = 1] = \"CONNECTED\";\n  NDKRelayStatus2[NDKRelayStatus2[\"DISCONNECTING\"] = 2] = \"DISCONNECTING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"DISCONNECTED\"] = 3] = \"DISCONNECTED\";\n  NDKRelayStatus2[NDKRelayStatus2[\"RECONNECTING\"] = 4] = \"RECONNECTING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"FLAPPING\"] = 5] = \"FLAPPING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"AUTH_REQUIRED\"] = 6] = \"AUTH_REQUIRED\";\n  NDKRelayStatus2[NDKRelayStatus2[\"AUTHENTICATING\"] = 7] = \"AUTHENTICATING\";\n  return NDKRelayStatus2;\n})(NDKRelayStatus || {});\nvar NDKRelay = class extends EventEmitter2 {\n  url;\n  scores;\n  connectivity;\n  subs;\n  publisher;\n  authPolicy;\n  /**\n   * Whether this relay is trusted.\n   *\n   * Trusted relay's events do not get their signature verified.\n   */\n  trusted = false;\n  complaining = false;\n  debug;\n  constructor(url, authPolicy) {\n    super();\n    this.url = url;\n    this.scores = /* @__PURE__ */ new Map();\n    this.debug = debug(`ndk:relay:${url}`);\n    this.connectivity = new NDKRelayConnectivity(this);\n    this.subs = new NDKRelaySubscriptions(this);\n    this.publisher = new NDKRelayPublisher(this);\n    this.authPolicy = authPolicy;\n  }\n  get status() {\n    return this.connectivity.status;\n  }\n  get connectionStats() {\n    return this.connectivity.connectionStats;\n  }\n  /**\n   * Connects to the relay.\n   */\n  async connect(timeoutMs) {\n    return this.connectivity.connect(timeoutMs);\n  }\n  /**\n   * Disconnects from the relay.\n   */\n  disconnect() {\n    if (this.status === 3 /* DISCONNECTED */) {\n      return;\n    }\n    this.connectivity.disconnect();\n  }\n  /**\n   * Queues or executes the subscription of a specific set of filters\n   * within this relay.\n   *\n   * @param subscription NDKSubscription this filters belong to.\n   * @param filters Filters to execute\n   */\n  subscribe(subscription, filters) {\n    this.subs.subscribe(subscription, filters);\n  }\n  /**\n   * Publishes an event to the relay with an optional timeout.\n   *\n   * If the relay is not connected, the event will be published when the relay connects,\n   * unless the timeout is reached before the relay connects.\n   *\n   * @param event The event to publish\n   * @param timeoutMs The timeout for the publish operation in milliseconds\n   * @returns A promise that resolves when the event has been published or rejects if the operation times out\n   */\n  async publish(event, timeoutMs = 2500) {\n    return this.publisher.publish(event, timeoutMs);\n  }\n  async auth(event) {\n    return this.publisher.auth(event);\n  }\n  /**\n   * Called when this relay has responded with an event but\n   * wasn't the fastest one.\n   * @param timeDiffInMs The time difference in ms between the fastest and this relay in milliseconds\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  scoreSlowerEvent(timeDiffInMs) {\n  }\n  /** @deprecated Use referenceTags instead. */\n  tagReference(marker) {\n    const tag = [\"r\", this.url];\n    if (marker) {\n      tag.push(marker);\n    }\n    return tag;\n  }\n  referenceTags() {\n    return [[\"r\", this.url]];\n  }\n  activeSubscriptions() {\n    return this.subs.executedFilters();\n  }\n};\n\n// src/relay/sets/index.ts\nvar PublishError = class extends Error {\n  errors;\n  constructor(message, errors) {\n    super(message);\n    this.errors = errors;\n  }\n  get relayErrors() {\n    const errors = [];\n    for (const [relay, err] of this.errors) {\n      errors.push(`${relay.url}: ${err}`);\n    }\n    return errors.join(\"\\n\");\n  }\n};\nvar NDKRelaySet = class _NDKRelaySet {\n  relays;\n  debug;\n  ndk;\n  constructor(relays, ndk) {\n    this.relays = relays;\n    this.ndk = ndk;\n    this.debug = ndk.debug.extend(\"relayset\");\n  }\n  /**\n   * Adds a relay to this set.\n   */\n  addRelay(relay) {\n    this.relays.add(relay);\n  }\n  /**\n   * Creates a relay set from a list of relay URLs.\n   *\n   * If no connection to the relay is found in the pool it will temporarily\n   * connect to it.\n   *\n   * @param relayUrls - list of relay URLs to include in this set\n   * @param ndk\n   * @returns NDKRelaySet\n   */\n  static fromRelayUrls(relayUrls, ndk) {\n    const relays = /* @__PURE__ */ new Set();\n    for (const url of relayUrls) {\n      const relay = ndk.pool.relays.get(url);\n      if (relay) {\n        relays.add(relay);\n      } else {\n        const temporaryRelay = new NDKRelay(url);\n        ndk.pool.useTemporaryRelay(temporaryRelay);\n        relays.add(temporaryRelay);\n      }\n    }\n    return new _NDKRelaySet(new Set(relays), ndk);\n  }\n  /**\n   * Publish an event to all relays in this set. Returns the number of relays that have received the event.\n   * @param event\n   * @param timeoutMs - timeout in milliseconds for each publish operation and connection operation\n   * @returns A set where the event was successfully published to\n   * @throws PublishError if no relay was able to receive the event\n   * @example\n   * ```typescript\n   * const event = new NDKEvent(ndk, {kinds: [NDKKind.Message], \"#d\": [\"123\"]});\n   * try {\n   *    const publishedToRelays = await relaySet.publish(event);\n   *    console.log(`published to ${publishedToRelays.size} relays`)\n   * } catch (error) {\n   *   console.error(\"error publishing to relays\", error);\n   *\n   *   if (error instanceof PublishError) {\n   *      for (const [relay, err] of error.errors) {\n   *         console.error(`error publishing to relay ${relay.url}`, err);\n   *       }\n   *   }\n   * }\n   * ```\n   */\n  async publish(event, timeoutMs) {\n    const publishedToRelays = /* @__PURE__ */ new Set();\n    const errors = /* @__PURE__ */ new Map();\n    const isEphemeral2 = event.isEphemeral();\n    const promises = Array.from(this.relays).map((relay) => {\n      return new Promise((resolve) => {\n        relay.publish(event, timeoutMs).then((e) => {\n          publishedToRelays.add(relay);\n          resolve();\n        }).catch((err) => {\n          if (!isEphemeral2) {\n            errors.set(relay, err);\n            this.debug(\"error publishing to relay\", {\n              relay: relay.url,\n              err\n            });\n          }\n          resolve();\n        });\n      });\n    });\n    await Promise.all(promises);\n    if (publishedToRelays.size === 0) {\n      if (!isEphemeral2) {\n        throw new PublishError(\"No relay was able to receive the event\", errors);\n      }\n    }\n    return publishedToRelays;\n  }\n  get size() {\n    return this.relays.size;\n  }\n};\n\n// src/relay/sets/calculate.ts\nfunction calculateRelaySetFromEvent(ndk, event) {\n  const relays = /* @__PURE__ */ new Set();\n  ndk.pool?.relays.forEach((relay) => relays.add(relay));\n  return new NDKRelaySet(relays, ndk);\n}\nfunction calculateRelaySetsFromFilter(ndk, filters, pool) {\n  const result = /* @__PURE__ */ new Map();\n  const authors = /* @__PURE__ */ new Set();\n  filters.forEach((filter) => {\n    if (filter.authors) {\n      filter.authors.forEach((author) => authors.add(author));\n    }\n  });\n  if (authors.size > 0) {\n    const authorToRelaysMap = getRelaysForFilterWithAuthors(ndk, Array.from(authors), pool);\n    for (const relayUrl of authorToRelaysMap.keys()) {\n      result.set(relayUrl, []);\n    }\n    for (const filter of filters) {\n      if (filter.authors) {\n        for (const [relayUrl, authors2] of authorToRelaysMap.entries()) {\n          const authorFilterAndRelayPubkeyIntersection = filter.authors.filter(\n            (author) => authors2.includes(author)\n          );\n          result.set(relayUrl, [\n            ...result.get(relayUrl),\n            {\n              ...filter,\n              // Overwrite authors sent to this relay with the authors that were\n              // present in the filter and are also present in the relay\n              authors: authorFilterAndRelayPubkeyIntersection\n            }\n          ]);\n        }\n      } else {\n        for (const relayUrl of authorToRelaysMap.keys()) {\n          result.set(relayUrl, [...result.get(relayUrl), filter]);\n        }\n      }\n    }\n  } else {\n    Array.from(pool.relays.keys()).forEach((relay) => {\n      result.set(relay, filters);\n    });\n  }\n  return result;\n}\nfunction calculateRelaySetsFromFilters(ndk, filters, pool) {\n  return calculateRelaySetsFromFilter(ndk, filters, pool);\n}\n\n// src/events/content-tagger.ts\nimport { nip19 as nip192 } from \"nostr-tools\";\nfunction mergeTags(tags1, tags2) {\n  const tagMap = /* @__PURE__ */ new Map();\n  const generateKey = (tag) => tag.join(\",\");\n  const isContained = (smaller, larger) => {\n    return smaller.every((value, index) => value === larger[index]);\n  };\n  const processTag = (tag) => {\n    for (let [key, existingTag] of tagMap) {\n      if (isContained(existingTag, tag) || isContained(tag, existingTag)) {\n        if (tag.length >= existingTag.length) {\n          tagMap.set(key, tag);\n        }\n        return;\n      }\n    }\n    tagMap.set(generateKey(tag), tag);\n  };\n  tags1.concat(tags2).forEach(processTag);\n  return Array.from(tagMap.values());\n}\nasync function generateContentTags(content, tags = []) {\n  const tagRegex = /(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g;\n  const hashtagRegex = /#(\\w+)/g;\n  let promises = [];\n  const addTagIfNew = (t) => {\n    if (!tags.find((t2) => t2[0] === t[0] && t2[1] === t[1])) {\n      tags.push(t);\n    }\n  };\n  content = content.replace(tagRegex, (tag) => {\n    try {\n      const entity = tag.split(/(@|nostr:)/)[2];\n      const { type, data } = nip192.decode(entity);\n      let t;\n      switch (type) {\n        case \"npub\":\n          t = [\"p\", data];\n          break;\n        case \"nprofile\":\n          t = [\"p\", data.pubkey];\n          break;\n        case \"note\":\n          promises.push(\n            new Promise(async (resolve) => {\n              addTagIfNew([\n                \"e\",\n                data,\n                await maybeGetEventRelayUrl(entity),\n                \"mention\"\n              ]);\n              resolve();\n            })\n          );\n          break;\n        case \"nevent\":\n          promises.push(\n            new Promise(async (resolve) => {\n              let { id, relays, author } = data;\n              if (!relays || relays.length === 0) {\n                relays = [await maybeGetEventRelayUrl(entity)];\n              }\n              addTagIfNew([\"e\", id, relays[0], \"mention\"]);\n              if (author)\n                addTagIfNew([\"p\", author]);\n              resolve();\n            })\n          );\n          break;\n        case \"naddr\":\n          promises.push(\n            new Promise(async (resolve) => {\n              const id = [data.kind, data.pubkey, data.identifier].join(\":\");\n              let relays = data.relays ?? [];\n              if (relays.length === 0) {\n                relays = [await maybeGetEventRelayUrl(entity)];\n              }\n              addTagIfNew([\"a\", id, relays[0], \"mention\"]);\n              addTagIfNew([\"p\", data.pubkey]);\n              resolve();\n            })\n          );\n          break;\n        default:\n          return tag;\n      }\n      if (t)\n        addTagIfNew(t);\n      return `nostr:${entity}`;\n    } catch (error) {\n      return tag;\n    }\n  });\n  await Promise.all(promises);\n  content = content.replace(hashtagRegex, (tag, word) => {\n    const t = [\"t\", word];\n    if (!tags.find((t2) => t2[0] === t[0] && t2[1] === t[1])) {\n      tags.push(t);\n    }\n    return tag;\n  });\n  return { content, tags };\n}\nasync function maybeGetEventRelayUrl(nip19Id) {\n  return \"\";\n}\n\n// src/events/kind.ts\nfunction isReplaceable() {\n  if (this.kind === void 0)\n    throw new Error(\"Kind not set\");\n  return [0, 3].includes(this.kind) || this.kind >= 1e4 && this.kind < 2e4 || this.kind >= 3e4 && this.kind < 4e4;\n}\nfunction isEphemeral() {\n  if (this.kind === void 0)\n    throw new Error(\"Kind not set\");\n  return this.kind >= 2e4 && this.kind < 3e4;\n}\nfunction isParamReplaceable() {\n  if (this.kind === void 0)\n    throw new Error(\"Kind not set\");\n  return this.kind >= 3e4 && this.kind < 4e4;\n}\n\n// src/events/kinds/index.ts\nvar NDKKind = /* @__PURE__ */ ((NDKKind2) => {\n  NDKKind2[NDKKind2[\"Metadata\"] = 0] = \"Metadata\";\n  NDKKind2[NDKKind2[\"Text\"] = 1] = \"Text\";\n  NDKKind2[NDKKind2[\"RecommendRelay\"] = 2] = \"RecommendRelay\";\n  NDKKind2[NDKKind2[\"Contacts\"] = 3] = \"Contacts\";\n  NDKKind2[NDKKind2[\"EncryptedDirectMessage\"] = 4] = \"EncryptedDirectMessage\";\n  NDKKind2[NDKKind2[\"EventDeletion\"] = 5] = \"EventDeletion\";\n  NDKKind2[NDKKind2[\"Repost\"] = 6] = \"Repost\";\n  NDKKind2[NDKKind2[\"Reaction\"] = 7] = \"Reaction\";\n  NDKKind2[NDKKind2[\"BadgeAward\"] = 8] = \"BadgeAward\";\n  NDKKind2[NDKKind2[\"GroupChat\"] = 9] = \"GroupChat\";\n  NDKKind2[NDKKind2[\"GroupNote\"] = 11] = \"GroupNote\";\n  NDKKind2[NDKKind2[\"GroupReply\"] = 12] = \"GroupReply\";\n  NDKKind2[NDKKind2[\"GenericRepost\"] = 16] = \"GenericRepost\";\n  NDKKind2[NDKKind2[\"ChannelCreation\"] = 40] = \"ChannelCreation\";\n  NDKKind2[NDKKind2[\"ChannelMetadata\"] = 41] = \"ChannelMetadata\";\n  NDKKind2[NDKKind2[\"ChannelMessage\"] = 42] = \"ChannelMessage\";\n  NDKKind2[NDKKind2[\"ChannelHideMessage\"] = 43] = \"ChannelHideMessage\";\n  NDKKind2[NDKKind2[\"ChannelMuteUser\"] = 44] = \"ChannelMuteUser\";\n  NDKKind2[NDKKind2[\"Media\"] = 1063] = \"Media\";\n  NDKKind2[NDKKind2[\"Report\"] = 1984] = \"Report\";\n  NDKKind2[NDKKind2[\"Label\"] = 1985] = \"Label\";\n  NDKKind2[NDKKind2[\"DVMReqTextExtraction\"] = 5e3] = \"DVMReqTextExtraction\";\n  NDKKind2[NDKKind2[\"DVMReqTextSummarization\"] = 5001] = \"DVMReqTextSummarization\";\n  NDKKind2[NDKKind2[\"DVMReqTextTranslation\"] = 5002] = \"DVMReqTextTranslation\";\n  NDKKind2[NDKKind2[\"DVMReqTextGeneration\"] = 5050] = \"DVMReqTextGeneration\";\n  NDKKind2[NDKKind2[\"DVMReqImageGeneration\"] = 5100] = \"DVMReqImageGeneration\";\n  NDKKind2[NDKKind2[\"DVMReqDiscoveryNostrContent\"] = 5300] = \"DVMReqDiscoveryNostrContent\";\n  NDKKind2[NDKKind2[\"DVMReqDiscoveryNostrPeople\"] = 5301] = \"DVMReqDiscoveryNostrPeople\";\n  NDKKind2[NDKKind2[\"DVMReqTimestamping\"] = 5900] = \"DVMReqTimestamping\";\n  NDKKind2[NDKKind2[\"DVMEventSchedule\"] = 5905] = \"DVMEventSchedule\";\n  NDKKind2[NDKKind2[\"DVMJobFeedback\"] = 7e3] = \"DVMJobFeedback\";\n  NDKKind2[NDKKind2[\"Subscribe\"] = 7001] = \"Subscribe\";\n  NDKKind2[NDKKind2[\"Unsubscribe\"] = 7002] = \"Unsubscribe\";\n  NDKKind2[NDKKind2[\"SubscriptionReceipt\"] = 7003] = \"SubscriptionReceipt\";\n  NDKKind2[NDKKind2[\"GroupAdminAddUser\"] = 9e3] = \"GroupAdminAddUser\";\n  NDKKind2[NDKKind2[\"GroupAdminRemoveUser\"] = 9001] = \"GroupAdminRemoveUser\";\n  NDKKind2[NDKKind2[\"GroupAdminEditMetadata\"] = 9002] = \"GroupAdminEditMetadata\";\n  NDKKind2[NDKKind2[\"GroupAdminEditStatus\"] = 9006] = \"GroupAdminEditStatus\";\n  NDKKind2[NDKKind2[\"MuteList\"] = 1e4] = \"MuteList\";\n  NDKKind2[NDKKind2[\"PinList\"] = 10001] = \"PinList\";\n  NDKKind2[NDKKind2[\"RelayList\"] = 10002] = \"RelayList\";\n  NDKKind2[NDKKind2[\"BookmarkList\"] = 10003] = \"BookmarkList\";\n  NDKKind2[NDKKind2[\"CommunityList\"] = 10004] = \"CommunityList\";\n  NDKKind2[NDKKind2[\"PublicChatList\"] = 10005] = \"PublicChatList\";\n  NDKKind2[NDKKind2[\"BlockRelayList\"] = 10006] = \"BlockRelayList\";\n  NDKKind2[NDKKind2[\"SearchRelayList\"] = 10007] = \"SearchRelayList\";\n  NDKKind2[NDKKind2[\"SimpleGroupList\"] = 10009] = \"SimpleGroupList\";\n  NDKKind2[NDKKind2[\"InterestList\"] = 10015] = \"InterestList\";\n  NDKKind2[NDKKind2[\"EmojiList\"] = 10030] = \"EmojiList\";\n  NDKKind2[NDKKind2[\"NostrWaletConnectInfo\"] = 13194] = \"NostrWaletConnectInfo\";\n  NDKKind2[NDKKind2[\"TierList\"] = 17e3] = \"TierList\";\n  NDKKind2[NDKKind2[\"FollowSet\"] = 3e4] = \"FollowSet\";\n  NDKKind2[NDKKind2[\"CategorizedPeopleList\"] = 3e4 /* FollowSet */] = \"CategorizedPeopleList\";\n  NDKKind2[NDKKind2[\"CategorizedBookmarkList\"] = 30001] = \"CategorizedBookmarkList\";\n  NDKKind2[NDKKind2[\"RelaySet\"] = 30002] = \"RelaySet\";\n  NDKKind2[NDKKind2[\"CategorizedRelayList\"] = 30002 /* RelaySet */] = \"CategorizedRelayList\";\n  NDKKind2[NDKKind2[\"BookmarkSet\"] = 30003] = \"BookmarkSet\";\n  NDKKind2[NDKKind2[\"CurationSet\"] = 30004] = \"CurationSet\";\n  NDKKind2[NDKKind2[\"ArticleCurationSet\"] = 30004] = \"ArticleCurationSet\";\n  NDKKind2[NDKKind2[\"VideoCurationSet\"] = 30005] = \"VideoCurationSet\";\n  NDKKind2[NDKKind2[\"InterestSet\"] = 30015] = \"InterestSet\";\n  NDKKind2[NDKKind2[\"InterestsList\"] = 30015 /* InterestSet */] = \"InterestsList\";\n  NDKKind2[NDKKind2[\"EmojiSet\"] = 30030] = \"EmojiSet\";\n  NDKKind2[NDKKind2[\"HighlightSet\"] = 39802] = \"HighlightSet\";\n  NDKKind2[NDKKind2[\"SubscriptionTier\"] = 37001] = \"SubscriptionTier\";\n  NDKKind2[NDKKind2[\"CategorizedHighlightList\"] = 39802 /* HighlightSet */] = \"CategorizedHighlightList\";\n  NDKKind2[NDKKind2[\"ZapRequest\"] = 9734] = \"ZapRequest\";\n  NDKKind2[NDKKind2[\"Zap\"] = 9735] = \"Zap\";\n  NDKKind2[NDKKind2[\"Highlight\"] = 9802] = \"Highlight\";\n  NDKKind2[NDKKind2[\"ClientAuth\"] = 22242] = \"ClientAuth\";\n  NDKKind2[NDKKind2[\"NostrWalletConnectReq\"] = 23194] = \"NostrWalletConnectReq\";\n  NDKKind2[NDKKind2[\"NostrWalletConnectRes\"] = 23195] = \"NostrWalletConnectRes\";\n  NDKKind2[NDKKind2[\"NostrConnect\"] = 24133] = \"NostrConnect\";\n  NDKKind2[NDKKind2[\"HttpAuth\"] = 27235] = \"HttpAuth\";\n  NDKKind2[NDKKind2[\"ProfileBadge\"] = 30008] = \"ProfileBadge\";\n  NDKKind2[NDKKind2[\"BadgeDefinition\"] = 30009] = \"BadgeDefinition\";\n  NDKKind2[NDKKind2[\"MarketStall\"] = 30017] = \"MarketStall\";\n  NDKKind2[NDKKind2[\"MarketProduct\"] = 30018] = \"MarketProduct\";\n  NDKKind2[NDKKind2[\"Article\"] = 30023] = \"Article\";\n  NDKKind2[NDKKind2[\"AppSpecificData\"] = 30078] = \"AppSpecificData\";\n  NDKKind2[NDKKind2[\"Classified\"] = 30402] = \"Classified\";\n  NDKKind2[NDKKind2[\"HorizontalVideo\"] = 34235] = \"HorizontalVideo\";\n  NDKKind2[NDKKind2[\"GroupMetadata\"] = 39e3] = \"GroupMetadata\";\n  NDKKind2[NDKKind2[\"GroupMembers\"] = 39002] = \"GroupMembers\";\n  NDKKind2[NDKKind2[\"AppRecommendation\"] = 31989] = \"AppRecommendation\";\n  NDKKind2[NDKKind2[\"AppHandler\"] = 31990] = \"AppHandler\";\n  return NDKKind2;\n})(NDKKind || {});\nvar NDKListKinds = [\n  1e4 /* MuteList */,\n  10001 /* PinList */,\n  10002 /* RelayList */,\n  10003 /* BookmarkList */,\n  10004 /* CommunityList */,\n  10005 /* PublicChatList */,\n  10006 /* BlockRelayList */,\n  10007 /* SearchRelayList */,\n  10015 /* InterestList */,\n  10030 /* EmojiList */,\n  3e4 /* FollowSet */,\n  30003 /* BookmarkSet */,\n  30001 /* CategorizedBookmarkList */,\n  // Backwards compatibility\n  30002 /* RelaySet */,\n  30004 /* ArticleCurationSet */,\n  30005 /* VideoCurationSet */,\n  30015 /* InterestSet */,\n  30030 /* EmojiSet */,\n  39802 /* HighlightSet */\n];\n\n// src/events/nip04.ts\nasync function encrypt(recipient, signer) {\n  if (!this.ndk)\n    throw new Error(\"No NDK instance found!\");\n  if (!signer) {\n    await this.ndk.assertSigner();\n    signer = this.ndk.signer;\n  }\n  if (!recipient) {\n    const pTags = this.getMatchingTags(\"p\");\n    if (pTags.length !== 1) {\n      throw new Error(\n        \"No recipient could be determined and no explicit recipient was provided\"\n      );\n    }\n    recipient = this.ndk.getUser({ hexpubkey: pTags[0][1] });\n  }\n  this.content = await signer?.encrypt(recipient, this.content);\n}\nasync function decrypt(sender, signer) {\n  if (!this.ndk)\n    throw new Error(\"No NDK instance found!\");\n  if (!signer) {\n    await this.ndk.assertSigner();\n    signer = this.ndk.signer;\n  }\n  if (!sender) {\n    sender = this.author;\n  }\n  this.content = await signer?.decrypt(sender, this.content);\n}\n\n// src/events/nip19.ts\nimport { nip19 as nip193 } from \"nostr-tools\";\nfunction encode() {\n  let relays = [];\n  if (this.onRelays.length > 0) {\n    relays = this.onRelays.map((relay) => relay.url);\n  } else if (this.relay) {\n    relays = [this.relay.url];\n  }\n  if (this.isParamReplaceable()) {\n    return nip193.naddrEncode({\n      kind: this.kind,\n      pubkey: this.pubkey,\n      identifier: this.replaceableDTag(),\n      relays\n    });\n  } else if (relays.length > 0) {\n    return nip193.neventEncode({\n      id: this.tagId(),\n      relays,\n      author: this.pubkey\n    });\n  } else {\n    return nip193.noteEncode(this.tagId());\n  }\n}\n\n// src/events/repost.ts\nasync function repost(publish = true, signer) {\n  if (!signer && publish) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    signer = this.ndk.signer;\n  }\n  const e = new NDKEvent(this.ndk, {\n    kind: getKind(this),\n    content: \"\"\n  });\n  e.tag(this);\n  if (e.kind === 16 /* GenericRepost */) {\n    e.tags.push([\"k\", `${this.kind}`]);\n  }\n  if (signer)\n    await e.sign(signer);\n  if (publish)\n    await e.publish();\n  return e;\n}\nfunction getKind(event) {\n  if (event.kind === 1) {\n    return 6 /* Repost */;\n  }\n  return 16 /* GenericRepost */;\n}\n\n// src/events/serializer.ts\nfunction serialize() {\n  return JSON.stringify([0, this.pubkey, this.created_at, this.kind, this.tags, this.content]);\n}\n\n// src/events/validation.ts\nimport { sha256 } from \"@noble/hashes/sha256\";\nimport { bytesToHex } from \"@noble/hashes/utils\";\nimport { schnorr } from \"@noble/curves/secp256k1\";\nvar PUBKEY_REGEX = /^[a-f0-9]{64}$/;\nfunction validate() {\n  if (typeof this.kind !== \"number\")\n    return false;\n  if (typeof this.content !== \"string\")\n    return false;\n  if (typeof this.created_at !== \"number\")\n    return false;\n  if (typeof this.pubkey !== \"string\")\n    return false;\n  if (!this.pubkey.match(PUBKEY_REGEX))\n    return false;\n  if (!Array.isArray(this.tags))\n    return false;\n  for (let i = 0; i < this.tags.length; i++) {\n    const tag = this.tags[i];\n    if (!Array.isArray(tag))\n      return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] === \"object\")\n        return false;\n    }\n  }\n  return true;\n}\nfunction verifySignature(persist) {\n  if (typeof this.signatureVerified === \"boolean\")\n    return this.signatureVerified;\n  const hash = this.getEventHash();\n  if (hash !== this.id) {\n    return persist ? this.signatureVerified = false : false;\n  }\n  try {\n    return this.signatureVerified = schnorr.verify(this.sig, hash, this.pubkey);\n  } catch (err) {\n    return this.signatureVerified = false;\n  }\n}\nfunction getEventHash() {\n  const eventHash = sha256(new TextEncoder().encode(this.serialize()));\n  return bytesToHex(eventHash);\n}\n\n// src/zap/index.ts\nimport { bech32 } from \"@scure/base\";\nimport { EventEmitter as EventEmitter3 } from \"tseep\";\nimport { nip57 } from \"nostr-tools\";\nimport createDebug from \"debug\";\nvar debug2 = createDebug(\"ndk:zap\");\nvar DEFAULT_RELAYS = [\n  \"wss://nos.lol\",\n  \"wss://relay.nostr.band\",\n  \"wss://relay.f7z.io\",\n  \"wss://relay.damus.io\",\n  \"wss://nostr.mom\",\n  \"wss://no.str.cr\"\n];\nvar NDKZap = class _NDKZap extends EventEmitter3 {\n  ndk;\n  zappedEvent;\n  zappedUser;\n  fetch = fetch;\n  constructor(args) {\n    super();\n    this.ndk = args.ndk;\n    this.zappedEvent = args.zappedEvent;\n    this.fetch = args._fetch || fetch;\n    this.zappedUser = args.zappedUser || this.ndk.getUser({ hexpubkey: this.zappedEvent?.pubkey });\n  }\n  /**\n   * Fetches the zapper's pubkey for the zapped user\n   */\n  static async getZapperPubkey(ndk, forUser) {\n    const zappedUser = ndk.getUser({ pubkey: forUser });\n    const zap = new _NDKZap({ ndk, zappedUser });\n    const lnurlspec = await zap.getZapSpec();\n    return lnurlspec?.nostrPubkey;\n  }\n  async getZapSpec() {\n    if (!this.zappedUser)\n      throw new Error(\"No user to zap was provided\");\n    return this.zappedUser.getZapConfiguration(this.ndk);\n  }\n  async getZapSpecWithoutCache() {\n    let lud06;\n    let lud16;\n    let zapEndpoint;\n    let profile;\n    if (this.zappedUser) {\n      if (!this.zappedUser.profile) {\n        await this.zappedUser.fetchProfile({ groupable: false });\n      }\n      profile = this.zappedUser.profile;\n      lud06 = (this.zappedUser.profile || {}).lud06;\n      lud16 = (this.zappedUser.profile || {}).lud16;\n    }\n    if (lud16 && !lud16.startsWith(\"LNURL\")) {\n      const [name, domain] = lud16.split(\"@\");\n      zapEndpoint = `https://${domain}/.well-known/lnurlp/${name}`;\n    } else if (lud06) {\n      const { words } = bech32.decode(lud06, 1e3);\n      const data = bech32.fromWords(words);\n      const utf8Decoder = new TextDecoder(\"utf-8\");\n      zapEndpoint = utf8Decoder.decode(data);\n    }\n    if (!zapEndpoint) {\n      debug2(\"No zap endpoint found\", profile, { lud06, lud16 });\n      throw new Error(\"No zap endpoint found\");\n    }\n    try {\n      const _fetch = this.fetch || this.ndk.httpFetch;\n      const response = await _fetch(zapEndpoint);\n      if (response.status !== 200) {\n        const text = await response.text();\n        throw new Error(`Unable to fetch zap endpoint ${zapEndpoint}: ${text}`);\n      }\n      return await response.json();\n    } catch (e) {\n      throw new Error(`Unable to fetch zap endpoint ${zapEndpoint}: ${e}`);\n    }\n  }\n  async getZapEndpoint() {\n    const zapSpec = await this.getZapSpec();\n    if (!zapSpec)\n      return;\n    let zapEndpointCallback;\n    if (zapSpec?.allowsNostr && (zapSpec?.nostrPubkey || zapSpec?.nostrPubkey)) {\n      zapEndpointCallback = zapSpec.callback;\n    }\n    return zapEndpointCallback;\n  }\n  /**\n   * Generates a kind:9734 zap request and returns the payment request\n   * @param amount amount to zap in millisatoshis\n   * @param comment optional comment to include in the zap request\n   * @param extraTags optional extra tags to include in the zap request\n   * @param relays optional relays to ask zapper to publish the zap to\n   * @returns the payment request\n   */\n  async createZapRequest(amount, comment, extraTags, relays, signer) {\n    const res = await this.generateZapRequest(amount, comment, extraTags, relays);\n    if (!res)\n      return null;\n    const { event, zapEndpoint } = res;\n    if (!event) {\n      throw new Error(\"No zap request event found\");\n    }\n    await event.sign(signer);\n    let invoice;\n    try {\n      debug2(`Getting invoice for zap request: ${zapEndpoint}`);\n      invoice = await this.getInvoice(event, amount, zapEndpoint);\n    } catch (e) {\n      throw new Error(\"Failed to get invoice: \" + e);\n    }\n    return invoice;\n  }\n  async getInvoice(event, amount, zapEndpoint) {\n    debug2(\n      `Fetching invoice from ${zapEndpoint}?` + new URLSearchParams({\n        amount: amount.toString(),\n        nostr: encodeURIComponent(JSON.stringify(event.rawEvent()))\n      })\n    );\n    const url = new URL(zapEndpoint);\n    url.searchParams.append(\"amount\", amount.toString());\n    url.searchParams.append(\"nostr\", JSON.stringify(event.rawEvent()));\n    debug2(`Fetching invoice from ${url.toString()}`);\n    const response = await fetch(url.toString());\n    debug2(`Got response from zap endpoint: ${zapEndpoint}`, { status: response.status });\n    if (response.status !== 200) {\n      debug2(`Received non-200 status from zap endpoint: ${zapEndpoint}`, {\n        status: response.status,\n        amount,\n        nostr: JSON.stringify(event.rawEvent())\n      });\n      const text = await response.text();\n      throw new Error(`Unable to fetch zap endpoint ${zapEndpoint}: ${text}`);\n    }\n    const body = await response.json();\n    return body.pr;\n  }\n  async generateZapRequest(amount, comment, extraTags, relays, signer) {\n    const zapEndpoint = await this.getZapEndpoint();\n    if (!zapEndpoint) {\n      throw new Error(\"No zap endpoint found\");\n    }\n    if (!this.zappedEvent && !this.zappedUser)\n      throw new Error(\"No zapped event or user found\");\n    const zapRequest = nip57.makeZapRequest({\n      profile: this.zappedUser.pubkey,\n      // set the event to null since nostr-tools doesn't support nip-33 zaps\n      event: null,\n      amount,\n      comment: comment || \"\",\n      relays: relays ?? this.relays()\n    });\n    if (this.zappedEvent) {\n      const tags = this.zappedEvent.referenceTags();\n      const nonPTags = tags.filter((tag) => tag[0] !== \"p\");\n      zapRequest.tags.push(...nonPTags);\n    }\n    zapRequest.tags.push([\"lnurl\", zapEndpoint]);\n    const event = new NDKEvent(this.ndk, zapRequest);\n    if (extraTags) {\n      event.tags = event.tags.concat(extraTags);\n    }\n    return { event, zapEndpoint };\n  }\n  /**\n   * @returns the relays to use for the zap request\n   */\n  relays() {\n    let r = [];\n    if (this.ndk?.pool?.relays) {\n      r = this.ndk.pool.urls();\n    }\n    if (!r.length) {\n      r = DEFAULT_RELAYS;\n    }\n    return r;\n  }\n};\n\n// src/events/index.ts\nvar NDKEvent = class _NDKEvent extends EventEmitter4 {\n  ndk;\n  created_at;\n  content = \"\";\n  tags = [];\n  kind;\n  id = \"\";\n  sig;\n  pubkey = \"\";\n  signatureVerified;\n  _author = void 0;\n  /**\n   * The relay that this event was first received from.\n   */\n  relay;\n  /**\n   * The relays that this event was received from and/or successfully published to.\n   */\n  onRelays = [];\n  constructor(ndk, event) {\n    super();\n    this.ndk = ndk;\n    this.created_at = event?.created_at;\n    this.content = event?.content || \"\";\n    this.tags = event?.tags || [];\n    this.id = event?.id || \"\";\n    this.sig = event?.sig;\n    this.pubkey = event?.pubkey || \"\";\n    this.kind = event?.kind;\n  }\n  /**\n   * Returns the event as is.\n   */\n  rawEvent() {\n    return {\n      created_at: this.created_at,\n      content: this.content,\n      tags: this.tags,\n      kind: this.kind,\n      pubkey: this.pubkey,\n      id: this.id,\n      sig: this.sig\n    };\n  }\n  set author(user) {\n    this.pubkey = user.hexpubkey;\n    this._author = void 0;\n  }\n  /**\n   * Returns an NDKUser for the author of the event.\n   */\n  get author() {\n    if (this._author)\n      return this._author;\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    const user = this.ndk.getUser({ hexpubkey: this.pubkey });\n    this._author = user;\n    return user;\n  }\n  tag(userOrTagOrEvent, marker, skipAuthorTag) {\n    let tags = [];\n    const isNDKUser = userOrTagOrEvent.fetchProfile !== void 0;\n    if (isNDKUser) {\n      const tag = [\"p\", userOrTagOrEvent.pubkey];\n      if (marker)\n        tag.push(...[\"\", marker]);\n      tags.push(tag);\n    } else if (userOrTagOrEvent instanceof _NDKEvent) {\n      const event = userOrTagOrEvent;\n      skipAuthorTag ??= event?.pubkey === this.pubkey;\n      tags = event.referenceTags(marker, skipAuthorTag);\n      for (const pTag of event.getMatchingTags(\"p\")) {\n        if (pTag[1] === this.pubkey)\n          continue;\n        if (this.tags.find((t) => t[0] === \"p\" && t[1] === pTag[1]))\n          continue;\n        this.tags.push([\"p\", pTag[1]]);\n      }\n    } else if (Array.isArray(userOrTagOrEvent)) {\n      tags = [userOrTagOrEvent];\n    } else {\n      throw new Error(\"Invalid argument\", userOrTagOrEvent);\n    }\n    this.tags = mergeTags(this.tags, tags);\n  }\n  /**\n   * Return a NostrEvent object, trying to fill in missing fields\n   * when possible, adding tags when necessary.\n   * @param pubkey {string} The pubkey of the user who the event belongs to.\n   * @returns {Promise<NostrEvent>} A promise that resolves to a NostrEvent.\n   */\n  async toNostrEvent(pubkey) {\n    if (!pubkey && this.pubkey === \"\") {\n      const user = await this.ndk?.signer?.user();\n      this.pubkey = user?.hexpubkey || \"\";\n    }\n    if (!this.created_at)\n      this.created_at = Math.floor(Date.now() / 1e3);\n    const nostrEvent = this.rawEvent();\n    const { content, tags } = await this.generateTags();\n    nostrEvent.content = content || \"\";\n    nostrEvent.tags = tags;\n    try {\n      this.id = this.getEventHash();\n    } catch (e) {\n    }\n    if (this.id)\n      nostrEvent.id = this.id;\n    if (this.sig)\n      nostrEvent.sig = this.sig;\n    return nostrEvent;\n  }\n  serialize = serialize.bind(this);\n  getEventHash = getEventHash.bind(this);\n  validate = validate.bind(this);\n  verifySignature = verifySignature.bind(this);\n  isReplaceable = isReplaceable.bind(this);\n  isEphemeral = isEphemeral.bind(this);\n  isParamReplaceable = isParamReplaceable.bind(this);\n  /**\n   * Encodes a bech32 id.\n   *\n   * @param relays {string[]} The relays to encode in the id\n   * @returns {string} - Encoded naddr, note or nevent.\n   */\n  encode = encode.bind(this);\n  encrypt = encrypt.bind(this);\n  decrypt = decrypt.bind(this);\n  /**\n   * Get all tags with the given name\n   * @param tagName {string} The name of the tag to search for\n   * @returns {NDKTag[]} An array of the matching tags\n   */\n  getMatchingTags(tagName) {\n    return this.tags.filter((tag) => tag[0] === tagName);\n  }\n  /**\n   * Get the first tag with the given name\n   * @param tagName Tag name to search for\n   * @returns The value of the first tag with the given name, or undefined if no such tag exists\n   */\n  tagValue(tagName) {\n    const tags = this.getMatchingTags(tagName);\n    if (tags.length === 0)\n      return void 0;\n    return tags[0][1];\n  }\n  /**\n   * Gets the NIP-31 \"alt\" tag of the event.\n   */\n  get alt() {\n    return this.tagValue(\"alt\");\n  }\n  /**\n   * Sets the NIP-31 \"alt\" tag of the event. Use this to set an alt tag so\n   * clients that don't handle a particular event kind can display something\n   * useful for users.\n   */\n  set alt(alt) {\n    this.removeTag(\"alt\");\n    if (alt)\n      this.tags.push([\"alt\", alt]);\n  }\n  /**\n   * Gets the NIP-33 \"d\" tag of the event.\n   */\n  get dTag() {\n    return this.tagValue(\"d\");\n  }\n  /**\n   * Sets the NIP-33 \"d\" tag of the event.\n   */\n  set dTag(value) {\n    this.removeTag(\"d\");\n    if (value)\n      this.tags.push([\"d\", value]);\n  }\n  /**\n   * Remove all tags with the given name (e.g. \"d\", \"a\", \"p\")\n   * @param tagName Tag name to search for and remove\n   * @returns {void}\n   */\n  removeTag(tagName) {\n    this.tags = this.tags.filter((tag) => tag[0] !== tagName);\n  }\n  /**\n   * Sign the event if a signer is present.\n   *\n   * It will generate tags.\n   * Repleacable events will have their created_at field set to the current time.\n   * @param signer {NDKSigner} The NDKSigner to use to sign the event\n   * @returns {Promise<string>} A Promise that resolves to the signature of the signed event.\n   */\n  async sign(signer) {\n    if (!signer) {\n      this.ndk?.assertSigner();\n      signer = this.ndk.signer;\n    } else {\n      this.author = await signer.user();\n    }\n    await this.generateTags();\n    if (this.isReplaceable()) {\n      this.created_at = Math.floor(Date.now() / 1e3);\n    }\n    const nostrEvent = await this.toNostrEvent();\n    this.sig = await signer.sign(nostrEvent);\n    return this.sig;\n  }\n  /**\n   * Attempt to sign and then publish an NDKEvent to a given relaySet.\n   * If no relaySet is provided, the relaySet will be calculated by NDK.\n   * @param relaySet {NDKRelaySet} The relaySet to publish the even to.\n   * @returns A promise that resolves to the relays the event was published to.\n   */\n  async publish(relaySet, timeoutMs) {\n    if (!this.sig)\n      await this.sign();\n    if (!this.ndk)\n      throw new Error(\"NDKEvent must be associated with an NDK instance to publish\");\n    if (!relaySet) {\n      relaySet = this.ndk.devWriteRelaySet || calculateRelaySetFromEvent(this.ndk, this);\n    }\n    this.ndk.debug(`publish to ${relaySet.size} relays`, this.rawEvent());\n    if (this.kind === 5 /* EventDeletion */ && this.ndk.cacheAdapter?.deleteEvent) {\n      this.ndk.cacheAdapter.deleteEvent(this);\n    }\n    const relays = await relaySet.publish(this, timeoutMs);\n    this.onRelays = Array.from(relays);\n    return relays;\n  }\n  /**\n   * Generates tags for users, notes, and other events tagged in content.\n   * Will also generate random \"d\" tag for parameterized replaceable events where needed.\n   * @returns {ContentTag} The tags and content of the event.\n   */\n  async generateTags() {\n    let tags = [];\n    const g = await generateContentTags(this.content, this.tags);\n    const content = g.content;\n    tags = g.tags;\n    if (this.kind && this.isParamReplaceable()) {\n      const dTag = this.getMatchingTags(\"d\")[0];\n      if (!dTag) {\n        const title = this.tagValue(\"title\");\n        const randLength = title ? 6 : 16;\n        let str = [...Array(randLength)].map(() => Math.random().toString(36)[2]).join(\"\");\n        if (title && title.length > 0) {\n          str = title.replace(/[^a-z0-9]+/gi, \"-\").replace(/^-|-$/g, \"\") + \"-\" + str;\n        }\n        tags.push([\"d\", str]);\n      }\n    }\n    if ((this.ndk?.clientName || this.ndk?.clientNip89) && !this.tagValue(\"client\")) {\n      const clientTag = [\"client\", this.ndk.clientName ?? \"\"];\n      if (this.ndk.clientNip89)\n        clientTag.push(this.ndk.clientNip89);\n      tags.push(clientTag);\n    }\n    return { content: content || \"\", tags };\n  }\n  muted() {\n    const authorMutedEntry = this.ndk?.mutedIds.get(this.pubkey);\n    if (authorMutedEntry && authorMutedEntry === \"p\")\n      return \"author\";\n    const eventTagReference = this.tagReference();\n    const eventMutedEntry = this.ndk?.mutedIds.get(eventTagReference[1]);\n    if (eventMutedEntry && eventMutedEntry === eventTagReference[0])\n      return \"event\";\n    return null;\n  }\n  /**\n   * Returns the \"d\" tag of a parameterized replaceable event or throws an error if the event isn't\n   * a parameterized replaceable event.\n   * @returns {string} the \"d\" tag of the event.\n   */\n  replaceableDTag() {\n    if (this.kind && this.kind >= 3e4 && this.kind <= 4e4) {\n      const dTag = this.getMatchingTags(\"d\")[0];\n      const dTagId = dTag ? dTag[1] : \"\";\n      return dTagId;\n    }\n    throw new Error(\"Event is not a parameterized replaceable event\");\n  }\n  /**\n   * Provides a deduplication key for the event.\n   *\n   * For kinds 0, 3, 10k-20k this will be the event <kind>:<pubkey>\n   * For kinds 30k-40k this will be the event <kind>:<pubkey>:<d-tag>\n   * For all other kinds this will be the event id\n   */\n  deduplicationKey() {\n    if (this.kind === 0 || this.kind === 3 || this.kind && this.kind >= 1e4 && this.kind < 2e4) {\n      return `${this.kind}:${this.pubkey}`;\n    } else {\n      return this.tagId();\n    }\n  }\n  /**\n   * Returns the id of the event or, if it's a parameterized event, the generated id of the event using \"d\" tag, pubkey, and kind.\n   * @returns {string} The id\n   */\n  tagId() {\n    if (this.isParamReplaceable()) {\n      return this.tagAddress();\n    }\n    return this.id;\n  }\n  /**\n   * Returns the \"reference\" value (\"<kind>:<author-pubkey>:<d-tag>\") for this replaceable event.\n   * @returns {string} The id\n   */\n  tagAddress() {\n    if (!this.isParamReplaceable()) {\n      throw new Error(\"This must only be called on replaceable events\");\n    }\n    const dTagId = this.replaceableDTag();\n    return `${this.kind}:${this.pubkey}:${dTagId}`;\n  }\n  /**\n   * Get the tag that can be used to reference this event from another event.\n   *\n   * Consider using referenceTags() instead (unless you have a good reason to use this)\n   *\n   * @example\n   *     event = new NDKEvent(ndk, { kind: 30000, pubkey: 'pubkey', tags: [ [\"d\", \"d-code\"] ] });\n   *     event.tagReference(); // [\"a\", \"30000:pubkey:d-code\"]\n   *\n   *     event = new NDKEvent(ndk, { kind: 1, pubkey: 'pubkey', id: \"eventid\" });\n   *     event.tagReference(); // [\"e\", \"eventid\"]\n   * @returns {NDKTag} The NDKTag object referencing this event\n   */\n  tagReference(marker) {\n    let tag;\n    if (this.isParamReplaceable()) {\n      tag = [\"a\", this.tagAddress()];\n    } else {\n      tag = [\"e\", this.tagId()];\n    }\n    if (this.relay) {\n      tag.push(this.relay.url);\n    } else {\n      tag.push(\"\");\n    }\n    if (marker) {\n      tag.push(marker);\n    }\n    return tag;\n  }\n  /**\n   * Get the tags that can be used to reference this event from another event\n   * @param marker The marker to use in the tag\n   * @example\n   *     event = new NDKEvent(ndk, { kind: 30000, pubkey: 'pubkey', tags: [ [\"d\", \"d-code\"] ] });\n   *     event.referenceTags(); // [[\"a\", \"30000:pubkey:d-code\"], [\"e\", \"parent-id\"]]\n   *\n   *     event = new NDKEvent(ndk, { kind: 1, pubkey: 'pubkey', id: \"eventid\" });\n   *     event.referenceTags(); // [[\"e\", \"parent-id\"]]\n   * @returns {NDKTag} The NDKTag object referencing this event\n   */\n  referenceTags(marker, skipAuthorTag) {\n    let tags = [];\n    if (this.isParamReplaceable()) {\n      tags = [\n        [\"a\", this.tagAddress()],\n        [\"e\", this.id]\n      ];\n    } else {\n      tags = [[\"e\", this.id]];\n    }\n    if (this.relay?.url) {\n      tags = tags.map((tag) => {\n        tag.push(this.relay?.url);\n        return tag;\n      });\n    } else if (marker) {\n      tags = tags.map((tag) => {\n        tag.push(\"\");\n        return tag;\n      });\n    }\n    if (marker) {\n      tags.forEach((tag) => tag.push(marker));\n    }\n    if (!skipAuthorTag)\n      tags.push(...this.author.referenceTags());\n    return tags;\n  }\n  /**\n   * Provides the filter that will return matching events for this event.\n   *\n   * @example\n   *    event = new NDKEvent(ndk, { kind: 30000, pubkey: 'pubkey', tags: [ [\"d\", \"d-code\"] ] });\n   *    event.filter(); // { \"#a\": [\"30000:pubkey:d-code\"] }\n   * @example\n   *    event = new NDKEvent(ndk, { kind: 1, pubkey: 'pubkey', id: \"eventid\" });\n   *    event.filter(); // { \"#e\": [\"eventid\"] }\n   *\n   * @returns The filter that will return matching events for this event\n   */\n  filter() {\n    if (this.isParamReplaceable()) {\n      return { \"#a\": [this.tagId()] };\n    } else {\n      return { \"#e\": [this.tagId()] };\n    }\n  }\n  /**\n   * Create a zap request for an existing event\n   *\n   * @param amount The amount to zap in millisatoshis\n   * @param comment A comment to add to the zap request\n   * @param extraTags Extra tags to add to the zap request\n   * @param recipient The zap recipient (optional for events)\n   * @param signer The signer to use (will default to the NDK instance's signer)\n   */\n  async zap(amount, comment, extraTags, recipient, signer) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    if (!signer) {\n      this.ndk.assertSigner();\n    }\n    const zap = new NDKZap({\n      ndk: this.ndk,\n      zappedEvent: this,\n      zappedUser: recipient\n    });\n    const relays = Array.from(this.ndk.pool.relays.keys());\n    const paymentRequest = await zap.createZapRequest(\n      amount,\n      comment,\n      extraTags,\n      relays,\n      signer\n    );\n    return paymentRequest;\n  }\n  /**\n   * Generates a deletion event of the current event\n   *\n   * @param reason The reason for the deletion\n   * @param publish Whether to publish the deletion event automatically\n   * @returns The deletion event\n   */\n  async delete(reason, publish = true) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    const e = new _NDKEvent(this.ndk, {\n      kind: 5 /* EventDeletion */,\n      content: reason || \"\"\n    });\n    e.tag(this);\n    if (publish)\n      await e.publish();\n    return e;\n  }\n  /**\n   * NIP-18 reposting event.\n   *\n   * @param publish Whether to publish the reposted event automatically\n   * @param signer The signer to use for signing the reposted event\n   * @returns The reposted event\n   *\n   * @function\n   */\n  repost = repost.bind(this);\n  /**\n   * React to an existing event\n   *\n   * @param content The content of the reaction\n   */\n  async react(content, publish = true) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    const e = new _NDKEvent(this.ndk, {\n      kind: 7 /* Reaction */,\n      content\n    });\n    e.tag(this);\n    if (publish) {\n      await e.publish();\n    } else {\n      await e.sign();\n    }\n    return e;\n  }\n  /**\n   * Checks whether the event is valid per underlying NIPs.\n   *\n   * This method is meant to be overridden by subclasses that implement specific NIPs\n   * to allow the enforcement of NIP-specific validation rules.\n   *\n   * Otherwise, it will only check for basic event properties.\n   *\n   */\n  get isValid() {\n    return this.validate();\n  }\n};\n\n// src/subscription/index.ts\nimport { EventEmitter as EventEmitter5 } from \"tseep\";\nvar NDKSubscriptionCacheUsage = /* @__PURE__ */ ((NDKSubscriptionCacheUsage2) => {\n  NDKSubscriptionCacheUsage2[\"ONLY_CACHE\"] = \"ONLY_CACHE\";\n  NDKSubscriptionCacheUsage2[\"CACHE_FIRST\"] = \"CACHE_FIRST\";\n  NDKSubscriptionCacheUsage2[\"PARALLEL\"] = \"PARALLEL\";\n  NDKSubscriptionCacheUsage2[\"ONLY_RELAY\"] = \"ONLY_RELAY\";\n  return NDKSubscriptionCacheUsage2;\n})(NDKSubscriptionCacheUsage || {});\nvar defaultOpts = {\n  closeOnEose: false,\n  cacheUsage: \"CACHE_FIRST\" /* CACHE_FIRST */,\n  groupable: true,\n  groupableDelay: 100,\n  groupableDelayType: \"at-most\"\n};\nvar NDKSubscription = class extends EventEmitter5 {\n  subId;\n  filters;\n  opts;\n  pool;\n  skipVerification = false;\n  skipValidation = false;\n  /**\n   * Tracks the filters as they are executed on each relay\n   */\n  relayFilters;\n  relaySet;\n  ndk;\n  debug;\n  eoseDebug;\n  /**\n   * Events that have been seen by the subscription, with the time they were first seen.\n   */\n  eventFirstSeen = /* @__PURE__ */ new Map();\n  /**\n   * Relays that have sent an EOSE.\n   */\n  eosesSeen = /* @__PURE__ */ new Set();\n  /**\n   * Events that have been seen by the subscription per relay.\n   */\n  eventsPerRelay = /* @__PURE__ */ new Map();\n  /**\n   * The time the last event was received by the subscription.\n   * This is used to calculate when EOSE should be emitted.\n   */\n  lastEventReceivedAt;\n  internalId;\n  constructor(ndk, filters, opts, relaySet, subId) {\n    super();\n    this.ndk = ndk;\n    this.pool = opts?.pool || ndk.pool;\n    this.opts = { ...defaultOpts, ...opts || {} };\n    this.filters = filters instanceof Array ? filters : [filters];\n    this.subId = subId || opts?.subId;\n    this.internalId = Math.random().toString(36).substring(7);\n    this.relaySet = relaySet;\n    this.debug = ndk.debug.extend(`subscription[${opts?.subId ?? this.internalId}]`);\n    this.eoseDebug = this.debug.extend(\"eose\");\n    this.skipVerification = opts?.skipVerification || false;\n    this.skipValidation = opts?.skipValidation || false;\n    if (!this.opts.closeOnEose) {\n      this.debug(\n        `Creating a permanent subscription`,\n        this.opts,\n        JSON.stringify(this.filters)\n      );\n    }\n    if (this.opts.cacheUsage === \"ONLY_CACHE\" /* ONLY_CACHE */ && !this.opts.closeOnEose) {\n      throw new Error(\"Cannot use cache-only options with a persistent subscription\");\n    }\n  }\n  /**\n   * Provides access to the first filter of the subscription for\n   * backwards compatibility.\n   */\n  get filter() {\n    return this.filters[0];\n  }\n  isGroupable() {\n    return this.opts?.groupable || false;\n  }\n  shouldQueryCache() {\n    return this.opts?.cacheUsage !== \"ONLY_RELAY\" /* ONLY_RELAY */;\n  }\n  shouldQueryRelays() {\n    return this.opts?.cacheUsage !== \"ONLY_CACHE\" /* ONLY_CACHE */;\n  }\n  shouldWaitForCache() {\n    return (\n      // Must want to close on EOSE; subscriptions\n      // that want to receive further updates must\n      // always hit the relay\n      this.opts.closeOnEose && // Cache adapter must claim to be fast\n      !!this.ndk.cacheAdapter?.locking && // If explicitly told to run in parallel, then\n      // we should not wait for the cache\n      this.opts.cacheUsage !== \"PARALLEL\" /* PARALLEL */\n    );\n  }\n  /**\n   * Start the subscription. This is the main method that should be called\n   * after creating a subscription.\n   */\n  async start() {\n    let cachePromise;\n    if (this.shouldQueryCache()) {\n      cachePromise = this.startWithCache();\n      if (this.shouldWaitForCache()) {\n        await cachePromise;\n        if (queryFullyFilled(this)) {\n          this.emit(\"eose\", this);\n          return;\n        }\n      }\n    }\n    if (this.shouldQueryRelays()) {\n      this.startWithRelays();\n    } else {\n      this.emit(\"eose\", this);\n    }\n    return;\n  }\n  stop() {\n    this.emit(\"close\", this);\n    this.removeAllListeners();\n  }\n  /**\n   * @returns Whether the subscription has an authors filter.\n   */\n  hasAuthorsFilter() {\n    return this.filters.some((f) => f.authors?.length);\n  }\n  async startWithCache() {\n    if (this.ndk.cacheAdapter?.query) {\n      const promise = this.ndk.cacheAdapter.query(this);\n      if (this.ndk.cacheAdapter.locking) {\n        await promise;\n      }\n    }\n  }\n  /**\n   * Send REQ to relays\n   */\n  startWithRelays() {\n    if (!this.relaySet) {\n      this.relayFilters = calculateRelaySetsFromFilters(this.ndk, this.filters, this.pool);\n    } else {\n      this.relayFilters = /* @__PURE__ */ new Map();\n      for (const relay of this.relaySet.relays) {\n        this.relayFilters.set(relay.url, this.filters);\n      }\n    }\n    if (!this.relayFilters || this.relayFilters.size === 0) {\n      this.debug(`No relays to subscribe to`, this.pool.relays.size);\n      return;\n    }\n    for (const [relayUrl, filters] of this.relayFilters) {\n      const relay = this.pool.getRelay(relayUrl);\n      relay.subscribe(this, filters);\n    }\n  }\n  // EVENT handling\n  /**\n   * Called when an event is received from a relay or the cache\n   * @param event\n   * @param relay\n   * @param fromCache Whether the event was received from the cache\n   */\n  eventReceived(event, relay, fromCache = false) {\n    if (relay) {\n      event.relay ??= relay;\n      event.onRelays.push(relay);\n    }\n    if (!relay)\n      relay = event.relay;\n    if (!this.skipValidation) {\n      if (!event.isValid) {\n        this.debug(`Event failed validation`, event);\n        return;\n      }\n    }\n    if (!this.skipVerification) {\n      if (!event.verifySignature(true)) {\n        this.debug(`Event failed signature validation`, event);\n        return;\n      }\n    }\n    if (!fromCache && relay) {\n      let events = this.eventsPerRelay.get(relay);\n      if (!events) {\n        events = /* @__PURE__ */ new Set();\n        this.eventsPerRelay.set(relay, events);\n      }\n      events.add(event.id);\n      const eventAlreadySeen = this.eventFirstSeen.has(event.id);\n      if (eventAlreadySeen) {\n        const timeSinceFirstSeen = Date.now() - (this.eventFirstSeen.get(event.id) || 0);\n        relay.scoreSlowerEvent(timeSinceFirstSeen);\n        this.emit(\"event:dup\", event, relay, timeSinceFirstSeen, this);\n        return;\n      }\n      if (this.ndk.cacheAdapter) {\n        this.ndk.cacheAdapter.setEvent(event, this.filters, relay);\n      }\n      this.eventFirstSeen.set(event.id, Date.now());\n    } else {\n      this.eventFirstSeen.set(event.id, 0);\n    }\n    if (!event.ndk)\n      event.ndk = this.ndk;\n    this.emit(\"event\", event, relay, this);\n    this.lastEventReceivedAt = Date.now();\n  }\n  // EOSE handling\n  eoseTimeout;\n  eoseReceived(relay) {\n    this.eosesSeen.add(relay);\n    let lastEventSeen = this.lastEventReceivedAt ? Date.now() - this.lastEventReceivedAt : void 0;\n    const hasSeenAllEoses = this.eosesSeen.size === this.relayFilters?.size;\n    const queryFilled = queryFullyFilled(this);\n    if (queryFilled) {\n      this.emit(\"eose\");\n      this.eoseDebug(`Query fully filled`);\n      if (this.opts?.closeOnEose) {\n        this.stop();\n      } else {\n      }\n    } else if (hasSeenAllEoses) {\n      this.emit(\"eose\");\n      this.eoseDebug(`All EOSEs seen`);\n      if (this.opts?.closeOnEose) {\n        this.stop();\n      } else {\n      }\n    } else {\n      let timeToWaitForNextEose = 1e3;\n      const percentageOfRelaysThatHaveSentEose = this.eosesSeen.size / this.relayFilters.size;\n      if (this.eosesSeen.size >= 2 && percentageOfRelaysThatHaveSentEose >= 0.5) {\n        timeToWaitForNextEose = timeToWaitForNextEose * (1 - percentageOfRelaysThatHaveSentEose);\n        if (this.eoseTimeout) {\n          clearTimeout(this.eoseTimeout);\n        }\n        const sendEoseTimeout = () => {\n          lastEventSeen = this.lastEventReceivedAt ? Date.now() - this.lastEventReceivedAt : void 0;\n          if (lastEventSeen !== void 0 && lastEventSeen < 20) {\n            this.eoseTimeout = setTimeout(sendEoseTimeout, timeToWaitForNextEose);\n          } else {\n            this.emit(\"eose\");\n            if (this.opts?.closeOnEose)\n              this.stop();\n          }\n        };\n        this.eoseTimeout = setTimeout(sendEoseTimeout, timeToWaitForNextEose);\n      }\n    }\n  }\n};\n\n// src/user/follows.ts\nasync function follows(opts, outbox, kind = 3 /* Contacts */) {\n  if (!this.ndk)\n    throw new Error(\"NDK not set\");\n  const contactListEvent = await this.ndk.fetchEvent(\n    { kinds: [kind], authors: [this.pubkey] },\n    opts || { groupable: false }\n  );\n  if (contactListEvent) {\n    const pubkeys = /* @__PURE__ */ new Set();\n    contactListEvent.tags.forEach((tag) => {\n      if (tag[0] === \"p\")\n        pubkeys.add(tag[1]);\n    });\n    if (outbox) {\n      this.ndk?.outboxTracker?.trackUsers(Array.from(pubkeys));\n    }\n    return [...pubkeys].reduce((acc, pubkey) => {\n      const user = new NDKUser({ pubkey });\n      user.ndk = this.ndk;\n      acc.add(user);\n      return acc;\n    }, /* @__PURE__ */ new Set());\n  }\n  return /* @__PURE__ */ new Set();\n}\n\n// src/user/profile.ts\nfunction profileFromEvent(event) {\n  const profile = {};\n  let payload;\n  try {\n    payload = JSON.parse(event.content);\n  } catch (error) {\n    throw new Error(`Failed to parse profile event: ${error}`);\n  }\n  Object.keys(payload).forEach((key) => {\n    switch (key) {\n      case \"name\":\n        profile.name = payload.name;\n        break;\n      case \"display_name\":\n        profile.displayName = payload.display_name;\n        break;\n      case \"image\":\n      case \"picture\":\n        profile.image = payload.picture || payload.image;\n        break;\n      case \"banner\":\n        profile.banner = payload.banner;\n        break;\n      case \"bio\":\n        profile.bio = payload.bio;\n        break;\n      case \"nip05\":\n        profile.nip05 = payload.nip05;\n        break;\n      case \"lud06\":\n        profile.lud06 = payload.lud06;\n        break;\n      case \"lud16\":\n        profile.lud16 = payload.lud16;\n        break;\n      case \"about\":\n        profile.about = payload.about;\n        break;\n      case \"zapService\":\n        profile.zapService = payload.zapService;\n        break;\n      case \"website\":\n        profile.website = payload.website;\n        break;\n      default:\n        profile[key] = payload[key];\n        break;\n    }\n  });\n  return profile;\n}\nfunction serializeProfile(profile) {\n  const payload = {};\n  for (const [key, val] of Object.entries(profile)) {\n    switch (key) {\n      case \"username\":\n      case \"name\":\n        payload.name = val;\n        break;\n      case \"displayName\":\n        payload.display_name = val;\n        break;\n      case \"image\":\n      case \"picture\":\n        payload.picture = val;\n        break;\n      case \"bio\":\n      case \"about\":\n        payload.about = val;\n        break;\n      default:\n        payload[key] = val;\n        break;\n    }\n  }\n  return JSON.stringify(payload);\n}\n\n// src/user/nip05.ts\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w.-]+)$/;\nasync function getNip05For(ndk, fullname, _fetch = fetch, fetchOpts = {}) {\n  return await ndk.queuesNip05.add({\n    id: fullname,\n    func: async () => {\n      if (ndk.cacheAdapter && ndk.cacheAdapter.loadNip05) {\n        const profile = await ndk.cacheAdapter.loadNip05(fullname);\n        if (profile !== \"missing\") {\n          if (profile) {\n            const user = new NDKUser({\n              pubkey: profile.pubkey,\n              relayUrls: profile.relays,\n              nip46Urls: profile.nip46\n            });\n            user.ndk = ndk;\n            return user;\n          } else {\n            return null;\n          }\n        }\n      }\n      const match = fullname.match(NIP05_REGEX);\n      if (!match)\n        return null;\n      const [_, name = \"_\", domain] = match;\n      try {\n        const res = await _fetch(\n          `https://${domain}/.well-known/nostr.json?name=${name}`,\n          fetchOpts\n        );\n        const { names, relays, nip46 } = parseNIP05Result(await res.json());\n        const pubkey = names[name.toLowerCase()];\n        let profile = null;\n        if (pubkey) {\n          profile = { pubkey, relays: relays?.[pubkey], nip46: nip46?.[pubkey] };\n        }\n        if (ndk?.cacheAdapter && ndk.cacheAdapter.saveNip05) {\n          ndk.cacheAdapter.saveNip05(fullname, profile);\n        }\n        return profile;\n      } catch (_e) {\n        if (ndk?.cacheAdapter && ndk.cacheAdapter.saveNip05) {\n          ndk?.cacheAdapter.saveNip05(fullname, null);\n        }\n        console.error(\"Failed to fetch NIP05 for\", fullname, _e);\n        return null;\n      }\n    }\n  });\n}\nfunction parseNIP05Result(json) {\n  const result = {\n    names: {}\n  };\n  for (const [name, pubkey] of Object.entries(json.names)) {\n    if (typeof name === \"string\" && typeof pubkey === \"string\") {\n      result.names[name.toLowerCase()] = pubkey;\n    }\n  }\n  if (json.relays) {\n    result.relays = {};\n    for (const [pubkey, relays] of Object.entries(json.relays)) {\n      if (typeof pubkey === \"string\" && Array.isArray(relays)) {\n        result.relays[pubkey] = relays.filter(\n          (relay) => typeof relay === \"string\"\n        );\n      }\n    }\n  }\n  if (json.nip46) {\n    result.nip46 = {};\n    for (const [pubkey, nip46] of Object.entries(json.nip46)) {\n      if (typeof pubkey === \"string\" && Array.isArray(nip46)) {\n        result.nip46[pubkey] = nip46.filter((relay) => typeof relay === \"string\");\n      }\n    }\n  }\n  return result;\n}\n\n// src/user/index.ts\nvar NDKUser = class _NDKUser {\n  ndk;\n  profile;\n  _npub;\n  _pubkey;\n  relayUrls = [];\n  nip46Urls = [];\n  constructor(opts) {\n    if (opts.npub)\n      this._npub = opts.npub;\n    if (opts.hexpubkey)\n      this._pubkey = opts.hexpubkey;\n    if (opts.pubkey)\n      this._pubkey = opts.pubkey;\n    if (opts.relayUrls)\n      this.relayUrls = opts.relayUrls;\n    if (opts.nip46Urls)\n      this.nip46Urls = opts.nip46Urls;\n  }\n  get npub() {\n    if (!this._npub) {\n      if (!this._pubkey)\n        throw new Error(\"hexpubkey not set\");\n      this._npub = nip194.npubEncode(this.pubkey);\n    }\n    return this._npub;\n  }\n  set npub(npub) {\n    this._npub = npub;\n  }\n  /**\n   * Get the user's hexpubkey\n   * @returns {Hexpubkey} The user's hexpubkey\n   *\n   * @deprecated Use `pubkey` instead\n   */\n  get hexpubkey() {\n    return this.pubkey;\n  }\n  /**\n   * Set the user's hexpubkey\n   * @param pubkey {Hexpubkey} The user's hexpubkey\n   * @deprecated Use `pubkey` instead\n   */\n  set hexpubkey(pubkey) {\n    this._pubkey = pubkey;\n  }\n  /**\n   * Get the user's pubkey\n   * @returns {string} The user's pubkey\n   */\n  get pubkey() {\n    if (!this._pubkey) {\n      if (!this._npub)\n        throw new Error(\"npub not set\");\n      this._pubkey = nip194.decode(this.npub).data;\n    }\n    return this._pubkey;\n  }\n  /**\n   * Set the user's pubkey\n   * @param pubkey {string} The user's pubkey\n   */\n  set pubkey(pubkey) {\n    this._pubkey = pubkey;\n  }\n  /**\n   * Retrieves the zapper this pubkey has designated as an issuer of zap receipts\n   */\n  async getZapConfiguration(ndk) {\n    ndk ??= this.ndk;\n    if (!ndk)\n      throw new Error(\"No NDK instance found\");\n    const process = async () => {\n      if (this.ndk?.cacheAdapter?.loadUsersLNURLDoc) {\n        const doc = await this.ndk.cacheAdapter.loadUsersLNURLDoc(this.pubkey);\n        if (doc !== \"missing\") {\n          if (doc === null)\n            return;\n          if (doc)\n            return doc;\n        }\n      }\n      const zap = new NDKZap({ ndk, zappedUser: this });\n      const lnurlspec = await zap.getZapSpecWithoutCache();\n      if (this.ndk?.cacheAdapter?.saveUsersLNURLDoc) {\n        this.ndk.cacheAdapter.saveUsersLNURLDoc(this.pubkey, lnurlspec || null);\n      }\n      if (!lnurlspec)\n        return;\n      return lnurlspec;\n    };\n    return await ndk.queuesZapConfig.add({\n      id: this.pubkey,\n      func: process\n    });\n  }\n  /**\n   * Fetches the zapper's pubkey for the zapped user\n   * @returns The zapper's pubkey if one can be found\n   */\n  async getZapperPubkey() {\n    const zapConfig = await this.getZapConfiguration();\n    return zapConfig?.nostrPubkey;\n  }\n  /**\n   * Instantiate an NDKUser from a NIP-05 string\n   * @param nip05Id {string} The user's NIP-05\n   * @param ndk {NDK} An NDK instance\n   * @param skipCache {boolean} Whether to skip the cache or not\n   * @returns {NDKUser | undefined} An NDKUser if one is found for the given NIP-05, undefined otherwise.\n   */\n  static async fromNip05(nip05Id, ndk, skipCache = false) {\n    if (!ndk)\n      throw new Error(\"No NDK instance found\");\n    let opts = {};\n    if (skipCache)\n      opts.cache = \"no-cache\";\n    const profile = await getNip05For(ndk, nip05Id, ndk?.httpFetch, opts);\n    if (profile) {\n      const user = new _NDKUser({\n        pubkey: profile.pubkey,\n        relayUrls: profile.relays,\n        nip46Urls: profile.nip46\n      });\n      user.ndk = ndk;\n      return user;\n    }\n  }\n  /**\n   * Fetch a user's profile\n   * @param opts {NDKSubscriptionOptions} A set of NDKSubscriptionOptions\n   * @returns User Profile\n   */\n  async fetchProfile(opts) {\n    if (!this.ndk)\n      throw new Error(\"NDK not set\");\n    if (!this.profile)\n      this.profile = {};\n    let setMetadataEvents = null;\n    if (this.ndk.cacheAdapter && this.ndk.cacheAdapter.fetchProfile && opts?.cacheUsage !== \"ONLY_RELAY\" /* ONLY_RELAY */) {\n      const profile = await this.ndk.cacheAdapter.fetchProfile(this.pubkey);\n      if (profile) {\n        this.profile = profile;\n        return profile;\n      }\n    }\n    if (!opts && // if no options have been set\n    this.ndk.cacheAdapter && // and we have a cache\n    this.ndk.cacheAdapter.locking) {\n      setMetadataEvents = await this.ndk.fetchEvents(\n        {\n          kinds: [0],\n          authors: [this.pubkey]\n        },\n        {\n          cacheUsage: \"ONLY_CACHE\" /* ONLY_CACHE */,\n          closeOnEose: true,\n          groupable: false\n        }\n      );\n      opts = {\n        cacheUsage: \"ONLY_RELAY\" /* ONLY_RELAY */,\n        closeOnEose: true,\n        groupable: true,\n        groupableDelay: 250\n      };\n    }\n    if (!setMetadataEvents || setMetadataEvents.size === 0) {\n      setMetadataEvents = await this.ndk.fetchEvents(\n        {\n          kinds: [0],\n          authors: [this.pubkey]\n        },\n        opts\n      );\n    }\n    const sortedSetMetadataEvents = Array.from(setMetadataEvents).sort(\n      (a, b) => a.created_at - b.created_at\n    );\n    if (sortedSetMetadataEvents.length === 0)\n      return null;\n    this.profile = profileFromEvent(sortedSetMetadataEvents[0]);\n    if (this.profile && this.ndk.cacheAdapter && this.ndk.cacheAdapter.saveProfile) {\n      this.ndk.cacheAdapter.saveProfile(this.pubkey, this.profile);\n    }\n    return this.profile;\n  }\n  /**\n   * Returns a set of users that this user follows.\n   */\n  follows = follows.bind(this);\n  /** @deprecated Use referenceTags instead. */\n  /**\n   * Get the tag that can be used to reference this user in an event\n   * @returns {NDKTag} an NDKTag\n   */\n  tagReference() {\n    return [\"p\", this.pubkey];\n  }\n  /**\n   * Get the tags that can be used to reference this user in an event\n   * @returns {NDKTag[]} an array of NDKTag\n   */\n  referenceTags(marker) {\n    const tag = [[\"p\", this.pubkey]];\n    if (!marker)\n      return tag;\n    tag[0].push(\"\", marker);\n    return tag;\n  }\n  /**\n   * Publishes the current profile.\n   */\n  async publish() {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    if (!this.profile)\n      throw new Error(\"No profile available\");\n    this.ndk.assertSigner();\n    const event = new NDKEvent(this.ndk, {\n      kind: 0,\n      content: serializeProfile(this.profile)\n    });\n    await event.publish();\n  }\n  /**\n   * Add a follow to this user's contact list\n   *\n   * @param newFollow {NDKUser} The user to follow\n   * @param currentFollowList {Set<NDKUser>} The current follow list\n   * @param kind {NDKKind} The kind to use for this contact list (defaults to `3`)\n   * @returns {Promise<boolean>} True if the follow was added, false if the follow already exists\n   */\n  async follow(newFollow, currentFollowList, kind = 3 /* Contacts */) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    if (!currentFollowList) {\n      currentFollowList = await this.follows(void 0, void 0, kind);\n    }\n    if (currentFollowList.has(newFollow)) {\n      return false;\n    }\n    currentFollowList.add(newFollow);\n    const event = new NDKEvent(this.ndk, { kind });\n    for (const follow of currentFollowList) {\n      event.tag(follow);\n    }\n    await event.publish();\n    return true;\n  }\n  /**\n   * Remove a follow from this user's contact list\n   *\n   * @param user {NDKUser} The user to unfollow\n   * @param currentFollowList {Set<NDKUser>} The current follow list\n   * @param kind {NDKKind} The kind to use for this contact list (defaults to `3`)\n   * @returns {Promise<boolean>} True if the follow was removed, false if the follow did not exist\n   */\n  async unfollow(user, currentFollowList, kind = 3 /* Contacts */) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    if (!currentFollowList) {\n      currentFollowList = await this.follows(void 0, void 0, kind);\n    }\n    if (!currentFollowList.has(user)) {\n      return false;\n    }\n    currentFollowList.delete(user);\n    const event = new NDKEvent(this.ndk, { kind });\n    for (const follow of currentFollowList) {\n      event.tag(follow);\n    }\n    await event.publish();\n    return true;\n  }\n  /**\n   * Validate a user's NIP-05 identifier (usually fetched from their kind:0 profile data)\n   *\n   * @param nip05Id The NIP-05 string to validate\n   * @returns {Promise<boolean | null>} True if the NIP-05 is found and matches this user's pubkey,\n   * False if the NIP-05 is found but doesn't match this user's pubkey,\n   * null if the NIP-05 isn't found on the domain or we're unable to verify (because of network issues, etc.)\n   */\n  async validateNip05(nip05Id) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    const profilePointer = await getNip05For(this.ndk, nip05Id);\n    if (profilePointer === null)\n      return null;\n    return profilePointer.pubkey === this.pubkey;\n  }\n  /**\n   * Zap a user\n   *\n   * @param amount The amount to zap in millisatoshis\n   * @param comment A comment to add to the zap request\n   * @param extraTags Extra tags to add to the zap request\n   * @param signer The signer to use (will default to the NDK instance's signer)\n   */\n  async zap(amount, comment, extraTags, signer) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    if (!signer) {\n      this.ndk.assertSigner();\n    }\n    const zap = new NDKZap({\n      ndk: this.ndk,\n      zappedUser: this\n    });\n    const relays = Array.from(this.ndk.pool.relays.keys());\n    const paymentRequest = await zap.createZapRequest(\n      amount,\n      comment,\n      extraTags,\n      relays,\n      signer\n    );\n    return paymentRequest;\n  }\n};\n\n// src/events/kinds/lists/index.ts\nvar NDKList = class _NDKList extends NDKEvent {\n  _encryptedTags;\n  /**\n   * Stores the number of bytes the content was before decryption\n   * to expire the cache when the content changes.\n   */\n  encryptedTagsLength;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 30001 /* CategorizedBookmarkList */;\n  }\n  /**\n   * Wrap a NDKEvent into a NDKList\n   */\n  static from(ndkEvent) {\n    return new _NDKList(ndkEvent.ndk, ndkEvent.rawEvent());\n  }\n  /**\n   * Returns the title of the list. Falls back on fetching the name tag value.\n   */\n  get title() {\n    const titleTag = this.tagValue(\"title\") || this.tagValue(\"name\");\n    if (this.kind === 3 /* Contacts */ && !titleTag) {\n      return \"Contacts\";\n    } else if (this.kind === 1e4 /* MuteList */ && !titleTag) {\n      return \"Mute\";\n    } else if (this.kind === 10001 /* PinList */ && !titleTag) {\n      return \"Pinned Notes\";\n    } else if (this.kind === 10002 /* RelayList */ && !titleTag) {\n      return \"Relay Metadata\";\n    } else if (this.kind === 10003 /* BookmarkList */ && !titleTag) {\n      return \"Bookmarks\";\n    } else if (this.kind === 10004 /* CommunityList */ && !titleTag) {\n      return \"Communities\";\n    } else if (this.kind === 10005 /* PublicChatList */ && !titleTag) {\n      return \"Public Chats\";\n    } else if (this.kind === 10006 /* BlockRelayList */ && !titleTag) {\n      return \"Blocked Relays\";\n    } else if (this.kind === 10007 /* SearchRelayList */ && !titleTag) {\n      return \"Search Relays\";\n    } else if (this.kind === 10015 /* InterestList */ && !titleTag) {\n      return \"Interests\";\n    } else if (this.kind === 10030 /* EmojiList */ && !titleTag) {\n      return \"Emojis\";\n    } else {\n      return titleTag ?? this.tagValue(\"d\");\n    }\n  }\n  /**\n   * Sets the title of the list.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    this.removeTag(\"name\");\n    if (title) {\n      this.tags.push([\"title\", title]);\n    } else {\n      throw new Error(\"Title cannot be empty\");\n    }\n  }\n  /**\n   * Returns the name of the list.\n   * @deprecated Please use \"title\" instead.\n   */\n  get name() {\n    const nameTag = this.tagValue(\"name\");\n    if (this.kind === 3 /* Contacts */ && !nameTag) {\n      return \"Contacts\";\n    } else if (this.kind === 1e4 /* MuteList */ && !nameTag) {\n      return \"Mute\";\n    } else if (this.kind === 10001 /* PinList */ && !nameTag) {\n      return \"Pinned Notes\";\n    } else if (this.kind === 10002 /* RelayList */ && !nameTag) {\n      return \"Relay Metadata\";\n    } else if (this.kind === 10003 /* BookmarkList */ && !nameTag) {\n      return \"Bookmarks\";\n    } else if (this.kind === 10004 /* CommunityList */ && !nameTag) {\n      return \"Communities\";\n    } else if (this.kind === 10005 /* PublicChatList */ && !nameTag) {\n      return \"Public Chats\";\n    } else if (this.kind === 10006 /* BlockRelayList */ && !nameTag) {\n      return \"Blocked Relays\";\n    } else if (this.kind === 10007 /* SearchRelayList */ && !nameTag) {\n      return \"Search Relays\";\n    } else if (this.kind === 10015 /* InterestList */ && !nameTag) {\n      return \"Interests\";\n    } else if (this.kind === 10030 /* EmojiList */ && !nameTag) {\n      return \"Emojis\";\n    } else {\n      return nameTag ?? this.tagValue(\"d\");\n    }\n  }\n  /**\n   * Sets the name of the list.\n   * @deprecated Please use \"title\" instead. This method will use the `title` tag instead.\n   */\n  set name(name) {\n    this.removeTag(\"name\");\n    if (name) {\n      this.tags.push([\"title\", name]);\n    } else {\n      throw new Error(\"Name cannot be empty\");\n    }\n  }\n  /**\n   * Returns the description of the list.\n   */\n  get description() {\n    return this.tagValue(\"description\");\n  }\n  /**\n   * Sets the description of the list.\n   */\n  set description(name) {\n    if (name) {\n      this.tags.push([\"description\", name]);\n    } else {\n      this.removeTag(\"description\");\n    }\n  }\n  isEncryptedTagsCacheValid() {\n    return !!(this._encryptedTags && this.encryptedTagsLength === this.content.length);\n  }\n  /**\n   * Returns the decrypted content of the list.\n   */\n  async encryptedTags(useCache = true) {\n    if (useCache && this.isEncryptedTagsCacheValid())\n      return this._encryptedTags;\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (!this.ndk.signer)\n      throw new Error(\"NDK signer not set\");\n    const user = await this.ndk.signer.user();\n    try {\n      if (this.content.length > 0) {\n        try {\n          const decryptedContent = await this.ndk.signer.decrypt(user, this.content);\n          const a = JSON.parse(decryptedContent);\n          if (a && a[0]) {\n            this.encryptedTagsLength = this.content.length;\n            return this._encryptedTags = a;\n          }\n          this.encryptedTagsLength = this.content.length;\n          return this._encryptedTags = [];\n        } catch (e) {\n          console.log(`error decrypting ${this.content}`);\n        }\n      }\n    } catch (e) {\n    }\n    return [];\n  }\n  /**\n   * This method can be overriden to validate that a tag is valid for this list.\n   *\n   * (i.e. the NDKPersonList can validate that items are NDKUser instances)\n   */\n  validateTag(tagValue) {\n    return true;\n  }\n  /**\n   * Returns the unecrypted items in this list.\n   */\n  get items() {\n    return this.tags.filter((t) => {\n      return ![\n        \"d\",\n        \"L\",\n        \"l\",\n        \"title\",\n        \"name\",\n        \"description\",\n        \"summary\",\n        \"image\",\n        \"thumb\",\n        \"alt\",\n        \"expiration\",\n        \"subject\",\n        \"client\"\n      ].includes(t[0]);\n    });\n  }\n  /**\n   * Adds a new item to the list.\n   * @param relay Relay to add\n   * @param mark Optional mark to add to the item\n   * @param encrypted Whether to encrypt the item\n   */\n  async addItem(item, mark = void 0, encrypted = false) {\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (!this.ndk.signer)\n      throw new Error(\"NDK signer not set\");\n    let tags;\n    if (item instanceof NDKEvent) {\n      tags = item.referenceTags();\n    } else if (item instanceof NDKUser) {\n      tags = item.referenceTags();\n    } else if (item instanceof NDKRelay) {\n      tags = item.referenceTags();\n    } else if (Array.isArray(item)) {\n      tags = [item];\n    } else {\n      throw new Error(\"Invalid object type\");\n    }\n    if (mark)\n      tags[0].push(mark);\n    if (encrypted) {\n      const user = await this.ndk.signer.user();\n      const currentList = await this.encryptedTags();\n      currentList.push(...tags);\n      this._encryptedTags = currentList;\n      this.encryptedTagsLength = this.content.length;\n      this.content = JSON.stringify(currentList);\n      await this.encrypt(user);\n    } else {\n      this.tags.push(...tags);\n    }\n    this.created_at = Math.floor(Date.now() / 1e3);\n    this.emit(\"change\");\n  }\n  /**\n   * Removes an item from the list.\n   *\n   * @param index The index of the item to remove.\n   * @param encrypted Whether to remove from the encrypted list or not.\n   */\n  async removeItem(index, encrypted) {\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (!this.ndk.signer)\n      throw new Error(\"NDK signer not set\");\n    if (encrypted) {\n      const user = await this.ndk.signer.user();\n      const currentList = await this.encryptedTags();\n      currentList.splice(index, 1);\n      this._encryptedTags = currentList;\n      this.encryptedTagsLength = this.content.length;\n      this.content = JSON.stringify(currentList);\n      await this.encrypt(user);\n    } else {\n      this.tags.splice(index, 1);\n    }\n    this.created_at = Math.floor(Date.now() / 1e3);\n    this.emit(\"change\");\n    return this;\n  }\n  /**\n   * Creates a filter that will result in fetching\n   * the items of this list\n   * @example\n   * const list = new NDKList(...);\n   * const filters = list.filterForItems();\n   * const events = await ndk.fetchEvents(filters);\n   */\n  filterForItems() {\n    const ids = /* @__PURE__ */ new Set();\n    const nip33Queries = /* @__PURE__ */ new Map();\n    const filters = [];\n    for (const tag of this.items) {\n      if (tag[0] === \"e\" && tag[1]) {\n        ids.add(tag[1]);\n      } else if (tag[0] === \"a\" && tag[1]) {\n        const [kind, pubkey, dTag] = tag[1].split(\":\");\n        if (!kind || !pubkey)\n          continue;\n        const key = `${kind}:${pubkey}`;\n        const item = nip33Queries.get(key) || [];\n        item.push(dTag || \"\");\n        nip33Queries.set(key, item);\n      }\n    }\n    if (ids.size > 0) {\n      filters.push({ ids: Array.from(ids) });\n    }\n    if (nip33Queries.size > 0) {\n      for (const [key, values] of nip33Queries.entries()) {\n        const [kind, pubkey] = key.split(\":\");\n        filters.push({\n          kinds: [parseInt(kind)],\n          authors: [pubkey],\n          \"#d\": values\n        });\n      }\n    }\n    return filters;\n  }\n};\nvar lists_default = NDKList;\n\n// src/user/pin.ts\nasync function pinEvent(user, event, pinEvent2, publish) {\n  const kind = 10001 /* PinList */;\n  if (!user.ndk)\n    throw new Error(\"No NDK instance found\");\n  user.ndk.assertSigner();\n  if (!pinEvent2) {\n    const events = await user.ndk.fetchEvents(\n      { kinds: [kind], authors: [user.pubkey] },\n      { cacheUsage: \"ONLY_RELAY\" /* ONLY_RELAY */ }\n    );\n    if (events.size > 0) {\n      pinEvent2 = lists_default.from(Array.from(events)[0]);\n    } else {\n      pinEvent2 = new NDKEvent(user.ndk, {\n        kind\n      });\n    }\n  }\n  pinEvent2.tag(event);\n  if (publish) {\n    await pinEvent2.publish();\n  }\n  return pinEvent2;\n}\n\n// src/events/kinds/article.ts\nvar NDKArticle = class _NDKArticle extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 30023 /* Article */;\n  }\n  /**\n   * Creates a NDKArticle from an existing NDKEvent.\n   *\n   * @param event NDKEvent to create the NDKArticle from.\n   * @returns NDKArticle\n   */\n  static from(event) {\n    return new _NDKArticle(event.ndk, event.rawEvent());\n  }\n  /**\n   * Getter for the article title.\n   *\n   * @returns {string | undefined} - The article title if available, otherwise undefined.\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the article title.\n   *\n   * @param {string | undefined} title - The title to set for the article.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    if (title)\n      this.tags.push([\"title\", title]);\n  }\n  /**\n   * Getter for the article image.\n   *\n   * @returns {string | undefined} - The article image if available, otherwise undefined.\n   */\n  get image() {\n    return this.tagValue(\"image\");\n  }\n  /**\n   * Setter for the article image.\n   *\n   * @param {string | undefined} image - The image to set for the article.\n   */\n  set image(image) {\n    this.removeTag(\"image\");\n    if (image)\n      this.tags.push([\"image\", image]);\n  }\n  get summary() {\n    return this.tagValue(\"summary\");\n  }\n  set summary(summary) {\n    this.removeTag(\"summary\");\n    if (summary)\n      this.tags.push([\"summary\", summary]);\n  }\n  /**\n   * Getter for the article's publication timestamp.\n   *\n   * @returns {number | undefined} - The Unix timestamp of when the article was published or undefined.\n   */\n  get published_at() {\n    const tag = this.tagValue(\"published_at\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the article's publication timestamp.\n   *\n   * @param {number | undefined} timestamp - The Unix timestamp to set for the article's publication date.\n   */\n  set published_at(timestamp) {\n    this.removeTag(\"published_at\");\n    if (timestamp !== void 0) {\n      this.tags.push([\"published_at\", timestamp.toString()]);\n    }\n  }\n  /**\n   * Generates content tags for the article.\n   *\n   * This method first checks and sets the publication date if not available,\n   * and then generates content tags based on the base NDKEvent class.\n   *\n   * @returns {ContentTag} - The generated content tags.\n   */\n  async generateTags() {\n    super.generateTags();\n    if (!this.published_at) {\n      this.published_at = this.created_at;\n    }\n    return super.generateTags();\n  }\n  /**\n   * Getter for the article's URL.\n   *\n   * @returns {string | undefined} - The article's URL if available, otherwise undefined.\n   */\n  get url() {\n    return this.tagValue(\"url\");\n  }\n  /**\n   * Setter for the article's URL.\n   *\n   * @param {string | undefined} url - The URL to set for the article.\n   */\n  set url(url) {\n    if (url) {\n      this.tags.push([\"url\", url]);\n    } else {\n      this.removeTag(\"url\");\n    }\n  }\n};\n\n// src/events/kinds/classified.ts\nvar NDKClassified = class _NDKClassified extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 30402 /* Classified */;\n  }\n  /**\n   * Creates a NDKClassified from an existing NDKEvent.\n   *\n   * @param event NDKEvent to create the NDKClassified from.\n   * @returns NDKClassified\n   */\n  static from(event) {\n    return new _NDKClassified(event.ndk, event.rawEvent());\n  }\n  /**\n   * Getter for the classified title.\n   *\n   * @returns {string | undefined} - The classified title if available, otherwise undefined.\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the classified title.\n   *\n   * @param {string | undefined} title - The title to set for the classified.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    if (title)\n      this.tags.push([\"title\", title]);\n  }\n  /**\n   * Getter for the classified summary.\n   *\n   * @returns {string | undefined} - The classified summary if available, otherwise undefined.\n   */\n  get summary() {\n    return this.tagValue(\"summary\");\n  }\n  /**\n   * Setter for the classified summary.\n   *\n   * @param {string | undefined} summary - The summary to set for the classified.\n   */\n  set summary(summary) {\n    this.removeTag(\"summary\");\n    if (summary)\n      this.tags.push([\"summary\", summary]);\n  }\n  /**\n   * Getter for the classified's publication timestamp.\n   *\n   * @returns {number | undefined} - The Unix timestamp of when the classified was published or undefined.\n   */\n  get published_at() {\n    const tag = this.tagValue(\"published_at\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the classified's publication timestamp.\n   *\n   * @param {number | undefined} timestamp - The Unix timestamp to set for the classified's publication date.\n   */\n  set published_at(timestamp) {\n    this.removeTag(\"published_at\");\n    if (timestamp !== void 0) {\n      this.tags.push([\"published_at\", timestamp.toString()]);\n    }\n  }\n  /**\n   * Getter for the classified location.\n   *\n   * @returns {string | undefined} - The classified location if available, otherwise undefined.\n   */\n  get location() {\n    return this.tagValue(\"location\");\n  }\n  /**\n   * Setter for the classified location.\n   *\n   * @param {string | undefined} location - The location to set for the classified.\n   */\n  set location(location) {\n    this.removeTag(\"location\");\n    if (location)\n      this.tags.push([\"location\", location]);\n  }\n  /**\n   * Getter for the classified price.\n   *\n   * @returns {NDKClassifiedPriceTag | undefined} - The classified price if available, otherwise undefined.\n   */\n  get price() {\n    const priceTag = this.tags.find((tag) => tag[0] === \"price\");\n    if (priceTag) {\n      return {\n        amount: parseFloat(priceTag[1]),\n        currency: priceTag[2],\n        frequency: priceTag[3]\n      };\n    } else {\n      return void 0;\n    }\n  }\n  /**\n   * Setter for the classified price.\n   *\n   * @param price - The price to set for the classified.\n   */\n  set price(priceTag) {\n    if (typeof priceTag === \"string\") {\n      priceTag = {\n        amount: parseFloat(priceTag)\n      };\n    }\n    if (priceTag?.amount) {\n      const tag = [\"price\", priceTag.amount.toString()];\n      if (priceTag.currency)\n        tag.push(priceTag.currency);\n      if (priceTag.frequency)\n        tag.push(priceTag.frequency);\n      this.tags.push(tag);\n    } else {\n      this.removeTag(\"price\");\n    }\n  }\n  /**\n   * Generates content tags for the classified.\n   *\n   * This method first checks and sets the publication date if not available,\n   * and then generates content tags based on the base NDKEvent class.\n   *\n   * @returns {ContentTag} - The generated content tags.\n   */\n  async generateTags() {\n    super.generateTags();\n    if (!this.published_at) {\n      this.published_at = this.created_at;\n    }\n    return super.generateTags();\n  }\n};\n\n// src/events/kinds/video.ts\nvar NDKVideo = class _NDKVideo extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 34235 /* HorizontalVideo */;\n  }\n  /**\n   * Creates a NDKArticle from an existing NDKEvent.\n   *\n   * @param event NDKEvent to create the NDKArticle from.\n   * @returns NDKArticle\n   */\n  static from(event) {\n    return new _NDKVideo(event.ndk, event.rawEvent());\n  }\n  /**\n   * Getter for the article title.\n   *\n   * @returns {string | undefined} - The article title if available, otherwise undefined.\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the article title.\n   *\n   * @param {string | undefined} title - The title to set for the article.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    if (title)\n      this.tags.push([\"title\", title]);\n  }\n  /**\n   * Getter for the article thumbnail.\n   *\n   * @returns {string | undefined} - The article thumbnail if available, otherwise undefined.\n   */\n  get thumbnail() {\n    return this.tagValue(\"thumb\");\n  }\n  /**\n   * Setter for the article thumbnail.\n   *\n   * @param {string | undefined} thumbnail - The thumbnail to set for the article.\n   */\n  set thumbnail(thumbnail) {\n    this.removeTag(\"thumb\");\n    if (thumbnail)\n      this.tags.push([\"thumb\", thumbnail]);\n  }\n  get url() {\n    return this.tagValue(\"url\");\n  }\n  set url(url) {\n    this.removeTag(\"url\");\n    if (url)\n      this.tags.push([\"url\", url]);\n  }\n  /**\n   * Getter for the article's publication timestamp.\n   *\n   * @returns {number | undefined} - The Unix timestamp of when the article was published or undefined.\n   */\n  get published_at() {\n    const tag = this.tagValue(\"published_at\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the article's publication timestamp.\n   *\n   * @param {number | undefined} timestamp - The Unix timestamp to set for the article's publication date.\n   */\n  set published_at(timestamp) {\n    this.removeTag(\"published_at\");\n    if (timestamp !== void 0) {\n      this.tags.push([\"published_at\", timestamp.toString()]);\n    }\n  }\n  /**\n   * Generates content tags for the article.\n   *\n   * This method first checks and sets the publication date if not available,\n   * and then generates content tags based on the base NDKEvent class.\n   *\n   * @returns {ContentTag} - The generated content tags.\n   */\n  async generateTags() {\n    super.generateTags();\n    if (!this.published_at) {\n      this.published_at = this.created_at;\n    }\n    return super.generateTags();\n  }\n  get duration() {\n    const tag = this.tagValue(\"duration\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the video's duration\n   *\n   * @param {number | undefined} duration - The duration to set for the video (in seconds)\n   */\n  set duration(dur) {\n    this.removeTag(\"duration\");\n    if (dur !== void 0) {\n      this.tags.push([\"duration\", Math.floor(dur).toString()]);\n    }\n  }\n};\n\n// src/events/kinds/highlight.ts\nimport { nip19 as nip195 } from \"nostr-tools\";\nvar NDKHighlight = class _NDKHighlight extends NDKEvent {\n  _article;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 9802 /* Highlight */;\n  }\n  static from(event) {\n    return new _NDKHighlight(event.ndk, event.rawEvent());\n  }\n  get url() {\n    return this.tagValue(\"r\");\n  }\n  /**\n   * Context tag.\n   */\n  set context(context) {\n    if (context === void 0) {\n      this.tags = this.tags.filter(([tag, value]) => tag !== \"context\");\n    } else {\n      this.tags = this.tags.filter(([tag, value]) => tag !== \"context\");\n      this.tags.push([\"context\", context]);\n    }\n  }\n  get context() {\n    return this.tags.find(([tag, value]) => tag === \"context\")?.[1] ?? void 0;\n  }\n  /**\n   * Will return the article URL or NDKEvent if they have already been\n   * set (it won't attempt to load remote events)\n   */\n  get article() {\n    return this._article;\n  }\n  /**\n   * Article the highlight is coming from.\n   *\n   * @param article Article URL or NDKEvent.\n   */\n  set article(article) {\n    this._article = article;\n    if (typeof article === \"string\") {\n      this.tags.push([\"r\", article]);\n    } else {\n      this.tag(article);\n    }\n  }\n  getArticleTag() {\n    return this.getMatchingTags(\"a\")[0] || this.getMatchingTags(\"e\")[0] || this.getMatchingTags(\"r\")[0];\n  }\n  async getArticle() {\n    if (this._article !== void 0)\n      return this._article;\n    let taggedBech32;\n    const articleTag = this.getArticleTag();\n    if (!articleTag)\n      return void 0;\n    switch (articleTag[0]) {\n      case \"a\":\n        const [kind, pubkey, identifier] = articleTag[1].split(\":\");\n        taggedBech32 = nip195.naddrEncode({ kind: parseInt(kind), pubkey, identifier });\n        break;\n      case \"e\":\n        taggedBech32 = nip195.noteEncode(articleTag[1]);\n        break;\n      case \"r\":\n        this._article = articleTag[1];\n        break;\n    }\n    if (taggedBech32) {\n      let a = await this.ndk?.fetchEvent(taggedBech32);\n      if (a) {\n        if (a.kind === 30023 /* Article */) {\n          a = NDKArticle.from(a);\n        }\n        this._article = a;\n      }\n    }\n    return this._article;\n  }\n};\n\n// ../node_modules/.pnpm/normalize-url@8.0.1/node_modules/normalize-url/index.js\nvar DATA_URL_DEFAULT_MIME_TYPE = \"text/plain\";\nvar DATA_URL_DEFAULT_CHARSET = \"us-ascii\";\nvar testParameter = (name, filters) => filters.some((filter) => filter instanceof RegExp ? filter.test(name) : filter === name);\nvar supportedProtocols = /* @__PURE__ */ new Set([\n  \"https:\",\n  \"http:\",\n  \"file:\"\n]);\nvar hasCustomProtocol = (urlString) => {\n  try {\n    const { protocol } = new URL(urlString);\n    return protocol.endsWith(\":\") && !protocol.includes(\".\") && !supportedProtocols.has(protocol);\n  } catch {\n    return false;\n  }\n};\nvar normalizeDataURL = (urlString, { stripHash }) => {\n  const match = /^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(urlString);\n  if (!match) {\n    throw new Error(`Invalid URL: ${urlString}`);\n  }\n  let { type, data, hash } = match.groups;\n  const mediaType = type.split(\";\");\n  hash = stripHash ? \"\" : hash;\n  let isBase64 = false;\n  if (mediaType[mediaType.length - 1] === \"base64\") {\n    mediaType.pop();\n    isBase64 = true;\n  }\n  const mimeType = mediaType.shift()?.toLowerCase() ?? \"\";\n  const attributes = mediaType.map((attribute) => {\n    let [key, value = \"\"] = attribute.split(\"=\").map((string) => string.trim());\n    if (key === \"charset\") {\n      value = value.toLowerCase();\n      if (value === DATA_URL_DEFAULT_CHARSET) {\n        return \"\";\n      }\n    }\n    return `${key}${value ? `=${value}` : \"\"}`;\n  }).filter(Boolean);\n  const normalizedMediaType = [\n    ...attributes\n  ];\n  if (isBase64) {\n    normalizedMediaType.push(\"base64\");\n  }\n  if (normalizedMediaType.length > 0 || mimeType && mimeType !== DATA_URL_DEFAULT_MIME_TYPE) {\n    normalizedMediaType.unshift(mimeType);\n  }\n  return `data:${normalizedMediaType.join(\";\")},${isBase64 ? data.trim() : data}${hash ? `#${hash}` : \"\"}`;\n};\nfunction normalizeUrl(urlString, options) {\n  options = {\n    defaultProtocol: \"http\",\n    normalizeProtocol: true,\n    forceHttp: false,\n    forceHttps: false,\n    stripAuthentication: true,\n    stripHash: false,\n    stripTextFragment: true,\n    stripWWW: true,\n    removeQueryParameters: [/^utm_\\w+/i],\n    removeTrailingSlash: true,\n    removeSingleSlash: true,\n    removeDirectoryIndex: false,\n    removeExplicitPort: false,\n    sortQueryParameters: true,\n    ...options\n  };\n  if (typeof options.defaultProtocol === \"string\" && !options.defaultProtocol.endsWith(\":\")) {\n    options.defaultProtocol = `${options.defaultProtocol}:`;\n  }\n  urlString = urlString.trim();\n  if (/^data:/i.test(urlString)) {\n    return normalizeDataURL(urlString, options);\n  }\n  if (hasCustomProtocol(urlString)) {\n    return urlString;\n  }\n  const hasRelativeProtocol = urlString.startsWith(\"//\");\n  const isRelativeUrl = !hasRelativeProtocol && /^\\.*\\//.test(urlString);\n  if (!isRelativeUrl) {\n    urlString = urlString.replace(/^(?!(?:\\w+:)?\\/\\/)|^\\/\\//, options.defaultProtocol);\n  }\n  const urlObject = new URL(urlString);\n  if (options.forceHttp && options.forceHttps) {\n    throw new Error(\"The `forceHttp` and `forceHttps` options cannot be used together\");\n  }\n  if (options.forceHttp && urlObject.protocol === \"https:\") {\n    urlObject.protocol = \"http:\";\n  }\n  if (options.forceHttps && urlObject.protocol === \"http:\") {\n    urlObject.protocol = \"https:\";\n  }\n  if (options.stripAuthentication) {\n    urlObject.username = \"\";\n    urlObject.password = \"\";\n  }\n  if (options.stripHash) {\n    urlObject.hash = \"\";\n  } else if (options.stripTextFragment) {\n    urlObject.hash = urlObject.hash.replace(/#?:~:text.*?$/i, \"\");\n  }\n  if (urlObject.pathname) {\n    const protocolRegex = /\\b[a-z][a-z\\d+\\-.]{1,50}:\\/\\//g;\n    let lastIndex = 0;\n    let result = \"\";\n    for (; ; ) {\n      const match = protocolRegex.exec(urlObject.pathname);\n      if (!match) {\n        break;\n      }\n      const protocol = match[0];\n      const protocolAtIndex = match.index;\n      const intermediate = urlObject.pathname.slice(lastIndex, protocolAtIndex);\n      result += intermediate.replace(/\\/{2,}/g, \"/\");\n      result += protocol;\n      lastIndex = protocolAtIndex + protocol.length;\n    }\n    const remnant = urlObject.pathname.slice(lastIndex, urlObject.pathname.length);\n    result += remnant.replace(/\\/{2,}/g, \"/\");\n    urlObject.pathname = result;\n  }\n  if (urlObject.pathname) {\n    try {\n      urlObject.pathname = decodeURI(urlObject.pathname);\n    } catch {\n    }\n  }\n  if (options.removeDirectoryIndex === true) {\n    options.removeDirectoryIndex = [/^index\\.[a-z]+$/];\n  }\n  if (Array.isArray(options.removeDirectoryIndex) && options.removeDirectoryIndex.length > 0) {\n    let pathComponents = urlObject.pathname.split(\"/\");\n    const lastComponent = pathComponents[pathComponents.length - 1];\n    if (testParameter(lastComponent, options.removeDirectoryIndex)) {\n      pathComponents = pathComponents.slice(0, -1);\n      urlObject.pathname = pathComponents.slice(1).join(\"/\") + \"/\";\n    }\n  }\n  if (urlObject.hostname) {\n    urlObject.hostname = urlObject.hostname.replace(/\\.$/, \"\");\n    if (options.stripWWW && /^www\\.(?!www\\.)[a-z\\-\\d]{1,63}\\.[a-z.\\-\\d]{2,63}$/.test(urlObject.hostname)) {\n      urlObject.hostname = urlObject.hostname.replace(/^www\\./, \"\");\n    }\n  }\n  if (Array.isArray(options.removeQueryParameters)) {\n    for (const key of [...urlObject.searchParams.keys()]) {\n      if (testParameter(key, options.removeQueryParameters)) {\n        urlObject.searchParams.delete(key);\n      }\n    }\n  }\n  if (!Array.isArray(options.keepQueryParameters) && options.removeQueryParameters === true) {\n    urlObject.search = \"\";\n  }\n  if (Array.isArray(options.keepQueryParameters) && options.keepQueryParameters.length > 0) {\n    for (const key of [...urlObject.searchParams.keys()]) {\n      if (!testParameter(key, options.keepQueryParameters)) {\n        urlObject.searchParams.delete(key);\n      }\n    }\n  }\n  if (options.sortQueryParameters) {\n    urlObject.searchParams.sort();\n    try {\n      urlObject.search = decodeURIComponent(urlObject.search);\n    } catch {\n    }\n  }\n  if (options.removeTrailingSlash) {\n    urlObject.pathname = urlObject.pathname.replace(/\\/$/, \"\");\n  }\n  if (options.removeExplicitPort && urlObject.port) {\n    urlObject.port = \"\";\n  }\n  const oldUrlString = urlString;\n  urlString = urlObject.toString();\n  if (!options.removeSingleSlash && urlObject.pathname === \"/\" && !oldUrlString.endsWith(\"/\") && urlObject.hash === \"\") {\n    urlString = urlString.replace(/\\/$/, \"\");\n  }\n  if ((options.removeTrailingSlash || urlObject.pathname === \"/\") && urlObject.hash === \"\" && options.removeSingleSlash) {\n    urlString = urlString.replace(/\\/$/, \"\");\n  }\n  if (hasRelativeProtocol && !options.normalizeProtocol) {\n    urlString = urlString.replace(/^http:\\/\\//, \"//\");\n  }\n  if (options.stripProtocol) {\n    urlString = urlString.replace(/^(?:https?:)?\\/\\//, \"\");\n  }\n  return urlString;\n}\n\n// src/utils/normalize-url.ts\nfunction normalizeRelayUrl(url) {\n  let r = normalizeUrl(url, {\n    stripAuthentication: false,\n    stripWWW: false,\n    stripHash: true\n  });\n  if (!r.endsWith(\"/\")) {\n    r += \"/\";\n  }\n  return r;\n}\nfunction normalize(urls) {\n  const normalized = /* @__PURE__ */ new Set();\n  for (const url of urls) {\n    try {\n      normalized.add(normalizeRelayUrl(url));\n    } catch {\n    }\n  }\n  return Array.from(normalized);\n}\n\n// src/events/kinds/NDKRelayList.ts\nvar READ_MARKER = \"read\";\nvar WRITE_MARKER = \"write\";\nvar NDKRelayList = class _NDKRelayList extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 10002 /* RelayList */;\n  }\n  static from(ndkEvent) {\n    return new _NDKRelayList(ndkEvent.ndk, ndkEvent.rawEvent());\n  }\n  static async forUser(pubkey, ndk) {\n    const result = await this.forUsers([pubkey], ndk);\n    return result.get(pubkey);\n  }\n  /**\n   * Gathers a set of relay list events for a given set of users.\n   * @returns A map of pubkeys to relay list.\n   */\n  static async forUsers(pubkeys, ndk) {\n    const pool = ndk.outboxPool || ndk.pool;\n    const set = /* @__PURE__ */ new Set();\n    for (const relay of pool.relays.values())\n      set.add(relay);\n    const relayLists = /* @__PURE__ */ new Map();\n    const fromContactList = /* @__PURE__ */ new Map();\n    const relaySet = new NDKRelaySet(set, ndk);\n    await Promise.all([\n      // Fetch all kind 10002 events\n      new Promise(async (resolve) => {\n        const lists = await ndk.fetchEvents(\n          { kinds: [10002], authors: pubkeys },\n          { closeOnEose: true, pool, groupable: false },\n          relaySet\n        );\n        for (const relayList of lists) {\n          relayLists.set(relayList.pubkey, _NDKRelayList.from(relayList));\n        }\n        resolve();\n      }),\n      // Also fetch all kind 3 events\n      new Promise(async (resolve) => {\n        const lists = await ndk.fetchEvents(\n          { kinds: [3], authors: pubkeys },\n          { closeOnEose: true, pool, groupable: false },\n          relaySet\n        );\n        for (const relayList of lists) {\n          const list = relayListFromKind3(ndk, relayList);\n          if (list)\n            fromContactList.set(relayList.pubkey, list);\n        }\n        resolve();\n      })\n    ]);\n    const result = /* @__PURE__ */ new Map();\n    for (const pubkey of pubkeys) {\n      const relayList = relayLists.get(pubkey) ?? fromContactList.get(pubkey);\n      if (relayList)\n        result.set(pubkey, relayList);\n    }\n    return result;\n  }\n  get readRelayUrls() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").filter((tag) => !tag[2] || tag[2] && tag[2] === READ_MARKER).map((tag) => tag[1]);\n  }\n  set readRelayUrls(relays) {\n    for (const relay of relays) {\n      this.tags.push([\"r\", relay, READ_MARKER]);\n    }\n  }\n  get writeRelayUrls() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").filter((tag) => !tag[2] || tag[2] && tag[2] === WRITE_MARKER).map((tag) => tag[1]);\n  }\n  set writeRelayUrls(relays) {\n    for (const relay of relays) {\n      this.tags.push([\"r\", relay, WRITE_MARKER]);\n    }\n  }\n  get bothRelayUrls() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").filter((tag) => !tag[2]).map((tag) => tag[1]);\n  }\n  set bothRelayUrls(relays) {\n    for (const relay of relays) {\n      this.tags.push([\"r\", relay]);\n    }\n  }\n  get relays() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").map((tag) => tag[1]);\n  }\n};\nfunction relayListFromKind3(ndk, contactList) {\n  try {\n    const content = JSON.parse(contactList.content);\n    const relayList = new NDKRelayList(ndk);\n    const readRelays = /* @__PURE__ */ new Set();\n    const writeRelays = /* @__PURE__ */ new Set();\n    for (let [key, config] of Object.entries(content)) {\n      try {\n        key = normalizeRelayUrl(key);\n      } catch {\n        continue;\n      }\n      if (!config) {\n        readRelays.add(key);\n        writeRelays.add(key);\n      } else {\n        const relayConfig = config;\n        if (relayConfig.write)\n          writeRelays.add(key);\n        if (relayConfig.read)\n          readRelays.add(key);\n      }\n    }\n    relayList.readRelayUrls = Array.from(readRelays);\n    relayList.writeRelayUrls = Array.from(writeRelays);\n    return relayList;\n  } catch {\n  }\n  return void 0;\n}\n\n// src/events/kinds/repost.ts\nvar NDKRepost = class _NDKRepost extends NDKEvent {\n  _repostedEvents;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n  }\n  static from(event) {\n    return new _NDKRepost(event.ndk, event.rawEvent());\n  }\n  /**\n   * Returns all reposted events by the current event.\n   *\n   * @param klass Optional class to convert the events to.\n   * @returns\n   */\n  async repostedEvents(klass, opts) {\n    const items = [];\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (this._repostedEvents !== void 0)\n      return this._repostedEvents;\n    for (const eventId of this.repostedEventIds()) {\n      const filter = filterForId(eventId);\n      const event = await this.ndk.fetchEvent(filter, opts);\n      if (event) {\n        items.push(klass ? klass.from(event) : event);\n      }\n    }\n    return items;\n  }\n  /**\n   * Returns the reposted event IDs.\n   */\n  repostedEventIds() {\n    return this.tags.filter((t) => t[0] === \"e\" || t[0] === \"a\").map((t) => t[1]);\n  }\n};\nfunction filterForId(id) {\n  if (id.match(/:/)) {\n    const [kind, pubkey, identifier] = id.split(\":\");\n    return {\n      kinds: [parseInt(kind)],\n      authors: [pubkey],\n      \"#d\": [identifier]\n    };\n  } else {\n    return { ids: [id] };\n  }\n}\n\n// src/events/kinds/nip89/NDKAppHandler.ts\nvar NDKAppHandlerEvent = class _NDKAppHandlerEvent extends NDKEvent {\n  profile;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 31990 /* AppHandler */;\n  }\n  static from(ndkEvent) {\n    return new _NDKAppHandlerEvent(ndkEvent.ndk, ndkEvent.rawEvent());\n  }\n  /**\n   * Fetches app handler information\n   * If no app information is available on the kind:31990,\n   * we fetch the event's author's profile and return that instead.\n   */\n  async fetchProfile() {\n    if (this.profile === void 0 && this.content.length > 0) {\n      try {\n        const profile = JSON.parse(this.content);\n        if (profile && profile.name) {\n          return profile;\n        } else {\n          this.profile = null;\n        }\n      } catch (e) {\n        this.profile = null;\n      }\n    }\n    return new Promise((resolve, reject) => {\n      const author = this.author;\n      author.fetchProfile().then(() => {\n        resolve(author.profile);\n      }).catch(reject);\n    });\n  }\n};\n\n// src/events/kinds/subscriptions/amount.ts\nvar possibleIntervalFrequencies = [\n  \"daily\",\n  \"weekly\",\n  \"monthly\",\n  \"quarterly\",\n  \"yearly\"\n];\nfunction calculateTermDurationInSeconds(term) {\n  switch (term) {\n    case \"daily\":\n      return 24 * 60 * 60;\n    case \"weekly\":\n      return 7 * 24 * 60 * 60;\n    case \"monthly\":\n      return 30 * 24 * 60 * 60;\n    case \"quarterly\":\n      return 3 * 30 * 24 * 60 * 60;\n    case \"yearly\":\n      return 365 * 24 * 60 * 60;\n  }\n}\nfunction newAmount(amount, currency, term) {\n  return [\"amount\", amount.toString(), currency, term];\n}\nfunction parseTagToSubscriptionAmount(tag) {\n  const amount = parseInt(tag[1]);\n  if (isNaN(amount) || amount === void 0 || amount === null || amount <= 0)\n    return void 0;\n  const currency = tag[2];\n  if (currency === void 0 || currency === \"\")\n    return void 0;\n  const term = tag[3];\n  if (term === void 0)\n    return void 0;\n  if (!possibleIntervalFrequencies.includes(term))\n    return void 0;\n  return {\n    amount,\n    currency,\n    term\n  };\n}\n\n// src/events/kinds/subscriptions/tier.ts\nvar NDKSubscriptionTier = class _NDKSubscriptionTier extends NDKArticle {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 37001 /* SubscriptionTier */;\n  }\n  /**\n   * Creates a new NDKSubscriptionTier from an event\n   * @param event\n   * @returns NDKSubscriptionTier\n   */\n  static from(event) {\n    return new _NDKSubscriptionTier(event.ndk, event.rawEvent());\n  }\n  /**\n   * Returns perks for this tier\n   */\n  get perks() {\n    return this.getMatchingTags(\"perk\").map((tag) => tag[1]).filter((perk) => perk !== void 0);\n  }\n  /**\n   * Adds a perk to this tier\n   */\n  addPerk(perk) {\n    this.tags.push([\"perk\", perk]);\n  }\n  /**\n   * Returns the amount for this tier\n   */\n  get amounts() {\n    return this.getMatchingTags(\"amount\").map((tag) => parseTagToSubscriptionAmount(tag)).filter((a) => a !== void 0);\n  }\n  /**\n   * Adds an amount to this tier\n   * @param amount Amount in the smallest unit of the currency (e.g. cents, msats)\n   * @param currency Currency code. Use msat for millisatoshis\n   * @param term One of daily, weekly, monthly, quarterly, yearly\n   */\n  addAmount(amount, currency, term) {\n    this.tags.push(newAmount(amount, currency, term));\n  }\n  /**\n   * Sets a relay where content related to this tier can be found\n   * @param relayUrl URL of the relay\n   */\n  set relayUrl(relayUrl) {\n    this.tags.push([\"r\", relayUrl]);\n  }\n  /**\n   * Returns the relay URLs for this tier\n   */\n  get relayUrls() {\n    return this.getMatchingTags(\"r\").map((tag) => tag[1]).filter((relay) => relay !== void 0);\n  }\n  /**\n   * Gets the verifier pubkey for this tier. This is the pubkey that will generate\n   * subscription payment receipts\n   */\n  get verifierPubkey() {\n    return this.tagValue(\"p\");\n  }\n  /**\n   * Sets the verifier pubkey for this tier.\n   */\n  set verifierPubkey(pubkey) {\n    this.removeTag(\"p\");\n    if (pubkey)\n      this.tags.push([\"p\", pubkey]);\n  }\n  /**\n   * Checks if this tier is valid\n   */\n  get isValid() {\n    return this.title !== void 0 && // Must have a title\n    this.amounts.length > 0;\n  }\n};\n\n// src/events/kinds/subscriptions/subscription-start.ts\nimport debug3 from \"debug\";\nvar NDKSubscriptionStart = class _NDKSubscriptionStart extends NDKEvent {\n  debug;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 7001 /* Subscribe */;\n    this.debug = ndk?.debug.extend(\"subscription-start\") ?? debug3(\"ndk:subscription-start\");\n  }\n  static from(event) {\n    return new _NDKSubscriptionStart(event.ndk, event.rawEvent());\n  }\n  /**\n   * Recipient of the subscription. I.e. The author of this event subscribes to this user.\n   */\n  get recipient() {\n    const pTag = this.getMatchingTags(\"p\")?.[0];\n    if (!pTag)\n      return void 0;\n    const user = new NDKUser({ pubkey: pTag[1] });\n    return user;\n  }\n  set recipient(user) {\n    this.removeTag(\"p\");\n    if (!user)\n      return;\n    this.tags.push([\"p\", user.pubkey]);\n  }\n  /**\n   * The amount of the subscription.\n   */\n  get amount() {\n    const amountTag = this.getMatchingTags(\"amount\")?.[0];\n    if (!amountTag)\n      return void 0;\n    return parseTagToSubscriptionAmount(amountTag);\n  }\n  set amount(amount) {\n    this.removeTag(\"amount\");\n    if (!amount)\n      return;\n    this.tags.push(newAmount(amount.amount, amount.currency, amount.term));\n  }\n  /**\n   * The event id or NIP-33 tag id of the tier that the user is subscribing to.\n   */\n  get tierId() {\n    const eTag = this.getMatchingTags(\"e\")?.[0];\n    const aTag = this.getMatchingTags(\"a\")?.[0];\n    if (!eTag || !aTag)\n      return void 0;\n    return eTag[1] ?? aTag[1];\n  }\n  set tier(tier) {\n    this.removeTag(\"e\");\n    this.removeTag(\"a\");\n    this.removeTag(\"event\");\n    if (!tier)\n      return;\n    this.tag(tier);\n    this.removeTag(\"p\");\n    this.tags.push([\"p\", tier.pubkey]);\n    this.tags.push([\"event\", JSON.stringify(tier.rawEvent())]);\n  }\n  /**\n   * Fetches the tier that the user is subscribing to.\n   */\n  async fetchTier() {\n    const eventTag = this.tagValue(\"event\");\n    if (eventTag) {\n      try {\n        const parsedEvent = JSON.parse(eventTag);\n        return NDKSubscriptionTier.from(parsedEvent);\n      } catch {\n        this.debug(\"Failed to parse event tag\");\n      }\n    }\n    const tierId = this.tierId;\n    if (!tierId)\n      return void 0;\n    const e = await this.ndk?.fetchEvent(tierId);\n    if (!e)\n      return void 0;\n    return NDKSubscriptionTier.from(e);\n  }\n  get isValid() {\n    if (this.getMatchingTags(\"amount\").length !== 1) {\n      this.debug(\"Invalid # of amount tag\");\n      return false;\n    }\n    if (!this.amount) {\n      this.debug(\"Invalid amount tag\");\n      return false;\n    }\n    if (this.getMatchingTags(\"p\").length !== 1) {\n      this.debug(\"Invalid # of p tag\");\n      return false;\n    }\n    if (!this.recipient) {\n      this.debug(\"Invalid p tag\");\n      return false;\n    }\n    return true;\n  }\n};\n\n// src/events/kinds/subscriptions/receipt.ts\nimport debug4 from \"debug\";\nvar NDKSubscriptionReceipt = class _NDKSubscriptionReceipt extends NDKEvent {\n  debug;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 7003 /* SubscriptionReceipt */;\n    this.debug = ndk?.debug.extend(\"subscription-start\") ?? debug4(\"ndk:subscription-start\");\n  }\n  static from(event) {\n    return new _NDKSubscriptionReceipt(event.ndk, event.rawEvent());\n  }\n  /**\n   * This is the person being subscribed to\n   */\n  get recipient() {\n    const pTag = this.getMatchingTags(\"p\")?.[0];\n    if (!pTag)\n      return void 0;\n    const user = new NDKUser({ pubkey: pTag[1] });\n    return user;\n  }\n  set recipient(user) {\n    this.removeTag(\"p\");\n    if (!user)\n      return;\n    this.tags.push([\"p\", user.pubkey]);\n  }\n  /**\n   * This is the person subscribing\n   */\n  get subscriber() {\n    const PTag = this.getMatchingTags(\"P\")?.[0];\n    if (!PTag)\n      return void 0;\n    const user = new NDKUser({ pubkey: PTag[1] });\n    return user;\n  }\n  set subscriber(user) {\n    this.removeTag(\"P\");\n    if (!user)\n      return;\n    this.tags.push([\"P\", user.pubkey]);\n  }\n  set subscriptionStart(event) {\n    this.debug(`before setting subscription start: ${this.rawEvent}`);\n    this.removeTag(\"e\");\n    this.tag(event, \"subscription\", true);\n    this.debug(`after setting subscription start: ${this.rawEvent}`);\n  }\n  get tierName() {\n    const tag = this.getMatchingTags(\"tier\")?.[0];\n    return tag?.[1];\n  }\n  get isValid() {\n    const period = this.validPeriod;\n    if (!period) {\n      return false;\n    }\n    if (period.start > period.end) {\n      return false;\n    }\n    const pTags = this.getMatchingTags(\"p\");\n    const PTags = this.getMatchingTags(\"P\");\n    if (pTags.length !== 1 || PTags.length !== 1) {\n      return false;\n    }\n    return true;\n  }\n  get validPeriod() {\n    const tag = this.getMatchingTags(\"valid\")?.[0];\n    if (!tag)\n      return void 0;\n    try {\n      return {\n        start: new Date(parseInt(tag[1]) * 1e3),\n        end: new Date(parseInt(tag[2]) * 1e3)\n      };\n    } catch {\n      return void 0;\n    }\n  }\n  set validPeriod(period) {\n    this.removeTag(\"valid\");\n    if (!period)\n      return;\n    this.tags.push([\n      \"valid\",\n      Math.floor(period.start.getTime() / 1e3).toString(),\n      Math.floor(period.end.getTime() / 1e3).toString()\n    ]);\n  }\n  get startPeriod() {\n    return this.validPeriod?.start;\n  }\n  get endPeriod() {\n    return this.validPeriod?.end;\n  }\n  /**\n   * Whether the subscription is currently active\n   */\n  isActive(time) {\n    time ??= /* @__PURE__ */ new Date();\n    const period = this.validPeriod;\n    if (!period)\n      return false;\n    if (time < period.start)\n      return false;\n    if (time > period.end)\n      return false;\n    return true;\n  }\n};\n\n// src/events/kinds/dvm/request.ts\nvar NDKDVMRequest = class _NDKDVMRequest extends NDKEvent {\n  constructor(ndk, event) {\n    super(ndk, event);\n  }\n  static from(event) {\n    return new _NDKDVMRequest(event.ndk, event.rawEvent());\n  }\n  set bid(msatAmount) {\n    if (msatAmount === void 0) {\n      this.removeTag(\"bid\");\n    } else {\n      this.tags.push([\"bid\", msatAmount.toString()]);\n    }\n  }\n  get bid() {\n    const v = this.tagValue(\"bid\");\n    if (v === void 0)\n      return void 0;\n    return parseInt(v);\n  }\n  /**\n   * Adds a new input to the job\n   * @param args The arguments to the input\n   */\n  addInput(...args) {\n    this.tags.push([\"i\", ...args]);\n  }\n  /**\n   * Adds a new parameter to the job\n   */\n  addParam(...args) {\n    this.tags.push([\"param\", ...args]);\n  }\n  set output(output) {\n    if (output === void 0) {\n      this.removeTag(\"output\");\n    } else {\n      if (typeof output === \"string\")\n        output = [output];\n      this.tags.push([\"output\", ...output]);\n    }\n  }\n  get output() {\n    const outputTag = this.getMatchingTags(\"output\")[0];\n    return outputTag ? outputTag.slice(1) : void 0;\n  }\n  get params() {\n    const paramTags = this.getMatchingTags(\"param\");\n    return paramTags.map((t) => t.slice(1));\n  }\n  getParam(name) {\n    const paramTag = this.getMatchingTags(\"param\").find((t) => t[1] === name);\n    return paramTag ? paramTag[2] : void 0;\n  }\n  /**\n   * Enables job encryption for this event\n   * @param dvm DVM that will receive the event\n   * @param signer Signer to use for encryption\n   */\n  async encryption(dvm, signer) {\n    const dvmTags = [\"i\", \"param\", \"output\", \"relays\", \"bid\"];\n    const tags = this.tags.filter((t) => dvmTags.includes(t[0]));\n    this.tags = this.tags.filter((t) => !dvmTags.includes(t[0]));\n    this.content = JSON.stringify(tags);\n    this.tag(dvm);\n    this.tags.push([\"encrypted\"]);\n    await this.encrypt(dvm, signer);\n  }\n  /**\n   * Sets the DVM that will receive the event\n   */\n  set dvm(dvm) {\n    this.removeTag(\"p\");\n    if (dvm)\n      this.tag(dvm);\n  }\n};\n\n// src/events/kinds/dvm/NDKTranscriptionDVM.ts\nvar NDKTranscriptionDVM = class _NDKTranscriptionDVM extends NDKDVMRequest {\n  constructor(ndk, event) {\n    super(ndk, event);\n    this.kind = 5e3 /* DVMReqTextExtraction */;\n  }\n  static from(event) {\n    return new _NDKTranscriptionDVM(event.ndk, event.rawEvent());\n  }\n  /**\n   * Returns the original source of the transcription\n   */\n  get url() {\n    const inputTags = this.getMatchingTags(\"i\");\n    if (inputTags.length !== 1) {\n      return void 0;\n    }\n    return inputTags[0][1];\n  }\n  /**\n   * Getter for the title tag\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the title tag\n   */\n  set title(value) {\n    this.removeTag(\"title\");\n    if (value) {\n      this.tags.push([\"title\", value]);\n    }\n  }\n  /**\n   * Getter for the image tag\n   */\n  get image() {\n    return this.tagValue(\"image\");\n  }\n  /**\n   * Setter for the image tag\n   */\n  set image(value) {\n    this.removeTag(\"image\");\n    if (value) {\n      this.tags.push([\"image\", value]);\n    }\n  }\n};\n\n// src/events/kinds/dvm/result.ts\nvar NDKDVMJobResult = class _NDKDVMJobResult extends NDKEvent {\n  constructor(ndk, event) {\n    super(ndk, event);\n  }\n  static from(event) {\n    return new _NDKDVMJobResult(event.ndk, event.rawEvent());\n  }\n  setAmount(msat, invoice) {\n    this.removeTag(\"amount\");\n    const tag = [\"amount\", msat.toString()];\n    if (invoice)\n      tag.push(invoice);\n    this.tags.push(tag);\n  }\n  set result(result) {\n    if (result === void 0) {\n      this.content = \"\";\n    } else {\n      this.content = result;\n    }\n  }\n  get result() {\n    if (this.content === \"\") {\n      return void 0;\n    }\n    return this.content;\n  }\n  set status(status) {\n    this.removeTag(\"status\");\n    if (status !== void 0) {\n      this.tags.push([\"status\", status]);\n    }\n  }\n  get status() {\n    return this.tagValue(\"status\");\n  }\n  get jobRequestId() {\n    for (const eTag of this.getMatchingTags(\"e\")) {\n      if (eTag[2] === \"job\")\n        return eTag[1];\n    }\n    if (this.jobRequest)\n      return this.jobRequest.id;\n    return this.tagValue(\"e\");\n  }\n  set jobRequest(event) {\n    this.removeTag(\"request\");\n    if (event) {\n      this.kind = event.kind + 1e3;\n      this.tags.push([\"request\", JSON.stringify(event.rawEvent())]);\n      this.tag(event);\n    }\n  }\n  get jobRequest() {\n    const tag = this.tagValue(\"request\");\n    if (tag === void 0) {\n      return void 0;\n    }\n    return new NDKEvent(this.ndk, JSON.parse(tag));\n  }\n};\n\n// src/events/kinds/dvm/feedback.ts\nvar NDKDvmJobFeedbackStatus = /* @__PURE__ */ ((NDKDvmJobFeedbackStatus2) => {\n  NDKDvmJobFeedbackStatus2[\"Processing\"] = \"processing\";\n  NDKDvmJobFeedbackStatus2[\"Success\"] = \"success\";\n  NDKDvmJobFeedbackStatus2[\"Scheduled\"] = \"scheduled\";\n  NDKDvmJobFeedbackStatus2[\"PayReq\"] = \"payment_required\";\n  return NDKDvmJobFeedbackStatus2;\n})(NDKDvmJobFeedbackStatus || {});\nvar NDKDVMJobFeedback = class _NDKDVMJobFeedback extends NDKEvent {\n  constructor(ndk, event) {\n    super(ndk, event);\n    this.kind ??= 7e3 /* DVMJobFeedback */;\n  }\n  static async from(event) {\n    const e = new _NDKDVMJobFeedback(event.ndk, event.rawEvent());\n    if (e.encrypted)\n      await e.dvmDecrypt();\n    return e;\n  }\n  get status() {\n    return this.tagValue(\"status\");\n  }\n  set status(status) {\n    this.removeTag(\"status\");\n    if (status !== void 0) {\n      this.tags.push([\"status\", status]);\n    }\n  }\n  get encrypted() {\n    return !!this.getMatchingTags(\"encrypted\")[0];\n  }\n  async dvmDecrypt() {\n    await this.decrypt();\n    const decryptedContent = JSON.parse(this.content);\n    this.tags.push(...decryptedContent);\n  }\n};\n\n// src/nwc/index.ts\nimport { EventEmitter as EventEmitter6 } from \"tseep\";\n\n// src/nwc/pay_invoice.ts\nasync function payInvoice(invoice) {\n  const ret = await this.sendReq(\"pay_invoice\", { invoice });\n  return ret;\n}\n\n// src/signers/private-key/index.ts\nimport { generatePrivateKey, getPublicKey, getSignature, nip04 } from \"nostr-tools\";\nvar NDKPrivateKeySigner = class _NDKPrivateKeySigner {\n  _user;\n  privateKey;\n  constructor(privateKey) {\n    if (privateKey) {\n      this.privateKey = privateKey;\n      this._user = new NDKUser({\n        hexpubkey: getPublicKey(this.privateKey)\n      });\n    }\n  }\n  static generate() {\n    const privateKey = generatePrivateKey();\n    return new _NDKPrivateKeySigner(privateKey);\n  }\n  async blockUntilReady() {\n    if (!this._user) {\n      throw new Error(\"NDKUser not initialized\");\n    }\n    return this._user;\n  }\n  async user() {\n    await this.blockUntilReady();\n    return this._user;\n  }\n  async sign(event) {\n    if (!this.privateKey) {\n      throw Error(\"Attempted to sign without a private key\");\n    }\n    return getSignature(event, this.privateKey);\n  }\n  async encrypt(recipient, value) {\n    if (!this.privateKey) {\n      throw Error(\"Attempted to encrypt without a private key\");\n    }\n    const recipientHexPubKey = recipient.hexpubkey;\n    return await nip04.encrypt(this.privateKey, recipientHexPubKey, value);\n  }\n  async decrypt(sender, value) {\n    if (!this.privateKey) {\n      throw Error(\"Attempted to decrypt without a private key\");\n    }\n    const senderHexPubKey = sender.hexpubkey;\n    return await nip04.decrypt(this.privateKey, senderHexPubKey, value);\n  }\n};\n\n// src/nwc/req.ts\nasync function sendReq(method, params) {\n  const event = new NDKEvent(this.ndk, {\n    kind: 23194 /* NostrWalletConnectReq */,\n    tags: [[\"p\", this.walletService.pubkey]],\n    content: JSON.stringify({ method, params })\n  });\n  this.debug(\"Sending request\", event.content);\n  await event.encrypt(this.walletService, this.signer);\n  await event.sign(this.signer);\n  this.debug(\"Request encrypted and signed\");\n  return new Promise(async (resolve, reject) => {\n    try {\n      const eTag = event.tagId();\n      if (!eTag)\n        throw new Error(\"Failed to get e-tag\");\n      const processEvent = (payload) => {\n        this.off(eTag, processEvent);\n        this.off(\"event\", processEvent);\n        this.debug(\"Received response\", payload);\n        try {\n          const content = JSON.parse(payload);\n          if (content.error)\n            reject(content);\n          resolve(content);\n        } catch (e) {\n          this.debug(\"Failed to parse response\", e);\n          reject({\n            result_type: \"error\",\n            error: {\n              code: \"failed_to_parse_response\",\n              message: e.message\n            }\n          });\n        }\n      };\n      const sub = this.ndk.subscribe(\n        {\n          kinds: [23195 /* NostrWalletConnectRes */],\n          \"#e\": [eTag],\n          limit: 1\n        },\n        { groupable: false, subId: `nwc-${method}` },\n        this.relaySet\n      );\n      sub.on(\"event\", async (event2) => {\n        await event2.decrypt(event2.author, this.signer);\n        processEvent(event2.content);\n        sub.stop();\n      });\n      this.once(eTag, processEvent);\n      this.once(\"event\", processEvent);\n      this.debug(\"Sending request to relay\", event.rawEvent());\n      await event.publish(this.relaySet);\n    } catch (e) {\n      this.debug(\"Failed to send request\", e, e.relayErrors);\n      reject({\n        result_type: \"error\",\n        error: {\n          code: \"failed_to_send_request\",\n          message: e.message\n        }\n      });\n    }\n  });\n}\n\n// src/nwc/get_balance.ts\nasync function getBalance() {\n  const ret = await this.sendReq(\"get_balance\", {});\n  return ret;\n}\n\n// src/nwc/get_info.ts\nasync function getInfo() {\n  const ret = await this.sendReq(\"get_info\", {});\n  return ret;\n}\n\n// src/nwc/index.ts\nvar NDKNwc = class _NDKNwc extends EventEmitter6 {\n  ndk;\n  debug;\n  /**\n   * The Wallet Service's public key\n   */\n  walletService;\n  relaySet;\n  signer;\n  active = false;\n  /**\n   *\n   * @param opts: NostrWalletConnectOptions\n   * @returns NDKNwc\n   */\n  constructor({\n    ndk,\n    pubkey,\n    relayUrls,\n    secret\n  }) {\n    super();\n    this.ndk = ndk;\n    this.walletService = ndk.getUser({ pubkey });\n    this.relaySet = new NDKRelaySet(\n      new Set(relayUrls.map((url) => ndk.pool.getRelay(url))),\n      ndk\n    );\n    this.signer = new NDKPrivateKeySigner(secret);\n    this.debug = ndk.debug.extend(\"nwc\");\n    this.debug(`Starting with wallet service ${this.walletService.npub}`);\n  }\n  static async fromURI(ndk, uri) {\n    const u = new URL(uri);\n    if (u.protocol !== \"nostr+walletconnect:\") {\n      throw new Error(\"Invalid protocol\");\n    }\n    const nwc = new _NDKNwc({\n      ndk,\n      pubkey: u.host ?? u.pathname,\n      relayUrls: u.searchParams.getAll(\"relay\") ?? [\"\"],\n      secret: u.searchParams.get(\"secret\") ?? \"\"\n    });\n    return nwc;\n  }\n  /**\n   * Blocks until we're subscribed to talk to the wallet service\n   * @param msTimeout Timeout in ms to wait for the subscription to be ready\n   * @returns\n   */\n  async blockUntilReady(msTimeout) {\n    const signerUser = await this.signer.user();\n    const timeout = new Promise((_, reject) => {\n      setTimeout(() => {\n        reject(new Error(\"Timeout\"));\n      }, msTimeout);\n    });\n    const subPromise = new Promise((resolve) => {\n      const sub = this.ndk.subscribe(\n        {\n          kinds: [23195 /* NostrWalletConnectRes */],\n          \"#p\": [signerUser.pubkey],\n          limit: 1\n        },\n        { groupable: false, subId: \"nwc\" },\n        this.relaySet\n      );\n      sub.on(\"event\", async (event) => {\n        this.debug(\"received response\", event.rawEvent());\n        const eTag = event.tagValue(\"e\");\n        if (!eTag) {\n          this.debug(\"Received an event without an e-tag\");\n          return;\n        }\n        this.debug(\"received an event\", eTag);\n        try {\n          await event.decrypt(event.author, this.signer);\n          this.emit(eTag, event.content);\n        } catch (e) {\n          this.debug(\"Failed to decrypt event\", e);\n          return;\n        }\n      });\n      sub.on(\"eose\", () => {\n        this.debug(\"Subscription ready\");\n        this.active = true;\n        resolve();\n      });\n      sub.on(\"close\", () => {\n        this.debug(\"Subscription closed\");\n        this.active = false;\n      });\n    });\n    const promises = [subPromise];\n    if (msTimeout)\n      promises.push(timeout);\n    return await Promise.race(promises);\n  }\n  async sendReq(method, params) {\n    return await sendReq.call(this, method, params);\n  }\n  async payInvoice(invoice) {\n    return await payInvoice.call(this, invoice);\n  }\n  async getInfo() {\n    return await getInfo.call(this);\n  }\n  getBalance = getBalance.bind(this);\n};\n\n// src/thread/index.ts\nfunction eventsBySameAuthor(op, events) {\n  const eventsByAuthor = /* @__PURE__ */ new Map();\n  eventsByAuthor.set(op.id, op);\n  events.forEach((event) => {\n    if (event.pubkey === op.pubkey) {\n      eventsByAuthor.set(event.id, event);\n    }\n  });\n  return eventsByAuthor;\n}\nfunction eventIsReply(op, event, threadIds) {\n  if (!threadIds)\n    threadIds = /* @__PURE__ */ new Set();\n  threadIds.add(op.id);\n  if (threadIds.has(event.id))\n    return false;\n  const replyMarker = event.tags.find((tag) => {\n    return threadIds.has(tag[1]) && tag[3] === \"reply\";\n  });\n  return !!replyMarker;\n  if (replyMarker)\n    return true;\n  const hasMarker = !!event.tags.find((tag) => [\"reply\", \"mention\"].includes(tag[3]));\n  if (hasMarker)\n    return false;\n  const expectedTags = event.getMatchingTags(\"e\").map((tag) => tag[1]);\n  expectedTags.push(event.id);\n  return event.getMatchingTags(\"e\").every((tag) => expectedTags.includes(tag[1]));\n}\nfunction eventThreads(op, events) {\n  const eventsByAuthor = eventsBySameAuthor(op, events);\n  const threadEvents = events.filter((event) => eventIsPartOfThread(op, event, eventsByAuthor));\n  return threadEvents.sort((a, b) => a.created_at - b.created_at);\n}\nfunction getEventReplyIds(event) {\n  return event.getMatchingTags(\"e\").filter((tag) => tag[3] === \"reply\").map((tag) => tag[1]);\n}\nfunction isEventOriginalPost(event) {\n  return getEventReplyIds(event).length === 0;\n}\nfunction eventThreadIds(op, events) {\n  const threadIds = /* @__PURE__ */ new Map();\n  const threadEvents = eventThreads(op, events);\n  threadEvents.forEach((event) => threadIds.set(event.id, event));\n  return threadIds;\n}\nfunction eventReplies(op, events, threadEventIds) {\n  threadEventIds ??= new Set(eventThreadIds(op, events).keys());\n  return events.filter((event) => eventIsReply(op, event, threadEventIds));\n}\nfunction eventIsPartOfThread(op, event, eventsByAuthor) {\n  if (op.pubkey !== event.pubkey)\n    return false;\n  const taggedEventIds = event.getMatchingTags(\"e\").map((tag) => tag[1]);\n  const allTaggedEventsAreByOriginalAuthor = taggedEventIds.every((id) => eventsByAuthor.has(id));\n  return allTaggedEventsAreByOriginalAuthor;\n}\nfunction eventHasETagMarkers(event) {\n  return event.getMatchingTags(\"e\").some((tag) => tag[3]);\n}\nfunction getRootEventId(event) {\n  let rootEventTag = event.tags.find((tag) => tag[0] === \"e\" && tag[3] === \"root\");\n  if (!rootEventTag) {\n    if (eventHasETagMarkers(event))\n      return null;\n    if (event.getMatchingTags(\"e\").length === 1) {\n      return event.getMatchingTags(\"e\")[0][1];\n    }\n  }\n  return rootEventTag ? rootEventTag[1] : null;\n}\n\n// src/events/kinds/simple-group/index.ts\nvar NDKSimpleGroup = class _NDKSimpleGroup {\n  ndk;\n  groupId;\n  relaySet;\n  constructor(ndk, groupId, relaySet) {\n    this.ndk = ndk;\n    this.groupId = groupId;\n    this.relaySet = relaySet;\n  }\n  /**\n   * Adds a user to the group using a kind:9000 event\n   * @param user user to add\n   * @param opts options\n   */\n  async addUser(user) {\n    const addUserEvent = _NDKSimpleGroup.generateAddUserEvent(user.pubkey, this.groupId);\n    addUserEvent.ndk = this.ndk;\n    const relays = await addUserEvent.publish(this.relaySet);\n    return addUserEvent;\n  }\n  async getMemberListEvent() {\n    const memberList = await this.ndk.fetchEvent(\n      {\n        kinds: [39002 /* GroupMembers */],\n        \"#d\": [this.groupId]\n      },\n      void 0,\n      this.relaySet\n    );\n    return memberList;\n  }\n  /**\n   * Gets a list of users that belong to this group\n   */\n  async getMembers() {\n    const members = [];\n    const memberPubkeys = /* @__PURE__ */ new Set();\n    const memberListEvent = await this.getMemberListEvent();\n    if (!memberListEvent)\n      return [];\n    for (const pTag of memberListEvent.getMatchingTags(\"p\")) {\n      const pubkey = pTag[1];\n      if (memberPubkeys.has(pubkey))\n        continue;\n      memberPubkeys.add(pubkey);\n      try {\n        members.push(this.ndk.getUser({ pubkey }));\n      } catch {\n      }\n    }\n    return members;\n  }\n  /**\n   * Generates an event that lists the members of a group.\n   * @param groupId\n   * @returns\n   */\n  static generateUserListEvent(groupId) {\n    const event = new NDKEvent(void 0, {\n      kind: 39002 /* GroupMembers */,\n      tags: [\n        [\"h\", groupId],\n        [\"alt\", \"Group Member List\"]\n      ]\n    });\n    return event;\n  }\n  /**\n   * Generates an event that adds a user to a group.\n   * @param userPubkey pubkey of the user to add\n   * @param groupId group to add the user to\n   * @returns\n   */\n  static generateAddUserEvent(userPubkey, groupId) {\n    const event = new NDKEvent(void 0, {\n      kind: 9e3 /* GroupAdminAddUser */,\n      tags: [[\"h\", groupId]]\n    });\n    event.tags.push([\"p\", userPubkey]);\n    return event;\n  }\n};\n\n// src/relay/auth-policies.ts\nimport createDebug2 from \"debug\";\nfunction disconnect(pool, debug7) {\n  debug7 ??= createDebug2(\"ndk:relay:auth-policies:disconnect\");\n  return async (relay) => {\n    debug7(`Relay ${relay.url} requested authentication, disconnecting`);\n    pool.removeRelay(relay.url);\n  };\n}\nasync function signAndAuth(event, relay, signer, debug7, resolve, reject) {\n  try {\n    await event.sign(signer);\n    await relay.auth(event);\n    resolve(event);\n  } catch (e) {\n    debug7(`Failed to publish auth event to relay ${relay.url}`, e);\n    reject(event);\n  }\n}\nfunction signIn({ ndk, signer, debug: debug7 } = {}) {\n  debug7 ??= createDebug2(\"ndk:auth-policies:signIn\");\n  return async (relay, challenge) => {\n    debug7(`Relay ${relay.url} requested authentication, signing in`);\n    const event = new NDKEvent(ndk);\n    event.kind = 22242 /* ClientAuth */;\n    event.tags = [\n      [\"relay\", relay.url],\n      [\"challenge\", challenge]\n    ];\n    signer ??= ndk?.signer;\n    return new Promise(async (resolve, reject) => {\n      if (signer) {\n        await signAndAuth(event, relay, signer, debug7, resolve, reject);\n      } else {\n        ndk?.once(\"signer:ready\", async (signer2) => {\n          await signAndAuth(event, relay, signer2, debug7, resolve, reject);\n        });\n      }\n    });\n  };\n}\nvar NDKRelayAuthPolicies = {\n  disconnect,\n  signIn\n};\n\n// src/signers/nip07/index.ts\nimport debug5 from \"debug\";\nvar NDKNip07Signer = class {\n  _userPromise;\n  nip04Queue = [];\n  nip04Processing = false;\n  debug;\n  waitTimeout;\n  /**\n   * @param waitTimeout - The timeout in milliseconds to wait for the NIP-07 to become available\n   */\n  constructor(waitTimeout = 1e3) {\n    this.debug = debug5(\"ndk:nip07\");\n    this.waitTimeout = waitTimeout;\n  }\n  async blockUntilReady() {\n    await this.waitForExtension();\n    const pubkey = await window.nostr.getPublicKey();\n    if (!pubkey) {\n      throw new Error(\"User rejected access\");\n    }\n    return new NDKUser({ hexpubkey: pubkey });\n  }\n  /**\n   * Getter for the user property.\n   * @returns The NDKUser instance.\n   */\n  async user() {\n    if (!this._userPromise) {\n      this._userPromise = this.blockUntilReady();\n    }\n    return this._userPromise;\n  }\n  /**\n   * Signs the given Nostr event.\n   * @param event - The Nostr event to be signed.\n   * @returns The signature of the signed event.\n   * @throws Error if the NIP-07 is not available on the window object.\n   */\n  async sign(event) {\n    await this.waitForExtension();\n    const signedEvent = await window.nostr.signEvent(event);\n    return signedEvent.sig;\n  }\n  async relays() {\n    await this.waitForExtension();\n    const relays = await window.nostr.getRelays?.() || {};\n    const activeRelays = [];\n    for (const url of Object.keys(relays)) {\n      if (relays[url].read && relays[url].write) {\n        activeRelays.push(url);\n      }\n    }\n    return activeRelays.map((url) => new NDKRelay(url));\n  }\n  async encrypt(recipient, value) {\n    await this.waitForExtension();\n    const recipientHexPubKey = recipient.hexpubkey;\n    return this.queueNip04(\"encrypt\", recipientHexPubKey, value);\n  }\n  async decrypt(sender, value) {\n    await this.waitForExtension();\n    const senderHexPubKey = sender.hexpubkey;\n    return this.queueNip04(\"decrypt\", senderHexPubKey, value);\n  }\n  async queueNip04(type, counterpartyHexpubkey, value) {\n    return new Promise((resolve, reject) => {\n      this.nip04Queue.push({\n        type,\n        counterpartyHexpubkey,\n        value,\n        resolve,\n        reject\n      });\n      if (!this.nip04Processing) {\n        this.processNip04Queue();\n      }\n    });\n  }\n  async processNip04Queue(item, retries = 0) {\n    if (!item && this.nip04Queue.length === 0) {\n      this.nip04Processing = false;\n      return;\n    }\n    this.nip04Processing = true;\n    const { type, counterpartyHexpubkey, value, resolve, reject } = item || this.nip04Queue.shift();\n    this.debug(\"Processing encryption queue item\", {\n      type,\n      counterpartyHexpubkey,\n      value\n    });\n    try {\n      let result;\n      if (type === \"encrypt\") {\n        result = await window.nostr.nip04.encrypt(counterpartyHexpubkey, value);\n      } else {\n        result = await window.nostr.nip04.decrypt(counterpartyHexpubkey, value);\n      }\n      resolve(result);\n    } catch (error) {\n      if (error.message && error.message.includes(\"call already executing\")) {\n        if (retries < 5) {\n          this.debug(\"Retrying encryption queue item\", {\n            type,\n            counterpartyHexpubkey,\n            value,\n            retries\n          });\n          setTimeout(() => {\n            this.processNip04Queue(item, retries + 1);\n          }, 50 * retries);\n          return;\n        }\n      }\n      reject(error);\n    }\n    this.processNip04Queue();\n  }\n  waitForExtension() {\n    return new Promise((resolve, reject) => {\n      if (window.nostr) {\n        resolve();\n        return;\n      }\n      let timerId;\n      const intervalId = setInterval(() => {\n        if (window.nostr) {\n          clearTimeout(timerId);\n          clearInterval(intervalId);\n          resolve();\n        }\n      }, 100);\n      timerId = setTimeout(() => {\n        clearInterval(intervalId);\n        reject(new Error(\"NIP-07 extension not available\"));\n      }, this.waitTimeout);\n    });\n  }\n};\n\n// src/signers/nip46/rpc.ts\nimport { EventEmitter as EventEmitter7 } from \"tseep\";\nvar NDKNostrRpc = class extends EventEmitter7 {\n  ndk;\n  signer;\n  debug;\n  constructor(ndk, signer, debug7) {\n    super();\n    this.ndk = ndk;\n    this.signer = signer;\n    this.debug = debug7.extend(\"rpc\");\n  }\n  /**\n   * Subscribe to a filter. This function will resolve once the subscription is ready.\n   */\n  subscribe(filter) {\n    const sub = this.ndk.subscribe(filter, {\n      closeOnEose: false,\n      groupable: false\n    });\n    sub.on(\"event\", async (event) => {\n      try {\n        const parsedEvent = await this.parseEvent(event);\n        if (parsedEvent.method) {\n          this.emit(\"request\", parsedEvent);\n        } else {\n          this.emit(`response-${parsedEvent.id}`, parsedEvent);\n        }\n      } catch (e) {\n        this.debug(\"error parsing event\", e, event.rawEvent());\n      }\n    });\n    return new Promise((resolve, reject) => {\n      sub.on(\"eose\", () => resolve(sub));\n    });\n  }\n  async parseEvent(event) {\n    const remoteUser = this.ndk.getUser({ hexpubkey: event.pubkey });\n    remoteUser.ndk = this.ndk;\n    const decryptedContent = await this.signer.decrypt(remoteUser, event.content);\n    const parsedContent = JSON.parse(decryptedContent);\n    const { id, method, params, result, error } = parsedContent;\n    if (method) {\n      return { id, pubkey: event.pubkey, method, params, event };\n    } else {\n      return { id, result, error, event };\n    }\n  }\n  async sendResponse(id, remotePubkey, result, kind = 24133 /* NostrConnect */, error) {\n    const res = { id, result };\n    if (error) {\n      res.error = error;\n    }\n    const localUser = await this.signer.user();\n    const remoteUser = this.ndk.getUser({ hexpubkey: remotePubkey });\n    const event = new NDKEvent(this.ndk, {\n      kind,\n      content: JSON.stringify(res),\n      tags: [[\"p\", remotePubkey]],\n      pubkey: localUser.hexpubkey\n    });\n    event.content = await this.signer.encrypt(remoteUser, event.content);\n    await event.sign(this.signer);\n    await event.publish();\n  }\n  /**\n   * Sends a request.\n   * @param remotePubkey\n   * @param method\n   * @param params\n   * @param kind\n   * @param id\n   */\n  async sendRequest(remotePubkey, method, params = [], kind = 24133, cb) {\n    const id = Math.random().toString(36).substring(7);\n    const localUser = await this.signer.user();\n    const remoteUser = this.ndk.getUser({ hexpubkey: remotePubkey });\n    const request = { id, method, params };\n    const promise = new Promise((resolve) => {\n      const responseHandler = (response) => {\n        if (response.result === \"auth_url\") {\n          this.once(`response-${id}`, responseHandler);\n          this.emit(\"authUrl\", response.error);\n        } else if (cb) {\n          cb(response);\n        }\n      };\n      this.once(`response-${id}`, responseHandler);\n    });\n    const event = new NDKEvent(this.ndk, {\n      kind,\n      content: JSON.stringify(request),\n      tags: [[\"p\", remotePubkey]],\n      pubkey: localUser.pubkey\n    });\n    event.content = await this.signer.encrypt(remoteUser, event.content);\n    await event.sign(this.signer);\n    this.debug(`sending ${method} request to`, remotePubkey);\n    await event.publish();\n    return promise;\n  }\n};\n\n// src/signers/nip46/backend/ping.ts\nvar PingEventHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const debug7 = backend.debug.extend(\"ping\");\n    debug7(`ping request from ${remotePubkey}`);\n    if (await backend.pubkeyAllowed({ id, pubkey: remotePubkey, method: \"ping\" })) {\n      debug7(`connection request from ${remotePubkey} allowed`);\n      return \"pong\";\n    } else {\n      debug7(`connection request from ${remotePubkey} rejected`);\n    }\n    return void 0;\n  }\n};\n\n// src/signers/nip46/backend/connect.ts\nvar ConnectEventHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const [_, token] = params;\n    const debug7 = backend.debug.extend(\"connect\");\n    debug7(`connection request from ${remotePubkey}`);\n    if (token && backend.applyToken) {\n      debug7(`applying token`);\n      await backend.applyToken(remotePubkey, token);\n    }\n    if (await backend.pubkeyAllowed({\n      id,\n      pubkey: remotePubkey,\n      method: \"connect\",\n      params: token\n    })) {\n      debug7(`connection request from ${remotePubkey} allowed`);\n      return \"ack\";\n    } else {\n      debug7(`connection request from ${remotePubkey} rejected`);\n    }\n    return void 0;\n  }\n};\n\n// src/signers/nip46/backend/get-public-key.ts\nvar GetPublicKeyHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    return backend.localUser?.pubkey;\n  }\n};\n\n// src/signers/nip46/backend/nip04-decrypt.ts\nvar Nip04DecryptHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const [senderPubkey, payload] = params;\n    const senderUser = new NDKUser({ hexpubkey: senderPubkey });\n    const decryptedPayload = await decrypt2(backend, id, remotePubkey, senderUser, payload);\n    return decryptedPayload;\n  }\n};\nasync function decrypt2(backend, id, remotePubkey, senderUser, payload) {\n  if (!await backend.pubkeyAllowed({\n    id,\n    pubkey: remotePubkey,\n    method: \"decrypt\",\n    params: payload\n  })) {\n    backend.debug(`decrypt request from ${remotePubkey} rejected`);\n    return void 0;\n  }\n  return await backend.signer.decrypt(senderUser, payload);\n}\n\n// src/signers/nip46/backend/nip04-encrypt.ts\nvar Nip04EncryptHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const [recipientPubkey, payload] = params;\n    const recipientUser = new NDKUser({ hexpubkey: recipientPubkey });\n    const encryptedPayload = await encrypt2(backend, id, remotePubkey, recipientUser, payload);\n    return encryptedPayload;\n  }\n};\nasync function encrypt2(backend, id, remotePubkey, recipientUser, payload) {\n  if (!await backend.pubkeyAllowed({\n    id,\n    pubkey: remotePubkey,\n    method: \"encrypt\",\n    params: payload\n  })) {\n    backend.debug(`encrypt request from ${remotePubkey} rejected`);\n    return void 0;\n  }\n  return await backend.signer.encrypt(recipientUser, payload);\n}\n\n// src/signers/nip46/backend/sign-event.ts\nvar SignEventHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const event = await signEvent(backend, id, remotePubkey, params);\n    if (!event)\n      return void 0;\n    return JSON.stringify(await event.toNostrEvent());\n  }\n};\nasync function signEvent(backend, id, remotePubkey, params) {\n  const [eventString] = params;\n  backend.debug(`sign event request from ${remotePubkey}`);\n  const event = new NDKEvent(backend.ndk, JSON.parse(eventString));\n  backend.debug(\"event to sign\", event.rawEvent());\n  if (!await backend.pubkeyAllowed({\n    id,\n    pubkey: remotePubkey,\n    method: \"sign_event\",\n    params: event\n  })) {\n    backend.debug(`sign event request from ${remotePubkey} rejected`);\n    return void 0;\n  }\n  backend.debug(`sign event request from ${remotePubkey} allowed`);\n  await event.sign(backend.signer);\n  return event;\n}\n\n// src/signers/nip46/backend/index.ts\nvar NDKNip46Backend = class {\n  ndk;\n  signer;\n  localUser;\n  debug;\n  rpc;\n  permitCallback;\n  /**\n   * @param ndk The NDK instance to use\n   * @param privateKeyOrSigner The private key or signer of the npub that wants to be published as\n   * @param permitCallback Callback executed when permission is requested\n   */\n  constructor(ndk, privateKeyOrSigner, permitCallback) {\n    this.ndk = ndk;\n    this.signer = typeof privateKeyOrSigner === \"string\" ? new NDKPrivateKeySigner(privateKeyOrSigner) : privateKeyOrSigner;\n    this.debug = ndk.debug.extend(\"nip46:backend\");\n    this.rpc = new NDKNostrRpc(ndk, this.signer, this.debug);\n    this.permitCallback = permitCallback;\n  }\n  /**\n   * This method starts the backend, which will start listening for incoming\n   * requests.\n   */\n  async start() {\n    this.localUser = await this.signer.user();\n    const sub = this.ndk.subscribe(\n      {\n        kinds: [24133],\n        \"#p\": [this.localUser.hexpubkey]\n      },\n      { closeOnEose: false }\n    );\n    sub.on(\"event\", (e) => this.handleIncomingEvent(e));\n  }\n  handlers = {\n    connect: new ConnectEventHandlingStrategy(),\n    sign_event: new SignEventHandlingStrategy(),\n    nip04_encrypt: new Nip04EncryptHandlingStrategy(),\n    nip04_decrypt: new Nip04DecryptHandlingStrategy(),\n    get_public_key: new GetPublicKeyHandlingStrategy(),\n    ping: new PingEventHandlingStrategy()\n  };\n  /**\n   * Enables the user to set a custom strategy for handling incoming events.\n   * @param method - The method to set the strategy for\n   * @param strategy - The strategy to set\n   */\n  setStrategy(method, strategy) {\n    this.handlers[method] = strategy;\n  }\n  /**\n   * Overload this method to apply tokens, which can\n   * wrap permission sets to be applied to a pubkey.\n   * @param pubkey public key to apply token to\n   * @param token token to apply\n   */\n  async applyToken(pubkey, token) {\n    throw new Error(\"connection token not supported\");\n  }\n  async handleIncomingEvent(event) {\n    const { id, method, params } = await this.rpc.parseEvent(event);\n    const remotePubkey = event.pubkey;\n    let response;\n    this.debug(\"incoming event\", { id, method, params });\n    if (!event.verifySignature(false)) {\n      this.debug(\"invalid signature\", event.rawEvent());\n      return;\n    }\n    const strategy = this.handlers[method];\n    if (strategy) {\n      try {\n        response = await strategy.handle(this, id, remotePubkey, params);\n      } catch (e) {\n        this.debug(\"error handling event\", e, { id, method, params });\n        this.rpc.sendResponse(id, remotePubkey, \"error\", void 0, e.message);\n      }\n    } else {\n      this.debug(\"unsupported method\", { method, params });\n    }\n    if (response) {\n      this.debug(`sending response to ${remotePubkey}`, response);\n      this.rpc.sendResponse(id, remotePubkey, response);\n    } else {\n      this.rpc.sendResponse(id, remotePubkey, \"error\", void 0, \"Not authorized\");\n    }\n  }\n  /**\n   * This method should be overriden by the user to allow or reject incoming\n   * connections.\n   */\n  async pubkeyAllowed(params) {\n    return this.permitCallback(params);\n  }\n};\n\n// src/signers/nip46/index.ts\nimport { EventEmitter as EventEmitter8 } from \"tseep\";\nvar NDKNip46Signer = class extends EventEmitter8 {\n  ndk;\n  remoteUser;\n  remotePubkey;\n  token;\n  localSigner;\n  nip05;\n  rpc;\n  debug;\n  relayUrls = [];\n  /**\n   * @param ndk - The NDK instance to use\n   * @param tokenOrRemoteUser - The public key, or a connection token, of the npub that wants to be published as\n   * @param localSigner - The signer that will be used to request events to be signed\n   */\n  constructor(ndk, tokenOrRemoteUser, localSigner) {\n    super();\n    let remotePubkey;\n    let token;\n    if (tokenOrRemoteUser.includes(\"#\")) {\n      const parts = tokenOrRemoteUser.split(\"#\");\n      remotePubkey = new NDKUser({ npub: parts[0] }).pubkey;\n      token = parts[1];\n    } else if (tokenOrRemoteUser.startsWith(\"npub\")) {\n      remotePubkey = new NDKUser({\n        npub: tokenOrRemoteUser\n      }).pubkey;\n    } else if (tokenOrRemoteUser.match(/\\./)) {\n      this.nip05 = tokenOrRemoteUser;\n    } else {\n      remotePubkey = tokenOrRemoteUser;\n    }\n    this.ndk = ndk;\n    if (remotePubkey)\n      this.remotePubkey = remotePubkey;\n    this.token = token;\n    this.debug = ndk.debug.extend(\"nip46:signer\");\n    this.remoteUser = new NDKUser({ pubkey: remotePubkey });\n    if (!localSigner) {\n      this.localSigner = NDKPrivateKeySigner.generate();\n    } else {\n      this.localSigner = localSigner;\n    }\n    this.rpc = new NDKNostrRpc(ndk, this.localSigner, this.debug);\n    this.rpc.on(\"authUrl\", (...props) => {\n      this.emit(\"authUrl\", ...props);\n    });\n    this.localSigner.user().then((localUser) => {\n      this.rpc.subscribe({\n        kinds: [24133 /* NostrConnect */, 24133 /* NostrConnect */ + 1],\n        \"#p\": [localUser.pubkey]\n      });\n    });\n  }\n  /**\n   * Get the user that is being published as\n   */\n  async user() {\n    return this.remoteUser;\n  }\n  async blockUntilReady() {\n    const localUser = await this.localSigner.user();\n    const remoteUser = this.ndk.getUser({ pubkey: this.remotePubkey });\n    if (this.nip05 && !this.remotePubkey) {\n      NDKUser.fromNip05(this.nip05).then((user) => {\n        if (user) {\n          this.remoteUser = user;\n          this.remotePubkey = user.pubkey;\n          this.relayUrls = user.nip46Urls;\n        }\n      });\n    }\n    if (!this.remotePubkey) {\n      throw new Error(\"Remote pubkey not set\");\n    }\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        const connectParams = [this.remotePubkey];\n        if (this.token) {\n          connectParams.push(this.token);\n        }\n        this.rpc.sendRequest(\n          this.remotePubkey,\n          \"connect\",\n          connectParams,\n          24133,\n          (response) => {\n            if (response.result === \"ack\") {\n              resolve(remoteUser);\n            } else {\n              reject(response.error);\n            }\n          }\n        );\n      }, 100);\n    });\n  }\n  async encrypt(recipient, value) {\n    this.debug(\"asking for encryption\");\n    const promise = new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"nip04_encrypt\",\n        [recipient.pubkey, value],\n        24133,\n        (response) => {\n          if (!response.error) {\n            resolve(response.result);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n    return promise;\n  }\n  async decrypt(sender, value) {\n    this.debug(\"asking for decryption\");\n    const promise = new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"nip04_decrypt\",\n        [sender.pubkey, value],\n        24133,\n        (response) => {\n          if (!response.error) {\n            const value2 = JSON.parse(response.result);\n            resolve(value2[0]);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n    return promise;\n  }\n  async sign(event) {\n    this.debug(\"asking for a signature\");\n    const promise = new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"sign_event\",\n        [JSON.stringify(event)],\n        24133,\n        (response) => {\n          this.debug(\"got a response\", response);\n          if (!response.error) {\n            const json = JSON.parse(response.result);\n            resolve(json.sig);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n    return promise;\n  }\n  /**\n   * Allows creating a new account on the remote server.\n   * @param username Desired username for the NIP-05\n   * @param domain Desired domain for the NIP-05\n   * @param email Email address to associate with this account -- Remote servers may use this for recovery\n   * @returns The public key of the newly created account\n   */\n  async createAccount(username, domain, email) {\n    this.debug(\"asking to create an account\");\n    const req = [];\n    if (username)\n      req.push(username);\n    if (domain)\n      req.push(domain);\n    if (email)\n      req.push(email);\n    return new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"create_account\",\n        req,\n        24133 /* NostrConnect */,\n        (response) => {\n          this.debug(\"got a response\", response);\n          if (!response.error) {\n            const pubkey = response.result;\n            resolve(pubkey);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n  }\n};\n\n// src/dvm/schedule.ts\nfunction addRelays(event, relays) {\n  const tags = [];\n  if (!relays || relays.length === 0) {\n    const poolRelays = event.ndk?.pool.relays;\n    relays = poolRelays ? Object.keys(poolRelays) : void 0;\n  }\n  if (relays && relays.length > 0)\n    tags.push([\"relays\", ...relays]);\n  return tags;\n}\nasync function dvmSchedule(event, dvm, relays, encrypted = true, waitForConfirmationForMs) {\n  if (!event.ndk)\n    throw new Error(\"NDK not set\");\n  if (!event.sig)\n    throw new Error(\"Event not signed\");\n  if (!event.created_at)\n    throw new Error(\"Event has no date\");\n  if (!dvm)\n    throw new Error(\"No DVM specified\");\n  if (event.created_at <= Date.now() / 1e3)\n    throw new Error(\"Event needs to be in the future\");\n  const scheduleEvent = new NDKDVMRequest(event.ndk, {\n    kind: 5905 /* DVMEventSchedule */\n  });\n  scheduleEvent.addInput(JSON.stringify(event.rawEvent()), \"text\");\n  scheduleEvent.tags.push(...addRelays(event, relays));\n  if (encrypted) {\n    await scheduleEvent.encryption(dvm);\n  } else {\n    scheduleEvent.dvm = dvm;\n  }\n  await scheduleEvent.sign();\n  let res;\n  if (waitForConfirmationForMs) {\n    res = event.ndk.subscribe(\n      {\n        kinds: [5905 /* DVMEventSchedule */ + 1e3, 7e3 /* DVMJobFeedback */],\n        ...scheduleEvent.filter()\n      },\n      { groupable: false, closeOnEose: false }\n    );\n  }\n  const timeoutPromise = new Promise((reject) => {\n    setTimeout(() => {\n      res?.stop();\n      reject(\"Timeout waiting for an answer from the DVM\");\n    }, waitForConfirmationForMs);\n  });\n  const schedulePromise = new Promise(\n    (resolve, reject) => {\n      if (waitForConfirmationForMs) {\n        res?.on(\"event\", async (e) => {\n          res?.stop();\n          if (e.kind === 7e3 /* DVMJobFeedback */) {\n            const feedback = await NDKDVMJobFeedback.from(e);\n            if (feedback.status === \"error\") {\n              const statusTag = feedback.getMatchingTags(\"status\");\n              reject(statusTag?.[2] ?? feedback);\n            } else {\n              resolve(feedback);\n            }\n          }\n          resolve(e);\n        });\n      }\n      scheduleEvent.publish().then(() => {\n        if (!waitForConfirmationForMs)\n          resolve();\n      });\n    }\n  );\n  return new Promise((resolve, reject) => {\n    if (waitForConfirmationForMs) {\n      Promise.race([timeoutPromise, schedulePromise]).then((e) => {\n        resolve(e);\n      }).catch(reject);\n    } else {\n      schedulePromise.then(resolve);\n    }\n  });\n}\n\n// src/ndk/index.ts\nimport debug6 from \"debug\";\nimport { EventEmitter as EventEmitter11 } from \"tseep\";\n\n// src/events/dedup.ts\nfunction dedup(event1, event2) {\n  if (event1.created_at > event2.created_at) {\n    return event1;\n  }\n  return event2;\n}\n\n// src/outbox/tracker.ts\nimport { EventEmitter as EventEmitter9 } from \"tseep\";\nimport { LRUCache } from \"typescript-lru-cache\";\nvar OutboxItem = class {\n  /**\n   * Type of item\n   */\n  type;\n  /**\n   * The relay URLs that are of interest to this item\n   */\n  relayUrlScores;\n  readRelays;\n  writeRelays;\n  constructor(type) {\n    this.type = type;\n    this.relayUrlScores = /* @__PURE__ */ new Map();\n    this.readRelays = /* @__PURE__ */ new Set();\n    this.writeRelays = /* @__PURE__ */ new Set();\n  }\n};\nvar OutboxTracker = class extends EventEmitter9 {\n  data;\n  ndk;\n  debug;\n  constructor(ndk) {\n    super();\n    this.ndk = ndk;\n    this.debug = ndk.debug.extend(\"outbox-tracker\");\n    this.data = new LRUCache({\n      maxSize: 1e5,\n      entryExpirationTimeInMS: 5e3\n    });\n  }\n  trackUsers(items) {\n    for (let i = 0; i < items.length; i += 400) {\n      const slice = items.slice(i, i + 400);\n      let pubkeys = slice.map((item) => getKeyFromItem(item));\n      pubkeys = pubkeys.filter((pubkey) => !this.data.has(pubkey));\n      if (pubkeys.length === 0)\n        continue;\n      const outboxItems = /* @__PURE__ */ new Map();\n      for (const pubkey of pubkeys) {\n        outboxItems.set(pubkey, this.track(pubkey, \"user\"));\n      }\n      NDKRelayList.forUsers(pubkeys, this.ndk).then(\n        (relayLists) => {\n          for (const [pubkey, relayList] of relayLists) {\n            const outboxItem = outboxItems.get(pubkey);\n            const user = new NDKUser({ pubkey });\n            user.ndk = this.ndk;\n            if (relayList) {\n              outboxItem.readRelays = new Set(normalize(relayList.readRelayUrls));\n              outboxItem.writeRelays = new Set(normalize(relayList.writeRelayUrls));\n              for (const relayUrl of outboxItem.readRelays) {\n                if (this.ndk.pool.blacklistRelayUrls.has(relayUrl)) {\n                  this.debug(\n                    `removing blacklisted relay ${relayUrl} from read relays`\n                  );\n                  outboxItem.readRelays.delete(relayUrl);\n                }\n              }\n              for (const relayUrl of outboxItem.writeRelays) {\n                if (this.ndk.pool.blacklistRelayUrls.has(relayUrl)) {\n                  this.debug(\n                    `removing blacklisted relay ${relayUrl} from write relays`\n                  );\n                  outboxItem.writeRelays.delete(relayUrl);\n                }\n              }\n              this.data.set(pubkey, outboxItem);\n            }\n          }\n        }\n      );\n    }\n  }\n  /**\n   *\n   * @param key\n   * @param score\n   */\n  track(item, type) {\n    const key = getKeyFromItem(item);\n    type ??= getTypeFromItem(item);\n    let outboxItem = this.data.get(key);\n    if (!outboxItem)\n      outboxItem = new OutboxItem(type);\n    this.data.set(key, outboxItem);\n    return outboxItem;\n  }\n};\nfunction getKeyFromItem(item) {\n  if (item instanceof NDKUser) {\n    return item.pubkey;\n  } else {\n    return item;\n  }\n}\nfunction getTypeFromItem(item) {\n  if (item instanceof NDKUser) {\n    return \"user\";\n  } else {\n    return \"kind\";\n  }\n}\n\n// src/relay/pool/index.ts\nimport { EventEmitter as EventEmitter10 } from \"tseep\";\nvar NDKPool = class extends EventEmitter10 {\n  // TODO: This should probably be an LRU cache\n  relays = /* @__PURE__ */ new Map();\n  blacklistRelayUrls;\n  debug;\n  temporaryRelayTimers = /* @__PURE__ */ new Map();\n  flappingRelays = /* @__PURE__ */ new Set();\n  // A map to store timeouts for each flapping relay.\n  backoffTimes = /* @__PURE__ */ new Map();\n  constructor(relayUrls = [], blacklistedRelayUrls = [], ndk, debug7) {\n    super();\n    this.debug = debug7 ?? ndk.debug.extend(\"pool\");\n    for (const relayUrl of relayUrls) {\n      const relay = new NDKRelay(relayUrl);\n      this.addRelay(relay, false);\n    }\n    this.blacklistRelayUrls = new Set(blacklistedRelayUrls);\n  }\n  /**\n   * Adds a relay to the pool, and sets a timer to remove it if it is not used within the specified time.\n   * @param relay - The relay to add to the pool.\n   * @param removeIfUnusedAfter - The time in milliseconds to wait before removing the relay from the pool after it is no longer used.\n   */\n  useTemporaryRelay(relay, removeIfUnusedAfter = 6e5) {\n    const relayAlreadyInPool = this.relays.has(relay.url);\n    if (!relayAlreadyInPool) {\n      this.addRelay(relay);\n    }\n    const existingTimer = this.temporaryRelayTimers.get(relay.url);\n    if (existingTimer) {\n      clearTimeout(existingTimer);\n    }\n    if (!relayAlreadyInPool || existingTimer) {\n      const timer = setTimeout(() => {\n        this.removeRelay(relay.url);\n      }, removeIfUnusedAfter);\n      this.temporaryRelayTimers.set(relay.url, timer);\n    }\n  }\n  /**\n   * Adds a relay to the pool.\n   *\n   * @param relay - The relay to add to the pool.\n   * @param connect - Whether or not to connect to the relay.\n   */\n  addRelay(relay, connect = true) {\n    const relayUrl = relay.url;\n    if (this.blacklistRelayUrls?.has(relayUrl)) {\n      this.debug(`Relay ${relayUrl} is blacklisted`);\n      return;\n    }\n    relay.on(\"notice\", async (relay2, notice) => this.emit(\"notice\", relay2, notice));\n    relay.on(\"connect\", () => this.handleRelayConnect(relayUrl));\n    relay.on(\"ready\", () => this.handleRelayReady(relay));\n    relay.on(\"disconnect\", async () => this.emit(\"relay:disconnect\", relay));\n    relay.on(\"flapping\", () => this.handleFlapping(relay));\n    relay.on(\"auth\", async (challenge) => this.emit(\"relay:auth\", relay, challenge));\n    relay.on(\"authed\", async () => this.emit(\"relay:authed\", relay));\n    this.relays.set(relayUrl, relay);\n    if (connect) {\n      this.emit(\"relay:connecting\", relay);\n      relay.connect().catch((e) => {\n        this.debug(`Failed to connect to relay ${relayUrl}`, e);\n      });\n    }\n  }\n  /**\n   * Removes a relay from the pool.\n   * @param relayUrl - The URL of the relay to remove.\n   * @returns {boolean} True if the relay was removed, false if it was not found.\n   */\n  removeRelay(relayUrl) {\n    const relay = this.relays.get(relayUrl);\n    if (relay) {\n      relay.disconnect();\n      this.relays.delete(relayUrl);\n      this.emit(\"relay:disconnect\", relay);\n      return true;\n    }\n    const existingTimer = this.temporaryRelayTimers.get(relayUrl);\n    if (existingTimer) {\n      clearTimeout(existingTimer);\n      this.temporaryRelayTimers.delete(relayUrl);\n    }\n    return false;\n  }\n  /**\n   * Fetches a relay from the pool, or creates a new one if it does not exist.\n   *\n   * New relays will be attempted to be connected.\n   */\n  getRelay(url, connect = true) {\n    let relay = this.relays.get(url);\n    if (!relay) {\n      relay = new NDKRelay(url);\n      this.addRelay(relay, connect);\n    }\n    return relay;\n  }\n  handleRelayConnect(relayUrl) {\n    this.debug(`Relay ${relayUrl} connected`);\n    this.emit(\"relay:connect\", this.relays.get(relayUrl));\n    if (this.stats().connected === this.relays.size) {\n      this.emit(\"connect\");\n    }\n  }\n  handleRelayReady(relay) {\n    this.debug(`Relay ${relay.url} ready`);\n    this.emit(\"relay:ready\", relay);\n  }\n  /**\n   * Attempts to establish a connection to each relay in the pool.\n   *\n   * @async\n   * @param {number} [timeoutMs] - Optional timeout in milliseconds for each connection attempt.\n   * @returns {Promise<void>} A promise that resolves when all connection attempts have completed.\n   * @throws {Error} If any of the connection attempts result in an error or timeout.\n   */\n  async connect(timeoutMs) {\n    const promises = [];\n    this.debug(\n      `Connecting to ${this.relays.size} relays${timeoutMs ? `, timeout ${timeoutMs}...` : \"\"}`\n    );\n    for (const relay of this.relays.values()) {\n      const connectPromise = new Promise((resolve, reject) => {\n        this.emit(\"relay:connecting\", relay);\n        return relay.connect(timeoutMs).then(resolve).catch(reject);\n      });\n      if (timeoutMs) {\n        const timeoutPromise = new Promise((_, reject) => {\n          setTimeout(() => reject(`Timed out after ${timeoutMs}ms`), timeoutMs);\n        });\n        promises.push(\n          Promise.race([connectPromise, timeoutPromise]).catch((e) => {\n            this.debug(\n              `Failed to connect to relay ${relay.url}: ${e ?? \"No reason specified\"}`\n            );\n          })\n        );\n      } else {\n        promises.push(connectPromise);\n      }\n    }\n    if (timeoutMs) {\n      setTimeout(() => {\n        const allConnected = this.stats().connected === this.relays.size;\n        const someConnected = this.stats().connected > 0;\n        if (!allConnected && someConnected) {\n          this.emit(\"connect\");\n        }\n      }, timeoutMs);\n    }\n    await Promise.all(promises);\n  }\n  checkOnFlappingRelays() {\n    const flappingRelaysCount = this.flappingRelays.size;\n    const totalRelays = this.relays.size;\n    if (flappingRelaysCount / totalRelays >= 0.8) {\n      for (const relayUrl of this.flappingRelays) {\n        this.backoffTimes.set(relayUrl, 0);\n      }\n    }\n  }\n  handleFlapping(relay) {\n    this.debug(`Relay ${relay.url} is flapping`);\n    let currentBackoff = this.backoffTimes.get(relay.url) || 5e3;\n    currentBackoff = currentBackoff * 2;\n    this.backoffTimes.set(relay.url, currentBackoff);\n    this.debug(`Backoff time for ${relay.url} is ${currentBackoff}ms`);\n    setTimeout(() => {\n      this.debug(`Attempting to reconnect to ${relay.url}`);\n      this.emit(\"relay:connecting\", relay);\n      relay.connect();\n      this.checkOnFlappingRelays();\n    }, currentBackoff);\n    relay.disconnect();\n    this.emit(\"flapping\", relay);\n  }\n  size() {\n    return this.relays.size;\n  }\n  /**\n   * Returns the status of each relay in the pool.\n   * @returns {NDKPoolStats} An object containing the number of relays in each status.\n   */\n  stats() {\n    const stats = {\n      total: 0,\n      connected: 0,\n      disconnected: 0,\n      connecting: 0\n    };\n    for (const relay of this.relays.values()) {\n      stats.total++;\n      if (relay.status === 1 /* CONNECTED */) {\n        stats.connected++;\n      } else if (relay.status === 3 /* DISCONNECTED */) {\n        stats.disconnected++;\n      } else if (relay.status === 0 /* CONNECTING */) {\n        stats.connecting++;\n      }\n    }\n    return stats;\n  }\n  connectedRelays() {\n    return Array.from(this.relays.values()).filter(\n      (relay) => relay.status === 1 /* CONNECTED */\n    );\n  }\n  /**\n   * Get a list of all relay urls in the pool.\n   */\n  urls() {\n    return Array.from(this.relays.keys());\n  }\n};\n\n// src/relay/sets/utils.ts\nfunction correctRelaySet(relaySet, pool) {\n  const connectedRelays = pool.connectedRelays();\n  const includesConnectedRelay = Array.from(relaySet.relays).some((relay) => {\n    return connectedRelays.map((r) => r.url).includes(relay.url);\n  });\n  if (!includesConnectedRelay) {\n    for (const relay of connectedRelays) {\n      relaySet.addRelay(relay);\n    }\n  }\n  if (connectedRelays.length === 0) {\n    for (const relay of pool.relays.values()) {\n      relaySet.addRelay(relay);\n    }\n  }\n  return relaySet;\n}\n\n// src/media/index.ts\nvar SPEC_PATH = \"/.well-known/nostr/nip96.json\";\nvar Nip96 = class {\n  ndk;\n  spec;\n  url;\n  nip98Required = false;\n  /**\n   * @param domain domain of the NIP96 service\n   */\n  constructor(domain, ndk) {\n    this.url = `https://${domain}${SPEC_PATH}`;\n    this.ndk = ndk;\n  }\n  async prepareUpload(blob, httpVerb = \"POST\") {\n    this.validateHttpFetch();\n    if (!this.spec)\n      await this.fetchSpec();\n    if (!this.spec)\n      throw new Error(\"Failed to fetch NIP96 spec\");\n    let headers = {};\n    if (this.nip98Required) {\n      const authorizationHeader = await this.generateNip98Header(\n        this.spec.api_url,\n        httpVerb,\n        blob\n      );\n      headers = { Authorization: authorizationHeader };\n    }\n    return {\n      url: this.spec.api_url,\n      headers\n    };\n  }\n  /**\n   * Provides an XMLHttpRequest-based upload method for browsers.\n   * @example\n   * const xhr = new XMLHttpRequest();\n   * xhr.upload.addEventListener(\"progress\", function(e) {\n   *    const percentComplete = e.loaded / e.total;\n   *    console.log(percentComplete);\n   * });\n   * const nip96 = ndk.getNip96(\"nostrcheck.me\");\n   * const blob = new Blob([\"Hello, world!\"], { type: \"text/plain\" });\n   * const response = await nip96.xhrUpload(xhr, blob);\n   * console.log(response);\n   * @returns Promise that resolves to the upload response\n   */\n  async xhrUpload(xhr, blob) {\n    const httpVerb = \"POST\";\n    const { url, headers } = await this.prepareUpload(blob, httpVerb);\n    xhr.open(httpVerb, url, true);\n    if (headers[\"Authorization\"]) {\n      xhr.setRequestHeader(\"Authorization\", headers[\"Authorization\"]);\n    }\n    const formData = new FormData();\n    formData.append(\"file\", blob);\n    return new Promise((resolve, reject) => {\n      xhr.onload = function() {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          resolve(JSON.parse(xhr.responseText));\n        } else {\n          reject(new Error(xhr.statusText));\n        }\n      };\n      xhr.onerror = function() {\n        reject(new Error(\"Network Error\"));\n      };\n      xhr.send(formData);\n    });\n  }\n  /**\n   * Fetch-based upload method. Note that this will use NDK's httpFetch\n   * @param blob\n   * @returns Promise that resolves to the upload response\n   *\n   * @example\n   * const nip96 = ndk.getNip96(\"nostrcheck.me\");\n   * const blob = new Blob([\"Hello, world!\"], { type: \"text/plain\" });\n   * const response = await nip96.upload(blob);\n   * console.log(response);\n   */\n  async upload(blob) {\n    const httpVerb = \"POST\";\n    const { url, headers } = await this.prepareUpload(blob, httpVerb);\n    const formData = new FormData();\n    formData.append(\"file\", blob);\n    const res = await this.ndk.httpFetch(this.spec.api_url, {\n      method: httpVerb,\n      headers,\n      body: formData\n    });\n    if (res.status !== 200)\n      throw new Error(`Failed to upload file to ${url}`);\n    const json = await res.json();\n    if (json.status !== \"success\")\n      throw new Error(json.message);\n    return json;\n  }\n  validateHttpFetch() {\n    if (!this.ndk)\n      throw new Error(\"NDK is required to fetch NIP96 spec\");\n    if (!this.ndk.httpFetch)\n      throw new Error(\"NDK must have an httpFetch method to fetch NIP96 spec\");\n  }\n  async fetchSpec() {\n    this.validateHttpFetch();\n    const res = await this.ndk.httpFetch(this.url);\n    if (res.status !== 200)\n      throw new Error(`Failed to fetch NIP96 spec from ${this.url}`);\n    const spec = await res.json();\n    if (!spec)\n      throw new Error(`Failed to parse NIP96 spec from ${this.url}`);\n    this.spec = spec;\n    this.nip98Required = this.spec.plans.free.is_nip98_required;\n  }\n  async generateNip98Header(requestUrl, httpMethod, blob) {\n    const event = new NDKEvent(this.ndk, {\n      kind: 27235 /* HttpAuth */,\n      tags: [\n        [\"u\", requestUrl],\n        [\"method\", httpMethod]\n      ]\n    });\n    if ([\"POST\", \"PUT\", \"PATCH\"].includes(httpMethod)) {\n      const sha256Hash = await this.calculateSha256(blob);\n      event.tags.push([\"payload\", sha256Hash]);\n    }\n    await event.sign();\n    const encodedEvent = btoa(JSON.stringify(event.rawEvent()));\n    return `Nostr ${encodedEvent}`;\n  }\n  async calculateSha256(blob) {\n    const buffer = await blob.arrayBuffer();\n    const hashBuffer = await crypto.subtle.digest(\"SHA-256\", buffer);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    const hashHex = hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n    return hashHex;\n  }\n};\n\n// src/ndk/queue/index.ts\nvar Queue = class {\n  queue = [];\n  maxConcurrency;\n  processing = /* @__PURE__ */ new Set();\n  promises = /* @__PURE__ */ new Map();\n  constructor(name, maxConcurrency) {\n    this.maxConcurrency = maxConcurrency;\n  }\n  add(item) {\n    if (this.promises.has(item.id)) {\n      return this.promises.get(item.id);\n    } else {\n    }\n    const promise = new Promise((resolve, reject) => {\n      this.queue.push({\n        ...item,\n        func: () => item.func().then(\n          (result) => {\n            resolve(result);\n            return result;\n          },\n          (error) => {\n            reject(error);\n            throw error;\n          }\n        )\n      });\n      this.process();\n    });\n    this.promises.set(item.id, promise);\n    promise.finally(() => {\n      this.promises.delete(item.id);\n      this.processing.delete(item.id);\n    });\n    return promise;\n  }\n  process() {\n    if (this.processing.size >= this.maxConcurrency || this.queue.length === 0) {\n      return;\n    }\n    const item = this.queue.shift();\n    if (!item || this.processing.has(item.id)) {\n      return;\n    }\n    this.processing.add(item.id);\n    item.func();\n  }\n  clear() {\n    this.queue = [];\n  }\n  clearProcessing() {\n    this.processing.clear();\n  }\n  clearAll() {\n    this.clear();\n    this.clearProcessing();\n  }\n  length() {\n    return this.queue.length;\n  }\n};\n\n// src/ndk/index.ts\nvar DEFAULT_OUTBOX_RELAYS = [\"wss://purplepag.es/\", \"wss://profiles.nos.social/\"];\nvar DEFAULT_BLACKLISTED_RELAYS = [\n  \"wss://brb.io/\",\n  // BRB\n  \"wss://nostr.mutinywallet.com/\",\n  // Don't try to read from this relay since it's a write-only relay\n  \"wss://purplepag.es/\"\n  // This is a hack, since this is a mostly read-only relay, but not fully. Once we have relay routing this can be removed so it only receives the supported kinds\n];\nvar NDK = class extends EventEmitter11 {\n  explicitRelayUrls;\n  pool;\n  outboxPool;\n  _signer;\n  _activeUser;\n  cacheAdapter;\n  debug;\n  devWriteRelaySet;\n  outboxTracker;\n  mutedIds;\n  clientName;\n  clientNip89;\n  queuesZapConfig;\n  queuesNip05;\n  /**\n   * Default relay-auth policy that will be used when a relay requests authentication,\n   * if no other policy is specified for that relay.\n   *\n   * @example Disconnect from relays that request authentication:\n   * ```typescript\n   * ndk.relayAuthDefaultPolicy = NDKAuthPolicies.disconnect(ndk.pool);\n   * ```\n   *\n   * @example Sign in to relays that request authentication:\n   * ```typescript\n   * ndk.relayAuthDefaultPolicy = NDKAuthPolicies.signIn({ndk})\n   * ```\n   *\n   * @example Sign in to relays that request authentication, asking the user for confirmation:\n   * ```typescript\n   * ndk.relayAuthDefaultPolicy = (relay: NDKRelay) => {\n   *     const signIn = NDKAuthPolicies.signIn({ndk});\n   *     if (confirm(`Relay ${relay.url} is requesting authentication, do you want to sign in?`)) {\n   *        signIn(relay);\n   *     }\n   * }\n   * ```\n   */\n  relayAuthDefaultPolicy;\n  /**\n   * Fetch function to use for HTTP requests.\n   *\n   * @example\n   * ```typescript\n   * import fetch from \"node-fetch\";\n   *\n   * ndk.httpFetch = fetch;\n   * ```\n   */\n  httpFetch;\n  autoConnectUserRelays = true;\n  autoFetchUserMutelist = true;\n  constructor(opts = {}) {\n    super();\n    this.debug = opts.debug || debug6(\"ndk\");\n    this.explicitRelayUrls = opts.explicitRelayUrls || [];\n    this.pool = new NDKPool(\n      opts.explicitRelayUrls || [],\n      opts.blacklistRelayUrls || DEFAULT_BLACKLISTED_RELAYS,\n      this\n    );\n    this.debug(`Starting with explicit relays: ${JSON.stringify(this.explicitRelayUrls)}`);\n    this.pool.on(\"relay:auth\", async (relay, challenge) => {\n      if (this.relayAuthDefaultPolicy) {\n        await this.relayAuthDefaultPolicy(relay, challenge);\n      }\n    });\n    this.autoConnectUserRelays = opts.autoConnectUserRelays ?? true;\n    this.autoFetchUserMutelist = opts.autoFetchUserMutelist ?? true;\n    this.clientName = opts.clientName;\n    this.clientNip89 = opts.clientNip89;\n    this.relayAuthDefaultPolicy = opts.relayAuthDefaultPolicy;\n    if (opts.enableOutboxModel) {\n      this.outboxPool = new NDKPool(\n        opts.outboxRelayUrls || DEFAULT_OUTBOX_RELAYS,\n        opts.blacklistRelayUrls || DEFAULT_BLACKLISTED_RELAYS,\n        this,\n        this.debug.extend(\"outbox-pool\")\n      );\n      this.outboxTracker = new OutboxTracker(this);\n    }\n    this.signer = opts.signer;\n    this.cacheAdapter = opts.cacheAdapter;\n    this.mutedIds = opts.mutedIds || /* @__PURE__ */ new Map();\n    if (opts.devWriteRelayUrls) {\n      this.devWriteRelaySet = NDKRelaySet.fromRelayUrls(opts.devWriteRelayUrls, this);\n    }\n    this.queuesZapConfig = new Queue(\"zaps\", 3);\n    this.queuesNip05 = new Queue(\"nip05\", 10);\n    try {\n      this.httpFetch = fetch;\n    } catch {\n    }\n  }\n  /**\n   * Adds an explicit relay to the pool.\n   * @param url\n   * @param relayAuthPolicy Authentication policy to use if different from the default\n   * @param connect Whether to connect to the relay automatically\n   * @returns\n   */\n  addExplicitRelay(urlOrRelay, relayAuthPolicy, connect = true) {\n    let relay;\n    if (typeof urlOrRelay === \"string\") {\n      relay = new NDKRelay(urlOrRelay, relayAuthPolicy);\n    } else {\n      relay = urlOrRelay;\n    }\n    this.pool.addRelay(relay, connect);\n    this.explicitRelayUrls.push(relay.url);\n    return relay;\n  }\n  toJSON() {\n    return { relayCount: this.pool.relays.size }.toString();\n  }\n  get activeUser() {\n    return this._activeUser;\n  }\n  /**\n   * Sets the active user for this NDK instance, typically this will be\n   * called when assigning a signer to the NDK instance.\n   *\n   * This function will automatically connect to the user's relays if\n   * `autoConnectUserRelays` is set to true.\n   *\n   * It will also fetch the user's mutelist if `autoFetchUserMutelist` is set to true.\n   */\n  set activeUser(user) {\n    const differentUser = this._activeUser?.pubkey !== user?.pubkey;\n    this._activeUser = user;\n    if (user && differentUser) {\n      const connectToUserRelays = async (user2) => {\n        const relayList = await NDKRelayList.forUser(user2.pubkey, this);\n        if (!relayList) {\n          this.debug(\"No relay list found for user\", { npub: user2.npub });\n          return;\n        }\n        this.debug(\"Connecting to user relays\", {\n          npub: user2.npub,\n          relays: relayList.relays\n        });\n        for (const url of relayList.relays) {\n          let relay = this.pool.relays.get(url);\n          if (!relay) {\n            relay = new NDKRelay(url);\n            this.pool.addRelay(relay);\n          }\n        }\n      };\n      const fetchBlockedRelays = async (user2) => {\n        const blockedRelays = await this.fetchEvent({\n          kinds: [10006 /* BlockRelayList */],\n          authors: [user2.pubkey]\n        });\n        if (blockedRelays) {\n          const list = lists_default.from(blockedRelays);\n          for (const item of list.items) {\n            this.pool.blacklistRelayUrls.add(item[0]);\n          }\n        }\n        this.debug(\"Blocked relays\", { blockedRelays });\n      };\n      const fetchUserMuteList = async (user2) => {\n        const muteList = await this.fetchEvent({\n          kinds: [1e4 /* MuteList */],\n          authors: [user2.pubkey]\n        });\n        if (muteList) {\n          const list = lists_default.from(muteList);\n          for (const item of list.items) {\n            this.mutedIds.set(item[1], item[0]);\n          }\n        }\n      };\n      const userFunctions = [fetchBlockedRelays];\n      if (this.autoConnectUserRelays)\n        userFunctions.push(connectToUserRelays);\n      if (this.autoFetchUserMutelist)\n        userFunctions.push(fetchUserMuteList);\n      const runUserFunctions = async (user2) => {\n        for (const fn of userFunctions) {\n          await fn(user2);\n        }\n      };\n      const pool = this.outboxPool || this.pool;\n      if (pool.connectedRelays.length > 0) {\n        runUserFunctions(user);\n      } else {\n        this.debug(\"Waiting for connection to main relays\");\n        pool.once(\"connect\", () => {\n          runUserFunctions(user);\n        });\n      }\n    } else if (!user) {\n      this.mutedIds = /* @__PURE__ */ new Map();\n    }\n  }\n  get signer() {\n    return this._signer;\n  }\n  set signer(newSigner) {\n    this._signer = newSigner;\n    this.emit(\"signer:ready\", newSigner);\n    newSigner?.user().then((user) => {\n      user.ndk = this;\n      this.activeUser = user;\n    });\n  }\n  /**\n   * Connect to relays with optional timeout.\n   * If the timeout is reached, the connection will be continued to be established in the background.\n   */\n  async connect(timeoutMs) {\n    if (this._signer && this.autoConnectUserRelays) {\n      this.debug(\"Attempting to connect to user relays specified by signer\");\n      if (this._signer.relays) {\n        const relays = await this._signer.relays();\n        relays.forEach((relay) => this.pool.addRelay(relay));\n      }\n    }\n    const connections = [this.pool.connect(timeoutMs)];\n    if (this.outboxPool) {\n      connections.push(this.outboxPool.connect(timeoutMs));\n    }\n    this.debug(\"Connecting to relays\", { timeoutMs });\n    return Promise.allSettled(connections).then(() => {\n    });\n  }\n  /**\n   * Get a NDKUser object\n   *\n   * @param opts\n   * @returns\n   */\n  getUser(opts) {\n    const user = new NDKUser(opts);\n    user.ndk = this;\n    return user;\n  }\n  /**\n   * Get a NDKUser from a NIP05\n   * @param nip05 NIP-05 ID\n   * @param skipCache Skip cache\n   * @returns\n   */\n  async getUserFromNip05(nip05, skipCache = false) {\n    return NDKUser.fromNip05(nip05, this, skipCache);\n  }\n  /**\n   * Create a new subscription. Subscriptions automatically start, you can make them automatically close when all relays send back an EOSE by setting `opts.closeOnEose` to `true`)\n   *\n   * @param filters\n   * @param opts\n   * @param relaySet explicit relay set to use\n   * @param autoStart automatically start the subscription\n   * @returns NDKSubscription\n   */\n  subscribe(filters, opts, relaySet, autoStart = true) {\n    const subscription = new NDKSubscription(this, filters, opts, relaySet);\n    if (relaySet) {\n      for (const relay of relaySet.relays) {\n        this.pool.useTemporaryRelay(relay);\n      }\n    }\n    if (this.outboxPool && subscription.hasAuthorsFilter()) {\n      const authors = subscription.filters.filter((filter) => filter.authors && filter.authors?.length > 0).map((filter) => filter.authors).flat();\n      this.outboxTracker?.trackUsers(authors);\n    }\n    if (autoStart)\n      subscription.start();\n    return subscription;\n  }\n  /**\n   * Publish an event to a relay\n   * @param event event to publish\n   * @param relaySet explicit relay set to use\n   * @param timeoutMs timeout in milliseconds to wait for the event to be published\n   * @returns The relays the event was published to\n   *\n   * @deprecated Use `event.publish()` instead\n   */\n  async publish(event, relaySet, timeoutMs) {\n    this.debug(\"Deprecated: Use `event.publish()` instead\");\n    return event.publish(relaySet, timeoutMs);\n  }\n  /**\n   * Fetch a single event.\n   *\n   * @param idOrFilter event id in bech32 format or filter\n   * @param opts subscription options\n   * @param relaySetOrRelay explicit relay set to use\n   */\n  async fetchEvent(idOrFilter, opts, relaySetOrRelay) {\n    let filter;\n    let relaySet;\n    if (relaySetOrRelay instanceof NDKRelay) {\n      relaySet = new NDKRelaySet(/* @__PURE__ */ new Set([relaySetOrRelay]), this);\n    } else if (relaySetOrRelay instanceof NDKRelaySet) {\n      relaySet = relaySetOrRelay;\n    }\n    if (!relaySetOrRelay && typeof idOrFilter === \"string\") {\n      if (!isNip33AValue(idOrFilter)) {\n        const relays = relaysFromBech32(idOrFilter);\n        if (relays.length > 0) {\n          relaySet = new NDKRelaySet(new Set(relays), this);\n          relaySet = correctRelaySet(relaySet, this.pool);\n        }\n      }\n    }\n    if (typeof idOrFilter === \"string\") {\n      filter = filterFromId(idOrFilter);\n    } else {\n      filter = idOrFilter;\n    }\n    if (!filter) {\n      throw new Error(`Invalid filter: ${JSON.stringify(idOrFilter)}`);\n    }\n    return new Promise((resolve) => {\n      let fetchedEvent = null;\n      const s = this.subscribe(\n        filter,\n        { ...opts || {}, closeOnEose: true },\n        relaySet,\n        false\n      );\n      s.on(\"event\", (event) => {\n        event.ndk = this;\n        if (!event.isReplaceable()) {\n          resolve(event);\n        } else if (!fetchedEvent || fetchedEvent.created_at < event.created_at) {\n          fetchedEvent = event;\n        }\n      });\n      s.on(\"eose\", () => {\n        resolve(fetchedEvent);\n      });\n      s.start();\n    });\n  }\n  /**\n   * Fetch events\n   */\n  async fetchEvents(filters, opts, relaySet) {\n    return new Promise((resolve) => {\n      const events = /* @__PURE__ */ new Map();\n      const relaySetSubscription = this.subscribe(\n        filters,\n        { ...opts || {}, closeOnEose: true },\n        relaySet,\n        false\n      );\n      const onEvent = (event) => {\n        const dedupKey = event.deduplicationKey();\n        const existingEvent = events.get(dedupKey);\n        if (existingEvent) {\n          event = dedup(existingEvent, event);\n        }\n        event.ndk = this;\n        events.set(dedupKey, event);\n      };\n      relaySetSubscription.on(\"event\", onEvent);\n      relaySetSubscription.on(\"event:dup\", onEvent);\n      relaySetSubscription.on(\"eose\", () => {\n        resolve(new Set(events.values()));\n      });\n      relaySetSubscription.start();\n    });\n  }\n  /**\n   * Ensures that a signer is available to sign an event.\n   */\n  assertSigner() {\n    if (!this.signer) {\n      this.emit(\"signerRequired\");\n      throw new Error(\"Signer required\");\n    }\n  }\n  /**\n   * Creates a new Nip96 instance for the given domain.\n   * @param domain Domain to use for nip96 uploads\n   * @example Upload a file to a NIP-96 enabled domain:\n   *\n   * ```typescript\n   * const blob = new Blob([\"Hello, world!\"], { type: \"text/plain\" });\n   * const nip96 = ndk.getNip96(\"nostrcheck.me\");\n   * await nip96.upload(blob);\n   * ```\n   */\n  getNip96(domain) {\n    return new Nip96(domain, this);\n  }\n  /**\n   * Creates a new Nostr Wallet Connect instance for the given URI and waits for it to be ready.\n   * @param uri WalletConnect URI\n   * @param connectTimeout Timeout in milliseconds to wait for the NWC to be ready. Set to `false` to avoid connecting.\n   * @example\n   * const nwc = await ndk.nwc(\"nostr+walletconnect://....\")\n   * nwc.payInvoice(\"lnbc...\")\n   */\n  async nwc(uri, connectTimeout = 2e3) {\n    const nwc = await NDKNwc.fromURI(this, uri);\n    if (connectTimeout !== false) {\n      await nwc.blockUntilReady(connectTimeout);\n    }\n    return nwc;\n  }\n};\n\n// src/zap/invoice.ts\nimport { decode } from \"light-bolt11-decoder\";\nfunction zapInvoiceFromEvent(event) {\n  const description = event.getMatchingTags(\"description\")[0];\n  const bolt11 = event.getMatchingTags(\"bolt11\")[0];\n  let decodedInvoice;\n  let zapRequest;\n  if (!description || !bolt11 || !bolt11[1]) {\n    return null;\n  }\n  try {\n    let zapRequestPayload = description[1];\n    if (zapRequestPayload.startsWith(\"%\")) {\n      zapRequestPayload = decodeURIComponent(zapRequestPayload);\n    }\n    if (zapRequestPayload === \"\") {\n      return null;\n    }\n    zapRequest = JSON.parse(zapRequestPayload);\n    decodedInvoice = decode(bolt11[1]);\n  } catch (e) {\n    return null;\n  }\n  const amountSection = decodedInvoice.sections.find((s) => s.name === \"amount\");\n  if (!amountSection) {\n    return null;\n  }\n  const amount = parseInt(amountSection.value);\n  if (!amount) {\n    return null;\n  }\n  const content = zapRequest.content;\n  const sender = zapRequest.pubkey;\n  const recipientTag = event.getMatchingTags(\"p\")[0];\n  const recipient = recipientTag[1];\n  let zappedEvent = event.getMatchingTags(\"e\")[0];\n  if (!zappedEvent) {\n    zappedEvent = event.getMatchingTags(\"a\")[0];\n  }\n  const zappedEventId = zappedEvent ? zappedEvent[1] : void 0;\n  const zapInvoice = {\n    id: event.id,\n    zapper: event.pubkey,\n    zappee: sender,\n    zapped: recipient,\n    zappedEvent: zappedEventId,\n    amount,\n    comment: content\n  };\n  return zapInvoice;\n}\nexport {\n  NDKAppHandlerEvent,\n  NDKArticle,\n  NDKClassified,\n  NDKDVMJobFeedback,\n  NDKDVMJobResult,\n  NDKDVMRequest,\n  NDKDvmJobFeedbackStatus,\n  NDKEvent,\n  NDKHighlight,\n  NDKKind,\n  NDKList,\n  NDKListKinds,\n  NDKNip07Signer,\n  NDKNip46Backend,\n  NDKNip46Signer,\n  NDKNostrRpc,\n  NDKNwc,\n  NDKPrivateKeySigner,\n  NDKRelay,\n  NDKRelayAuthPolicies,\n  NDKRelayList,\n  NDKRelaySet,\n  NDKRelayStatus,\n  NDKRepost,\n  NDKSimpleGroup,\n  NDKSubscription,\n  NDKSubscriptionCacheUsage,\n  NDKSubscriptionReceipt,\n  NDKSubscriptionStart,\n  NDKSubscriptionTier,\n  NDKTranscriptionDVM,\n  NDKUser,\n  NDKVideo,\n  NDKZap,\n  NIP33_A_REGEX,\n  PublishError,\n  calculateGroupableId,\n  calculateTermDurationInSeconds,\n  compareFilter,\n  NDK as default,\n  defaultOpts,\n  dvmSchedule,\n  eventHasETagMarkers,\n  eventIsPartOfThread,\n  eventIsReply,\n  eventReplies,\n  eventThreadIds,\n  eventThreads,\n  eventsBySameAuthor,\n  filterFromId,\n  generateSubId,\n  getEventReplyIds,\n  getRootEventId,\n  isEventOriginalPost,\n  isNip33AValue,\n  mergeFilters,\n  newAmount,\n  parseTagToSubscriptionAmount,\n  pinEvent,\n  possibleIntervalFrequencies,\n  profileFromEvent,\n  queryFullyFilled,\n  relaysFromBech32,\n  serializeProfile,\n  zapInvoiceFromEvent\n};\n","/**\n * NIP-44 Encryption Helper Functions\n *\n * Provides encryption/decryption utilities for private todos.\n * Falls back to public-only mode if NIP-44 is unavailable.\n */\n\nexport async function checkNIP44Support() {\n  return window.nostr && window.nostr.nip44;\n}\n\nexport async function encryptContent(pubKey, content) {\n  if (await checkNIP44Support()) {\n    try {\n      return await window.nostr.nip44.encrypt(pubKey, content);\n    } catch (e) {\n      console.error(\"NIP-44 encryption failed:\", e);\n      return null;\n    }\n  }\n  return null; // Return null if NIP-44 unavailable (public only)\n}\n\nexport async function decryptContent(pubKey, content) {\n  if (await checkNIP44Support()) {\n    try {\n      return await window.nostr.nip44.decrypt(pubKey, content);\n    } catch (e) {\n      console.error(\"NIP-44 decryption failed:\", e);\n      throw new Error(\"Failed to decrypt content\");\n    }\n  }\n  throw new Error(\"NIP-44 encryption not available\");\n}\n","/**\n * NIP-XX Todo Events Publishing Functions\n *\n * Handles creation of:\n * - Kind 713: Todo items\n * - Kind 714: Status updates (DOING, DONE, BLOCKED)\n * - Kind 5: Deletion events (NIP-09)\n */\n\nimport { checkNIP44Support, encryptContent } from './encryption.js';\n\nexport async function publishTodoItem(pool, relays, pubKey, content, isPrivate = false) {\n  let eventContent = content;\n  let tags = [];\n\n  if (isPrivate) {\n    const encrypted = await encryptContent(pubKey, content);\n    if (!encrypted) {\n      throw new Error(\"Private todos require NIP-44 support\");\n    }\n    eventContent = encrypted;\n    tags.push([\"encrypted\", \"NIP-44\"]);\n  }\n\n  const event = {\n    kind: 713,\n    content: eventContent,\n    tags: tags,\n    created_at: Math.floor(Date.now() / 1000),\n    pubkey: pubKey\n  };\n\n  const signedEvent = await window.nostr.signEvent(event);\n\n  // Publish to all relays\n  await Promise.all(\n    relays.map(relay =>\n      pool.publish([relay], signedEvent)\n    )\n  );\n\n  return signedEvent.id;\n}\n\nexport async function publishStatusUpdate(pool, relays, pubKey, todoEventId, status) {\n  const event = {\n    kind: 714,\n    content: status, // \"DOING\", \"DONE\", or \"BLOCKED\"\n    tags: [[\"e\", todoEventId]],\n    created_at: Math.floor(Date.now() / 1000),\n    pubkey: pubKey\n  };\n\n  const signedEvent = await window.nostr.signEvent(event);\n\n  // Publish to all relays\n  await Promise.all(\n    relays.map(relay =>\n      pool.publish([relay], signedEvent)\n    )\n  );\n}\n\nexport async function publishDeletion(pool, relays, pubKey, todoEventId) {\n  const event = {\n    kind: 5,\n    content: \"\",\n    tags: [\n      [\"e\", todoEventId],\n      [\"k\", \"713\"]\n    ],\n    created_at: Math.floor(Date.now() / 1000),\n    pubkey: pubKey\n  };\n\n  const signedEvent = await window.nostr.signEvent(event);\n\n  // Publish to all relays\n  await Promise.all(\n    relays.map(relay =>\n      pool.publish([relay], signedEvent)\n    )\n  );\n}\n","<script>\n import { onMount, onDestroy } from 'svelte';\n import { navigate } from 'svelte-routing';\n import { getEvents } from '../utils/eventsStore';\n import { SimplePool } from 'nostr-tools';\n import NDK, { NDKNip07Signer } from \"@nostr-dev-kit/ndk\";\n import { checkNIP44Support, decryptContent } from '../utils/encryption.js';\n import { publishTodoItem, publishStatusUpdate, publishDeletion } from '../utils/todoEvents.js';\n\n const eventsStore = getEvents();\n const RELAYS_URL = [\n   'wss://relay.snort.social',\n   'wss://relay.primal.net',\n   'wss://relay.damus.io',\n   'wss://purplepag.es'\n ];\n\n let profilePicture = '/css/zaplan_logo.png';\n let isLoading = true;\n let pubKey = \"\";\n let pool;\n let sub;\n let newTaskInput = \"\";\n let errorMessage = \"\";\n\n // New state structure for NIP-XX compliance\n let todos = new Map();\n let statuses = new Map();\n let deletedIds = new Set();\n let isPrivateMode = false;\n let nip44Available = false;\n\n async function waitForNostr(maxAttempts = 5, delay = 500) {\n   for (let i = 0; i < maxAttempts; i++) {\n     if (window.nostr) {\n       return true;\n     }\n     await new Promise(resolve => setTimeout(resolve, delay));\n   }\n   return false;\n }\n\n async function handleEvent(event) {\n   const { kind, id, content, tags, created_at } = event;\n\n   if (kind === 713) {\n     const encryptedTag = tags.find(t => t[0] === \"encrypted\");\n     let todoContent = content;\n\n     if (encryptedTag) {\n       try {\n         todoContent = await decryptContent(pubKey, content);\n       } catch (e) {\n         console.error(\"Failed to decrypt todo:\", e);\n         return;\n       }\n     }\n\n     todos.set(id, {\n       eventId: id,\n       content: todoContent,\n       created_at,\n       encrypted: !!encryptedTag\n     });\n     todos = todos;\n\n   } else if (kind === 714) {\n     const todoId = tags.find(t => t[0] === \"e\")?.[1];\n     if (todoId) {\n       const existing = statuses.get(todoId);\n       if (!existing || created_at > existing.created_at) {\n         statuses.set(todoId, {\n           status: content,\n           created_at\n         });\n         statuses = statuses;\n       }\n     }\n\n   } else if (kind === 5) {\n     const eventIds = tags\n       .filter(t => t[0] === \"e\")\n       .map(t => t[1]);\n     eventIds.forEach(id => deletedIds.add(id));\n     deletedIds = deletedIds;\n   }\n }\n\n async function initializeApp() {\n   try {\n     const nostrAvailable = await waitForNostr();\n\n     if (!nostrAvailable) {\n       errorMessage = \"Nostr extension not found. Please install a Nostr extension and refresh the page.\";\n       setTimeout(() => navigate('/'), 3000);\n       return;\n     }\n\n     nip44Available = await checkNIP44Support();\n\n     try {\n       pubKey = await window.nostr.getPublicKey();\n     } catch (e) {\n       errorMessage = \"Failed to get permission from Nostr extension. Redirecting to login...\";\n       setTimeout(() => navigate('/'), 2000);\n       return;\n     }\n\n     if (!pubKey) {\n       navigate('/');\n       return;\n     }\n\n     // Fetch profile - always fetch fresh to ensure we have latest profile data\n     try {\n       const profilePool = new SimplePool();\n       const profileSub = profilePool.sub(RELAYS_URL, [{\n         kinds: [0],\n         authors: [pubKey]\n       }]);\n\n       profileSub.on('event', (event) => {\n         let events = [];\n         const unsubGet = eventsStore.subscribe(value => events = value);\n         unsubGet();\n         // Add event only if it's not already in the store\n         if (!events.find(e => e.id === event.id)) {\n           events = [...events, event];\n           eventsStore.set(events);\n         }\n       });\n\n       profileSub.on('eose', () => {\n         setTimeout(() => {\n           profilePool.close(RELAYS_URL);\n         }, 1000);\n       });\n     } catch (e) {\n       console.error(\"Failed to fetch profile:\", e);\n     }\n\n     // Connect to relays for todos\n     pool = new SimplePool();\n     sub = pool.sub(RELAYS_URL, [\n       {\n         authors: [pubKey],\n         kinds: [713]\n       },\n       {\n         authors: [pubKey],\n         kinds: [714]\n       },\n       {\n         authors: [pubKey],\n         kinds: [5],\n         \"#k\": [\"713\"]\n       }\n     ]);\n\n     sub.on('event', handleEvent);\n     sub.on('eose', () => {\n       isLoading = false;\n     });\n\n   } catch (error) {\n     console.error('Failed to initialize:', error);\n     errorMessage = error.message || \"Failed to initialize app\";\n     setTimeout(() => navigate('/'), 3000);\n   }\n }\n\n async function addItem() {\n   if (newTaskInput.trim() === '') return;\n\n   try {\n     await publishTodoItem(pool, RELAYS_URL, pubKey, newTaskInput, isPrivateMode);\n     newTaskInput = '';\n   } catch (e) {\n     console.error(\"Failed to create todo:\", e);\n     errorMessage = e.message;\n     setTimeout(() => errorMessage = \"\", 3000);\n   }\n }\n\n async function removeItem(eventId) {\n   try {\n     await publishDeletion(pool, RELAYS_URL, pubKey, eventId);\n   } catch (e) {\n     console.error(\"Failed to delete todo:\", e);\n   }\n }\n\n async function updateStatus(eventId, newStatus) {\n   try {\n     await publishStatusUpdate(pool, RELAYS_URL, pubKey, eventId, newStatus);\n   } catch (e) {\n     console.error(\"Failed to update status:\", e);\n   }\n }\n\n function handleKeyPress(e) {\n   if (e.key === 'Enter') {\n     addItem();\n   }\n }\n\n function logout() {\n   navigate('/');\n }\n\n // Computed properties\n $: activeTodos = Array.from(todos.entries())\n   .filter(([id, todo]) => {\n     if (deletedIds.has(id)) return false;\n     const status = statuses.get(id)?.status;\n     return !status || status === \"DOING\" || status === \"BLOCKED\";\n   })\n   .map(([id, todo]) => ({\n     ...todo,\n     status: statuses.get(id)?.status || \"pending\"\n   }))\n   .sort((a, b) => b.created_at - a.created_at);\n\n $: completedTodos = Array.from(todos.entries())\n   .filter(([id, todo]) => {\n     if (deletedIds.has(id)) return false;\n     const status = statuses.get(id)?.status;\n     return status === \"DONE\";\n   })\n   .map(([id, todo]) => ({\n     ...todo,\n     status: \"DONE\"\n   }))\n   .sort((a, b) => b.created_at - a.created_at);\n\n let unsubscribe = eventsStore.subscribe(value => {\n   if (value.length > 0) {\n     try {\n       // Get the most recent profile event by created_at timestamp\n       const profileEvent = value.reduce((latest, current) =>\n         current.created_at > latest.created_at ? current : latest\n       );\n       const content = JSON.parse(profileEvent.content);\n       if (content.picture) {\n         profilePicture = content.picture;\n       }\n     } catch (e) {\n       console.error(\"Failed to parse profile data:\", e);\n     }\n   }\n });\n\n onMount(() => {\n   initializeApp();\n });\n\n onDestroy(() => {\n   if (sub) {\n     sub.unsub();\n   }\n   if (pool) {\n     pool.close(RELAYS_URL);\n   }\n   unsubscribe();\n });\n\n</script>\n\n<svelte:head>\n    <title>Zaplan - My Tasks</title>\n</svelte:head>\n\n{#if isLoading}\n<div class=\"loading-screen\">\n    <div class=\"loading-content\">\n        {#if errorMessage}\n        <div class=\"error-box\">{errorMessage}</div>\n        {:else}\n        <div class=\"spinner\"></div>\n        <p>Loading your tasks...</p>\n        {/if}\n    </div>\n</div>\n{:else}\n<div class=\"app-container\">\n    <!-- Sidebar -->\n    <aside class=\"sidebar\">\n        <div class=\"sidebar-header\">\n            <img src=\"/css/zaplan_logo.png\" alt=\"Zaplan\" class=\"logo\">\n            <h1>Zaplan</h1>\n        </div>\n\n        <nav class=\"sidebar-nav\">\n            <button class=\"nav-item active\">\n                <span class=\"icon\"></span>\n                <span>My Tasks</span>\n            </button>\n        </nav>\n\n        <div class=\"sidebar-footer\">\n            <div class=\"user-profile\">\n                <img src={profilePicture} alt=\"Profile\" class=\"profile-pic\">\n                <div class=\"user-info\">\n                    <span class=\"user-name\">My Profile</span>\n                </div>\n            </div>\n            <button class=\"logout-btn\" on:click={logout}>\n                <span class=\"icon\"></span>\n                Logout\n            </button>\n        </div>\n    </aside>\n\n    <!-- Main Content -->\n    <main class=\"main-content\">\n        <div class=\"content-wrapper\">\n            <!-- Header -->\n            <header class=\"page-header\">\n                <div>\n                    <h2>My Tasks</h2>\n                    <p class=\"subtitle\">{activeTodos.length} active, {completedTodos.length} completed</p>\n                </div>\n                <div class=\"header-actions\">\n                    <label class=\"privacy-switch\">\n                        <input\n                          type=\"checkbox\"\n                          bind:checked={isPrivateMode}\n                          disabled={!nip44Available}\n                        />\n                        <span class=\"switch-slider\"></span>\n                        <span class=\"switch-label\">\n                            {isPrivateMode ? ' Private' : ' Public'}\n                        </span>\n                    </label>\n                    {#if !nip44Available}\n                    <span class=\"warning-badge\">NIP-44 unavailable</span>\n                    {/if}\n                </div>\n            </header>\n\n            <!-- Add Task Input -->\n            <div class=\"add-task-container\">\n                <input\n                  type=\"text\"\n                  class=\"add-task-input\"\n                  placeholder=\"What needs to be done?\"\n                  bind:value={newTaskInput}\n                  on:keypress={handleKeyPress}\n                />\n                <button class=\"add-task-btn\" on:click={addItem}>\n                    Add Task\n                </button>\n            </div>\n\n            <!-- Active Tasks -->\n            {#if activeTodos.length > 0}\n            <section class=\"tasks-section\">\n                <h3 class=\"section-title\">Active Tasks</h3>\n                <div class=\"tasks-list\">\n                    {#each activeTodos as todo (todo.eventId)}\n                    <div class=\"task-card status-{todo.status}\">\n                        <div class=\"task-main\">\n                            <div class=\"task-content\">\n                                <p class=\"task-text\">{todo.content}</p>\n                                <div class=\"task-meta\">\n                                    <span class=\"status-pill status-{todo.status}\">\n                                        {#if todo.status === 'pending'}\n                                         Todo\n                                        {:else if todo.status === 'DOING'}\n                                         In Progress\n                                        {:else if todo.status === 'BLOCKED'}\n                                         Blocked\n                                        {/if}\n                                    </span>\n                                    {#if todo.encrypted}\n                                    <span class=\"encrypted-pill\"> Private</span>\n                                    {/if}\n                                </div>\n                            </div>\n\n                            <div class=\"task-actions\">\n                                {#if todo.status === \"pending\"}\n                                <button class=\"action-btn primary\" on:click={() => updateStatus(todo.eventId, \"DOING\")}>\n                                    Start\n                                </button>\n                                {:else if todo.status === \"DOING\"}\n                                <button class=\"action-btn success\" on:click={() => updateStatus(todo.eventId, \"DONE\")}>\n                                    Complete\n                                </button>\n                                <button class=\"action-btn warning\" on:click={() => updateStatus(todo.eventId, \"BLOCKED\")}>\n                                    Block\n                                </button>\n                                {:else if todo.status === \"BLOCKED\"}\n                                <button class=\"action-btn primary\" on:click={() => updateStatus(todo.eventId, \"DOING\")}>\n                                    Resume\n                                </button>\n                                {/if}\n                                <button class=\"action-btn danger\" on:click={() => removeItem(todo.eventId)}>\n                                    Delete\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                    {/each}\n                </div>\n            </section>\n            {/if}\n\n            <!-- Completed Tasks -->\n            {#if completedTodos.length > 0}\n            <section class=\"tasks-section\">\n                <h3 class=\"section-title\">Completed</h3>\n                <div class=\"tasks-list\">\n                    {#each completedTodos as todo (todo.eventId)}\n                    <div class=\"task-card completed\">\n                        <div class=\"task-main\">\n                            <div class=\"task-content\">\n                                <p class=\"task-text completed-text\">{todo.content}</p>\n                                <div class=\"task-meta\">\n                                    <span class=\"status-pill completed\">\n                                         Done\n                                    </span>\n                                    {#if todo.encrypted}\n                                    <span class=\"encrypted-pill\"> Private</span>\n                                    {/if}\n                                </div>\n                            </div>\n\n                            <div class=\"task-actions\">\n                                <button class=\"action-btn secondary\" on:click={() => updateStatus(todo.eventId, \"DOING\")}>\n                                    Reopen\n                                </button>\n                                <button class=\"action-btn danger\" on:click={() => removeItem(todo.eventId)}>\n                                    Delete\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                    {/each}\n                </div>\n            </section>\n            {/if}\n\n            <!-- Empty State -->\n            {#if activeTodos.length === 0 && completedTodos.length === 0}\n            <div class=\"empty-state\">\n                <div class=\"empty-icon\"></div>\n                <h3>No tasks yet</h3>\n                <p>Add your first task to get started!</p>\n            </div>\n            {/if}\n        </div>\n    </main>\n</div>\n{/if}\n\n{#if errorMessage && !isLoading}\n<div class=\"toast error\">{errorMessage}</div>\n{/if}\n\n<style>\n* {\n  box-sizing: border-box;\n}\n\n/* Loading Screen */\n.loading-screen {\n  position: fixed;\n  inset: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  z-index: 9999;\n}\n\n.loading-content {\n  text-align: center;\n  color: white;\n}\n\n.spinner {\n  width: 50px;\n  height: 50px;\n  border: 4px solid rgba(255, 255, 255, 0.3);\n  border-top-color: white;\n  border-radius: 50%;\n  animation: spin 0.8s linear infinite;\n  margin: 0 auto 20px;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n.error-box {\n  background: rgba(255, 255, 255, 0.2);\n  padding: 20px 30px;\n  border-radius: 12px;\n  backdrop-filter: blur(10px);\n}\n\n/* App Container */\n.app-container {\n  display: flex;\n  height: 100vh;\n  overflow: hidden;\n}\n\n/* Sidebar */\n.sidebar {\n  width: 260px;\n  background: white;\n  border-right: 1px solid #e5e7eb;\n  display: flex;\n  flex-direction: column;\n  flex-shrink: 0;\n}\n\n.sidebar-header {\n  padding: 24px 20px;\n  border-bottom: 1px solid #e5e7eb;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.logo {\n  width: 32px;\n  height: 32px;\n}\n\n.sidebar-header h1 {\n  font-size: 20px;\n  font-weight: 700;\n  color: #1f2937;\n  margin: 0;\n}\n\n.sidebar-nav {\n  flex: 1;\n  padding: 20px 12px;\n}\n\n.nav-item {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  border: none;\n  background: none;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  color: #6b7280;\n  transition: all 0.2s;\n}\n\n.nav-item:hover {\n  background: #f3f4f6;\n  color: #1f2937;\n}\n\n.nav-item.active {\n  background: #667eea;\n  color: white;\n}\n\n.icon {\n  font-size: 18px;\n}\n\n.sidebar-footer {\n  padding: 16px;\n  border-top: 1px solid #e5e7eb;\n}\n\n.user-profile {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 8px;\n  margin-bottom: 8px;\n}\n\n.profile-pic {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n\n.user-info {\n  flex: 1;\n}\n\n.user-name {\n  font-size: 14px;\n  font-weight: 500;\n  color: #1f2937;\n}\n\n.logout-btn {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 12px;\n  border: 1px solid #e5e7eb;\n  background: white;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 14px;\n  color: #6b7280;\n  transition: all 0.2s;\n}\n\n.logout-btn:hover {\n  background: #f9fafb;\n  border-color: #d1d5db;\n}\n\n/* Main Content */\n.main-content {\n  flex: 1;\n  overflow-y: auto;\n  background: #f5f7fa;\n}\n\n.content-wrapper {\n  max-width: 900px;\n  margin: 0 auto;\n  padding: 40px 24px;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 32px;\n}\n\n.page-header h2 {\n  font-size: 32px;\n  font-weight: 700;\n  color: #1f2937;\n  margin: 0 0 4px 0;\n}\n\n.subtitle {\n  font-size: 14px;\n  color: #6b7280;\n  margin: 0;\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n/* Privacy Switch */\n.privacy-switch {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.privacy-switch input {\n  display: none;\n}\n\n.switch-slider {\n  position: relative;\n  width: 44px;\n  height: 24px;\n  background: #d1d5db;\n  border-radius: 12px;\n  transition: all 0.3s;\n}\n\n.switch-slider::after {\n  content: '';\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 20px;\n  height: 20px;\n  background: white;\n  border-radius: 50%;\n  transition: all 0.3s;\n}\n\n.privacy-switch input:checked + .switch-slider {\n  background: #667eea;\n}\n\n.privacy-switch input:checked + .switch-slider::after {\n  left: 22px;\n}\n\n.privacy-switch input:disabled + .switch-slider {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.switch-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.warning-badge {\n  padding: 4px 8px;\n  background: #fef3c7;\n  color: #92400e;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 500;\n}\n\n/* Add Task */\n.add-task-container {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 32px;\n}\n\n.add-task-input {\n  flex: 1;\n  padding: 16px 20px;\n  border: 2px solid #e5e7eb;\n  border-radius: 12px;\n  font-size: 15px;\n  transition: all 0.2s;\n}\n\n.add-task-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n}\n\n.add-task-btn {\n  padding: 16px 32px;\n  background: #667eea;\n  color: white;\n  border: none;\n  border-radius: 12px;\n  font-size: 15px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.add-task-btn:hover {\n  background: #5568d3;\n  transform: translateY(-1px);\n}\n\n/* Tasks Section */\n.tasks-section {\n  margin-bottom: 40px;\n}\n\n.section-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: #374151;\n  margin: 0 0 16px 0;\n}\n\n.tasks-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n/* Task Card */\n.task-card {\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 12px;\n  transition: all 0.2s;\n}\n\n.task-card:hover {\n  border-color: #d1d5db;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n}\n\n.task-card.completed {\n  opacity: 0.7;\n}\n\n.task-main {\n  padding: 20px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 16px;\n}\n\n.task-content {\n  flex: 1;\n  min-width: 0;\n}\n\n.task-text {\n  font-size: 15px;\n  color: #1f2937;\n  margin: 0 0 12px 0;\n  word-wrap: break-word;\n}\n\n.completed-text {\n  text-decoration: line-through;\n  color: #9ca3af;\n}\n\n.task-meta {\n  display: flex;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n\n.status-pill {\n  padding: 4px 12px;\n  border-radius: 6px;\n  font-size: 13px;\n  font-weight: 500;\n}\n\n.status-pill.status-pending {\n  background: #f3f4f6;\n  color: #6b7280;\n}\n\n.status-pill.status-DOING {\n  background: #dbeafe;\n  color: #1e40af;\n}\n\n.status-pill.status-BLOCKED {\n  background: #fed7aa;\n  color: #c2410c;\n}\n\n.status-pill.completed {\n  background: #d1fae5;\n  color: #065f46;\n}\n\n.encrypted-pill {\n  padding: 4px 12px;\n  background: #fef3c7;\n  color: #92400e;\n  border-radius: 6px;\n  font-size: 13px;\n  font-weight: 500;\n}\n\n.task-actions {\n  display: flex;\n  gap: 8px;\n  flex-shrink: 0;\n}\n\n.action-btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 8px;\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.action-btn.primary {\n  background: #667eea;\n  color: white;\n}\n\n.action-btn.primary:hover {\n  background: #5568d3;\n}\n\n.action-btn.success {\n  background: #10b981;\n  color: white;\n}\n\n.action-btn.success:hover {\n  background: #059669;\n}\n\n.action-btn.warning {\n  background: #f59e0b;\n  color: white;\n}\n\n.action-btn.warning:hover {\n  background: #d97706;\n}\n\n.action-btn.danger {\n  background: #ef4444;\n  color: white;\n}\n\n.action-btn.danger:hover {\n  background: #dc2626;\n}\n\n.action-btn.secondary {\n  background: #f3f4f6;\n  color: #374151;\n}\n\n.action-btn.secondary:hover {\n  background: #e5e7eb;\n}\n\n/* Empty State */\n.empty-state {\n  text-align: center;\n  padding: 80px 20px;\n}\n\n.empty-icon {\n  font-size: 64px;\n  margin-bottom: 16px;\n}\n\n.empty-state h3 {\n  font-size: 20px;\n  font-weight: 600;\n  color: #374151;\n  margin: 0 0 8px 0;\n}\n\n.empty-state p {\n  font-size: 14px;\n  color: #6b7280;\n  margin: 0;\n}\n\n/* Toast */\n.toast {\n  position: fixed;\n  bottom: 24px;\n  right: 24px;\n  padding: 16px 24px;\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);\n  z-index: 1000;\n  animation: slideIn 0.3s ease;\n}\n\n.toast.error {\n  background: #fef2f2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(400px);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n\n/* Responsive */\n@media (max-width: 768px) {\n  .sidebar {\n    display: none;\n  }\n\n  .content-wrapper {\n    padding: 20px 16px;\n  }\n\n  .page-header {\n    flex-direction: column;\n    gap: 16px;\n  }\n\n  .add-task-container {\n    flex-direction: column;\n  }\n\n  .task-main {\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  .task-actions {\n    flex-wrap: wrap;\n  }\n\n  .action-btn {\n    flex: 1;\n  }\n}\n</style>\n","<script>\n  // Import the necessary components\n  import { Router, Route } from 'svelte-routing';\n  import TodoPage from './routes/TodoPage.svelte'\n\n\n  // Define the Login component\n  export let Login;\n</script>\n\n<Router>\n  <!-- Wrap your entire application with the Router -->\n  <main>\n    <!-- Define your routes -->\n    <Route path=\"/\" component={Login} />\n    <Route path=\"/todoPage\" component={TodoPage} />\n  </main>\n</Router>\n\n<style>\n  /* Your styles here */\n</style>\n","<script>\n  import { eventsStore } from './utils/eventsStore';\n  import { SimplePool } from 'nostr-tools';\n  import NDK, { NDKNip07Signer } from \"@nostr-dev-kit/ndk\";\n  import { navigate } from 'svelte-routing';\n\n  let events = [];\n  const RELAYS_URL = [\n    'wss://relay.snort.social',\n    'wss://relay.primal.net',\n    'wss://relay.damus.io',\n    'wss://purplepag.es'\n  ];\n\n  const nip07signer = new NDKNip07Signer();\n  let publicKey = {};\n\n  async function extlogin() {\n    try {\n      if (publicKey.pubkey) {\n        console.log(\"Permission granted to read their public key:\", publicKey.pubkey);\n      }\n\n      publicKey = await nip07signer.user();\n\n      const pool = new SimplePool();\n      const subEvents = pool.sub(RELAYS_URL, [{\n        kinds: [0],\n        authors: [publicKey.pubkey]\n      }]);\n\n      subEvents.on('event', (event) => {\n        events = [...events, event];\n        eventsStore.set(events);\n      });\n\n      navigate('/todoPage');\n\n    } catch (error) {\n      console.error('Login failed:', error.message);\n      alert(error.message);\n    }\n  }\n</script>\n\n<div class=\"landing-container\">\n  <!-- Hero Section -->\n  <div class=\"hero-section\">\n    <div class=\"hero-content\">\n      <div class=\"logo-container\">\n        <img class=\"logo\" src=\"./css/zaplan_logo.png\" alt=\"Zaplan Logo\">\n        <h1 class=\"brand-name\">Zaplan</h1>\n      </div>\n      <h2 class=\"tagline\">Your Decentralized To-Do List</h2>\n      <p class=\"hero-description\">\n        Built on Nostr protocol - Own your data, sync across devices, and stay organized without centralized servers.\n      </p>\n\n      <button class=\"cta-button\" on:click={extlogin}>\n        <span class=\"button-icon\"></span>\n        Login with Nostr Extension\n      </button>\n    </div>\n\n    <!-- Features Grid -->\n    <div class=\"features-grid\">\n      <div class=\"feature-card\">\n        <div class=\"feature-icon\"></div>\n        <h3>Task Management</h3>\n        <p>Create, organize, and track your tasks with an intuitive interface</p>\n      </div>\n      <div class=\"feature-card\">\n        <div class=\"feature-icon\"></div>\n        <h3>Encrypted & Private</h3>\n        <p>Your tasks are encrypted end-to-end, only you can read them</p>\n      </div>\n      <div class=\"feature-card\">\n        <div class=\"feature-icon\"></div>\n        <h3>Decentralized</h3>\n        <p>No central server - your data lives on the Nostr network</p>\n      </div>\n      <div class=\"feature-card\">\n        <div class=\"feature-icon\"></div>\n        <h3>Sync Instantly</h3>\n        <p>Access your tasks from any device with your Nostr identity</p>\n      </div>\n    </div>\n  </div>\n\n  <!-- Getting Started Section -->\n  <div class=\"getting-started\">\n    <h3 class=\"section-title\">Getting Started with Nostr</h3>\n    <p class=\"section-description\">\n      New to Nostr? No problem! Install a Nostr extension to get started. It's like a digital key that lets you securely access Zaplan and other Nostr apps.\n    </p>\n\n    <div class=\"extension-cards\">\n      <div class=\"extension-card\">\n        <div class=\"browser-icon chrome-icon\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"2\"/>\n            <circle cx=\"12\" cy=\"12\" r=\"4\" stroke=\"currentColor\" stroke-width=\"2\"/>\n          </svg>\n        </div>\n        <h4>Chrome / Edge / Brave</h4>\n        <p>Install Nostr Connect extension</p>\n        <a href=\"https://chromewebstore.google.com/detail/ampjiinddmggbhpebhaegmjkbbeofoaj\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"extension-link\">\n          Get Extension \n        </a>\n      </div>\n\n      <div class=\"extension-card\">\n        <div class=\"browser-icon firefox-icon\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M12 2L3 7v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-9-5z\" stroke=\"currentColor\" stroke-width=\"2\"/>\n          </svg>\n        </div>\n        <h4>Firefox</h4>\n        <p>Install Nostr Connect extension</p>\n        <a href=\"https://addons.mozilla.org/en-US/firefox/addon/nostr-connect/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"extension-link\">\n          Get Extension \n        </a>\n      </div>\n\n      <div class=\"extension-card\">\n        <div class=\"browser-icon safari-icon\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\" stroke=\"currentColor\" stroke-width=\"2\"/>\n            <path d=\"M12 8v8M8 12h8\" stroke=\"currentColor\" stroke-width=\"2\"/>\n          </svg>\n        </div>\n        <h4>Safari (iOS)</h4>\n        <p>Install Nostore app</p>\n        <a href=\"https://apps.apple.com/us/app/nostore/id1666553677\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"extension-link\">\n          Get App \n        </a>\n      </div>\n    </div>\n\n    <div class=\"help-section\">\n      <h4>After installing the extension:</h4>\n      <ol class=\"setup-steps\">\n        <li>Click on the extension icon in your browser</li>\n        <li>Create a new Nostr identity (or import an existing one)</li>\n        <li>Return to this page and click \"Login with Nostr Extension\"</li>\n        <li>Approve the connection request</li>\n        <li>Start organizing your tasks! </li>\n      </ol>\n    </div>\n  </div>\n\n  <!-- Footer -->\n  <div class=\"footer\">\n    <p>Powered by <a href=\"https://nostr.com\" target=\"_blank\" rel=\"noopener noreferrer\">Nostr Protocol</a></p>\n  </div>\n</div>\n","// Import Svelte components\nimport App from './App.svelte';\nimport Login from './Login.svelte';\nimport TodoPage from './routes/TodoPage.svelte'\n\n// Create the Svelte app instance\nconst app = new App({\n    target: document.body,\n    props: {\n        Login,\n        TodoPage\n          }\n});\n"],"names":["noop","identity","x","assign","tar","src","k","is_promise","value","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","src_url_equal_anchor","src_url_equal","element_src","url","document","createElement","href","is_empty","obj","keys","length","subscribe","store","callbacks","callback","undefined","unsub","unsubscribe","component_subscribe","component","$$","on_destroy","push","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","slice","get_slot_changes","dirty","lets","merged","len","Math","max","i","update_slot_base","slot","slot_definition","slot_changes","get_slot_context_fn","slot_context","p","get_all_dirty_from_scope","exclude_internal_props","props","result","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","Set","run_tasks","task","c","delete","f","size","loop","promise","Promise","fulfill","add","abort","globals","globalThis","global","append","target","node","appendChild","get_root_for_style","root","getRootNode","ownerDocument","host","append_empty_stylesheet","style_element","element","textContent","append_stylesheet","sheet","style","head","insert","anchor","insertBefore","detach","parentNode","removeChild","name","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","children","Array","from","childNodes","set_data","set_input_value","input","custom_event","type","detail","bubbles","cancelable","CustomEvent","construct_svelte_component","managed_styles","Map","active","current_component","hash","str","charCodeAt","create_style_information","doc","info","stylesheet","rules","set","create_rule","duration","delay","ease","uid","step","keyframes","t","rule","get","insertRule","cssRules","animation","delete_rule","previous","split","next","filter","anim","indexOf","deleted","join","clear_rules","ownerNode","clear","set_current_component","get_current_component","Error","onMount","on_mount","onDestroy","setContext","key","context","getContext","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","resolve","update_scheduled","schedule_update","then","flush","add_render_callback","seen_callbacks","flushidx","saved_component","update","e","pop","has","fragment","before_update","after_update","flush_render_callbacks","filtered","targets","wait","dispatch","direction","kind","dispatchEvent","outroing","outros","group_outros","r","check_outros","transition_in","block","local","transition_out","o","d","null_transition","create_in_transition","params","animation_name","config","running","cleanup","go","easing","linear","tick","css","start_time","end_time","started","start","invalidate","end","create_out_transition","group","original_inert_value","inert","reset","handle_promise","token","index","resolved","child_ctx","current","needs_flush","blocks","m","mount","error","catch","hasCatch","pending","update_await_block_branch","ensure_array_like","array_like_or_iterator","destroy_block","lookup","update_keyed_each","old_blocks","get_key","dynamic","list","destroy","create_each_block","get_context","n","old_indexes","new_blocks","new_lookup","deltas","updates","abs","will_move","did_move","first","new_block","old_block","new_key","old_key","get_spread_update","levels","to_null_out","accounted_for","get_spread_object","spread_props","create_component","mount_component","new_on_destroy","map","destroy_component","detaching","make_dirty","fill","init","instance","create_fragment","not_equal","append_styles","parent_component","bound","on_disconnect","skip_bound","ready","ret","rest","hydrate","nodes","l","intro","SvelteComponent","$$set","$destroy","this","$on","splice","$set","PUBLIC_VERSION","__svelte","v","LOCATION","ROUTER","HISTORY","PARAM","SEGMENT_POINTS","STATIC_POINTS","DYNAMIC_POINTS","SPLAT_PENALTY","ROOT_POINTS","segmentize","uri","replace","stripSlashes","string","rankRoute","route","score","default","path","reduce","segment","test","rankRoutes","routes","sort","pick","match","default_","uriPathname","uriSegments","isRootUri","ranked","missed","routeSegments","routeSegment","uriSegment","decodeURIComponent","dynamicMatch","exec","combinePaths","basepath","canUseDOM","switch_instance_spread_levels","if_block","create_if_block","$$props","routeParams","routeProps","registerRoute","unregisterRoute","activeRoute","$activeRoute","$$invalidate","toString","startsWith","preserveScroll","scrollTo","subscriber_queue","readable","writable","stop","subscribers","new_value","run_queue","subscriber","derived","stores","initial_value","single","isArray","stores_array","every","Boolean","auto","values","sync","unsubscribers","getLocation","source","location","state","history","createHistory","listeners","listener","popstateListener","action","navigate","to","blurActiveElement","replaceState","pushState","activeElement","blur","createMemorySource","initialPathname","stack","pathname","search","states","entries","_","globalHistory","previous_key","div","viewtransition","locationContext","routerContext","hasActiveRoute","base","routerBase","$base","_path","matchingRoute","$location","rs","bestMatch","$routes","vt","eventsStore","getEvents","number","Number","isSafeInteger","bool","bytes","lengths","Uint8Array","includes","outputLen","blockLen","exists","checkFinished","destroyed","finished","output","out","min","assert","crypto","u8a","createView","arr","DataView","buffer","byteOffset","byteLength","rotr","word","shift","isLE","Uint32Array","hexes","padStart","bytesToHex","hex","hexToBytes","array","j","hexByte","byte","parseInt","isNaN","utf8ToBytes","TextEncoder","encode","toBytes","concatBytes","arrays","sum","pad","Hash$4","clone","_cloneInto","wrapConstructor","hashCons","hashC","msg","digest","tmp","randomBytes","bytesLength","getRandomValues","setBigUint64","view","_32n","BigInt","_u32_max","wh","wl","h","setUint32","Hash","constructor","padOffset","super","pos","take","subarray","process","dataView","roundClean","digestInto","oview","outLen","res","Chi","Maj","SHA256_K","IV","SHA256_W","SHA2","A","B","C","D","E","F","G","H","offset","getUint32","W15","W2","s0","s1","T1","T2","SHA256","sha256","SHA224","_0n","_1n","_2n","numberToHexUnpadded","num","hexToNumber","bytesToNumberBE","bytesToNumberLE","reverse","numberToBytesBE","numberToBytesLE","numberToVarBytesBE","ensureBytes","title","expectedLength","equalBytes","b1","b2","bitLen","bitGet","bitSet","bitMask","u8n","u8fr","createHmacDrbg","hashLen","qByteLen","hmacFn","reseed","seed","gen","sl","pred","validatorFns","bigint","val","function","boolean","field","object","Fp","isValid","validateObject","validators","optValidators","checkField","fieldName","isOptional","checkVal","String","_3n","_4n","_5n","_8n","mod","pow","power","modulo","pow2","invert","u","tonelliShanks","P","legendreC","Q","S","Z","p1div4","eql","sqr","Q1div2","neg","ONE","g","mul","ZERO","t2","ge","FpSqrt","c1","n2","nv","sub","FIELD_FIELDS","validateField","ORDER","MASK","BYTES","BITS","FpPow","FpInvertBatch","nums","lastMultiplied","acc","is0","inverted","inv","reduceRight","nLength","nBitLength","_nBitLength","nByteLength","ceil","Field","redef","sqrtP","freeze","isOdd","lhs","rhs","sqrN","addN","subN","mulN","sqrt","invertBatch","lst","cmov","fromBytes","hashToPrivateScalar","groupOrder","minLen","wNAF","bits","constTimeNegate","condition","item","negate","opts","W","windows","windowSize","unsafeLadder","elm","double","precomputeWindow","points","precomputes","BASE","mask","maxNumber","shiftBy","wbits","offset1","offset2","cond1","cond2","wNAFCached","precomputesMap","transform","_WINDOW_SIZE","comp","validateBasic","curve","Gx","Gy","validatePointOpts","ut.validateObject","allowedPrivateKeyLengths","wrapPrivateKey","isTorsionFree","clearCofactor","allowInfinityPoint","endo","beta","splitScalar","b2n","h2b","ut","DER","Err","_parseInt","toSig","sBytes","s","rBytesLeft","hexFromSig","sig","shl","rhl","rl","weierstrassPoints","CURVE","point","isCompressed","toAffine","ut.concatBytes","y","tail","weierstrassEquation","x2","x3","isWithinCurveOrder","assertGE","normPrivateKeyToScalar","ut.bytesToHex","ut.bytesToNumberBE","mod.mod","pointPrecomputes","assertPrjPoint","other","Point","px","py","pz","fromAffine","normalizeZ","toInv","fromHex","assertValidity","fromPrivateKey","privateKey","multiply","_setWindowSize","left","right","hasEvenY","equals","X1","Y1","Z1","X2","Y2","Z2","U1","U2","b3","X3","Y3","Z3","t0","t1","t3","t4","t5","subtract","wnaf","multiplyUnsafe","I","k1neg","k1","k2neg","k2","k1p","k2p","scalar","fake","f1p","f2p","multiplyAndAddUnsafe","iz","z","ax","ay","zz","cofactor","toRawBytes","toHex","_bits","ProjectivePoint","validateOpts","hmac","bits2int","bits2int_modN","lowS","weierstrass","curveDef","CURVE_ORDER","compressedLen","uncompressedLen","modN","invN","mod.invert","cat","y2","numToNByteStr","ut.numberToBytesBE","isBiggerThanHalfOrder","slcNum","Signature","recovery","fromCompact","fromDER","addRecoveryBit","recoverPublicKey","msgHash","rec","radj","prefix","R","ir","u1","u2","hasHighS","normalizeS","toDERRawBytes","ut.hexToBytes","toDERHex","toCompactRawBytes","toCompactHex","utils","isValidPrivateKey","randomPrivateKey","mod.hashToPrivateScalar","precompute","isProbPub","delta","ORDER_MASK","ut.bitMask","int2octets","prepSig","defaultSigOpts","some","prehash","extraEntropy","ent","h1int","seedArgs","k2sig","kBytes","ik","q","normS","defaultVerOpts","getPublicKey","getSharedSecret","privateA","publicB","sign","privKey","ut.createHmacDrbg","drbg","verify","signature","publicKey","sg","_sig","derError","message","is","_key","iHash","oHash","buf","getPrototypeOf","HMAC","getHash","msgs","createCurve","defHash","secp256k1P","secp256k1N","divNearest","sqrtMod","_6n","_11n","_22n","_23n","_44n","_88n","b6","b9","b11","b22","b44","b88","b176","b220","b223","secp256k1","a1","a2","POW_2_128","c2","fe","TAGGED_HASH_PREFIXES","taggedHash","tag","messages","tagP","tagH","pointToBytes","numTo32b","modP","GmulAdd","schnorrGetExtPubKey","priv","d_","lift_x","xx","challenge","args","schnorrGetPublicKey","schnorrSign","auxRand","rand","k_","rx","schnorrVerify","pub","schnorr","assertNumber","chain","wrap","decode","alphabet","digits","letter","separator","padding","chr","normalize","convertRadix","carry","done","digit","digitBase","floor","gcd","radix2carry","convertRadix2","radix","radix2","revPadding","unsafeWrapper","apply","base16","base32","toUpperCase","base64","base64url","genBase58","abc","base58","XMR_BLOCK_LEN","base58xmr","concat","BECH_ALPHABET","POLYMOD_GENERATORS","bech32Polymod","pre","chk","bechChecksum","words","encodingConst","genBech32","encoding","ENCODING_CONST","_words","fromWords","toWords","fromWordsUnsafe","limit","TypeError","lowered","toLowerCase","sepIndex","lastIndexOf","endsWith","actualLength","decodeToBytes","decodeUnsafe","bech32","utf8","TextDecoder","CODERS","wordlist","isBytes","assert$3","Hash$3","toStr","checkOpts","defaults","call","assertHash","assertExists","assertBytes","pbkdf2Init","_password","_salt","_opts","dkLen","asyncTick","password","salt","DK","PRF","PRFSalt","pbkdf2Output","prfW","pbkdf2","ti","Ti","setInt32","ui","U32_MASK64","fromBig","le","Ah","Al","toBig","shrSH","_l","shrSL","rotrSH","rotrSL","rotrBH","rotrBL","rotr32H","_h","rotr32L","rotlSH","rotlSL","rotlBH","rotlBL","Bh","Bl","add3L","Cl","add3H","low","Ch","add4L","Dl","add4H","Dh","add5L","El","add5H","Eh","u64","u64$3","SHA512_Kh","SHA512_Kl","SHA512_W_H","SHA512_W_L","Fh","Fl","Gh","Gl","Hh","Hl","W15h","W15l","s0h","s0l","W2h","W2l","s1h","s1l","SUMl","SUMh","sigma1h","sigma1l","CHIh","CHIl","T1ll","T1h","T1l","sigma0h","sigma0l","MAJh","MAJl","All","sha512","SHA512","id","rounded","checksum","payload","newChecksum","oldChecksum","createBase58check","base58check","isJapanese","nfkd","norm","assertEntropy","entropy","generateMnemonic","strength","entropyToMnemonic","calcChecksum","bitsLeft","getCoder","baseUtils","mnemonicToEntropy","mnemonic","validateMnemonic","passphrase","mnemonicToSeedSync","asciis","_0","_9","_A","_F","_a","_f","asciiToBase16","char","hl","al","ai","hi","n1","Hash$2","Rho","Id","Pi","idxL","idxR","shifts","shiftsL","idx","shiftsR","Kl","Kr","rotl","BUF","RIPEMD160","h0","h1","h2","h3","h4","ar","bl","br","cl","cr","dl","dr","el","er","rGroup","hbl","hbr","rr","sr","tl","tr","ripemd160","u64$1","Hash$1","secp","base58checker","bytesToNumber","numberToBytes","MASTER_SECRET","BITCOIN_VERSIONS","private","public","HARDENED_OFFSET","hash160","fromU32","toU32","HDKey","fingerprint","pubHash","identifier","pubKeyHash","privKeyBytes","pubKey","privateExtendedKey","serialize","versions","publicExtendedKey","fromMasterSeed","chainCode","fromExtendedKey","base58key","keyBuffer","keyView","version","opt","depth","parentFingerprint","isPriv","fromJSON","json","xpriv","derive","parts","child","deriveChild","childTweak","added","err","wipePrivateData","toJSON","xpub","u32","isPlainObject","prototype","isSame","u8to16","Poly1305","Uint16Array","t6","t7","isLast","hibit","r0","r1","r2","r3","r4","r5","r6","r7","r8","r9","h5","h6","h7","h8","h9","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","finalize","opos","wrapConstructorWithKey","sigma16","sigma32","sigma16_32","sigma32_32","isAligned32","salsaBasic","core","rounds","counterRight","counterLen","allow128bitKeys","extendNonceFn","blockLen32","nonce","counter","toClean","sigma","nonceLen","nc","b32","k32","n32","d32","o32","ctr","pos32","chachaCore","cnt","y00","y01","y02","y03","y04","y05","y06","y07","y08","y09","y10","y11","y12","y13","y14","y15","x00","x01","x02","x03","x04","x05","x06","x07","x08","x09","x10","x11","x12","x13","x14","x15","oi","chacha20","extract","ikm","HKDF_COUNTER","EMPTY_BUFFER","expand","prk","okm","HMACTmp","T","hkdf","__defProp","defineProperty","__export","all","enumerable","utils_exports","MessageNode","MessageQueue","insertEventIntoAscendingList","insertEventIntoDescendingList","normalizeURL","utf8Decoder","utf8Encoder","URL","port","protocol","searchParams","sortedArray","midPoint","position","created_at","_value","_next","_first","_last","messageNode","last","_size","enqueue","newNode","dequeue","prev","verifiedSymbol","Symbol","getBlankEvent","content","tags","finishEvent","pubkey","getEventHash","getSignature","serializeEvent","evt","validateEvent","JSON","stringify","bytesToHex2","isRecord","verifySignature","schnorr2","matchFilter","ids","kinds","authors","find","since","until","matchFilters","filters","mergeFilters","property","fakejson_exports","getHex64","getInt","sliced","getSubscriptionId","pstart","pend","matchEventId","matchEventPubkey","matchEventKind","newListeners","connect","disconnect","notice","auth","relayInit","listTimeout","getTimeout","countTimeout","ws","connectionPromise","openSubs","subListeners","pubListeners","connected","readyState","async","trySend","setTimeout","send","console","log","verb","skipVerification","alreadyHaveEvent","random","subid","subscription","newFilters","newOpts","on","count","eose","off","listeners2","events","eventsGenerator","_publishEvent","reject","timeout","clearTimeout","publish","WebSocket","onopen","onerror","onclose","handleNextInterval","incomingMessageQueue","handleNext","clearInterval","so","parse","id2","ok","reason","resolve2","reject2","onmessage","setInterval","connectRelay","close","OPEN","status","nextResolve","eventQueue","pushToQueue","SimplePool","_conn","_seenOn","batchedByKey","eoseSubTimeout","seenOnEnabled","batchInterval","relays","relay","ensureRelay","nm","_knownIds","modifiedOpts","subs","eventListeners","eoseListeners","eosesMissing","eoseSent","eoseTimeout","handleEose","greaterSub","filters2","opts2","batchedList","batchKey","batchKey2","batchedRequests","relays2","seenOn","nip19_exports","BECH32_REGEX","naddrEncode","neventEncode","noteEncode","nprofileEncode","npubEncode","nrelayEncode","nsecEncode","Bech32MaxSize","integerToUint8Array","uint8Array","nip19","tlv","parseTLV","bytesToHex3","author","encodeBytes","encodeBech32","profile","encodeTLV","kindArray","addr","ArrayBuffer","vs","entry","nip04_exports","encrypt","privkey","normalizedKey","getNormalizedX","iv","plaintext","cryptoKey","subtle","importKey","ciphertext","decrypt","ctb64","ivb64","webcrypto","nip05_exports","NIP05_REGEX","queryProfile","searchDomain","useFetchImplementation","_fetch","fetch","fetchImplementation","domain","query","names","fullname","parseNIP05Result","_e","nip06_exports","privateKeyFromSeedWords","bytesToHex4","generateSeedWords","validateWords","nip10_exports","reply","mentions","profiles","eTags","eTagIndex","eTag","eTagEventId","eTagRelayUrl","eTagMarker","eventPointer","isFirstETag","isLastETag","nip13_exports","getPow","nibble","clz32","minePow","unsigned","difficulty","getTime","nip18_exports","finishRepostEvent","reposted","relayUrl","getRepostedEventPointer","lastETag","lastPTag","getRepostedEvent","pointer","repostedEvent","nip21_exports","NOSTR_URI_REGEX","parse2","RegExp","decoded","nip25_exports","finishReactionEvent","reacted","inheritedTags","getReactedEventPointer","nip26_exports","createDelegation","parameters","conditions","cond","sighash","sha2562","bytesToHex5","schnorr3","getDelegator","tag2","operator","nip27_exports","matchAll","regex","replaceAll","matches","replacer","nip28_exports","channelCreateEvent","channelHideMessageEvent","channelMessageEvent","channelMetadataEvent","channelMuteUserEvent","channel_create_event_id","relay_url","reply_to_channel_message_event_id","channel_message_event_id","pubkey_to_mute","nip39_exports","_fetch2","useFetchImplementation2","validateGithub","username","proof","nip42_exports","authenticate","nip44_exports","decrypt2","encrypt2","v2","maxPlaintextSize","minCiphertextSize","maxCiphertextSize","getConversationKey","privkeyA","pubkeyB","secp256k12","getMessageKeys","conversationKey","sha2563","encryption","calcPadding","nextpower","log2","chunk","unpadded","unpaddedB","paddedLen","zeros","lenBuf","setUint16","concatBytes2","unpad","padded","unpaddedLen","getUint16","randomBytes2","mac","base642","clen","vers","ciphertext_","nip47_exports","parseConnectionString","connectionString","secret","makeNwcRequestEvent","invoice","method","encryptedContent","round","nip57_exports","_fetch3","getZapEndpoint","makeZapReceipt","makeZapRequest","useFetchImplementation3","validateZapRequest","metadata","lnurl","lud06","lud16","bech322","body","allowsNostr","nostrPubkey","amount","comment","zr","zapRequestString","zapRequest","preimage","bolt11","paidAt","tagsFromZapRequest","zap","nip98_exports","getToken","unpackEventFromToken","validateEvent2","validateToken","_authorizationScheme","loginUrl","httpMethod","includeAuthorizationScheme","signedEvent","base643","eventB64","urlTag","methodTag","types","exports","bakeCollectionVariadic","bakeCollectionAwait","bakeCollection","BAKED_EMPTY_FUNC","FORLOOP_FALLBACK","generateArgsDefCode","numArgs","argsDefCode","generateBodyPartsCode","collectionLength","funcDefCode","funcCallCode","generateBodyPartsVariadicCode","collection","fixedArgsNum","funcFactoryCode","funcFactory","eval","__spreadArray","pack","arguments","taskCollection","TaskCollection","_fast_remove_single","bake_collection_1","require$$0","push_norebuild","_tasks","newAr","push_rebuild","firstEmitBuildStrategy","rebuild_on_first_call","rebuild","removeLast_norebuild","removeLast_rebuild","insert_norebuild","_b","func","_i","unshift","insert_rebuild","rebuild_noawait","argsNum","rebuild_await","autoRebuild","initialTasks","awaitTasks","bind","setAutoRebuild","__createBinding","__exportStar","fastClear","growArgsNum","newVal","removeLast","tasksAsArray","setTasks","desc","getOwnPropertyDescriptor","__esModule","configurable","hasOwnProperty","nullObj","ee","EventEmitter","task_collection_1","utils_1","require$$1","emit","ev","emitHasOnce","oev","onceEvents","fncs","_symbolKeys","maxListeners","Infinity","eventNames","once","addListener","evtmap","warn","removeListener","evto","addListenerBound","bindTo","boundFuncs","removeListenerBound","hasListeners","prependListener","prependOnceListener","removeAllListeners","setMaxListeners","getMaxListeners","_this","keysO","listenerCount","w","plural","ms","msAbs","isPlural","parseFloat","isFinite","long","fmtLong","fmtShort","setup","env","createDebug","namespace","prevTime","namespacesCache","enabledCache","enableOverride","debug","enabled","self","curr","diff","coerce","format","formatter","formatters","formatArgs","useColors","color","selectColor","extend","namespaces","delimiter","newDebug","toNamespace","regexp","substring","disable","skips","enable","save","humanize","colors","load","common","module","lastC","storage","setItem","removeItem","getItem","DEBUG","__nwjs","navigator","userAgent","documentElement","WebkitAppearance","firebug","exception","table","$1","localStorage","localstorage","warned","abytes","HashMD","SHA256_IV","stringOrUint8Array","getFieldBytesLength","fieldOrder","bitLength","getMinHashLength","mapHashToField","fieldLen","reduced","ut.abytes","_c","_isCompressed","ut.isBytes","sqrtError","suffix","mod.getMinHashLength","mod.mapHashToField","LRUCacheNode_1","LRUCacheNode","entryExpirationTimeInMS","onEntryEvicted","onEntryMarkedAsMostRecentlyUsed","cloneFn","defaultClone","internalValue","created","isExpired","invokeOnEvicted","invokeOnEntryMarkedAsMostRecentlyUsed","LRUCache_1","LRUCache","lookupTable","maxSize","maxSizeInternal","cleanCache","remainingSize","newest","removeNodeFromListAndLookupTable","mapNodeToEntry","oldest","enforceSizeLimit","entryOptions","currentNodeForKey","setNodeAsHead","peek","iterator","removeNodeFromList","expiredNodes","stringToBytes","bytesToString","bech32m","base58xrp","base58flickr","base32hex","base32crockford","coderTypeError","TAGCODES","payment_hash","payment_secret","description","payee","description_hash","expiry","min_final_cltv_expiry","fallback_address","route_hint","feature_bits","runWithTimeout","timeoutMs","timeoutMessage","finally","NDKRelayConnectivity","ndkRelay","_status","connectedAt","_connectionStats","attempts","success","durations","reconnectTimeout","handleNotice","connectHandler","updateConnectionStats","disconnectHandler","disconnected","handleReconnection","authHandler","havePolicy","authPolicy","attempt","isAvailable","isFlapping","avg","variance","reconnectDelay","nextReconnectAt","connectionStats","NDKRelayPublisher","publishWhenConnected","publishEvent","timeoutPromise","onConnectHandler","connectResolve","connectReject","race","nostrEvent","toNostrEvent","connectivity","publishTimeout","publishPromise","isEphemeral","rawEvent","calculateGroupableId","elements","MAX_SUBID_LENGTH","compareFilter","filter1","filter2","valuesInFilter2","valueInFilter2","generateSubId","subscriptions","subIds","subId","subIdParts","filterNonKindKeys","filterKinds","NDKGroupedSubscriptions","req","debug7","handleSubscriptionClosure","addSubscription","eventReceived","eoseReceived","findIndex","NDKSubscriptionFilters","eventMatchesLocalFilter","findMatchingActiveSubscriptions","activeSubscriptions","NDKRelaySubscriptions","delayedItems","delayedTimers","activeSubscriptionsByGroupId","executionTimeoutsByGroupId","groupingDebug","conn","groupableId","subscriptionFilters","isGroupable","executeSubscriptions","activeSubscription","delayedItem","groupableDelayType","executeGroup","groupableDelay","triggeredBy","timeouts","filterCount","mergedFilters","allFiltersAtIndex","di","executeSubscriptionsWhenConnected","groupedSubscriptions","readyListener","executeSubscriptionsConnected","subOptions","trusted","sub2","NDKEvent","subFilters","executedFilters","NDKRelay","EventEmitter2","scores","publisher","complaining","scoreSlowerEvent","timeDiffInMs","tagReference","marker","referenceTags","PublishError","errors","relayErrors","NDKRelaySet","_NDKRelaySet","ndk","addRelay","fromRelayUrls","relayUrls","pool","temporaryRelay","useTemporaryRelay","publishedToRelays","isEphemeral2","promises","calculateRelaySetFromEvent","mergeTags","tags1","tags2","tagMap","isContained","smaller","larger","existingTag","generateKey","generateContentTags","addTagIfNew","entity","nip192","maybeGetEventRelayUrl","nip19Id","isReplaceable","isParamReplaceable","recipient","signer","assertSigner","pTags","getMatchingTags","getUser","hexpubkey","sender","onRelays","nip193","replaceableDTag","tagId","repost","getKind","PUBKEY_REGEX","validate","persist","signatureVerified","debug2","DEFAULT_RELAYS","NDKZap","_NDKZap","EventEmitter3","zappedEvent","zappedUser","getZapperPubkey","forUser","lnurlspec","getZapSpec","getZapConfiguration","getZapSpecWithoutCache","zapEndpoint","fetchProfile","groupable","httpFetch","response","zapSpec","zapEndpointCallback","createZapRequest","extraTags","generateZapRequest","getInvoice","URLSearchParams","nostr","encodeURIComponent","pr","nip57","nonPTags","urls","_NDKEvent","EventEmitter4","_author","user","userOrTagOrEvent","skipAuthorTag","pTag","generateTags","tagName","tagValue","alt","removeTag","dTag","relaySet","devWriteRelaySet","cacheAdapter","deleteEvent","clientName","clientNip89","clientTag","muted","authorMutedEntry","mutedIds","eventTagReference","eventMutedEntry","deduplicationKey","tagAddress","dTagId","react","follows","outbox","contactListEvent","fetchEvent","pubkeys","outboxTracker","trackUsers","NDKUser","profileFromEvent","displayName","display_name","image","picture","banner","bio","nip05","about","zapService","website","serializeProfile","getNip05For","fetchOpts","queuesNip05","loadNip05","nip46Urls","nip46","saveNip05","_NDKUser","_npub","_pubkey","npub","nip194","queuesZapConfig","loadUsersLNURLDoc","saveUsersLNURLDoc","zapConfig","fromNip05","nip05Id","skipCache","cache","setMetadataEvents","cacheUsage","locking","fetchEvents","closeOnEose","sortedSetMetadataEvents","saveProfile","follow","newFollow","currentFollowList","unfollow","validateNip05","profilePointer","NDKNip07Signer","_userPromise","nip04Queue","nip04Processing","waitTimeout","debug5","blockUntilReady","waitForExtension","signEvent","getRelays","activeRelays","read","write","recipientHexPubKey","queueNip04","senderHexPubKey","counterpartyHexpubkey","processNip04Queue","retries","nip04","timerId","intervalId","checkNIP44Support","nip44","encryptContent","decryptContent","publishTodoItem","isPrivate","eventContent","encrypted","publishStatusUpdate","todoEventId","publishDeletion","t15_value","t17_value","create_if_block_14","create_if_block_6","create_if_block_4","create_if_block_3","img1","img1_src_value","div8","aside","div0","nav","div3","div2","div1","button1","main","div7","header","div4","div5","label","input0","span4","span5","div6","input1","button2","t15","t17","t22","t22_value","create_if_block_2","span","eventId","section","button","button0","t0_value","create_if_block_11","create_if_block_12","create_if_block_13","if_block1","create_if_block_10","create_if_block_7","create_if_block_8","create_if_block_9","span_class_value","div4_class_value","create_if_block_5","create_if_block_1","waitForNostr","maxAttempts","RELAYS_URL","profilePicture","isLoading","newTaskInput","errorMessage","todos","statuses","deletedIds","isPrivateMode","nip44Available","handleEvent","encryptedTag","todoContent","todoId","existing","addItem","trim","updateStatus","newStatus","profileEvent","latest","profilePool","profileSub","unsubGet","initializeApp","activeTodos","todo","completedTodos","checked","TodoPage","Login","div22","div11","p0","div10","div20","div21","nip07signer","alert","App"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102]}